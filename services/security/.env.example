# ============================================================================
# SECURITY SERVICE CONFIGURATION
# SOC 2 Compliant Settings
# ============================================================================

# ============================================================================
# ENCRYPTION SETTINGS (REQUIRED)
# ============================================================================

# Master Encryption Key (256-bit, base64-encoded)
# Generate with: python -c 'import os; import base64; print(base64.b64encode(os.urandom(32)).decode())'
MASTER_ENCRYPTION_KEY=REPLACE_WITH_GENERATED_KEY

# Key rotation period (days)
KEY_ROTATION_DAYS=90

# Enable field-level encryption
ENABLE_FIELD_ENCRYPTION=true

# ============================================================================
# AUDIT LOGGING SETTINGS
# ============================================================================

# Enable comprehensive audit logging
ENABLE_AUDIT_LOGGING=true

# Audit log retention periods (days)
AUDIT_LOG_RETENTION_DAYS=2555  # 7 years for financial compliance
SECURITY_LOG_RETENTION_DAYS=730  # 2 years for security events
ACCESS_LOG_RETENTION_DAYS=365  # 1 year for access logs

# External logging system (optional)
EXTERNAL_LOG_ENDPOINT=
EXTERNAL_LOG_API_KEY=

# ============================================================================
# SECURITY MIDDLEWARE SETTINGS
# ============================================================================

# Rate limiting
ENABLE_RATE_LIMITING=true
RATE_LIMIT_DEFAULT=100
RATE_LIMIT_AUTHENTICATED=1000
RATE_LIMIT_LOGIN=5

# IP filtering (optional)
ENABLE_IP_FILTERING=false
IP_ALLOWLIST=
IP_DENYLIST=

# CSRF protection
ENABLE_CSRF_PROTECTION=true
CSRF_TOKEN_EXPIRY_HOURS=1

# ============================================================================
# SESSION SECURITY SETTINGS
# ============================================================================

# Session timeouts
SESSION_TIMEOUT_MINUTES=30
SESSION_ABSOLUTE_TIMEOUT_HOURS=8
MAX_CONCURRENT_SESSIONS=3

# MFA requirements
REQUIRE_MFA_FOR_PRIVILEGED=true

# ============================================================================
# KEY MANAGEMENT SETTINGS
# ============================================================================

# KMS Provider (internal, aws_kms, vault, azure_kms)
KMS_PROVIDER=internal

# AWS KMS (if using aws_kms)
AWS_KMS_KEY_ID=
AWS_KMS_REGION=us-east-1

# HashiCorp Vault (if using vault)
VAULT_ADDR=
VAULT_TOKEN=
VAULT_NAMESPACE=

# Azure Key Vault (if using azure_kms)
AZURE_KEY_VAULT_URL=
AZURE_KEY_VAULT_KEY_NAME=

# ============================================================================
# SOC 2 COMPLIANCE SETTINGS
# ============================================================================

# Enable SOC 2 compliance tracking
ENABLE_SOC2_TRACKING=true

# Audit period
SOC2_AUDIT_PERIOD_START=2025-01-01
SOC2_AUDIT_PERIOD_END=2025-12-31

# Audit firm details
SOC2_AUDIT_FIRM=
SOC2_AUDIT_PARTNER=

# Trust Service Categories (CC, A, C, PI, P)
SOC2_TSC_CATEGORIES=CC,A,C,PI

# ============================================================================
# SECURITY MONITORING SETTINGS
# ============================================================================

# Enable security monitoring and alerts
ENABLE_SECURITY_MONITORING=true
ENABLE_SECURITY_ALERTS=true

# Alert thresholds
FAILED_LOGIN_ALERT_THRESHOLD=5
UNAUTHORIZED_ACCESS_ALERT_THRESHOLD=3

# Alert destinations
SECURITY_ALERT_EMAIL=security@yourcompany.com
SECURITY_ALERT_WEBHOOK=

# ============================================================================
# VULNERABILITY SCANNING SETTINGS
# ============================================================================

# Enable automated vulnerability scanning
ENABLE_VULNERABILITY_SCANNING=true
VULNERABILITY_SCAN_FREQUENCY_DAYS=7
VULNERABILITY_SCAN_TOOL=

# ============================================================================
# BACKUP AND RECOVERY SETTINGS
# ============================================================================

# Automated backups
ENABLE_AUTOMATED_BACKUPS=true
BACKUP_FREQUENCY_HOURS=24
BACKUP_RETENTION_DAYS=30
ENCRYPT_BACKUPS=true
TEST_RECOVERY_QUARTERLY=true

# ============================================================================
# GENERAL SETTINGS
# ============================================================================

# Environment (development, staging, production)
ENVIRONMENT=production

# Debug mode (NEVER enable in production)
DEBUG=false

# Service name
SERVICE_NAME=security-service
