var _4=Object.defineProperty;var zx=e=>{throw TypeError(e)};var k4=(e,t,r)=>t in e?_4(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Wt=(e,t,r)=>k4(e,typeof t!="symbol"?t+"":t,r),af=(e,t,r)=>t.has(e)||zx("Cannot "+r);var re=(e,t,r)=>(af(e,t,"read from private field"),r?r.call(e):t.get(e)),Ie=(e,t,r)=>t.has(e)?zx("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),_e=(e,t,r,s)=>(af(e,t,"write to private field"),s?s.call(e,r):t.set(e,r),r),Zt=(e,t,r)=>(af(e,t,"access private method"),r);var fu=(e,t,r,s)=>({set _(n){_e(e,t,n,r)},get _(){return re(e,t,s)}});function S4(e,t){for(var r=0;r<t.length;r++){const s=t[r];if(typeof s!="string"&&!Array.isArray(s)){for(const n in s)if(n!=="default"&&!(n in e)){const i=Object.getOwnPropertyDescriptor(s,n);i&&Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:()=>s[n]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();function C4(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var d2={exports:{}},u0={},f2={exports:{}},Pe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rc=Symbol.for("react.element"),T4=Symbol.for("react.portal"),E4=Symbol.for("react.fragment"),A4=Symbol.for("react.strict_mode"),F4=Symbol.for("react.profiler"),R4=Symbol.for("react.provider"),P4=Symbol.for("react.context"),D4=Symbol.for("react.forward_ref"),I4=Symbol.for("react.suspense"),O4=Symbol.for("react.memo"),M4=Symbol.for("react.lazy"),Hx=Symbol.iterator;function L4(e){return e===null||typeof e!="object"?null:(e=Hx&&e[Hx]||e["@@iterator"],typeof e=="function"?e:null)}var h2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m2=Object.assign,p2={};function $l(e,t,r){this.props=e,this.context=t,this.refs=p2,this.updater=r||h2}$l.prototype.isReactComponent={};$l.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};$l.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function x2(){}x2.prototype=$l.prototype;function Um(e,t,r){this.props=e,this.context=t,this.refs=p2,this.updater=r||h2}var $m=Um.prototype=new x2;$m.constructor=Um;m2($m,$l.prototype);$m.isPureReactComponent=!0;var Wx=Array.isArray,g2=Object.prototype.hasOwnProperty,Vm={current:null},y2={key:!0,ref:!0,__self:!0,__source:!0};function v2(e,t,r){var s,n={},i=null,l=null;if(t!=null)for(s in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(i=""+t.key),t)g2.call(t,s)&&!y2.hasOwnProperty(s)&&(n[s]=t[s]);var o=arguments.length-2;if(o===1)n.children=r;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];n.children=c}if(e&&e.defaultProps)for(s in o=e.defaultProps,o)n[s]===void 0&&(n[s]=o[s]);return{$$typeof:Rc,type:e,key:i,ref:l,props:n,_owner:Vm.current}}function B4(e,t){return{$$typeof:Rc,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function zm(e){return typeof e=="object"&&e!==null&&e.$$typeof===Rc}function U4(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Gx=/\/+/g;function nf(e,t){return typeof e=="object"&&e!==null&&e.key!=null?U4(""+e.key):t.toString(36)}function Ku(e,t,r,s,n){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Rc:case T4:l=!0}}if(l)return l=e,n=n(l),e=s===""?"."+nf(l,0):s,Wx(n)?(r="",e!=null&&(r=e.replace(Gx,"$&/")+"/"),Ku(n,t,r,"",function(u){return u})):n!=null&&(zm(n)&&(n=B4(n,r+(!n.key||l&&l.key===n.key?"":(""+n.key).replace(Gx,"$&/")+"/")+e)),t.push(n)),1;if(l=0,s=s===""?".":s+":",Wx(e))for(var o=0;o<e.length;o++){i=e[o];var c=s+nf(i,o);l+=Ku(i,t,r,c,n)}else if(c=L4(e),typeof c=="function")for(e=c.call(e),o=0;!(i=e.next()).done;)i=i.value,c=s+nf(i,o++),l+=Ku(i,t,r,c,n);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function hu(e,t,r){if(e==null)return e;var s=[],n=0;return Ku(e,s,"","",function(i){return t.call(r,i,n++)}),s}function $4(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Sr={current:null},Xu={transition:null},V4={ReactCurrentDispatcher:Sr,ReactCurrentBatchConfig:Xu,ReactCurrentOwner:Vm};function w2(){throw Error("act(...) is not supported in production builds of React.")}Pe.Children={map:hu,forEach:function(e,t,r){hu(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return hu(e,function(){t++}),t},toArray:function(e){return hu(e,function(t){return t})||[]},only:function(e){if(!zm(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Pe.Component=$l;Pe.Fragment=E4;Pe.Profiler=F4;Pe.PureComponent=Um;Pe.StrictMode=A4;Pe.Suspense=I4;Pe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=V4;Pe.act=w2;Pe.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=m2({},e.props),n=e.key,i=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,l=Vm.current),t.key!==void 0&&(n=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)g2.call(t,c)&&!y2.hasOwnProperty(c)&&(s[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)s.children=r;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];s.children=o}return{$$typeof:Rc,type:e.type,key:n,ref:i,props:s,_owner:l}};Pe.createContext=function(e){return e={$$typeof:P4,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:R4,_context:e},e.Consumer=e};Pe.createElement=v2;Pe.createFactory=function(e){var t=v2.bind(null,e);return t.type=e,t};Pe.createRef=function(){return{current:null}};Pe.forwardRef=function(e){return{$$typeof:D4,render:e}};Pe.isValidElement=zm;Pe.lazy=function(e){return{$$typeof:M4,_payload:{_status:-1,_result:e},_init:$4}};Pe.memo=function(e,t){return{$$typeof:O4,type:e,compare:t===void 0?null:t}};Pe.startTransition=function(e){var t=Xu.transition;Xu.transition={};try{e()}finally{Xu.transition=t}};Pe.unstable_act=w2;Pe.useCallback=function(e,t){return Sr.current.useCallback(e,t)};Pe.useContext=function(e){return Sr.current.useContext(e)};Pe.useDebugValue=function(){};Pe.useDeferredValue=function(e){return Sr.current.useDeferredValue(e)};Pe.useEffect=function(e,t){return Sr.current.useEffect(e,t)};Pe.useId=function(){return Sr.current.useId()};Pe.useImperativeHandle=function(e,t,r){return Sr.current.useImperativeHandle(e,t,r)};Pe.useInsertionEffect=function(e,t){return Sr.current.useInsertionEffect(e,t)};Pe.useLayoutEffect=function(e,t){return Sr.current.useLayoutEffect(e,t)};Pe.useMemo=function(e,t){return Sr.current.useMemo(e,t)};Pe.useReducer=function(e,t,r){return Sr.current.useReducer(e,t,r)};Pe.useRef=function(e){return Sr.current.useRef(e)};Pe.useState=function(e){return Sr.current.useState(e)};Pe.useSyncExternalStore=function(e,t,r){return Sr.current.useSyncExternalStore(e,t,r)};Pe.useTransition=function(){return Sr.current.useTransition()};Pe.version="18.3.1";f2.exports=Pe;var C=f2.exports;const Ei=C4(C),z4=S4({__proto__:null,default:Ei},[C]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H4=C,W4=Symbol.for("react.element"),G4=Symbol.for("react.fragment"),q4=Object.prototype.hasOwnProperty,Y4=H4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,K4={key:!0,ref:!0,__self:!0,__source:!0};function b2(e,t,r){var s,n={},i=null,l=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(l=t.ref);for(s in t)q4.call(t,s)&&!K4.hasOwnProperty(s)&&(n[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)n[s]===void 0&&(n[s]=t[s]);return{$$typeof:W4,type:e,key:i,ref:l,props:n,_owner:Y4.current}}u0.Fragment=G4;u0.jsx=b2;u0.jsxs=b2;d2.exports=u0;var a=d2.exports,ch={},j2={exports:{}},es={},N2={exports:{}},_2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(se,H){var ne=se.length;se.push(H);e:for(;0<ne;){var W=ne-1>>>1,T=se[W];if(0<n(T,H))se[W]=H,se[ne]=T,ne=W;else break e}}function r(se){return se.length===0?null:se[0]}function s(se){if(se.length===0)return null;var H=se[0],ne=se.pop();if(ne!==H){se[0]=ne;e:for(var W=0,T=se.length,L=T>>>1;W<L;){var B=2*(W+1)-1,V=se[B],te=B+1,ue=se[te];if(0>n(V,ne))te<T&&0>n(ue,V)?(se[W]=ue,se[te]=ne,W=te):(se[W]=V,se[B]=ne,W=B);else if(te<T&&0>n(ue,ne))se[W]=ue,se[te]=ne,W=te;else break e}}return H}function n(se,H){var ne=se.sortIndex-H.sortIndex;return ne!==0?ne:se.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var c=[],u=[],d=1,f=null,h=3,x=!1,m=!1,p=!1,w=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(se){for(var H=r(u);H!==null;){if(H.callback===null)s(u);else if(H.startTime<=se)s(u),H.sortIndex=H.expirationTime,t(c,H);else break;H=r(u)}}function j(se){if(p=!1,y(se),!m)if(r(c)!==null)m=!0,ee(A);else{var H=r(u);H!==null&&fe(j,H.startTime-se)}}function A(se,H){m=!1,p&&(p=!1,b(E),E=-1),x=!0;var ne=h;try{for(y(H),f=r(c);f!==null&&(!(f.expirationTime>H)||se&&!D());){var W=f.callback;if(typeof W=="function"){f.callback=null,h=f.priorityLevel;var T=W(f.expirationTime<=H);H=e.unstable_now(),typeof T=="function"?f.callback=T:f===r(c)&&s(c),y(H)}else s(c);f=r(c)}if(f!==null)var L=!0;else{var B=r(u);B!==null&&fe(j,B.startTime-H),L=!1}return L}finally{f=null,h=ne,x=!1}}var k=!1,v=null,E=-1,S=5,N=-1;function D(){return!(e.unstable_now()-N<S)}function F(){if(v!==null){var se=e.unstable_now();N=se;var H=!0;try{H=v(!0,se)}finally{H?Y():(k=!1,v=null)}}else k=!1}var Y;if(typeof g=="function")Y=function(){g(F)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,ae=Q.port2;Q.port1.onmessage=F,Y=function(){ae.postMessage(null)}}else Y=function(){w(F,0)};function ee(se){v=se,k||(k=!0,Y())}function fe(se,H){E=w(function(){se(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(se){se.callback=null},e.unstable_continueExecution=function(){m||x||(m=!0,ee(A))},e.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<se?Math.floor(1e3/se):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(se){switch(h){case 1:case 2:case 3:var H=3;break;default:H=h}var ne=h;h=H;try{return se()}finally{h=ne}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(se,H){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var ne=h;h=se;try{return H()}finally{h=ne}},e.unstable_scheduleCallback=function(se,H,ne){var W=e.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?W+ne:W):ne=W,se){case 1:var T=-1;break;case 2:T=250;break;case 5:T=1073741823;break;case 4:T=1e4;break;default:T=5e3}return T=ne+T,se={id:d++,callback:H,priorityLevel:se,startTime:ne,expirationTime:T,sortIndex:-1},ne>W?(se.sortIndex=ne,t(u,se),r(c)===null&&se===r(u)&&(p?(b(E),E=-1):p=!0,fe(j,ne-W))):(se.sortIndex=T,t(c,se),m||x||(m=!0,ee(A))),se},e.unstable_shouldYield=D,e.unstable_wrapCallback=function(se){var H=h;return function(){var ne=h;h=H;try{return se.apply(this,arguments)}finally{h=ne}}}})(_2);N2.exports=_2;var X4=N2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Q4=C,Kr=X4;function ce(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var k2=new Set,Wo={};function Ai(e,t){Tl(e,t),Tl(e+"Capture",t)}function Tl(e,t){for(Wo[e]=t,e=0;e<t.length;e++)k2.add(t[e])}var Pa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),uh=Object.prototype.hasOwnProperty,J4=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,qx={},Yx={};function Z4(e){return uh.call(Yx,e)?!0:uh.call(qx,e)?!1:J4.test(e)?Yx[e]=!0:(qx[e]=!0,!1)}function ek(e,t,r,s){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function tk(e,t,r,s){if(t===null||typeof t>"u"||ek(e,t,r,s))return!0;if(s)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Cr(e,t,r,s,n,i,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=n,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=l}var Qt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Qt[e]=new Cr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Qt[t]=new Cr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Qt[e]=new Cr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Qt[e]=new Cr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Qt[e]=new Cr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Qt[e]=new Cr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Qt[e]=new Cr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Qt[e]=new Cr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Qt[e]=new Cr(e,5,!1,e.toLowerCase(),null,!1,!1)});var Hm=/[\-:]([a-z])/g;function Wm(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Hm,Wm);Qt[t]=new Cr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Hm,Wm);Qt[t]=new Cr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Hm,Wm);Qt[t]=new Cr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Qt[e]=new Cr(e,1,!1,e.toLowerCase(),null,!1,!1)});Qt.xlinkHref=new Cr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Qt[e]=new Cr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Gm(e,t,r,s){var n=Qt.hasOwnProperty(t)?Qt[t]:null;(n!==null?n.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(tk(t,r,n,s)&&(r=null),s||n===null?Z4(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):n.mustUseProperty?e[n.propertyName]=r===null?n.type===3?!1:"":r:(t=n.attributeName,s=n.attributeNamespace,r===null?e.removeAttribute(t):(n=n.type,r=n===3||n===4&&r===!0?"":""+r,s?e.setAttributeNS(s,t,r):e.setAttribute(t,r))))}var Va=Q4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,mu=Symbol.for("react.element"),Yi=Symbol.for("react.portal"),Ki=Symbol.for("react.fragment"),qm=Symbol.for("react.strict_mode"),dh=Symbol.for("react.profiler"),S2=Symbol.for("react.provider"),C2=Symbol.for("react.context"),Ym=Symbol.for("react.forward_ref"),fh=Symbol.for("react.suspense"),hh=Symbol.for("react.suspense_list"),Km=Symbol.for("react.memo"),Ka=Symbol.for("react.lazy"),T2=Symbol.for("react.offscreen"),Kx=Symbol.iterator;function to(e){return e===null||typeof e!="object"?null:(e=Kx&&e[Kx]||e["@@iterator"],typeof e=="function"?e:null)}var ht=Object.assign,lf;function mo(e){if(lf===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);lf=t&&t[1]||""}return`
`+lf+e}var of=!1;function cf(e,t){if(!e||of)return"";of=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var s=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){s=u}e.call(t.prototype)}else{try{throw Error()}catch(u){s=u}e()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var n=u.stack.split(`
`),i=s.stack.split(`
`),l=n.length-1,o=i.length-1;1<=l&&0<=o&&n[l]!==i[o];)o--;for(;1<=l&&0<=o;l--,o--)if(n[l]!==i[o]){if(l!==1||o!==1)do if(l--,o--,0>o||n[l]!==i[o]){var c=`
`+n[l].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=l&&0<=o);break}}}finally{of=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?mo(e):""}function rk(e){switch(e.tag){case 5:return mo(e.type);case 16:return mo("Lazy");case 13:return mo("Suspense");case 19:return mo("SuspenseList");case 0:case 2:case 15:return e=cf(e.type,!1),e;case 11:return e=cf(e.type.render,!1),e;case 1:return e=cf(e.type,!0),e;default:return""}}function mh(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ki:return"Fragment";case Yi:return"Portal";case dh:return"Profiler";case qm:return"StrictMode";case fh:return"Suspense";case hh:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case C2:return(e.displayName||"Context")+".Consumer";case S2:return(e._context.displayName||"Context")+".Provider";case Ym:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Km:return t=e.displayName||null,t!==null?t:mh(e.type)||"Memo";case Ka:t=e._payload,e=e._init;try{return mh(e(t))}catch{}}return null}function sk(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return mh(t);case 8:return t===qm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Sn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function E2(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function ak(e){var t=E2(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var n=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(l){s=""+l,i.call(this,l)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return s},setValue:function(l){s=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function pu(e){e._valueTracker||(e._valueTracker=ak(e))}function A2(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),s="";return e&&(s=E2(e)?e.checked?"true":"false":e.value),e=s,e!==r?(t.setValue(e),!0):!1}function md(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function ph(e,t){var r=t.checked;return ht({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Xx(e,t){var r=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;r=Sn(t.value!=null?t.value:r),e._wrapperState={initialChecked:s,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function F2(e,t){t=t.checked,t!=null&&Gm(e,"checked",t,!1)}function xh(e,t){F2(e,t);var r=Sn(t.value),s=t.type;if(r!=null)s==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?gh(e,t.type,r):t.hasOwnProperty("defaultValue")&&gh(e,t.type,Sn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Qx(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function gh(e,t,r){(t!=="number"||md(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var po=Array.isArray;function dl(e,t,r,s){if(e=e.options,t){t={};for(var n=0;n<r.length;n++)t["$"+r[n]]=!0;for(r=0;r<e.length;r++)n=t.hasOwnProperty("$"+e[r].value),e[r].selected!==n&&(e[r].selected=n),n&&s&&(e[r].defaultSelected=!0)}else{for(r=""+Sn(r),t=null,n=0;n<e.length;n++){if(e[n].value===r){e[n].selected=!0,s&&(e[n].defaultSelected=!0);return}t!==null||e[n].disabled||(t=e[n])}t!==null&&(t.selected=!0)}}function yh(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ce(91));return ht({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Jx(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ce(92));if(po(r)){if(1<r.length)throw Error(ce(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Sn(r)}}function R2(e,t){var r=Sn(t.value),s=Sn(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),s!=null&&(e.defaultValue=""+s)}function Zx(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function P2(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function vh(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?P2(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var xu,D2=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,s,n){MSApp.execUnsafeLocalFunction(function(){return e(t,r,s,n)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(xu=xu||document.createElement("div"),xu.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=xu.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Go(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var No={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},nk=["Webkit","ms","Moz","O"];Object.keys(No).forEach(function(e){nk.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),No[t]=No[e]})});function I2(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||No.hasOwnProperty(e)&&No[e]?(""+t).trim():t+"px"}function O2(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var s=r.indexOf("--")===0,n=I2(r,t[r],s);r==="float"&&(r="cssFloat"),s?e.setProperty(r,n):e[r]=n}}var ik=ht({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function wh(e,t){if(t){if(ik[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ce(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ce(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ce(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ce(62))}}function bh(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jh=null;function Xm(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Nh=null,fl=null,hl=null;function eg(e){if(e=Ic(e)){if(typeof Nh!="function")throw Error(ce(280));var t=e.stateNode;t&&(t=p0(t),Nh(e.stateNode,e.type,t))}}function M2(e){fl?hl?hl.push(e):hl=[e]:fl=e}function L2(){if(fl){var e=fl,t=hl;if(hl=fl=null,eg(e),t)for(e=0;e<t.length;e++)eg(t[e])}}function B2(e,t){return e(t)}function U2(){}var uf=!1;function $2(e,t,r){if(uf)return e(t,r);uf=!0;try{return B2(e,t,r)}finally{uf=!1,(fl!==null||hl!==null)&&(U2(),L2())}}function qo(e,t){var r=e.stateNode;if(r===null)return null;var s=p0(r);if(s===null)return null;r=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ce(231,t,typeof r));return r}var _h=!1;if(Pa)try{var ro={};Object.defineProperty(ro,"passive",{get:function(){_h=!0}}),window.addEventListener("test",ro,ro),window.removeEventListener("test",ro,ro)}catch{_h=!1}function lk(e,t,r,s,n,i,l,o,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var _o=!1,pd=null,xd=!1,kh=null,ok={onError:function(e){_o=!0,pd=e}};function ck(e,t,r,s,n,i,l,o,c){_o=!1,pd=null,lk.apply(ok,arguments)}function uk(e,t,r,s,n,i,l,o,c){if(ck.apply(this,arguments),_o){if(_o){var u=pd;_o=!1,pd=null}else throw Error(ce(198));xd||(xd=!0,kh=u)}}function Fi(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function V2(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function tg(e){if(Fi(e)!==e)throw Error(ce(188))}function dk(e){var t=e.alternate;if(!t){if(t=Fi(e),t===null)throw Error(ce(188));return t!==e?null:e}for(var r=e,s=t;;){var n=r.return;if(n===null)break;var i=n.alternate;if(i===null){if(s=n.return,s!==null){r=s;continue}break}if(n.child===i.child){for(i=n.child;i;){if(i===r)return tg(n),e;if(i===s)return tg(n),t;i=i.sibling}throw Error(ce(188))}if(r.return!==s.return)r=n,s=i;else{for(var l=!1,o=n.child;o;){if(o===r){l=!0,r=n,s=i;break}if(o===s){l=!0,s=n,r=i;break}o=o.sibling}if(!l){for(o=i.child;o;){if(o===r){l=!0,r=i,s=n;break}if(o===s){l=!0,s=i,r=n;break}o=o.sibling}if(!l)throw Error(ce(189))}}if(r.alternate!==s)throw Error(ce(190))}if(r.tag!==3)throw Error(ce(188));return r.stateNode.current===r?e:t}function z2(e){return e=dk(e),e!==null?H2(e):null}function H2(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=H2(e);if(t!==null)return t;e=e.sibling}return null}var W2=Kr.unstable_scheduleCallback,rg=Kr.unstable_cancelCallback,fk=Kr.unstable_shouldYield,hk=Kr.unstable_requestPaint,bt=Kr.unstable_now,mk=Kr.unstable_getCurrentPriorityLevel,Qm=Kr.unstable_ImmediatePriority,G2=Kr.unstable_UserBlockingPriority,gd=Kr.unstable_NormalPriority,pk=Kr.unstable_LowPriority,q2=Kr.unstable_IdlePriority,d0=null,na=null;function xk(e){if(na&&typeof na.onCommitFiberRoot=="function")try{na.onCommitFiberRoot(d0,e,void 0,(e.current.flags&128)===128)}catch{}}var Ds=Math.clz32?Math.clz32:vk,gk=Math.log,yk=Math.LN2;function vk(e){return e>>>=0,e===0?32:31-(gk(e)/yk|0)|0}var gu=64,yu=4194304;function xo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function yd(e,t){var r=e.pendingLanes;if(r===0)return 0;var s=0,n=e.suspendedLanes,i=e.pingedLanes,l=r&268435455;if(l!==0){var o=l&~n;o!==0?s=xo(o):(i&=l,i!==0&&(s=xo(i)))}else l=r&~n,l!==0?s=xo(l):i!==0&&(s=xo(i));if(s===0)return 0;if(t!==0&&t!==s&&!(t&n)&&(n=s&-s,i=t&-t,n>=i||n===16&&(i&4194240)!==0))return t;if(s&4&&(s|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)r=31-Ds(t),n=1<<r,s|=e[r],t&=~n;return s}function wk(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bk(e,t){for(var r=e.suspendedLanes,s=e.pingedLanes,n=e.expirationTimes,i=e.pendingLanes;0<i;){var l=31-Ds(i),o=1<<l,c=n[l];c===-1?(!(o&r)||o&s)&&(n[l]=wk(o,t)):c<=t&&(e.expiredLanes|=o),i&=~o}}function Sh(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Y2(){var e=gu;return gu<<=1,!(gu&4194240)&&(gu=64),e}function df(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Pc(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ds(t),e[t]=r}function jk(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<r;){var n=31-Ds(r),i=1<<n;t[n]=0,s[n]=-1,e[n]=-1,r&=~i}}function Jm(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var s=31-Ds(r),n=1<<s;n&t|e[s]&t&&(e[s]|=t),r&=~n}}var Ge=0;function K2(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var X2,Zm,Q2,J2,Z2,Ch=!1,vu=[],xn=null,gn=null,yn=null,Yo=new Map,Ko=new Map,Ja=[],Nk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function sg(e,t){switch(e){case"focusin":case"focusout":xn=null;break;case"dragenter":case"dragleave":gn=null;break;case"mouseover":case"mouseout":yn=null;break;case"pointerover":case"pointerout":Yo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ko.delete(t.pointerId)}}function so(e,t,r,s,n,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:s,nativeEvent:i,targetContainers:[n]},t!==null&&(t=Ic(t),t!==null&&Zm(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,n!==null&&t.indexOf(n)===-1&&t.push(n),e)}function _k(e,t,r,s,n){switch(t){case"focusin":return xn=so(xn,e,t,r,s,n),!0;case"dragenter":return gn=so(gn,e,t,r,s,n),!0;case"mouseover":return yn=so(yn,e,t,r,s,n),!0;case"pointerover":var i=n.pointerId;return Yo.set(i,so(Yo.get(i)||null,e,t,r,s,n)),!0;case"gotpointercapture":return i=n.pointerId,Ko.set(i,so(Ko.get(i)||null,e,t,r,s,n)),!0}return!1}function ew(e){var t=Jn(e.target);if(t!==null){var r=Fi(t);if(r!==null){if(t=r.tag,t===13){if(t=V2(r),t!==null){e.blockedOn=t,Z2(e.priority,function(){Q2(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Qu(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Th(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var s=new r.constructor(r.type,r);jh=s,r.target.dispatchEvent(s),jh=null}else return t=Ic(r),t!==null&&Zm(t),e.blockedOn=r,!1;t.shift()}return!0}function ag(e,t,r){Qu(e)&&r.delete(t)}function kk(){Ch=!1,xn!==null&&Qu(xn)&&(xn=null),gn!==null&&Qu(gn)&&(gn=null),yn!==null&&Qu(yn)&&(yn=null),Yo.forEach(ag),Ko.forEach(ag)}function ao(e,t){e.blockedOn===t&&(e.blockedOn=null,Ch||(Ch=!0,Kr.unstable_scheduleCallback(Kr.unstable_NormalPriority,kk)))}function Xo(e){function t(n){return ao(n,e)}if(0<vu.length){ao(vu[0],e);for(var r=1;r<vu.length;r++){var s=vu[r];s.blockedOn===e&&(s.blockedOn=null)}}for(xn!==null&&ao(xn,e),gn!==null&&ao(gn,e),yn!==null&&ao(yn,e),Yo.forEach(t),Ko.forEach(t),r=0;r<Ja.length;r++)s=Ja[r],s.blockedOn===e&&(s.blockedOn=null);for(;0<Ja.length&&(r=Ja[0],r.blockedOn===null);)ew(r),r.blockedOn===null&&Ja.shift()}var ml=Va.ReactCurrentBatchConfig,vd=!0;function Sk(e,t,r,s){var n=Ge,i=ml.transition;ml.transition=null;try{Ge=1,ep(e,t,r,s)}finally{Ge=n,ml.transition=i}}function Ck(e,t,r,s){var n=Ge,i=ml.transition;ml.transition=null;try{Ge=4,ep(e,t,r,s)}finally{Ge=n,ml.transition=i}}function ep(e,t,r,s){if(vd){var n=Th(e,t,r,s);if(n===null)bf(e,t,s,wd,r),sg(e,s);else if(_k(n,e,t,r,s))s.stopPropagation();else if(sg(e,s),t&4&&-1<Nk.indexOf(e)){for(;n!==null;){var i=Ic(n);if(i!==null&&X2(i),i=Th(e,t,r,s),i===null&&bf(e,t,s,wd,r),i===n)break;n=i}n!==null&&s.stopPropagation()}else bf(e,t,s,null,r)}}var wd=null;function Th(e,t,r,s){if(wd=null,e=Xm(s),e=Jn(e),e!==null)if(t=Fi(e),t===null)e=null;else if(r=t.tag,r===13){if(e=V2(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return wd=e,null}function tw(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(mk()){case Qm:return 1;case G2:return 4;case gd:case pk:return 16;case q2:return 536870912;default:return 16}default:return 16}}var dn=null,tp=null,Ju=null;function rw(){if(Ju)return Ju;var e,t=tp,r=t.length,s,n="value"in dn?dn.value:dn.textContent,i=n.length;for(e=0;e<r&&t[e]===n[e];e++);var l=r-e;for(s=1;s<=l&&t[r-s]===n[i-s];s++);return Ju=n.slice(e,1<s?1-s:void 0)}function Zu(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function wu(){return!0}function ng(){return!1}function ts(e){function t(r,s,n,i,l){this._reactName=r,this._targetInst=n,this.type=s,this.nativeEvent=i,this.target=l,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?wu:ng,this.isPropagationStopped=ng,this}return ht(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=wu)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=wu)},persist:function(){},isPersistent:wu}),t}var Vl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rp=ts(Vl),Dc=ht({},Vl,{view:0,detail:0}),Tk=ts(Dc),ff,hf,no,f0=ht({},Dc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sp,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==no&&(no&&e.type==="mousemove"?(ff=e.screenX-no.screenX,hf=e.screenY-no.screenY):hf=ff=0,no=e),ff)},movementY:function(e){return"movementY"in e?e.movementY:hf}}),ig=ts(f0),Ek=ht({},f0,{dataTransfer:0}),Ak=ts(Ek),Fk=ht({},Dc,{relatedTarget:0}),mf=ts(Fk),Rk=ht({},Vl,{animationName:0,elapsedTime:0,pseudoElement:0}),Pk=ts(Rk),Dk=ht({},Vl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ik=ts(Dk),Ok=ht({},Vl,{data:0}),lg=ts(Ok),Mk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Lk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Bk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Uk(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Bk[e])?!!t[e]:!1}function sp(){return Uk}var $k=ht({},Dc,{key:function(e){if(e.key){var t=Mk[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Zu(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Lk[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sp,charCode:function(e){return e.type==="keypress"?Zu(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Zu(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Vk=ts($k),zk=ht({},f0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),og=ts(zk),Hk=ht({},Dc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sp}),Wk=ts(Hk),Gk=ht({},Vl,{propertyName:0,elapsedTime:0,pseudoElement:0}),qk=ts(Gk),Yk=ht({},f0,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Kk=ts(Yk),Xk=[9,13,27,32],ap=Pa&&"CompositionEvent"in window,ko=null;Pa&&"documentMode"in document&&(ko=document.documentMode);var Qk=Pa&&"TextEvent"in window&&!ko,sw=Pa&&(!ap||ko&&8<ko&&11>=ko),cg=" ",ug=!1;function aw(e,t){switch(e){case"keyup":return Xk.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nw(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Xi=!1;function Jk(e,t){switch(e){case"compositionend":return nw(t);case"keypress":return t.which!==32?null:(ug=!0,cg);case"textInput":return e=t.data,e===cg&&ug?null:e;default:return null}}function Zk(e,t){if(Xi)return e==="compositionend"||!ap&&aw(e,t)?(e=rw(),Ju=tp=dn=null,Xi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return sw&&t.locale!=="ko"?null:t.data;default:return null}}var eS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function dg(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!eS[e.type]:t==="textarea"}function iw(e,t,r,s){M2(s),t=bd(t,"onChange"),0<t.length&&(r=new rp("onChange","change",null,r,s),e.push({event:r,listeners:t}))}var So=null,Qo=null;function tS(e){gw(e,0)}function h0(e){var t=Zi(e);if(A2(t))return e}function rS(e,t){if(e==="change")return t}var lw=!1;if(Pa){var pf;if(Pa){var xf="oninput"in document;if(!xf){var fg=document.createElement("div");fg.setAttribute("oninput","return;"),xf=typeof fg.oninput=="function"}pf=xf}else pf=!1;lw=pf&&(!document.documentMode||9<document.documentMode)}function hg(){So&&(So.detachEvent("onpropertychange",ow),Qo=So=null)}function ow(e){if(e.propertyName==="value"&&h0(Qo)){var t=[];iw(t,Qo,e,Xm(e)),$2(tS,t)}}function sS(e,t,r){e==="focusin"?(hg(),So=t,Qo=r,So.attachEvent("onpropertychange",ow)):e==="focusout"&&hg()}function aS(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return h0(Qo)}function nS(e,t){if(e==="click")return h0(t)}function iS(e,t){if(e==="input"||e==="change")return h0(t)}function lS(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ls=typeof Object.is=="function"?Object.is:lS;function Jo(e,t){if(Ls(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;for(s=0;s<r.length;s++){var n=r[s];if(!uh.call(t,n)||!Ls(e[n],t[n]))return!1}return!0}function mg(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function pg(e,t){var r=mg(e);e=0;for(var s;r;){if(r.nodeType===3){if(s=e+r.textContent.length,e<=t&&s>=t)return{node:r,offset:t-e};e=s}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=mg(r)}}function cw(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?cw(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function uw(){for(var e=window,t=md();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=md(e.document)}return t}function np(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function oS(e){var t=uw(),r=e.focusedElem,s=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&cw(r.ownerDocument.documentElement,r)){if(s!==null&&np(r)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var n=r.textContent.length,i=Math.min(s.start,n);s=s.end===void 0?i:Math.min(s.end,n),!e.extend&&i>s&&(n=s,s=i,i=n),n=pg(r,i);var l=pg(r,s);n&&l&&(e.rangeCount!==1||e.anchorNode!==n.node||e.anchorOffset!==n.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(n.node,n.offset),e.removeAllRanges(),i>s?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var cS=Pa&&"documentMode"in document&&11>=document.documentMode,Qi=null,Eh=null,Co=null,Ah=!1;function xg(e,t,r){var s=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Ah||Qi==null||Qi!==md(s)||(s=Qi,"selectionStart"in s&&np(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Co&&Jo(Co,s)||(Co=s,s=bd(Eh,"onSelect"),0<s.length&&(t=new rp("onSelect","select",null,t,r),e.push({event:t,listeners:s}),t.target=Qi)))}function bu(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ji={animationend:bu("Animation","AnimationEnd"),animationiteration:bu("Animation","AnimationIteration"),animationstart:bu("Animation","AnimationStart"),transitionend:bu("Transition","TransitionEnd")},gf={},dw={};Pa&&(dw=document.createElement("div").style,"AnimationEvent"in window||(delete Ji.animationend.animation,delete Ji.animationiteration.animation,delete Ji.animationstart.animation),"TransitionEvent"in window||delete Ji.transitionend.transition);function m0(e){if(gf[e])return gf[e];if(!Ji[e])return e;var t=Ji[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in dw)return gf[e]=t[r];return e}var fw=m0("animationend"),hw=m0("animationiteration"),mw=m0("animationstart"),pw=m0("transitionend"),xw=new Map,gg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rn(e,t){xw.set(e,t),Ai(t,[e])}for(var yf=0;yf<gg.length;yf++){var vf=gg[yf],uS=vf.toLowerCase(),dS=vf[0].toUpperCase()+vf.slice(1);Rn(uS,"on"+dS)}Rn(fw,"onAnimationEnd");Rn(hw,"onAnimationIteration");Rn(mw,"onAnimationStart");Rn("dblclick","onDoubleClick");Rn("focusin","onFocus");Rn("focusout","onBlur");Rn(pw,"onTransitionEnd");Tl("onMouseEnter",["mouseout","mouseover"]);Tl("onMouseLeave",["mouseout","mouseover"]);Tl("onPointerEnter",["pointerout","pointerover"]);Tl("onPointerLeave",["pointerout","pointerover"]);Ai("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ai("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ai("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ai("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ai("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ai("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var go="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fS=new Set("cancel close invalid load scroll toggle".split(" ").concat(go));function yg(e,t,r){var s=e.type||"unknown-event";e.currentTarget=r,uk(s,t,void 0,e),e.currentTarget=null}function gw(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var s=e[r],n=s.event;s=s.listeners;e:{var i=void 0;if(t)for(var l=s.length-1;0<=l;l--){var o=s[l],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==i&&n.isPropagationStopped())break e;yg(n,o,u),i=c}else for(l=0;l<s.length;l++){if(o=s[l],c=o.instance,u=o.currentTarget,o=o.listener,c!==i&&n.isPropagationStopped())break e;yg(n,o,u),i=c}}}if(xd)throw e=kh,xd=!1,kh=null,e}function et(e,t){var r=t[Ih];r===void 0&&(r=t[Ih]=new Set);var s=e+"__bubble";r.has(s)||(yw(t,e,2,!1),r.add(s))}function wf(e,t,r){var s=0;t&&(s|=4),yw(r,e,s,t)}var ju="_reactListening"+Math.random().toString(36).slice(2);function Zo(e){if(!e[ju]){e[ju]=!0,k2.forEach(function(r){r!=="selectionchange"&&(fS.has(r)||wf(r,!1,e),wf(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ju]||(t[ju]=!0,wf("selectionchange",!1,t))}}function yw(e,t,r,s){switch(tw(t)){case 1:var n=Sk;break;case 4:n=Ck;break;default:n=ep}r=n.bind(null,t,r,e),n=void 0,!_h||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(n=!0),s?n!==void 0?e.addEventListener(t,r,{capture:!0,passive:n}):e.addEventListener(t,r,!0):n!==void 0?e.addEventListener(t,r,{passive:n}):e.addEventListener(t,r,!1)}function bf(e,t,r,s,n){var i=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var l=s.tag;if(l===3||l===4){var o=s.stateNode.containerInfo;if(o===n||o.nodeType===8&&o.parentNode===n)break;if(l===4)for(l=s.return;l!==null;){var c=l.tag;if((c===3||c===4)&&(c=l.stateNode.containerInfo,c===n||c.nodeType===8&&c.parentNode===n))return;l=l.return}for(;o!==null;){if(l=Jn(o),l===null)return;if(c=l.tag,c===5||c===6){s=i=l;continue e}o=o.parentNode}}s=s.return}$2(function(){var u=i,d=Xm(r),f=[];e:{var h=xw.get(e);if(h!==void 0){var x=rp,m=e;switch(e){case"keypress":if(Zu(r)===0)break e;case"keydown":case"keyup":x=Vk;break;case"focusin":m="focus",x=mf;break;case"focusout":m="blur",x=mf;break;case"beforeblur":case"afterblur":x=mf;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=ig;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=Ak;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=Wk;break;case fw:case hw:case mw:x=Pk;break;case pw:x=qk;break;case"scroll":x=Tk;break;case"wheel":x=Kk;break;case"copy":case"cut":case"paste":x=Ik;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=og}var p=(t&4)!==0,w=!p&&e==="scroll",b=p?h!==null?h+"Capture":null:h;p=[];for(var g=u,y;g!==null;){y=g;var j=y.stateNode;if(y.tag===5&&j!==null&&(y=j,b!==null&&(j=qo(g,b),j!=null&&p.push(ec(g,j,y)))),w)break;g=g.return}0<p.length&&(h=new x(h,m,null,r,d),f.push({event:h,listeners:p}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",x=e==="mouseout"||e==="pointerout",h&&r!==jh&&(m=r.relatedTarget||r.fromElement)&&(Jn(m)||m[Da]))break e;if((x||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,x?(m=r.relatedTarget||r.toElement,x=u,m=m?Jn(m):null,m!==null&&(w=Fi(m),m!==w||m.tag!==5&&m.tag!==6)&&(m=null)):(x=null,m=u),x!==m)){if(p=ig,j="onMouseLeave",b="onMouseEnter",g="mouse",(e==="pointerout"||e==="pointerover")&&(p=og,j="onPointerLeave",b="onPointerEnter",g="pointer"),w=x==null?h:Zi(x),y=m==null?h:Zi(m),h=new p(j,g+"leave",x,r,d),h.target=w,h.relatedTarget=y,j=null,Jn(d)===u&&(p=new p(b,g+"enter",m,r,d),p.target=y,p.relatedTarget=w,j=p),w=j,x&&m)t:{for(p=x,b=m,g=0,y=p;y;y=zi(y))g++;for(y=0,j=b;j;j=zi(j))y++;for(;0<g-y;)p=zi(p),g--;for(;0<y-g;)b=zi(b),y--;for(;g--;){if(p===b||b!==null&&p===b.alternate)break t;p=zi(p),b=zi(b)}p=null}else p=null;x!==null&&vg(f,h,x,p,!1),m!==null&&w!==null&&vg(f,w,m,p,!0)}}e:{if(h=u?Zi(u):window,x=h.nodeName&&h.nodeName.toLowerCase(),x==="select"||x==="input"&&h.type==="file")var A=rS;else if(dg(h))if(lw)A=iS;else{A=aS;var k=sS}else(x=h.nodeName)&&x.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(A=nS);if(A&&(A=A(e,u))){iw(f,A,r,d);break e}k&&k(e,h,u),e==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&gh(h,"number",h.value)}switch(k=u?Zi(u):window,e){case"focusin":(dg(k)||k.contentEditable==="true")&&(Qi=k,Eh=u,Co=null);break;case"focusout":Co=Eh=Qi=null;break;case"mousedown":Ah=!0;break;case"contextmenu":case"mouseup":case"dragend":Ah=!1,xg(f,r,d);break;case"selectionchange":if(cS)break;case"keydown":case"keyup":xg(f,r,d)}var v;if(ap)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Xi?aw(e,r)&&(E="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(sw&&r.locale!=="ko"&&(Xi||E!=="onCompositionStart"?E==="onCompositionEnd"&&Xi&&(v=rw()):(dn=d,tp="value"in dn?dn.value:dn.textContent,Xi=!0)),k=bd(u,E),0<k.length&&(E=new lg(E,e,null,r,d),f.push({event:E,listeners:k}),v?E.data=v:(v=nw(r),v!==null&&(E.data=v)))),(v=Qk?Jk(e,r):Zk(e,r))&&(u=bd(u,"onBeforeInput"),0<u.length&&(d=new lg("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=v))}gw(f,t)})}function ec(e,t,r){return{instance:e,listener:t,currentTarget:r}}function bd(e,t){for(var r=t+"Capture",s=[];e!==null;){var n=e,i=n.stateNode;n.tag===5&&i!==null&&(n=i,i=qo(e,r),i!=null&&s.unshift(ec(e,i,n)),i=qo(e,t),i!=null&&s.push(ec(e,i,n))),e=e.return}return s}function zi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function vg(e,t,r,s,n){for(var i=t._reactName,l=[];r!==null&&r!==s;){var o=r,c=o.alternate,u=o.stateNode;if(c!==null&&c===s)break;o.tag===5&&u!==null&&(o=u,n?(c=qo(r,i),c!=null&&l.unshift(ec(r,c,o))):n||(c=qo(r,i),c!=null&&l.push(ec(r,c,o)))),r=r.return}l.length!==0&&e.push({event:t,listeners:l})}var hS=/\r\n?/g,mS=/\u0000|\uFFFD/g;function wg(e){return(typeof e=="string"?e:""+e).replace(hS,`
`).replace(mS,"")}function Nu(e,t,r){if(t=wg(t),wg(e)!==t&&r)throw Error(ce(425))}function jd(){}var Fh=null,Rh=null;function Ph(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Dh=typeof setTimeout=="function"?setTimeout:void 0,pS=typeof clearTimeout=="function"?clearTimeout:void 0,bg=typeof Promise=="function"?Promise:void 0,xS=typeof queueMicrotask=="function"?queueMicrotask:typeof bg<"u"?function(e){return bg.resolve(null).then(e).catch(gS)}:Dh;function gS(e){setTimeout(function(){throw e})}function jf(e,t){var r=t,s=0;do{var n=r.nextSibling;if(e.removeChild(r),n&&n.nodeType===8)if(r=n.data,r==="/$"){if(s===0){e.removeChild(n),Xo(t);return}s--}else r!=="$"&&r!=="$?"&&r!=="$!"||s++;r=n}while(r);Xo(t)}function vn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function jg(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var zl=Math.random().toString(36).slice(2),sa="__reactFiber$"+zl,tc="__reactProps$"+zl,Da="__reactContainer$"+zl,Ih="__reactEvents$"+zl,yS="__reactListeners$"+zl,vS="__reactHandles$"+zl;function Jn(e){var t=e[sa];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Da]||r[sa]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=jg(e);e!==null;){if(r=e[sa])return r;e=jg(e)}return t}e=r,r=e.parentNode}return null}function Ic(e){return e=e[sa]||e[Da],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Zi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ce(33))}function p0(e){return e[tc]||null}var Oh=[],el=-1;function Pn(e){return{current:e}}function tt(e){0>el||(e.current=Oh[el],Oh[el]=null,el--)}function Ke(e,t){el++,Oh[el]=e.current,e.current=t}var Cn={},fr=Pn(Cn),Pr=Pn(!1),vi=Cn;function El(e,t){var r=e.type.contextTypes;if(!r)return Cn;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var n={},i;for(i in r)n[i]=t[i];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=n),n}function Dr(e){return e=e.childContextTypes,e!=null}function Nd(){tt(Pr),tt(fr)}function Ng(e,t,r){if(fr.current!==Cn)throw Error(ce(168));Ke(fr,t),Ke(Pr,r)}function vw(e,t,r){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return r;s=s.getChildContext();for(var n in s)if(!(n in t))throw Error(ce(108,sk(e)||"Unknown",n));return ht({},r,s)}function _d(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Cn,vi=fr.current,Ke(fr,e),Ke(Pr,Pr.current),!0}function _g(e,t,r){var s=e.stateNode;if(!s)throw Error(ce(169));r?(e=vw(e,t,vi),s.__reactInternalMemoizedMergedChildContext=e,tt(Pr),tt(fr),Ke(fr,e)):tt(Pr),Ke(Pr,r)}var ba=null,x0=!1,Nf=!1;function ww(e){ba===null?ba=[e]:ba.push(e)}function wS(e){x0=!0,ww(e)}function Dn(){if(!Nf&&ba!==null){Nf=!0;var e=0,t=Ge;try{var r=ba;for(Ge=1;e<r.length;e++){var s=r[e];do s=s(!0);while(s!==null)}ba=null,x0=!1}catch(n){throw ba!==null&&(ba=ba.slice(e+1)),W2(Qm,Dn),n}finally{Ge=t,Nf=!1}}return null}var tl=[],rl=0,kd=null,Sd=0,cs=[],us=0,wi=null,Na=1,_a="";function Wn(e,t){tl[rl++]=Sd,tl[rl++]=kd,kd=e,Sd=t}function bw(e,t,r){cs[us++]=Na,cs[us++]=_a,cs[us++]=wi,wi=e;var s=Na;e=_a;var n=32-Ds(s)-1;s&=~(1<<n),r+=1;var i=32-Ds(t)+n;if(30<i){var l=n-n%5;i=(s&(1<<l)-1).toString(32),s>>=l,n-=l,Na=1<<32-Ds(t)+n|r<<n|s,_a=i+e}else Na=1<<i|r<<n|s,_a=e}function ip(e){e.return!==null&&(Wn(e,1),bw(e,1,0))}function lp(e){for(;e===kd;)kd=tl[--rl],tl[rl]=null,Sd=tl[--rl],tl[rl]=null;for(;e===wi;)wi=cs[--us],cs[us]=null,_a=cs[--us],cs[us]=null,Na=cs[--us],cs[us]=null}var Yr=null,qr=null,at=!1,As=null;function jw(e,t){var r=ds(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function kg(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Yr=e,qr=vn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Yr=e,qr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=wi!==null?{id:Na,overflow:_a}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=ds(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Yr=e,qr=null,!0):!1;default:return!1}}function Mh(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Lh(e){if(at){var t=qr;if(t){var r=t;if(!kg(e,t)){if(Mh(e))throw Error(ce(418));t=vn(r.nextSibling);var s=Yr;t&&kg(e,t)?jw(s,r):(e.flags=e.flags&-4097|2,at=!1,Yr=e)}}else{if(Mh(e))throw Error(ce(418));e.flags=e.flags&-4097|2,at=!1,Yr=e}}}function Sg(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Yr=e}function _u(e){if(e!==Yr)return!1;if(!at)return Sg(e),at=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Ph(e.type,e.memoizedProps)),t&&(t=qr)){if(Mh(e))throw Nw(),Error(ce(418));for(;t;)jw(e,t),t=vn(t.nextSibling)}if(Sg(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ce(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){qr=vn(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}qr=null}}else qr=Yr?vn(e.stateNode.nextSibling):null;return!0}function Nw(){for(var e=qr;e;)e=vn(e.nextSibling)}function Al(){qr=Yr=null,at=!1}function op(e){As===null?As=[e]:As.push(e)}var bS=Va.ReactCurrentBatchConfig;function io(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ce(309));var s=r.stateNode}if(!s)throw Error(ce(147,e));var n=s,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(l){var o=n.refs;l===null?delete o[i]:o[i]=l},t._stringRef=i,t)}if(typeof e!="string")throw Error(ce(284));if(!r._owner)throw Error(ce(290,e))}return e}function ku(e,t){throw e=Object.prototype.toString.call(t),Error(ce(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Cg(e){var t=e._init;return t(e._payload)}function _w(e){function t(b,g){if(e){var y=b.deletions;y===null?(b.deletions=[g],b.flags|=16):y.push(g)}}function r(b,g){if(!e)return null;for(;g!==null;)t(b,g),g=g.sibling;return null}function s(b,g){for(b=new Map;g!==null;)g.key!==null?b.set(g.key,g):b.set(g.index,g),g=g.sibling;return b}function n(b,g){return b=Nn(b,g),b.index=0,b.sibling=null,b}function i(b,g,y){return b.index=y,e?(y=b.alternate,y!==null?(y=y.index,y<g?(b.flags|=2,g):y):(b.flags|=2,g)):(b.flags|=1048576,g)}function l(b){return e&&b.alternate===null&&(b.flags|=2),b}function o(b,g,y,j){return g===null||g.tag!==6?(g=Af(y,b.mode,j),g.return=b,g):(g=n(g,y),g.return=b,g)}function c(b,g,y,j){var A=y.type;return A===Ki?d(b,g,y.props.children,j,y.key):g!==null&&(g.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Ka&&Cg(A)===g.type)?(j=n(g,y.props),j.ref=io(b,g,y),j.return=b,j):(j=id(y.type,y.key,y.props,null,b.mode,j),j.ref=io(b,g,y),j.return=b,j)}function u(b,g,y,j){return g===null||g.tag!==4||g.stateNode.containerInfo!==y.containerInfo||g.stateNode.implementation!==y.implementation?(g=Ff(y,b.mode,j),g.return=b,g):(g=n(g,y.children||[]),g.return=b,g)}function d(b,g,y,j,A){return g===null||g.tag!==7?(g=fi(y,b.mode,j,A),g.return=b,g):(g=n(g,y),g.return=b,g)}function f(b,g,y){if(typeof g=="string"&&g!==""||typeof g=="number")return g=Af(""+g,b.mode,y),g.return=b,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case mu:return y=id(g.type,g.key,g.props,null,b.mode,y),y.ref=io(b,null,g),y.return=b,y;case Yi:return g=Ff(g,b.mode,y),g.return=b,g;case Ka:var j=g._init;return f(b,j(g._payload),y)}if(po(g)||to(g))return g=fi(g,b.mode,y,null),g.return=b,g;ku(b,g)}return null}function h(b,g,y,j){var A=g!==null?g.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return A!==null?null:o(b,g,""+y,j);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case mu:return y.key===A?c(b,g,y,j):null;case Yi:return y.key===A?u(b,g,y,j):null;case Ka:return A=y._init,h(b,g,A(y._payload),j)}if(po(y)||to(y))return A!==null?null:d(b,g,y,j,null);ku(b,y)}return null}function x(b,g,y,j,A){if(typeof j=="string"&&j!==""||typeof j=="number")return b=b.get(y)||null,o(g,b,""+j,A);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case mu:return b=b.get(j.key===null?y:j.key)||null,c(g,b,j,A);case Yi:return b=b.get(j.key===null?y:j.key)||null,u(g,b,j,A);case Ka:var k=j._init;return x(b,g,y,k(j._payload),A)}if(po(j)||to(j))return b=b.get(y)||null,d(g,b,j,A,null);ku(g,j)}return null}function m(b,g,y,j){for(var A=null,k=null,v=g,E=g=0,S=null;v!==null&&E<y.length;E++){v.index>E?(S=v,v=null):S=v.sibling;var N=h(b,v,y[E],j);if(N===null){v===null&&(v=S);break}e&&v&&N.alternate===null&&t(b,v),g=i(N,g,E),k===null?A=N:k.sibling=N,k=N,v=S}if(E===y.length)return r(b,v),at&&Wn(b,E),A;if(v===null){for(;E<y.length;E++)v=f(b,y[E],j),v!==null&&(g=i(v,g,E),k===null?A=v:k.sibling=v,k=v);return at&&Wn(b,E),A}for(v=s(b,v);E<y.length;E++)S=x(v,b,E,y[E],j),S!==null&&(e&&S.alternate!==null&&v.delete(S.key===null?E:S.key),g=i(S,g,E),k===null?A=S:k.sibling=S,k=S);return e&&v.forEach(function(D){return t(b,D)}),at&&Wn(b,E),A}function p(b,g,y,j){var A=to(y);if(typeof A!="function")throw Error(ce(150));if(y=A.call(y),y==null)throw Error(ce(151));for(var k=A=null,v=g,E=g=0,S=null,N=y.next();v!==null&&!N.done;E++,N=y.next()){v.index>E?(S=v,v=null):S=v.sibling;var D=h(b,v,N.value,j);if(D===null){v===null&&(v=S);break}e&&v&&D.alternate===null&&t(b,v),g=i(D,g,E),k===null?A=D:k.sibling=D,k=D,v=S}if(N.done)return r(b,v),at&&Wn(b,E),A;if(v===null){for(;!N.done;E++,N=y.next())N=f(b,N.value,j),N!==null&&(g=i(N,g,E),k===null?A=N:k.sibling=N,k=N);return at&&Wn(b,E),A}for(v=s(b,v);!N.done;E++,N=y.next())N=x(v,b,E,N.value,j),N!==null&&(e&&N.alternate!==null&&v.delete(N.key===null?E:N.key),g=i(N,g,E),k===null?A=N:k.sibling=N,k=N);return e&&v.forEach(function(F){return t(b,F)}),at&&Wn(b,E),A}function w(b,g,y,j){if(typeof y=="object"&&y!==null&&y.type===Ki&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case mu:e:{for(var A=y.key,k=g;k!==null;){if(k.key===A){if(A=y.type,A===Ki){if(k.tag===7){r(b,k.sibling),g=n(k,y.props.children),g.return=b,b=g;break e}}else if(k.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Ka&&Cg(A)===k.type){r(b,k.sibling),g=n(k,y.props),g.ref=io(b,k,y),g.return=b,b=g;break e}r(b,k);break}else t(b,k);k=k.sibling}y.type===Ki?(g=fi(y.props.children,b.mode,j,y.key),g.return=b,b=g):(j=id(y.type,y.key,y.props,null,b.mode,j),j.ref=io(b,g,y),j.return=b,b=j)}return l(b);case Yi:e:{for(k=y.key;g!==null;){if(g.key===k)if(g.tag===4&&g.stateNode.containerInfo===y.containerInfo&&g.stateNode.implementation===y.implementation){r(b,g.sibling),g=n(g,y.children||[]),g.return=b,b=g;break e}else{r(b,g);break}else t(b,g);g=g.sibling}g=Ff(y,b.mode,j),g.return=b,b=g}return l(b);case Ka:return k=y._init,w(b,g,k(y._payload),j)}if(po(y))return m(b,g,y,j);if(to(y))return p(b,g,y,j);ku(b,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,g!==null&&g.tag===6?(r(b,g.sibling),g=n(g,y),g.return=b,b=g):(r(b,g),g=Af(y,b.mode,j),g.return=b,b=g),l(b)):r(b,g)}return w}var Fl=_w(!0),kw=_w(!1),Cd=Pn(null),Td=null,sl=null,cp=null;function up(){cp=sl=Td=null}function dp(e){var t=Cd.current;tt(Cd),e._currentValue=t}function Bh(e,t,r){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===r)break;e=e.return}}function pl(e,t){Td=e,cp=sl=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Rr=!0),e.firstContext=null)}function ms(e){var t=e._currentValue;if(cp!==e)if(e={context:e,memoizedValue:t,next:null},sl===null){if(Td===null)throw Error(ce(308));sl=e,Td.dependencies={lanes:0,firstContext:e}}else sl=sl.next=e;return t}var Zn=null;function fp(e){Zn===null?Zn=[e]:Zn.push(e)}function Sw(e,t,r,s){var n=t.interleaved;return n===null?(r.next=r,fp(t)):(r.next=n.next,n.next=r),t.interleaved=r,Ia(e,s)}function Ia(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Xa=!1;function hp(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Cw(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ca(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function wn(e,t,r){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,Ue&2){var n=s.pending;return n===null?t.next=t:(t.next=n.next,n.next=t),s.pending=t,Ia(e,r)}return n=s.interleaved,n===null?(t.next=t,fp(s)):(t.next=n.next,n.next=t),s.interleaved=t,Ia(e,r)}function ed(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,Jm(e,r)}}function Tg(e,t){var r=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,r===s)){var n=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var l={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?n=i=l:i=i.next=l,r=r.next}while(r!==null);i===null?n=i=t:i=i.next=t}else n=i=t;r={baseState:s.baseState,firstBaseUpdate:n,lastBaseUpdate:i,shared:s.shared,effects:s.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Ed(e,t,r,s){var n=e.updateQueue;Xa=!1;var i=n.firstBaseUpdate,l=n.lastBaseUpdate,o=n.shared.pending;if(o!==null){n.shared.pending=null;var c=o,u=c.next;c.next=null,l===null?i=u:l.next=u,l=c;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==l&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=c))}if(i!==null){var f=n.baseState;l=0,d=u=c=null,o=i;do{var h=o.lane,x=o.eventTime;if((s&h)===h){d!==null&&(d=d.next={eventTime:x,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,p=o;switch(h=t,x=r,p.tag){case 1:if(m=p.payload,typeof m=="function"){f=m.call(x,f,h);break e}f=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=p.payload,h=typeof m=="function"?m.call(x,f,h):m,h==null)break e;f=ht({},f,h);break e;case 2:Xa=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=n.effects,h===null?n.effects=[o]:h.push(o))}else x={eventTime:x,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=x,c=f):d=d.next=x,l|=h;if(o=o.next,o===null){if(o=n.shared.pending,o===null)break;h=o,o=h.next,h.next=null,n.lastBaseUpdate=h,n.shared.pending=null}}while(!0);if(d===null&&(c=f),n.baseState=c,n.firstBaseUpdate=u,n.lastBaseUpdate=d,t=n.shared.interleaved,t!==null){n=t;do l|=n.lane,n=n.next;while(n!==t)}else i===null&&(n.shared.lanes=0);ji|=l,e.lanes=l,e.memoizedState=f}}function Eg(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],n=s.callback;if(n!==null){if(s.callback=null,s=r,typeof n!="function")throw Error(ce(191,n));n.call(s)}}}var Oc={},ia=Pn(Oc),rc=Pn(Oc),sc=Pn(Oc);function ei(e){if(e===Oc)throw Error(ce(174));return e}function mp(e,t){switch(Ke(sc,t),Ke(rc,e),Ke(ia,Oc),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:vh(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=vh(t,e)}tt(ia),Ke(ia,t)}function Rl(){tt(ia),tt(rc),tt(sc)}function Tw(e){ei(sc.current);var t=ei(ia.current),r=vh(t,e.type);t!==r&&(Ke(rc,e),Ke(ia,r))}function pp(e){rc.current===e&&(tt(ia),tt(rc))}var ut=Pn(0);function Ad(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var _f=[];function xp(){for(var e=0;e<_f.length;e++)_f[e]._workInProgressVersionPrimary=null;_f.length=0}var td=Va.ReactCurrentDispatcher,kf=Va.ReactCurrentBatchConfig,bi=0,ft=null,At=null,Lt=null,Fd=!1,To=!1,ac=0,jS=0;function er(){throw Error(ce(321))}function gp(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ls(e[r],t[r]))return!1;return!0}function yp(e,t,r,s,n,i){if(bi=i,ft=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,td.current=e===null||e.memoizedState===null?SS:CS,e=r(s,n),To){i=0;do{if(To=!1,ac=0,25<=i)throw Error(ce(301));i+=1,Lt=At=null,t.updateQueue=null,td.current=TS,e=r(s,n)}while(To)}if(td.current=Rd,t=At!==null&&At.next!==null,bi=0,Lt=At=ft=null,Fd=!1,t)throw Error(ce(300));return e}function vp(){var e=ac!==0;return ac=0,e}function Zs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Lt===null?ft.memoizedState=Lt=e:Lt=Lt.next=e,Lt}function ps(){if(At===null){var e=ft.alternate;e=e!==null?e.memoizedState:null}else e=At.next;var t=Lt===null?ft.memoizedState:Lt.next;if(t!==null)Lt=t,At=e;else{if(e===null)throw Error(ce(310));At=e,e={memoizedState:At.memoizedState,baseState:At.baseState,baseQueue:At.baseQueue,queue:At.queue,next:null},Lt===null?ft.memoizedState=Lt=e:Lt=Lt.next=e}return Lt}function nc(e,t){return typeof t=="function"?t(e):t}function Sf(e){var t=ps(),r=t.queue;if(r===null)throw Error(ce(311));r.lastRenderedReducer=e;var s=At,n=s.baseQueue,i=r.pending;if(i!==null){if(n!==null){var l=n.next;n.next=i.next,i.next=l}s.baseQueue=n=i,r.pending=null}if(n!==null){i=n.next,s=s.baseState;var o=l=null,c=null,u=i;do{var d=u.lane;if((bi&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:e(s,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(o=c=f,l=s):c=c.next=f,ft.lanes|=d,ji|=d}u=u.next}while(u!==null&&u!==i);c===null?l=s:c.next=o,Ls(s,t.memoizedState)||(Rr=!0),t.memoizedState=s,t.baseState=l,t.baseQueue=c,r.lastRenderedState=s}if(e=r.interleaved,e!==null){n=e;do i=n.lane,ft.lanes|=i,ji|=i,n=n.next;while(n!==e)}else n===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Cf(e){var t=ps(),r=t.queue;if(r===null)throw Error(ce(311));r.lastRenderedReducer=e;var s=r.dispatch,n=r.pending,i=t.memoizedState;if(n!==null){r.pending=null;var l=n=n.next;do i=e(i,l.action),l=l.next;while(l!==n);Ls(i,t.memoizedState)||(Rr=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,s]}function Ew(){}function Aw(e,t){var r=ft,s=ps(),n=t(),i=!Ls(s.memoizedState,n);if(i&&(s.memoizedState=n,Rr=!0),s=s.queue,wp(Pw.bind(null,r,s,e),[e]),s.getSnapshot!==t||i||Lt!==null&&Lt.memoizedState.tag&1){if(r.flags|=2048,ic(9,Rw.bind(null,r,s,n,t),void 0,null),Bt===null)throw Error(ce(349));bi&30||Fw(r,t,n)}return n}function Fw(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=ft.updateQueue,t===null?(t={lastEffect:null,stores:null},ft.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Rw(e,t,r,s){t.value=r,t.getSnapshot=s,Dw(t)&&Iw(e)}function Pw(e,t,r){return r(function(){Dw(t)&&Iw(e)})}function Dw(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ls(e,r)}catch{return!0}}function Iw(e){var t=Ia(e,1);t!==null&&Is(t,e,1,-1)}function Ag(e){var t=Zs();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:nc,lastRenderedState:e},t.queue=e,e=e.dispatch=kS.bind(null,ft,e),[t.memoizedState,e]}function ic(e,t,r,s){return e={tag:e,create:t,destroy:r,deps:s,next:null},t=ft.updateQueue,t===null?(t={lastEffect:null,stores:null},ft.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(s=r.next,r.next=e,e.next=s,t.lastEffect=e)),e}function Ow(){return ps().memoizedState}function rd(e,t,r,s){var n=Zs();ft.flags|=e,n.memoizedState=ic(1|t,r,void 0,s===void 0?null:s)}function g0(e,t,r,s){var n=ps();s=s===void 0?null:s;var i=void 0;if(At!==null){var l=At.memoizedState;if(i=l.destroy,s!==null&&gp(s,l.deps)){n.memoizedState=ic(t,r,i,s);return}}ft.flags|=e,n.memoizedState=ic(1|t,r,i,s)}function Fg(e,t){return rd(8390656,8,e,t)}function wp(e,t){return g0(2048,8,e,t)}function Mw(e,t){return g0(4,2,e,t)}function Lw(e,t){return g0(4,4,e,t)}function Bw(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Uw(e,t,r){return r=r!=null?r.concat([e]):null,g0(4,4,Bw.bind(null,t,e),r)}function bp(){}function $w(e,t){var r=ps();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&gp(t,s[1])?s[0]:(r.memoizedState=[e,t],e)}function Vw(e,t){var r=ps();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&gp(t,s[1])?s[0]:(e=e(),r.memoizedState=[e,t],e)}function zw(e,t,r){return bi&21?(Ls(r,t)||(r=Y2(),ft.lanes|=r,ji|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Rr=!0),e.memoizedState=r)}function NS(e,t){var r=Ge;Ge=r!==0&&4>r?r:4,e(!0);var s=kf.transition;kf.transition={};try{e(!1),t()}finally{Ge=r,kf.transition=s}}function Hw(){return ps().memoizedState}function _S(e,t,r){var s=jn(e);if(r={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null},Ww(e))Gw(t,r);else if(r=Sw(e,t,r,s),r!==null){var n=Nr();Is(r,e,s,n),qw(r,t,s)}}function kS(e,t,r){var s=jn(e),n={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null};if(Ww(e))Gw(t,n);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var l=t.lastRenderedState,o=i(l,r);if(n.hasEagerState=!0,n.eagerState=o,Ls(o,l)){var c=t.interleaved;c===null?(n.next=n,fp(t)):(n.next=c.next,c.next=n),t.interleaved=n;return}}catch{}finally{}r=Sw(e,t,n,s),r!==null&&(n=Nr(),Is(r,e,s,n),qw(r,t,s))}}function Ww(e){var t=e.alternate;return e===ft||t!==null&&t===ft}function Gw(e,t){To=Fd=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function qw(e,t,r){if(r&4194240){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,Jm(e,r)}}var Rd={readContext:ms,useCallback:er,useContext:er,useEffect:er,useImperativeHandle:er,useInsertionEffect:er,useLayoutEffect:er,useMemo:er,useReducer:er,useRef:er,useState:er,useDebugValue:er,useDeferredValue:er,useTransition:er,useMutableSource:er,useSyncExternalStore:er,useId:er,unstable_isNewReconciler:!1},SS={readContext:ms,useCallback:function(e,t){return Zs().memoizedState=[e,t===void 0?null:t],e},useContext:ms,useEffect:Fg,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,rd(4194308,4,Bw.bind(null,t,e),r)},useLayoutEffect:function(e,t){return rd(4194308,4,e,t)},useInsertionEffect:function(e,t){return rd(4,2,e,t)},useMemo:function(e,t){var r=Zs();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var s=Zs();return t=r!==void 0?r(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=_S.bind(null,ft,e),[s.memoizedState,e]},useRef:function(e){var t=Zs();return e={current:e},t.memoizedState=e},useState:Ag,useDebugValue:bp,useDeferredValue:function(e){return Zs().memoizedState=e},useTransition:function(){var e=Ag(!1),t=e[0];return e=NS.bind(null,e[1]),Zs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var s=ft,n=Zs();if(at){if(r===void 0)throw Error(ce(407));r=r()}else{if(r=t(),Bt===null)throw Error(ce(349));bi&30||Fw(s,t,r)}n.memoizedState=r;var i={value:r,getSnapshot:t};return n.queue=i,Fg(Pw.bind(null,s,i,e),[e]),s.flags|=2048,ic(9,Rw.bind(null,s,i,r,t),void 0,null),r},useId:function(){var e=Zs(),t=Bt.identifierPrefix;if(at){var r=_a,s=Na;r=(s&~(1<<32-Ds(s)-1)).toString(32)+r,t=":"+t+"R"+r,r=ac++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=jS++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},CS={readContext:ms,useCallback:$w,useContext:ms,useEffect:wp,useImperativeHandle:Uw,useInsertionEffect:Mw,useLayoutEffect:Lw,useMemo:Vw,useReducer:Sf,useRef:Ow,useState:function(){return Sf(nc)},useDebugValue:bp,useDeferredValue:function(e){var t=ps();return zw(t,At.memoizedState,e)},useTransition:function(){var e=Sf(nc)[0],t=ps().memoizedState;return[e,t]},useMutableSource:Ew,useSyncExternalStore:Aw,useId:Hw,unstable_isNewReconciler:!1},TS={readContext:ms,useCallback:$w,useContext:ms,useEffect:wp,useImperativeHandle:Uw,useInsertionEffect:Mw,useLayoutEffect:Lw,useMemo:Vw,useReducer:Cf,useRef:Ow,useState:function(){return Cf(nc)},useDebugValue:bp,useDeferredValue:function(e){var t=ps();return At===null?t.memoizedState=e:zw(t,At.memoizedState,e)},useTransition:function(){var e=Cf(nc)[0],t=ps().memoizedState;return[e,t]},useMutableSource:Ew,useSyncExternalStore:Aw,useId:Hw,unstable_isNewReconciler:!1};function ks(e,t){if(e&&e.defaultProps){t=ht({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Uh(e,t,r,s){t=e.memoizedState,r=r(s,t),r=r==null?t:ht({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var y0={isMounted:function(e){return(e=e._reactInternals)?Fi(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var s=Nr(),n=jn(e),i=Ca(s,n);i.payload=t,r!=null&&(i.callback=r),t=wn(e,i,n),t!==null&&(Is(t,e,n,s),ed(t,e,n))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var s=Nr(),n=jn(e),i=Ca(s,n);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=wn(e,i,n),t!==null&&(Is(t,e,n,s),ed(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Nr(),s=jn(e),n=Ca(r,s);n.tag=2,t!=null&&(n.callback=t),t=wn(e,n,s),t!==null&&(Is(t,e,s,r),ed(t,e,s))}};function Rg(e,t,r,s,n,i,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,i,l):t.prototype&&t.prototype.isPureReactComponent?!Jo(r,s)||!Jo(n,i):!0}function Yw(e,t,r){var s=!1,n=Cn,i=t.contextType;return typeof i=="object"&&i!==null?i=ms(i):(n=Dr(t)?vi:fr.current,s=t.contextTypes,i=(s=s!=null)?El(e,n):Cn),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=y0,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=i),t}function Pg(e,t,r,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,s),t.state!==e&&y0.enqueueReplaceState(t,t.state,null)}function $h(e,t,r,s){var n=e.stateNode;n.props=r,n.state=e.memoizedState,n.refs={},hp(e);var i=t.contextType;typeof i=="object"&&i!==null?n.context=ms(i):(i=Dr(t)?vi:fr.current,n.context=El(e,i)),n.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Uh(e,t,i,r),n.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(t=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),t!==n.state&&y0.enqueueReplaceState(n,n.state,null),Ed(e,r,n,s),n.state=e.memoizedState),typeof n.componentDidMount=="function"&&(e.flags|=4194308)}function Pl(e,t){try{var r="",s=t;do r+=rk(s),s=s.return;while(s);var n=r}catch(i){n=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:n,digest:null}}function Tf(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Vh(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var ES=typeof WeakMap=="function"?WeakMap:Map;function Kw(e,t,r){r=Ca(-1,r),r.tag=3,r.payload={element:null};var s=t.value;return r.callback=function(){Dd||(Dd=!0,Jh=s),Vh(e,t)},r}function Xw(e,t,r){r=Ca(-1,r),r.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var n=t.value;r.payload=function(){return s(n)},r.callback=function(){Vh(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Vh(e,t),typeof s!="function"&&(bn===null?bn=new Set([this]):bn.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),r}function Dg(e,t,r){var s=e.pingCache;if(s===null){s=e.pingCache=new ES;var n=new Set;s.set(t,n)}else n=s.get(t),n===void 0&&(n=new Set,s.set(t,n));n.has(r)||(n.add(r),e=zS.bind(null,e,t,r),t.then(e,e))}function Ig(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Og(e,t,r,s,n){return e.mode&1?(e.flags|=65536,e.lanes=n,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Ca(-1,1),t.tag=2,wn(r,t,1))),r.lanes|=1),e)}var AS=Va.ReactCurrentOwner,Rr=!1;function yr(e,t,r,s){t.child=e===null?kw(t,null,r,s):Fl(t,e.child,r,s)}function Mg(e,t,r,s,n){r=r.render;var i=t.ref;return pl(t,n),s=yp(e,t,r,s,i,n),r=vp(),e!==null&&!Rr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,Oa(e,t,n)):(at&&r&&ip(t),t.flags|=1,yr(e,t,s,n),t.child)}function Lg(e,t,r,s,n){if(e===null){var i=r.type;return typeof i=="function"&&!Ep(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,Qw(e,t,i,s,n)):(e=id(r.type,null,s,t,t.mode,n),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&n)){var l=i.memoizedProps;if(r=r.compare,r=r!==null?r:Jo,r(l,s)&&e.ref===t.ref)return Oa(e,t,n)}return t.flags|=1,e=Nn(i,s),e.ref=t.ref,e.return=t,t.child=e}function Qw(e,t,r,s,n){if(e!==null){var i=e.memoizedProps;if(Jo(i,s)&&e.ref===t.ref)if(Rr=!1,t.pendingProps=s=i,(e.lanes&n)!==0)e.flags&131072&&(Rr=!0);else return t.lanes=e.lanes,Oa(e,t,n)}return zh(e,t,r,s,n)}function Jw(e,t,r){var s=t.pendingProps,n=s.children,i=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ke(nl,Vr),Vr|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ke(nl,Vr),Vr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:r,Ke(nl,Vr),Vr|=s}else i!==null?(s=i.baseLanes|r,t.memoizedState=null):s=r,Ke(nl,Vr),Vr|=s;return yr(e,t,n,r),t.child}function Zw(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function zh(e,t,r,s,n){var i=Dr(r)?vi:fr.current;return i=El(t,i),pl(t,n),r=yp(e,t,r,s,i,n),s=vp(),e!==null&&!Rr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,Oa(e,t,n)):(at&&s&&ip(t),t.flags|=1,yr(e,t,r,n),t.child)}function Bg(e,t,r,s,n){if(Dr(r)){var i=!0;_d(t)}else i=!1;if(pl(t,n),t.stateNode===null)sd(e,t),Yw(t,r,s),$h(t,r,s,n),s=!0;else if(e===null){var l=t.stateNode,o=t.memoizedProps;l.props=o;var c=l.context,u=r.contextType;typeof u=="object"&&u!==null?u=ms(u):(u=Dr(r)?vi:fr.current,u=El(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof l.getSnapshotBeforeUpdate=="function";f||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==s||c!==u)&&Pg(t,l,s,u),Xa=!1;var h=t.memoizedState;l.state=h,Ed(t,s,l,n),c=t.memoizedState,o!==s||h!==c||Pr.current||Xa?(typeof d=="function"&&(Uh(t,r,d,s),c=t.memoizedState),(o=Xa||Rg(t,r,o,s,h,c,u))?(f||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=c),l.props=s,l.state=c,l.context=u,s=o):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{l=t.stateNode,Cw(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:ks(t.type,o),l.props=u,f=t.pendingProps,h=l.context,c=r.contextType,typeof c=="object"&&c!==null?c=ms(c):(c=Dr(r)?vi:fr.current,c=El(t,c));var x=r.getDerivedStateFromProps;(d=typeof x=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==f||h!==c)&&Pg(t,l,s,c),Xa=!1,h=t.memoizedState,l.state=h,Ed(t,s,l,n);var m=t.memoizedState;o!==f||h!==m||Pr.current||Xa?(typeof x=="function"&&(Uh(t,r,x,s),m=t.memoizedState),(u=Xa||Rg(t,r,u,s,h,m,c)||!1)?(d||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(s,m,c),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(s,m,c)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=m),l.props=s,l.state=m,l.context=c,s=u):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),s=!1)}return Hh(e,t,r,s,i,n)}function Hh(e,t,r,s,n,i){Zw(e,t);var l=(t.flags&128)!==0;if(!s&&!l)return n&&_g(t,r,!1),Oa(e,t,i);s=t.stateNode,AS.current=t;var o=l&&typeof r.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&l?(t.child=Fl(t,e.child,null,i),t.child=Fl(t,null,o,i)):yr(e,t,o,i),t.memoizedState=s.state,n&&_g(t,r,!0),t.child}function eb(e){var t=e.stateNode;t.pendingContext?Ng(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Ng(e,t.context,!1),mp(e,t.containerInfo)}function Ug(e,t,r,s,n){return Al(),op(n),t.flags|=256,yr(e,t,r,s),t.child}var Wh={dehydrated:null,treeContext:null,retryLane:0};function Gh(e){return{baseLanes:e,cachePool:null,transitions:null}}function tb(e,t,r){var s=t.pendingProps,n=ut.current,i=!1,l=(t.flags&128)!==0,o;if((o=l)||(o=e!==null&&e.memoizedState===null?!1:(n&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(n|=1),Ke(ut,n&1),e===null)return Lh(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=s.children,e=s.fallback,i?(s=t.mode,i=t.child,l={mode:"hidden",children:l},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=l):i=b0(l,s,0,null),e=fi(e,s,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Gh(r),t.memoizedState=Wh,e):jp(t,l));if(n=e.memoizedState,n!==null&&(o=n.dehydrated,o!==null))return FS(e,t,l,s,o,n,r);if(i){i=s.fallback,l=t.mode,n=e.child,o=n.sibling;var c={mode:"hidden",children:s.children};return!(l&1)&&t.child!==n?(s=t.child,s.childLanes=0,s.pendingProps=c,t.deletions=null):(s=Nn(n,c),s.subtreeFlags=n.subtreeFlags&14680064),o!==null?i=Nn(o,i):(i=fi(i,l,r,null),i.flags|=2),i.return=t,s.return=t,s.sibling=i,t.child=s,s=i,i=t.child,l=e.child.memoizedState,l=l===null?Gh(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~r,t.memoizedState=Wh,s}return i=e.child,e=i.sibling,s=Nn(i,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=r),s.return=t,s.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=s,t.memoizedState=null,s}function jp(e,t){return t=b0({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Su(e,t,r,s){return s!==null&&op(s),Fl(t,e.child,null,r),e=jp(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function FS(e,t,r,s,n,i,l){if(r)return t.flags&256?(t.flags&=-257,s=Tf(Error(ce(422))),Su(e,t,l,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=s.fallback,n=t.mode,s=b0({mode:"visible",children:s.children},n,0,null),i=fi(i,n,l,null),i.flags|=2,s.return=t,i.return=t,s.sibling=i,t.child=s,t.mode&1&&Fl(t,e.child,null,l),t.child.memoizedState=Gh(l),t.memoizedState=Wh,i);if(!(t.mode&1))return Su(e,t,l,null);if(n.data==="$!"){if(s=n.nextSibling&&n.nextSibling.dataset,s)var o=s.dgst;return s=o,i=Error(ce(419)),s=Tf(i,s,void 0),Su(e,t,l,s)}if(o=(l&e.childLanes)!==0,Rr||o){if(s=Bt,s!==null){switch(l&-l){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(s.suspendedLanes|l)?0:n,n!==0&&n!==i.retryLane&&(i.retryLane=n,Ia(e,n),Is(s,e,n,-1))}return Tp(),s=Tf(Error(ce(421))),Su(e,t,l,s)}return n.data==="$?"?(t.flags|=128,t.child=e.child,t=HS.bind(null,e),n._reactRetry=t,null):(e=i.treeContext,qr=vn(n.nextSibling),Yr=t,at=!0,As=null,e!==null&&(cs[us++]=Na,cs[us++]=_a,cs[us++]=wi,Na=e.id,_a=e.overflow,wi=t),t=jp(t,s.children),t.flags|=4096,t)}function $g(e,t,r){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),Bh(e.return,t,r)}function Ef(e,t,r,s,n){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:r,tailMode:n}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=r,i.tailMode=n)}function rb(e,t,r){var s=t.pendingProps,n=s.revealOrder,i=s.tail;if(yr(e,t,s.children,r),s=ut.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&$g(e,r,t);else if(e.tag===19)$g(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(Ke(ut,s),!(t.mode&1))t.memoizedState=null;else switch(n){case"forwards":for(r=t.child,n=null;r!==null;)e=r.alternate,e!==null&&Ad(e)===null&&(n=r),r=r.sibling;r=n,r===null?(n=t.child,t.child=null):(n=r.sibling,r.sibling=null),Ef(t,!1,n,r,i);break;case"backwards":for(r=null,n=t.child,t.child=null;n!==null;){if(e=n.alternate,e!==null&&Ad(e)===null){t.child=n;break}e=n.sibling,n.sibling=r,r=n,n=e}Ef(t,!0,r,null,i);break;case"together":Ef(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function sd(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Oa(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ji|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ce(153));if(t.child!==null){for(e=t.child,r=Nn(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Nn(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function RS(e,t,r){switch(t.tag){case 3:eb(t),Al();break;case 5:Tw(t);break;case 1:Dr(t.type)&&_d(t);break;case 4:mp(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,n=t.memoizedProps.value;Ke(Cd,s._currentValue),s._currentValue=n;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(Ke(ut,ut.current&1),t.flags|=128,null):r&t.child.childLanes?tb(e,t,r):(Ke(ut,ut.current&1),e=Oa(e,t,r),e!==null?e.sibling:null);Ke(ut,ut.current&1);break;case 19:if(s=(r&t.childLanes)!==0,e.flags&128){if(s)return rb(e,t,r);t.flags|=128}if(n=t.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),Ke(ut,ut.current),s)break;return null;case 22:case 23:return t.lanes=0,Jw(e,t,r)}return Oa(e,t,r)}var sb,qh,ab,nb;sb=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};qh=function(){};ab=function(e,t,r,s){var n=e.memoizedProps;if(n!==s){e=t.stateNode,ei(ia.current);var i=null;switch(r){case"input":n=ph(e,n),s=ph(e,s),i=[];break;case"select":n=ht({},n,{value:void 0}),s=ht({},s,{value:void 0}),i=[];break;case"textarea":n=yh(e,n),s=yh(e,s),i=[];break;default:typeof n.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=jd)}wh(r,s);var l;r=null;for(u in n)if(!s.hasOwnProperty(u)&&n.hasOwnProperty(u)&&n[u]!=null)if(u==="style"){var o=n[u];for(l in o)o.hasOwnProperty(l)&&(r||(r={}),r[l]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Wo.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in s){var c=s[u];if(o=n!=null?n[u]:void 0,s.hasOwnProperty(u)&&c!==o&&(c!=null||o!=null))if(u==="style")if(o){for(l in o)!o.hasOwnProperty(l)||c&&c.hasOwnProperty(l)||(r||(r={}),r[l]="");for(l in c)c.hasOwnProperty(l)&&o[l]!==c[l]&&(r||(r={}),r[l]=c[l])}else r||(i||(i=[]),i.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Wo.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&et("scroll",e),i||o===c||(i=[])):(i=i||[]).push(u,c))}r&&(i=i||[]).push("style",r);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};nb=function(e,t,r,s){r!==s&&(t.flags|=4)};function lo(e,t){if(!at)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var s=null;r!==null;)r.alternate!==null&&(s=r),r=r.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function tr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,s=0;if(t)for(var n=e.child;n!==null;)r|=n.lanes|n.childLanes,s|=n.subtreeFlags&14680064,s|=n.flags&14680064,n.return=e,n=n.sibling;else for(n=e.child;n!==null;)r|=n.lanes|n.childLanes,s|=n.subtreeFlags,s|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=s,e.childLanes=r,t}function PS(e,t,r){var s=t.pendingProps;switch(lp(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tr(t),null;case 1:return Dr(t.type)&&Nd(),tr(t),null;case 3:return s=t.stateNode,Rl(),tt(Pr),tt(fr),xp(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(_u(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,As!==null&&(tm(As),As=null))),qh(e,t),tr(t),null;case 5:pp(t);var n=ei(sc.current);if(r=t.type,e!==null&&t.stateNode!=null)ab(e,t,r,s,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(ce(166));return tr(t),null}if(e=ei(ia.current),_u(t)){s=t.stateNode,r=t.type;var i=t.memoizedProps;switch(s[sa]=t,s[tc]=i,e=(t.mode&1)!==0,r){case"dialog":et("cancel",s),et("close",s);break;case"iframe":case"object":case"embed":et("load",s);break;case"video":case"audio":for(n=0;n<go.length;n++)et(go[n],s);break;case"source":et("error",s);break;case"img":case"image":case"link":et("error",s),et("load",s);break;case"details":et("toggle",s);break;case"input":Xx(s,i),et("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},et("invalid",s);break;case"textarea":Jx(s,i),et("invalid",s)}wh(r,i),n=null;for(var l in i)if(i.hasOwnProperty(l)){var o=i[l];l==="children"?typeof o=="string"?s.textContent!==o&&(i.suppressHydrationWarning!==!0&&Nu(s.textContent,o,e),n=["children",o]):typeof o=="number"&&s.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&Nu(s.textContent,o,e),n=["children",""+o]):Wo.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&et("scroll",s)}switch(r){case"input":pu(s),Qx(s,i,!0);break;case"textarea":pu(s),Zx(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=jd)}s=n,t.updateQueue=s,s!==null&&(t.flags|=4)}else{l=n.nodeType===9?n:n.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=P2(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=l.createElement(r,{is:s.is}):(e=l.createElement(r),r==="select"&&(l=e,s.multiple?l.multiple=!0:s.size&&(l.size=s.size))):e=l.createElementNS(e,r),e[sa]=t,e[tc]=s,sb(e,t,!1,!1),t.stateNode=e;e:{switch(l=bh(r,s),r){case"dialog":et("cancel",e),et("close",e),n=s;break;case"iframe":case"object":case"embed":et("load",e),n=s;break;case"video":case"audio":for(n=0;n<go.length;n++)et(go[n],e);n=s;break;case"source":et("error",e),n=s;break;case"img":case"image":case"link":et("error",e),et("load",e),n=s;break;case"details":et("toggle",e),n=s;break;case"input":Xx(e,s),n=ph(e,s),et("invalid",e);break;case"option":n=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},n=ht({},s,{value:void 0}),et("invalid",e);break;case"textarea":Jx(e,s),n=yh(e,s),et("invalid",e);break;default:n=s}wh(r,n),o=n;for(i in o)if(o.hasOwnProperty(i)){var c=o[i];i==="style"?O2(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&D2(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Go(e,c):typeof c=="number"&&Go(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Wo.hasOwnProperty(i)?c!=null&&i==="onScroll"&&et("scroll",e):c!=null&&Gm(e,i,c,l))}switch(r){case"input":pu(e),Qx(e,s,!1);break;case"textarea":pu(e),Zx(e);break;case"option":s.value!=null&&e.setAttribute("value",""+Sn(s.value));break;case"select":e.multiple=!!s.multiple,i=s.value,i!=null?dl(e,!!s.multiple,i,!1):s.defaultValue!=null&&dl(e,!!s.multiple,s.defaultValue,!0);break;default:typeof n.onClick=="function"&&(e.onclick=jd)}switch(r){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return tr(t),null;case 6:if(e&&t.stateNode!=null)nb(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(ce(166));if(r=ei(sc.current),ei(ia.current),_u(t)){if(s=t.stateNode,r=t.memoizedProps,s[sa]=t,(i=s.nodeValue!==r)&&(e=Yr,e!==null))switch(e.tag){case 3:Nu(s.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Nu(s.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else s=(r.nodeType===9?r:r.ownerDocument).createTextNode(s),s[sa]=t,t.stateNode=s}return tr(t),null;case 13:if(tt(ut),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(at&&qr!==null&&t.mode&1&&!(t.flags&128))Nw(),Al(),t.flags|=98560,i=!1;else if(i=_u(t),s!==null&&s.dehydrated!==null){if(e===null){if(!i)throw Error(ce(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ce(317));i[sa]=t}else Al(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;tr(t),i=!1}else As!==null&&(tm(As),As=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||ut.current&1?Ft===0&&(Ft=3):Tp())),t.updateQueue!==null&&(t.flags|=4),tr(t),null);case 4:return Rl(),qh(e,t),e===null&&Zo(t.stateNode.containerInfo),tr(t),null;case 10:return dp(t.type._context),tr(t),null;case 17:return Dr(t.type)&&Nd(),tr(t),null;case 19:if(tt(ut),i=t.memoizedState,i===null)return tr(t),null;if(s=(t.flags&128)!==0,l=i.rendering,l===null)if(s)lo(i,!1);else{if(Ft!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=Ad(e),l!==null){for(t.flags|=128,lo(i,!1),s=l.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=r,r=t.child;r!==null;)i=r,e=s,i.flags&=14680066,l=i.alternate,l===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Ke(ut,ut.current&1|2),t.child}e=e.sibling}i.tail!==null&&bt()>Dl&&(t.flags|=128,s=!0,lo(i,!1),t.lanes=4194304)}else{if(!s)if(e=Ad(l),e!==null){if(t.flags|=128,s=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),lo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!l.alternate&&!at)return tr(t),null}else 2*bt()-i.renderingStartTime>Dl&&r!==1073741824&&(t.flags|=128,s=!0,lo(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(r=i.last,r!==null?r.sibling=l:t.child=l,i.last=l)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=bt(),t.sibling=null,r=ut.current,Ke(ut,s?r&1|2:r&1),t):(tr(t),null);case 22:case 23:return Cp(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?Vr&1073741824&&(tr(t),t.subtreeFlags&6&&(t.flags|=8192)):tr(t),null;case 24:return null;case 25:return null}throw Error(ce(156,t.tag))}function DS(e,t){switch(lp(t),t.tag){case 1:return Dr(t.type)&&Nd(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Rl(),tt(Pr),tt(fr),xp(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return pp(t),null;case 13:if(tt(ut),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ce(340));Al()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return tt(ut),null;case 4:return Rl(),null;case 10:return dp(t.type._context),null;case 22:case 23:return Cp(),null;case 24:return null;default:return null}}var Cu=!1,nr=!1,IS=typeof WeakSet=="function"?WeakSet:Set,be=null;function al(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(s){xt(e,t,s)}else r.current=null}function Yh(e,t,r){try{r()}catch(s){xt(e,t,s)}}var Vg=!1;function OS(e,t){if(Fh=vd,e=uw(),np(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var s=r.getSelection&&r.getSelection();if(s&&s.rangeCount!==0){r=s.anchorNode;var n=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var l=0,o=-1,c=-1,u=0,d=0,f=e,h=null;t:for(;;){for(var x;f!==r||n!==0&&f.nodeType!==3||(o=l+n),f!==i||s!==0&&f.nodeType!==3||(c=l+s),f.nodeType===3&&(l+=f.nodeValue.length),(x=f.firstChild)!==null;)h=f,f=x;for(;;){if(f===e)break t;if(h===r&&++u===n&&(o=l),h===i&&++d===s&&(c=l),(x=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=x}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Rh={focusedElem:e,selectionRange:r},vd=!1,be=t;be!==null;)if(t=be,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,be=e;else for(;be!==null;){t=be;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var p=m.memoizedProps,w=m.memoizedState,b=t.stateNode,g=b.getSnapshotBeforeUpdate(t.elementType===t.type?p:ks(t.type,p),w);b.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ce(163))}}catch(j){xt(t,t.return,j)}if(e=t.sibling,e!==null){e.return=t.return,be=e;break}be=t.return}return m=Vg,Vg=!1,m}function Eo(e,t,r){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var n=s=s.next;do{if((n.tag&e)===e){var i=n.destroy;n.destroy=void 0,i!==void 0&&Yh(t,r,i)}n=n.next}while(n!==s)}}function v0(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var s=r.create;r.destroy=s()}r=r.next}while(r!==t)}}function Kh(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function ib(e){var t=e.alternate;t!==null&&(e.alternate=null,ib(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[sa],delete t[tc],delete t[Ih],delete t[yS],delete t[vS])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function lb(e){return e.tag===5||e.tag===3||e.tag===4}function zg(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||lb(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Xh(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=jd));else if(s!==4&&(e=e.child,e!==null))for(Xh(e,t,r),e=e.sibling;e!==null;)Xh(e,t,r),e=e.sibling}function Qh(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(Qh(e,t,r),e=e.sibling;e!==null;)Qh(e,t,r),e=e.sibling}var Gt=null,Es=!1;function Ha(e,t,r){for(r=r.child;r!==null;)ob(e,t,r),r=r.sibling}function ob(e,t,r){if(na&&typeof na.onCommitFiberUnmount=="function")try{na.onCommitFiberUnmount(d0,r)}catch{}switch(r.tag){case 5:nr||al(r,t);case 6:var s=Gt,n=Es;Gt=null,Ha(e,t,r),Gt=s,Es=n,Gt!==null&&(Es?(e=Gt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Gt.removeChild(r.stateNode));break;case 18:Gt!==null&&(Es?(e=Gt,r=r.stateNode,e.nodeType===8?jf(e.parentNode,r):e.nodeType===1&&jf(e,r),Xo(e)):jf(Gt,r.stateNode));break;case 4:s=Gt,n=Es,Gt=r.stateNode.containerInfo,Es=!0,Ha(e,t,r),Gt=s,Es=n;break;case 0:case 11:case 14:case 15:if(!nr&&(s=r.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){n=s=s.next;do{var i=n,l=i.destroy;i=i.tag,l!==void 0&&(i&2||i&4)&&Yh(r,t,l),n=n.next}while(n!==s)}Ha(e,t,r);break;case 1:if(!nr&&(al(r,t),s=r.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=r.memoizedProps,s.state=r.memoizedState,s.componentWillUnmount()}catch(o){xt(r,t,o)}Ha(e,t,r);break;case 21:Ha(e,t,r);break;case 22:r.mode&1?(nr=(s=nr)||r.memoizedState!==null,Ha(e,t,r),nr=s):Ha(e,t,r);break;default:Ha(e,t,r)}}function Hg(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new IS),t.forEach(function(s){var n=WS.bind(null,e,s);r.has(s)||(r.add(s),s.then(n,n))})}}function bs(e,t){var r=t.deletions;if(r!==null)for(var s=0;s<r.length;s++){var n=r[s];try{var i=e,l=t,o=l;e:for(;o!==null;){switch(o.tag){case 5:Gt=o.stateNode,Es=!1;break e;case 3:Gt=o.stateNode.containerInfo,Es=!0;break e;case 4:Gt=o.stateNode.containerInfo,Es=!0;break e}o=o.return}if(Gt===null)throw Error(ce(160));ob(i,l,n),Gt=null,Es=!1;var c=n.alternate;c!==null&&(c.return=null),n.return=null}catch(u){xt(n,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)cb(t,e),t=t.sibling}function cb(e,t){var r=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(bs(t,e),Ys(e),s&4){try{Eo(3,e,e.return),v0(3,e)}catch(p){xt(e,e.return,p)}try{Eo(5,e,e.return)}catch(p){xt(e,e.return,p)}}break;case 1:bs(t,e),Ys(e),s&512&&r!==null&&al(r,r.return);break;case 5:if(bs(t,e),Ys(e),s&512&&r!==null&&al(r,r.return),e.flags&32){var n=e.stateNode;try{Go(n,"")}catch(p){xt(e,e.return,p)}}if(s&4&&(n=e.stateNode,n!=null)){var i=e.memoizedProps,l=r!==null?r.memoizedProps:i,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&F2(n,i),bh(o,l);var u=bh(o,i);for(l=0;l<c.length;l+=2){var d=c[l],f=c[l+1];d==="style"?O2(n,f):d==="dangerouslySetInnerHTML"?D2(n,f):d==="children"?Go(n,f):Gm(n,d,f,u)}switch(o){case"input":xh(n,i);break;case"textarea":R2(n,i);break;case"select":var h=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!i.multiple;var x=i.value;x!=null?dl(n,!!i.multiple,x,!1):h!==!!i.multiple&&(i.defaultValue!=null?dl(n,!!i.multiple,i.defaultValue,!0):dl(n,!!i.multiple,i.multiple?[]:"",!1))}n[tc]=i}catch(p){xt(e,e.return,p)}}break;case 6:if(bs(t,e),Ys(e),s&4){if(e.stateNode===null)throw Error(ce(162));n=e.stateNode,i=e.memoizedProps;try{n.nodeValue=i}catch(p){xt(e,e.return,p)}}break;case 3:if(bs(t,e),Ys(e),s&4&&r!==null&&r.memoizedState.isDehydrated)try{Xo(t.containerInfo)}catch(p){xt(e,e.return,p)}break;case 4:bs(t,e),Ys(e);break;case 13:bs(t,e),Ys(e),n=e.child,n.flags&8192&&(i=n.memoizedState!==null,n.stateNode.isHidden=i,!i||n.alternate!==null&&n.alternate.memoizedState!==null||(kp=bt())),s&4&&Hg(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(nr=(u=nr)||d,bs(t,e),nr=u):bs(t,e),Ys(e),s&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(be=e,d=e.child;d!==null;){for(f=be=d;be!==null;){switch(h=be,x=h.child,h.tag){case 0:case 11:case 14:case 15:Eo(4,h,h.return);break;case 1:al(h,h.return);var m=h.stateNode;if(typeof m.componentWillUnmount=="function"){s=h,r=h.return;try{t=s,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(p){xt(s,r,p)}}break;case 5:al(h,h.return);break;case 22:if(h.memoizedState!==null){Gg(f);continue}}x!==null?(x.return=h,be=x):Gg(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{n=f.stateNode,u?(i=n.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=f.stateNode,c=f.memoizedProps.style,l=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=I2("display",l))}catch(p){xt(e,e.return,p)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(p){xt(e,e.return,p)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:bs(t,e),Ys(e),s&4&&Hg(e);break;case 21:break;default:bs(t,e),Ys(e)}}function Ys(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(lb(r)){var s=r;break e}r=r.return}throw Error(ce(160))}switch(s.tag){case 5:var n=s.stateNode;s.flags&32&&(Go(n,""),s.flags&=-33);var i=zg(e);Qh(e,i,n);break;case 3:case 4:var l=s.stateNode.containerInfo,o=zg(e);Xh(e,o,l);break;default:throw Error(ce(161))}}catch(c){xt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function MS(e,t,r){be=e,ub(e)}function ub(e,t,r){for(var s=(e.mode&1)!==0;be!==null;){var n=be,i=n.child;if(n.tag===22&&s){var l=n.memoizedState!==null||Cu;if(!l){var o=n.alternate,c=o!==null&&o.memoizedState!==null||nr;o=Cu;var u=nr;if(Cu=l,(nr=c)&&!u)for(be=n;be!==null;)l=be,c=l.child,l.tag===22&&l.memoizedState!==null?qg(n):c!==null?(c.return=l,be=c):qg(n);for(;i!==null;)be=i,ub(i),i=i.sibling;be=n,Cu=o,nr=u}Wg(e)}else n.subtreeFlags&8772&&i!==null?(i.return=n,be=i):Wg(e)}}function Wg(e){for(;be!==null;){var t=be;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:nr||v0(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!nr)if(r===null)s.componentDidMount();else{var n=t.elementType===t.type?r.memoizedProps:ks(t.type,r.memoizedProps);s.componentDidUpdate(n,r.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Eg(t,i,s);break;case 3:var l=t.updateQueue;if(l!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Eg(t,l,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Xo(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ce(163))}nr||t.flags&512&&Kh(t)}catch(h){xt(t,t.return,h)}}if(t===e){be=null;break}if(r=t.sibling,r!==null){r.return=t.return,be=r;break}be=t.return}}function Gg(e){for(;be!==null;){var t=be;if(t===e){be=null;break}var r=t.sibling;if(r!==null){r.return=t.return,be=r;break}be=t.return}}function qg(e){for(;be!==null;){var t=be;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{v0(4,t)}catch(c){xt(t,r,c)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var n=t.return;try{s.componentDidMount()}catch(c){xt(t,n,c)}}var i=t.return;try{Kh(t)}catch(c){xt(t,i,c)}break;case 5:var l=t.return;try{Kh(t)}catch(c){xt(t,l,c)}}}catch(c){xt(t,t.return,c)}if(t===e){be=null;break}var o=t.sibling;if(o!==null){o.return=t.return,be=o;break}be=t.return}}var LS=Math.ceil,Pd=Va.ReactCurrentDispatcher,Np=Va.ReactCurrentOwner,hs=Va.ReactCurrentBatchConfig,Ue=0,Bt=null,Tt=null,Yt=0,Vr=0,nl=Pn(0),Ft=0,lc=null,ji=0,w0=0,_p=0,Ao=null,Fr=null,kp=0,Dl=1/0,wa=null,Dd=!1,Jh=null,bn=null,Tu=!1,fn=null,Id=0,Fo=0,Zh=null,ad=-1,nd=0;function Nr(){return Ue&6?bt():ad!==-1?ad:ad=bt()}function jn(e){return e.mode&1?Ue&2&&Yt!==0?Yt&-Yt:bS.transition!==null?(nd===0&&(nd=Y2()),nd):(e=Ge,e!==0||(e=window.event,e=e===void 0?16:tw(e.type)),e):1}function Is(e,t,r,s){if(50<Fo)throw Fo=0,Zh=null,Error(ce(185));Pc(e,r,s),(!(Ue&2)||e!==Bt)&&(e===Bt&&(!(Ue&2)&&(w0|=r),Ft===4&&Za(e,Yt)),Ir(e,s),r===1&&Ue===0&&!(t.mode&1)&&(Dl=bt()+500,x0&&Dn()))}function Ir(e,t){var r=e.callbackNode;bk(e,t);var s=yd(e,e===Bt?Yt:0);if(s===0)r!==null&&rg(r),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(r!=null&&rg(r),t===1)e.tag===0?wS(Yg.bind(null,e)):ww(Yg.bind(null,e)),xS(function(){!(Ue&6)&&Dn()}),r=null;else{switch(K2(s)){case 1:r=Qm;break;case 4:r=G2;break;case 16:r=gd;break;case 536870912:r=q2;break;default:r=gd}r=yb(r,db.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function db(e,t){if(ad=-1,nd=0,Ue&6)throw Error(ce(327));var r=e.callbackNode;if(xl()&&e.callbackNode!==r)return null;var s=yd(e,e===Bt?Yt:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=Od(e,s);else{t=s;var n=Ue;Ue|=2;var i=hb();(Bt!==e||Yt!==t)&&(wa=null,Dl=bt()+500,di(e,t));do try{$S();break}catch(o){fb(e,o)}while(!0);up(),Pd.current=i,Ue=n,Tt!==null?t=0:(Bt=null,Yt=0,t=Ft)}if(t!==0){if(t===2&&(n=Sh(e),n!==0&&(s=n,t=em(e,n))),t===1)throw r=lc,di(e,0),Za(e,s),Ir(e,bt()),r;if(t===6)Za(e,s);else{if(n=e.current.alternate,!(s&30)&&!BS(n)&&(t=Od(e,s),t===2&&(i=Sh(e),i!==0&&(s=i,t=em(e,i))),t===1))throw r=lc,di(e,0),Za(e,s),Ir(e,bt()),r;switch(e.finishedWork=n,e.finishedLanes=s,t){case 0:case 1:throw Error(ce(345));case 2:Gn(e,Fr,wa);break;case 3:if(Za(e,s),(s&130023424)===s&&(t=kp+500-bt(),10<t)){if(yd(e,0)!==0)break;if(n=e.suspendedLanes,(n&s)!==s){Nr(),e.pingedLanes|=e.suspendedLanes&n;break}e.timeoutHandle=Dh(Gn.bind(null,e,Fr,wa),t);break}Gn(e,Fr,wa);break;case 4:if(Za(e,s),(s&4194240)===s)break;for(t=e.eventTimes,n=-1;0<s;){var l=31-Ds(s);i=1<<l,l=t[l],l>n&&(n=l),s&=~i}if(s=n,s=bt()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*LS(s/1960))-s,10<s){e.timeoutHandle=Dh(Gn.bind(null,e,Fr,wa),s);break}Gn(e,Fr,wa);break;case 5:Gn(e,Fr,wa);break;default:throw Error(ce(329))}}}return Ir(e,bt()),e.callbackNode===r?db.bind(null,e):null}function em(e,t){var r=Ao;return e.current.memoizedState.isDehydrated&&(di(e,t).flags|=256),e=Od(e,t),e!==2&&(t=Fr,Fr=r,t!==null&&tm(t)),e}function tm(e){Fr===null?Fr=e:Fr.push.apply(Fr,e)}function BS(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var s=0;s<r.length;s++){var n=r[s],i=n.getSnapshot;n=n.value;try{if(!Ls(i(),n))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Za(e,t){for(t&=~_p,t&=~w0,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Ds(t),s=1<<r;e[r]=-1,t&=~s}}function Yg(e){if(Ue&6)throw Error(ce(327));xl();var t=yd(e,0);if(!(t&1))return Ir(e,bt()),null;var r=Od(e,t);if(e.tag!==0&&r===2){var s=Sh(e);s!==0&&(t=s,r=em(e,s))}if(r===1)throw r=lc,di(e,0),Za(e,t),Ir(e,bt()),r;if(r===6)throw Error(ce(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Gn(e,Fr,wa),Ir(e,bt()),null}function Sp(e,t){var r=Ue;Ue|=1;try{return e(t)}finally{Ue=r,Ue===0&&(Dl=bt()+500,x0&&Dn())}}function Ni(e){fn!==null&&fn.tag===0&&!(Ue&6)&&xl();var t=Ue;Ue|=1;var r=hs.transition,s=Ge;try{if(hs.transition=null,Ge=1,e)return e()}finally{Ge=s,hs.transition=r,Ue=t,!(Ue&6)&&Dn()}}function Cp(){Vr=nl.current,tt(nl)}function di(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,pS(r)),Tt!==null)for(r=Tt.return;r!==null;){var s=r;switch(lp(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Nd();break;case 3:Rl(),tt(Pr),tt(fr),xp();break;case 5:pp(s);break;case 4:Rl();break;case 13:tt(ut);break;case 19:tt(ut);break;case 10:dp(s.type._context);break;case 22:case 23:Cp()}r=r.return}if(Bt=e,Tt=e=Nn(e.current,null),Yt=Vr=t,Ft=0,lc=null,_p=w0=ji=0,Fr=Ao=null,Zn!==null){for(t=0;t<Zn.length;t++)if(r=Zn[t],s=r.interleaved,s!==null){r.interleaved=null;var n=s.next,i=r.pending;if(i!==null){var l=i.next;i.next=n,s.next=l}r.pending=s}Zn=null}return e}function fb(e,t){do{var r=Tt;try{if(up(),td.current=Rd,Fd){for(var s=ft.memoizedState;s!==null;){var n=s.queue;n!==null&&(n.pending=null),s=s.next}Fd=!1}if(bi=0,Lt=At=ft=null,To=!1,ac=0,Np.current=null,r===null||r.return===null){Ft=1,lc=t,Tt=null;break}e:{var i=e,l=r.return,o=r,c=t;if(t=Yt,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=o,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var x=Ig(l);if(x!==null){x.flags&=-257,Og(x,l,o,i,t),x.mode&1&&Dg(i,u,t),t=x,c=u;var m=t.updateQueue;if(m===null){var p=new Set;p.add(c),t.updateQueue=p}else m.add(c);break e}else{if(!(t&1)){Dg(i,u,t),Tp();break e}c=Error(ce(426))}}else if(at&&o.mode&1){var w=Ig(l);if(w!==null){!(w.flags&65536)&&(w.flags|=256),Og(w,l,o,i,t),op(Pl(c,o));break e}}i=c=Pl(c,o),Ft!==4&&(Ft=2),Ao===null?Ao=[i]:Ao.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var b=Kw(i,c,t);Tg(i,b);break e;case 1:o=c;var g=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof g.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(bn===null||!bn.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t;var j=Xw(i,o,t);Tg(i,j);break e}}i=i.return}while(i!==null)}pb(r)}catch(A){t=A,Tt===r&&r!==null&&(Tt=r=r.return);continue}break}while(!0)}function hb(){var e=Pd.current;return Pd.current=Rd,e===null?Rd:e}function Tp(){(Ft===0||Ft===3||Ft===2)&&(Ft=4),Bt===null||!(ji&268435455)&&!(w0&268435455)||Za(Bt,Yt)}function Od(e,t){var r=Ue;Ue|=2;var s=hb();(Bt!==e||Yt!==t)&&(wa=null,di(e,t));do try{US();break}catch(n){fb(e,n)}while(!0);if(up(),Ue=r,Pd.current=s,Tt!==null)throw Error(ce(261));return Bt=null,Yt=0,Ft}function US(){for(;Tt!==null;)mb(Tt)}function $S(){for(;Tt!==null&&!fk();)mb(Tt)}function mb(e){var t=gb(e.alternate,e,Vr);e.memoizedProps=e.pendingProps,t===null?pb(e):Tt=t,Np.current=null}function pb(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=DS(r,t),r!==null){r.flags&=32767,Tt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ft=6,Tt=null;return}}else if(r=PS(r,t,Vr),r!==null){Tt=r;return}if(t=t.sibling,t!==null){Tt=t;return}Tt=t=e}while(t!==null);Ft===0&&(Ft=5)}function Gn(e,t,r){var s=Ge,n=hs.transition;try{hs.transition=null,Ge=1,VS(e,t,r,s)}finally{hs.transition=n,Ge=s}return null}function VS(e,t,r,s){do xl();while(fn!==null);if(Ue&6)throw Error(ce(327));r=e.finishedWork;var n=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ce(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(jk(e,i),e===Bt&&(Tt=Bt=null,Yt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Tu||(Tu=!0,yb(gd,function(){return xl(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=hs.transition,hs.transition=null;var l=Ge;Ge=1;var o=Ue;Ue|=4,Np.current=null,OS(e,r),cb(r,e),oS(Rh),vd=!!Fh,Rh=Fh=null,e.current=r,MS(r),hk(),Ue=o,Ge=l,hs.transition=i}else e.current=r;if(Tu&&(Tu=!1,fn=e,Id=n),i=e.pendingLanes,i===0&&(bn=null),xk(r.stateNode),Ir(e,bt()),t!==null)for(s=e.onRecoverableError,r=0;r<t.length;r++)n=t[r],s(n.value,{componentStack:n.stack,digest:n.digest});if(Dd)throw Dd=!1,e=Jh,Jh=null,e;return Id&1&&e.tag!==0&&xl(),i=e.pendingLanes,i&1?e===Zh?Fo++:(Fo=0,Zh=e):Fo=0,Dn(),null}function xl(){if(fn!==null){var e=K2(Id),t=hs.transition,r=Ge;try{if(hs.transition=null,Ge=16>e?16:e,fn===null)var s=!1;else{if(e=fn,fn=null,Id=0,Ue&6)throw Error(ce(331));var n=Ue;for(Ue|=4,be=e.current;be!==null;){var i=be,l=i.child;if(be.flags&16){var o=i.deletions;if(o!==null){for(var c=0;c<o.length;c++){var u=o[c];for(be=u;be!==null;){var d=be;switch(d.tag){case 0:case 11:case 15:Eo(8,d,i)}var f=d.child;if(f!==null)f.return=d,be=f;else for(;be!==null;){d=be;var h=d.sibling,x=d.return;if(ib(d),d===u){be=null;break}if(h!==null){h.return=x,be=h;break}be=x}}}var m=i.alternate;if(m!==null){var p=m.child;if(p!==null){m.child=null;do{var w=p.sibling;p.sibling=null,p=w}while(p!==null)}}be=i}}if(i.subtreeFlags&2064&&l!==null)l.return=i,be=l;else e:for(;be!==null;){if(i=be,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Eo(9,i,i.return)}var b=i.sibling;if(b!==null){b.return=i.return,be=b;break e}be=i.return}}var g=e.current;for(be=g;be!==null;){l=be;var y=l.child;if(l.subtreeFlags&2064&&y!==null)y.return=l,be=y;else e:for(l=g;be!==null;){if(o=be,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:v0(9,o)}}catch(A){xt(o,o.return,A)}if(o===l){be=null;break e}var j=o.sibling;if(j!==null){j.return=o.return,be=j;break e}be=o.return}}if(Ue=n,Dn(),na&&typeof na.onPostCommitFiberRoot=="function")try{na.onPostCommitFiberRoot(d0,e)}catch{}s=!0}return s}finally{Ge=r,hs.transition=t}}return!1}function Kg(e,t,r){t=Pl(r,t),t=Kw(e,t,1),e=wn(e,t,1),t=Nr(),e!==null&&(Pc(e,1,t),Ir(e,t))}function xt(e,t,r){if(e.tag===3)Kg(e,e,r);else for(;t!==null;){if(t.tag===3){Kg(t,e,r);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(bn===null||!bn.has(s))){e=Pl(r,e),e=Xw(t,e,1),t=wn(t,e,1),e=Nr(),t!==null&&(Pc(t,1,e),Ir(t,e));break}}t=t.return}}function zS(e,t,r){var s=e.pingCache;s!==null&&s.delete(t),t=Nr(),e.pingedLanes|=e.suspendedLanes&r,Bt===e&&(Yt&r)===r&&(Ft===4||Ft===3&&(Yt&130023424)===Yt&&500>bt()-kp?di(e,0):_p|=r),Ir(e,t)}function xb(e,t){t===0&&(e.mode&1?(t=yu,yu<<=1,!(yu&130023424)&&(yu=4194304)):t=1);var r=Nr();e=Ia(e,t),e!==null&&(Pc(e,t,r),Ir(e,r))}function HS(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),xb(e,r)}function WS(e,t){var r=0;switch(e.tag){case 13:var s=e.stateNode,n=e.memoizedState;n!==null&&(r=n.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(ce(314))}s!==null&&s.delete(t),xb(e,r)}var gb;gb=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Pr.current)Rr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Rr=!1,RS(e,t,r);Rr=!!(e.flags&131072)}else Rr=!1,at&&t.flags&1048576&&bw(t,Sd,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;sd(e,t),e=t.pendingProps;var n=El(t,fr.current);pl(t,r),n=yp(null,t,s,e,n,r);var i=vp();return t.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Dr(s)?(i=!0,_d(t)):i=!1,t.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,hp(t),n.updater=y0,t.stateNode=n,n._reactInternals=t,$h(t,s,e,r),t=Hh(null,t,s,!0,i,r)):(t.tag=0,at&&i&&ip(t),yr(null,t,n,r),t=t.child),t;case 16:s=t.elementType;e:{switch(sd(e,t),e=t.pendingProps,n=s._init,s=n(s._payload),t.type=s,n=t.tag=qS(s),e=ks(s,e),n){case 0:t=zh(null,t,s,e,r);break e;case 1:t=Bg(null,t,s,e,r);break e;case 11:t=Mg(null,t,s,e,r);break e;case 14:t=Lg(null,t,s,ks(s.type,e),r);break e}throw Error(ce(306,s,""))}return t;case 0:return s=t.type,n=t.pendingProps,n=t.elementType===s?n:ks(s,n),zh(e,t,s,n,r);case 1:return s=t.type,n=t.pendingProps,n=t.elementType===s?n:ks(s,n),Bg(e,t,s,n,r);case 3:e:{if(eb(t),e===null)throw Error(ce(387));s=t.pendingProps,i=t.memoizedState,n=i.element,Cw(e,t),Ed(t,s,null,r);var l=t.memoizedState;if(s=l.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){n=Pl(Error(ce(423)),t),t=Ug(e,t,s,r,n);break e}else if(s!==n){n=Pl(Error(ce(424)),t),t=Ug(e,t,s,r,n);break e}else for(qr=vn(t.stateNode.containerInfo.firstChild),Yr=t,at=!0,As=null,r=kw(t,null,s,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Al(),s===n){t=Oa(e,t,r);break e}yr(e,t,s,r)}t=t.child}return t;case 5:return Tw(t),e===null&&Lh(t),s=t.type,n=t.pendingProps,i=e!==null?e.memoizedProps:null,l=n.children,Ph(s,n)?l=null:i!==null&&Ph(s,i)&&(t.flags|=32),Zw(e,t),yr(e,t,l,r),t.child;case 6:return e===null&&Lh(t),null;case 13:return tb(e,t,r);case 4:return mp(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=Fl(t,null,s,r):yr(e,t,s,r),t.child;case 11:return s=t.type,n=t.pendingProps,n=t.elementType===s?n:ks(s,n),Mg(e,t,s,n,r);case 7:return yr(e,t,t.pendingProps,r),t.child;case 8:return yr(e,t,t.pendingProps.children,r),t.child;case 12:return yr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(s=t.type._context,n=t.pendingProps,i=t.memoizedProps,l=n.value,Ke(Cd,s._currentValue),s._currentValue=l,i!==null)if(Ls(i.value,l)){if(i.children===n.children&&!Pr.current){t=Oa(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){l=i.child;for(var c=o.firstContext;c!==null;){if(c.context===s){if(i.tag===1){c=Ca(-1,r&-r),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),Bh(i.return,r,t),o.lanes|=r;break}c=c.next}}else if(i.tag===10)l=i.type===t.type?null:i.child;else if(i.tag===18){if(l=i.return,l===null)throw Error(ce(341));l.lanes|=r,o=l.alternate,o!==null&&(o.lanes|=r),Bh(l,r,t),l=i.sibling}else l=i.child;if(l!==null)l.return=i;else for(l=i;l!==null;){if(l===t){l=null;break}if(i=l.sibling,i!==null){i.return=l.return,l=i;break}l=l.return}i=l}yr(e,t,n.children,r),t=t.child}return t;case 9:return n=t.type,s=t.pendingProps.children,pl(t,r),n=ms(n),s=s(n),t.flags|=1,yr(e,t,s,r),t.child;case 14:return s=t.type,n=ks(s,t.pendingProps),n=ks(s.type,n),Lg(e,t,s,n,r);case 15:return Qw(e,t,t.type,t.pendingProps,r);case 17:return s=t.type,n=t.pendingProps,n=t.elementType===s?n:ks(s,n),sd(e,t),t.tag=1,Dr(s)?(e=!0,_d(t)):e=!1,pl(t,r),Yw(t,s,n),$h(t,s,n,r),Hh(null,t,s,!0,e,r);case 19:return rb(e,t,r);case 22:return Jw(e,t,r)}throw Error(ce(156,t.tag))};function yb(e,t){return W2(e,t)}function GS(e,t,r,s){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ds(e,t,r,s){return new GS(e,t,r,s)}function Ep(e){return e=e.prototype,!(!e||!e.isReactComponent)}function qS(e){if(typeof e=="function")return Ep(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Ym)return 11;if(e===Km)return 14}return 2}function Nn(e,t){var r=e.alternate;return r===null?(r=ds(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function id(e,t,r,s,n,i){var l=2;if(s=e,typeof e=="function")Ep(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case Ki:return fi(r.children,n,i,t);case qm:l=8,n|=8;break;case dh:return e=ds(12,r,t,n|2),e.elementType=dh,e.lanes=i,e;case fh:return e=ds(13,r,t,n),e.elementType=fh,e.lanes=i,e;case hh:return e=ds(19,r,t,n),e.elementType=hh,e.lanes=i,e;case T2:return b0(r,n,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case S2:l=10;break e;case C2:l=9;break e;case Ym:l=11;break e;case Km:l=14;break e;case Ka:l=16,s=null;break e}throw Error(ce(130,e==null?e:typeof e,""))}return t=ds(l,r,t,n),t.elementType=e,t.type=s,t.lanes=i,t}function fi(e,t,r,s){return e=ds(7,e,s,t),e.lanes=r,e}function b0(e,t,r,s){return e=ds(22,e,s,t),e.elementType=T2,e.lanes=r,e.stateNode={isHidden:!1},e}function Af(e,t,r){return e=ds(6,e,null,t),e.lanes=r,e}function Ff(e,t,r){return t=ds(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function YS(e,t,r,s,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=df(0),this.expirationTimes=df(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=df(0),this.identifierPrefix=s,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function Ap(e,t,r,s,n,i,l,o,c){return e=new YS(e,t,r,o,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=ds(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:s,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},hp(i),e}function KS(e,t,r){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Yi,key:s==null?null:""+s,children:e,containerInfo:t,implementation:r}}function vb(e){if(!e)return Cn;e=e._reactInternals;e:{if(Fi(e)!==e||e.tag!==1)throw Error(ce(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Dr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ce(171))}if(e.tag===1){var r=e.type;if(Dr(r))return vw(e,r,t)}return t}function wb(e,t,r,s,n,i,l,o,c){return e=Ap(r,s,!0,e,n,i,l,o,c),e.context=vb(null),r=e.current,s=Nr(),n=jn(r),i=Ca(s,n),i.callback=t??null,wn(r,i,n),e.current.lanes=n,Pc(e,n,s),Ir(e,s),e}function j0(e,t,r,s){var n=t.current,i=Nr(),l=jn(n);return r=vb(r),t.context===null?t.context=r:t.pendingContext=r,t=Ca(i,l),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=wn(n,t,l),e!==null&&(Is(e,n,l,i),ed(e,n,l)),l}function Md(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Xg(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Fp(e,t){Xg(e,t),(e=e.alternate)&&Xg(e,t)}function XS(){return null}var bb=typeof reportError=="function"?reportError:function(e){console.error(e)};function Rp(e){this._internalRoot=e}N0.prototype.render=Rp.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ce(409));j0(e,t,null,null)};N0.prototype.unmount=Rp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ni(function(){j0(null,e,null,null)}),t[Da]=null}};function N0(e){this._internalRoot=e}N0.prototype.unstable_scheduleHydration=function(e){if(e){var t=J2();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Ja.length&&t!==0&&t<Ja[r].priority;r++);Ja.splice(r,0,e),r===0&&ew(e)}};function Pp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function _0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Qg(){}function QS(e,t,r,s,n){if(n){if(typeof s=="function"){var i=s;s=function(){var u=Md(l);i.call(u)}}var l=wb(t,s,e,0,null,!1,!1,"",Qg);return e._reactRootContainer=l,e[Da]=l.current,Zo(e.nodeType===8?e.parentNode:e),Ni(),l}for(;n=e.lastChild;)e.removeChild(n);if(typeof s=="function"){var o=s;s=function(){var u=Md(c);o.call(u)}}var c=Ap(e,0,!1,null,null,!1,!1,"",Qg);return e._reactRootContainer=c,e[Da]=c.current,Zo(e.nodeType===8?e.parentNode:e),Ni(function(){j0(t,c,r,s)}),c}function k0(e,t,r,s,n){var i=r._reactRootContainer;if(i){var l=i;if(typeof n=="function"){var o=n;n=function(){var c=Md(l);o.call(c)}}j0(t,l,e,n)}else l=QS(r,t,e,n,s);return Md(l)}X2=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=xo(t.pendingLanes);r!==0&&(Jm(t,r|1),Ir(t,bt()),!(Ue&6)&&(Dl=bt()+500,Dn()))}break;case 13:Ni(function(){var s=Ia(e,1);if(s!==null){var n=Nr();Is(s,e,1,n)}}),Fp(e,1)}};Zm=function(e){if(e.tag===13){var t=Ia(e,134217728);if(t!==null){var r=Nr();Is(t,e,134217728,r)}Fp(e,134217728)}};Q2=function(e){if(e.tag===13){var t=jn(e),r=Ia(e,t);if(r!==null){var s=Nr();Is(r,e,t,s)}Fp(e,t)}};J2=function(){return Ge};Z2=function(e,t){var r=Ge;try{return Ge=e,t()}finally{Ge=r}};Nh=function(e,t,r){switch(t){case"input":if(xh(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var s=r[t];if(s!==e&&s.form===e.form){var n=p0(s);if(!n)throw Error(ce(90));A2(s),xh(s,n)}}}break;case"textarea":R2(e,r);break;case"select":t=r.value,t!=null&&dl(e,!!r.multiple,t,!1)}};B2=Sp;U2=Ni;var JS={usingClientEntryPoint:!1,Events:[Ic,Zi,p0,M2,L2,Sp]},oo={findFiberByHostInstance:Jn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ZS={bundleType:oo.bundleType,version:oo.version,rendererPackageName:oo.rendererPackageName,rendererConfig:oo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Va.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=z2(e),e===null?null:e.stateNode},findFiberByHostInstance:oo.findFiberByHostInstance||XS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Eu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Eu.isDisabled&&Eu.supportsFiber)try{d0=Eu.inject(ZS),na=Eu}catch{}}es.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=JS;es.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Pp(t))throw Error(ce(200));return KS(e,t,null,r)};es.createRoot=function(e,t){if(!Pp(e))throw Error(ce(299));var r=!1,s="",n=bb;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(n=t.onRecoverableError)),t=Ap(e,1,!1,null,null,r,!1,s,n),e[Da]=t.current,Zo(e.nodeType===8?e.parentNode:e),new Rp(t)};es.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ce(188)):(e=Object.keys(e).join(","),Error(ce(268,e)));return e=z2(t),e=e===null?null:e.stateNode,e};es.flushSync=function(e){return Ni(e)};es.hydrate=function(e,t,r){if(!_0(t))throw Error(ce(200));return k0(null,e,t,!0,r)};es.hydrateRoot=function(e,t,r){if(!Pp(e))throw Error(ce(405));var s=r!=null&&r.hydratedSources||null,n=!1,i="",l=bb;if(r!=null&&(r.unstable_strictMode===!0&&(n=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(l=r.onRecoverableError)),t=wb(t,null,e,1,r??null,n,!1,i,l),e[Da]=t.current,Zo(e),s)for(e=0;e<s.length;e++)r=s[e],n=r._getVersion,n=n(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,n]:t.mutableSourceEagerHydrationData.push(r,n);return new N0(t)};es.render=function(e,t,r){if(!_0(t))throw Error(ce(200));return k0(null,e,t,!1,r)};es.unmountComponentAtNode=function(e){if(!_0(e))throw Error(ce(40));return e._reactRootContainer?(Ni(function(){k0(null,null,e,!1,function(){e._reactRootContainer=null,e[Da]=null})}),!0):!1};es.unstable_batchedUpdates=Sp;es.unstable_renderSubtreeIntoContainer=function(e,t,r,s){if(!_0(r))throw Error(ce(200));if(e==null||e._reactInternals===void 0)throw Error(ce(38));return k0(e,t,r,!1,s)};es.version="18.3.1-next-f1338f8080-20240426";function jb(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(jb)}catch(e){console.error(e)}}jb(),j2.exports=es;var e5=j2.exports,Jg=e5;ch.createRoot=Jg.createRoot,ch.hydrateRoot=Jg.hydrateRoot;var S0=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},t5={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},an,Bm,r2,r5=(r2=class{constructor(){Ie(this,an,t5);Ie(this,Bm,!1)}setTimeoutProvider(e){_e(this,an,e)}setTimeout(e,t){return re(this,an).setTimeout(e,t)}clearTimeout(e){re(this,an).clearTimeout(e)}setInterval(e,t){return re(this,an).setInterval(e,t)}clearInterval(e){re(this,an).clearInterval(e)}},an=new WeakMap,Bm=new WeakMap,r2),rm=new r5;function s5(e){setTimeout(e,0)}var C0=typeof window>"u"||"Deno"in globalThis;function Ss(){}function a5(e,t){return typeof e=="function"?e(t):e}function n5(e){return typeof e=="number"&&e>=0&&e!==1/0}function i5(e,t){return Math.max(e+(t||0)-Date.now(),0)}function sm(e,t){return typeof e=="function"?e(t):e}function l5(e,t){return typeof e=="function"?e(t):e}function Zg(e,t){const{type:r="all",exact:s,fetchStatus:n,predicate:i,queryKey:l,stale:o}=e;if(l){if(s){if(t.queryHash!==Dp(l,t.options))return!1}else if(!cc(t.queryKey,l))return!1}if(r!=="all"){const c=t.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||n&&n!==t.state.fetchStatus||i&&!i(t))}function e1(e,t){const{exact:r,status:s,predicate:n,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(r){if(oc(t.options.mutationKey)!==oc(i))return!1}else if(!cc(t.options.mutationKey,i))return!1}return!(s&&t.state.status!==s||n&&!n(t))}function Dp(e,t){return((t==null?void 0:t.queryKeyHashFn)||oc)(e)}function oc(e){return JSON.stringify(e,(t,r)=>am(r)?Object.keys(r).sort().reduce((s,n)=>(s[n]=r[n],s),{}):r)}function cc(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>cc(e[r],t[r])):!1}var o5=Object.prototype.hasOwnProperty;function Nb(e,t){if(e===t)return e;const r=t1(e)&&t1(t);if(!r&&!(am(e)&&am(t)))return t;const n=(r?e:Object.keys(e)).length,i=r?t:Object.keys(t),l=i.length,o=r?new Array(l):{};let c=0;for(let u=0;u<l;u++){const d=r?u:i[u],f=e[d],h=t[d];if(f===h){o[d]=f,(r?u<n:o5.call(e,d))&&c++;continue}if(f===null||h===null||typeof f!="object"||typeof h!="object"){o[d]=h;continue}const x=Nb(f,h);o[d]=x,x===f&&c++}return n===l&&c===n?e:o}function t1(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function am(e){if(!r1(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!r1(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function r1(e){return Object.prototype.toString.call(e)==="[object Object]"}function c5(e){return new Promise(t=>{rm.setTimeout(t,e)})}function u5(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?Nb(e,t):t}function d5(e,t,r=0){const s=[...e,t];return r&&s.length>r?s.slice(1):s}function f5(e,t,r=0){const s=[t,...e];return r&&s.length>r?s.slice(0,-1):s}var Ip=Symbol();function _b(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===Ip?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var ni,nn,wl,s2,h5=(s2=class extends S0{constructor(){super();Ie(this,ni);Ie(this,nn);Ie(this,wl);_e(this,wl,t=>{if(!C0&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){re(this,nn)||this.setEventListener(re(this,wl))}onUnsubscribe(){var t;this.hasListeners()||((t=re(this,nn))==null||t.call(this),_e(this,nn,void 0))}setEventListener(t){var r;_e(this,wl,t),(r=re(this,nn))==null||r.call(this),_e(this,nn,t(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(t){re(this,ni)!==t&&(_e(this,ni,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof re(this,ni)=="boolean"?re(this,ni):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},ni=new WeakMap,nn=new WeakMap,wl=new WeakMap,s2),kb=new h5;function m5(){let e,t;const r=new Promise((n,i)=>{e=n,t=i});r.status="pending",r.catch(()=>{});function s(n){Object.assign(r,n),delete r.resolve,delete r.reject}return r.resolve=n=>{s({status:"fulfilled",value:n}),e(n)},r.reject=n=>{s({status:"rejected",reason:n}),t(n)},r}var p5=s5;function x5(){let e=[],t=0,r=o=>{o()},s=o=>{o()},n=p5;const i=o=>{t?e.push(o):n(()=>{r(o)})},l=()=>{const o=e;e=[],o.length&&n(()=>{s(()=>{o.forEach(c=>{r(c)})})})};return{batch:o=>{let c;t++;try{c=o()}finally{t--,t||l()}return c},batchCalls:o=>(...c)=>{i(()=>{o(...c)})},schedule:i,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{s=o},setScheduler:o=>{n=o}}}var wr=x5(),bl,ln,jl,a2,g5=(a2=class extends S0{constructor(){super();Ie(this,bl,!0);Ie(this,ln);Ie(this,jl);_e(this,jl,t=>{if(!C0&&window.addEventListener){const r=()=>t(!0),s=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",s)}}})}onSubscribe(){re(this,ln)||this.setEventListener(re(this,jl))}onUnsubscribe(){var t;this.hasListeners()||((t=re(this,ln))==null||t.call(this),_e(this,ln,void 0))}setEventListener(t){var r;_e(this,jl,t),(r=re(this,ln))==null||r.call(this),_e(this,ln,t(this.setOnline.bind(this)))}setOnline(t){re(this,bl)!==t&&(_e(this,bl,t),this.listeners.forEach(s=>{s(t)}))}isOnline(){return re(this,bl)}},bl=new WeakMap,ln=new WeakMap,jl=new WeakMap,a2),Ld=new g5;function y5(e){return Math.min(1e3*2**e,3e4)}function Sb(e){return(e??"online")==="online"?Ld.isOnline():!0}var nm=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function Cb(e){let t=!1,r=0,s;const n=m5(),i=()=>n.status!=="pending",l=p=>{var w;if(!i()){const b=new nm(p);h(b),(w=e.onCancel)==null||w.call(e,b)}},o=()=>{t=!0},c=()=>{t=!1},u=()=>kb.isFocused()&&(e.networkMode==="always"||Ld.isOnline())&&e.canRun(),d=()=>Sb(e.networkMode)&&e.canRun(),f=p=>{i()||(s==null||s(),n.resolve(p))},h=p=>{i()||(s==null||s(),n.reject(p))},x=()=>new Promise(p=>{var w;s=b=>{(i()||u())&&p(b)},(w=e.onPause)==null||w.call(e)}).then(()=>{var p;s=void 0,i()||(p=e.onContinue)==null||p.call(e)}),m=()=>{if(i())return;let p;const w=r===0?e.initialPromise:void 0;try{p=w??e.fn()}catch(b){p=Promise.reject(b)}Promise.resolve(p).then(f).catch(b=>{var k;if(i())return;const g=e.retry??(C0?0:3),y=e.retryDelay??y5,j=typeof y=="function"?y(r,b):y,A=g===!0||typeof g=="number"&&r<g||typeof g=="function"&&g(r,b);if(t||!A){h(b);return}r++,(k=e.onFail)==null||k.call(e,r,b),c5(j).then(()=>u()?void 0:x()).then(()=>{t?h(b):m()})})};return{promise:n,status:()=>n.status,cancel:l,continue:()=>(s==null||s(),n),cancelRetry:o,continueRetry:c,canStart:d,start:()=>(d()?m():x().then(m),n)}}var ii,n2,Tb=(n2=class{constructor(){Ie(this,ii)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),n5(this.gcTime)&&_e(this,ii,rm.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(C0?1/0:5*60*1e3))}clearGcTimeout(){re(this,ii)&&(rm.clearTimeout(re(this,ii)),_e(this,ii,void 0))}},ii=new WeakMap,n2),li,Nl,os,oi,Ot,Ec,ci,Cs,va,i2,v5=(i2=class extends Tb{constructor(t){super();Ie(this,Cs);Ie(this,li);Ie(this,Nl);Ie(this,os);Ie(this,oi);Ie(this,Ot);Ie(this,Ec);Ie(this,ci);_e(this,ci,!1),_e(this,Ec,t.defaultOptions),this.setOptions(t.options),this.observers=[],_e(this,oi,t.client),_e(this,os,re(this,oi).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,_e(this,li,a1(this.options)),this.state=t.state??re(this,li),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=re(this,Ot))==null?void 0:t.promise}setOptions(t){if(this.options={...re(this,Ec),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=a1(this.options);r.data!==void 0&&(this.setState(s1(r.data,r.dataUpdatedAt)),_e(this,li,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&re(this,os).remove(this)}setData(t,r){const s=u5(this.state.data,t,this.options);return Zt(this,Cs,va).call(this,{data:s,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),s}setState(t,r){Zt(this,Cs,va).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var s,n;const r=(s=re(this,Ot))==null?void 0:s.promise;return(n=re(this,Ot))==null||n.cancel(t),r?r.then(Ss).catch(Ss):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(re(this,li))}isActive(){return this.observers.some(t=>l5(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Ip||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>sm(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!i5(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(s=>s.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=re(this,Ot))==null||r.continue()}onOnline(){var r;const t=this.observers.find(s=>s.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=re(this,Ot))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),re(this,os).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(re(this,Ot)&&(re(this,ci)?re(this,Ot).cancel({revert:!0}):re(this,Ot).cancelRetry()),this.scheduleGc()),re(this,os).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Zt(this,Cs,va).call(this,{type:"invalidate"})}async fetch(t,r){var c,u,d,f,h,x,m,p,w,b,g,y;if(this.state.fetchStatus!=="idle"&&((c=re(this,Ot))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(re(this,Ot))return re(this,Ot).continueRetry(),re(this,Ot).promise}if(t&&this.setOptions(t),!this.options.queryFn){const j=this.observers.find(A=>A.options.queryFn);j&&this.setOptions(j.options)}const s=new AbortController,n=j=>{Object.defineProperty(j,"signal",{enumerable:!0,get:()=>(_e(this,ci,!0),s.signal)})},i=()=>{const j=_b(this.options,r),k=(()=>{const v={client:re(this,oi),queryKey:this.queryKey,meta:this.meta};return n(v),v})();return _e(this,ci,!1),this.options.persister?this.options.persister(j,k,this):j(k)},o=(()=>{const j={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:re(this,oi),state:this.state,fetchFn:i};return n(j),j})();(u=this.options.behavior)==null||u.onFetch(o,this),_e(this,Nl,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((d=o.fetchOptions)==null?void 0:d.meta))&&Zt(this,Cs,va).call(this,{type:"fetch",meta:(f=o.fetchOptions)==null?void 0:f.meta}),_e(this,Ot,Cb({initialPromise:r==null?void 0:r.initialPromise,fn:o.fetchFn,onCancel:j=>{j instanceof nm&&j.revert&&this.setState({...re(this,Nl),fetchStatus:"idle"}),s.abort()},onFail:(j,A)=>{Zt(this,Cs,va).call(this,{type:"failed",failureCount:j,error:A})},onPause:()=>{Zt(this,Cs,va).call(this,{type:"pause"})},onContinue:()=>{Zt(this,Cs,va).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const j=await re(this,Ot).start();if(j===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(j),(x=(h=re(this,os).config).onSuccess)==null||x.call(h,j,this),(p=(m=re(this,os).config).onSettled)==null||p.call(m,j,this.state.error,this),j}catch(j){if(j instanceof nm){if(j.silent)return re(this,Ot).promise;if(j.revert){if(this.state.data===void 0)throw j;return this.state.data}}throw Zt(this,Cs,va).call(this,{type:"error",error:j}),(b=(w=re(this,os).config).onError)==null||b.call(w,j,this),(y=(g=re(this,os).config).onSettled)==null||y.call(g,this.state.data,j,this),j}finally{this.scheduleGc()}}},li=new WeakMap,Nl=new WeakMap,os=new WeakMap,oi=new WeakMap,Ot=new WeakMap,Ec=new WeakMap,ci=new WeakMap,Cs=new WeakSet,va=function(t){const r=s=>{switch(t.type){case"failed":return{...s,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...w5(s.data,this.options),fetchMeta:t.meta??null};case"success":const n={...s,...s1(t.data,t.dataUpdatedAt),dataUpdateCount:s.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return _e(this,Nl,t.manual?n:void 0),n;case"error":const i=t.error;return{...s,error:i,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...t.state}}};this.state=r(this.state),wr.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),re(this,os).notify({query:this,type:"updated",action:t})})},i2);function w5(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Sb(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function s1(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function a1(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,s=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}function n1(e){return{onFetch:(t,r)=>{var d,f,h,x,m;const s=t.options,n=(h=(f=(d=t.fetchOptions)==null?void 0:d.meta)==null?void 0:f.fetchMore)==null?void 0:h.direction,i=((x=t.state.data)==null?void 0:x.pages)||[],l=((m=t.state.data)==null?void 0:m.pageParams)||[];let o={pages:[],pageParams:[]},c=0;const u=async()=>{let p=!1;const w=y=>{Object.defineProperty(y,"signal",{enumerable:!0,get:()=>(t.signal.aborted?p=!0:t.signal.addEventListener("abort",()=>{p=!0}),t.signal)})},b=_b(t.options,t.fetchOptions),g=async(y,j,A)=>{if(p)return Promise.reject();if(j==null&&y.pages.length)return Promise.resolve(y);const v=(()=>{const D={client:t.client,queryKey:t.queryKey,pageParam:j,direction:A?"backward":"forward",meta:t.options.meta};return w(D),D})(),E=await b(v),{maxPages:S}=t.options,N=A?f5:d5;return{pages:N(y.pages,E,S),pageParams:N(y.pageParams,j,S)}};if(n&&i.length){const y=n==="backward",j=y?b5:i1,A={pages:i,pageParams:l},k=j(s,A);o=await g(A,k,y)}else{const y=e??i.length;do{const j=c===0?l[0]??s.initialPageParam:i1(s,o);if(c>0&&j==null)break;o=await g(o,j),c++}while(c<y)}return o};t.options.persister?t.fetchFn=()=>{var p,w;return(w=(p=t.options).persister)==null?void 0:w.call(p,u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=u}}}function i1(e,{pages:t,pageParams:r}){const s=t.length-1;return t.length>0?e.getNextPageParam(t[s],t,r[s],r):void 0}function b5(e,{pages:t,pageParams:r}){var s;return t.length>0?(s=e.getPreviousPageParam)==null?void 0:s.call(e,t[0],t,r[0],r):void 0}var Ac,ea,xr,ui,ta,Ga,l2,j5=(l2=class extends Tb{constructor(t){super();Ie(this,ta);Ie(this,Ac);Ie(this,ea);Ie(this,xr);Ie(this,ui);_e(this,Ac,t.client),this.mutationId=t.mutationId,_e(this,xr,t.mutationCache),_e(this,ea,[]),this.state=t.state||N5(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){re(this,ea).includes(t)||(re(this,ea).push(t),this.clearGcTimeout(),re(this,xr).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){_e(this,ea,re(this,ea).filter(r=>r!==t)),this.scheduleGc(),re(this,xr).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){re(this,ea).length||(this.state.status==="pending"?this.scheduleGc():re(this,xr).remove(this))}continue(){var t;return((t=re(this,ui))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var l,o,c,u,d,f,h,x,m,p,w,b,g,y,j,A,k,v,E,S;const r=()=>{Zt(this,ta,Ga).call(this,{type:"continue"})},s={client:re(this,Ac),meta:this.options.meta,mutationKey:this.options.mutationKey};_e(this,ui,Cb({fn:()=>this.options.mutationFn?this.options.mutationFn(t,s):Promise.reject(new Error("No mutationFn found")),onFail:(N,D)=>{Zt(this,ta,Ga).call(this,{type:"failed",failureCount:N,error:D})},onPause:()=>{Zt(this,ta,Ga).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>re(this,xr).canRun(this)}));const n=this.state.status==="pending",i=!re(this,ui).canStart();try{if(n)r();else{Zt(this,ta,Ga).call(this,{type:"pending",variables:t,isPaused:i}),await((o=(l=re(this,xr).config).onMutate)==null?void 0:o.call(l,t,this,s));const D=await((u=(c=this.options).onMutate)==null?void 0:u.call(c,t,s));D!==this.state.context&&Zt(this,ta,Ga).call(this,{type:"pending",context:D,variables:t,isPaused:i})}const N=await re(this,ui).start();return await((f=(d=re(this,xr).config).onSuccess)==null?void 0:f.call(d,N,t,this.state.context,this,s)),await((x=(h=this.options).onSuccess)==null?void 0:x.call(h,N,t,this.state.context,s)),await((p=(m=re(this,xr).config).onSettled)==null?void 0:p.call(m,N,null,this.state.variables,this.state.context,this,s)),await((b=(w=this.options).onSettled)==null?void 0:b.call(w,N,null,t,this.state.context,s)),Zt(this,ta,Ga).call(this,{type:"success",data:N}),N}catch(N){try{throw await((y=(g=re(this,xr).config).onError)==null?void 0:y.call(g,N,t,this.state.context,this,s)),await((A=(j=this.options).onError)==null?void 0:A.call(j,N,t,this.state.context,s)),await((v=(k=re(this,xr).config).onSettled)==null?void 0:v.call(k,void 0,N,this.state.variables,this.state.context,this,s)),await((S=(E=this.options).onSettled)==null?void 0:S.call(E,void 0,N,t,this.state.context,s)),N}finally{Zt(this,ta,Ga).call(this,{type:"error",error:N})}}finally{re(this,xr).runNext(this)}}},Ac=new WeakMap,ea=new WeakMap,xr=new WeakMap,ui=new WeakMap,ta=new WeakSet,Ga=function(t){const r=s=>{switch(t.type){case"failed":return{...s,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...s,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:t.error,failureCount:s.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),wr.batch(()=>{re(this,ea).forEach(s=>{s.onMutationUpdate(t)}),re(this,xr).notify({mutation:this,type:"updated",action:t})})},l2);function N5(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var ja,Ts,Fc,o2,_5=(o2=class extends S0{constructor(t={}){super();Ie(this,ja);Ie(this,Ts);Ie(this,Fc);this.config=t,_e(this,ja,new Set),_e(this,Ts,new Map),_e(this,Fc,0)}build(t,r,s){const n=new j5({client:t,mutationCache:this,mutationId:++fu(this,Fc)._,options:t.defaultMutationOptions(r),state:s});return this.add(n),n}add(t){re(this,ja).add(t);const r=Au(t);if(typeof r=="string"){const s=re(this,Ts).get(r);s?s.push(t):re(this,Ts).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(re(this,ja).delete(t)){const r=Au(t);if(typeof r=="string"){const s=re(this,Ts).get(r);if(s)if(s.length>1){const n=s.indexOf(t);n!==-1&&s.splice(n,1)}else s[0]===t&&re(this,Ts).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=Au(t);if(typeof r=="string"){const s=re(this,Ts).get(r),n=s==null?void 0:s.find(i=>i.state.status==="pending");return!n||n===t}else return!0}runNext(t){var s;const r=Au(t);if(typeof r=="string"){const n=(s=re(this,Ts).get(r))==null?void 0:s.find(i=>i!==t&&i.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}else return Promise.resolve()}clear(){wr.batch(()=>{re(this,ja).forEach(t=>{this.notify({type:"removed",mutation:t})}),re(this,ja).clear(),re(this,Ts).clear()})}getAll(){return Array.from(re(this,ja))}find(t){const r={exact:!0,...t};return this.getAll().find(s=>e1(r,s))}findAll(t={}){return this.getAll().filter(r=>e1(t,r))}notify(t){wr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return wr.batch(()=>Promise.all(t.map(r=>r.continue().catch(Ss))))}},ja=new WeakMap,Ts=new WeakMap,Fc=new WeakMap,o2);function Au(e){var t;return(t=e.options.scope)==null?void 0:t.id}var ra,c2,k5=(c2=class extends S0{constructor(t={}){super();Ie(this,ra);this.config=t,_e(this,ra,new Map)}build(t,r,s){const n=r.queryKey,i=r.queryHash??Dp(n,r);let l=this.get(i);return l||(l=new v5({client:t,queryKey:n,queryHash:i,options:t.defaultQueryOptions(r),state:s,defaultOptions:t.getQueryDefaults(n)}),this.add(l)),l}add(t){re(this,ra).has(t.queryHash)||(re(this,ra).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=re(this,ra).get(t.queryHash);r&&(t.destroy(),r===t&&re(this,ra).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){wr.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return re(this,ra).get(t)}getAll(){return[...re(this,ra).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(s=>Zg(r,s))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(s=>Zg(t,s)):r}notify(t){wr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){wr.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){wr.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},ra=new WeakMap,c2),pt,on,cn,_l,kl,un,Sl,Cl,u2,S5=(u2=class{constructor(e={}){Ie(this,pt);Ie(this,on);Ie(this,cn);Ie(this,_l);Ie(this,kl);Ie(this,un);Ie(this,Sl);Ie(this,Cl);_e(this,pt,e.queryCache||new k5),_e(this,on,e.mutationCache||new _5),_e(this,cn,e.defaultOptions||{}),_e(this,_l,new Map),_e(this,kl,new Map),_e(this,un,0)}mount(){fu(this,un)._++,re(this,un)===1&&(_e(this,Sl,kb.subscribe(async e=>{e&&(await this.resumePausedMutations(),re(this,pt).onFocus())})),_e(this,Cl,Ld.subscribe(async e=>{e&&(await this.resumePausedMutations(),re(this,pt).onOnline())})))}unmount(){var e,t;fu(this,un)._--,re(this,un)===0&&((e=re(this,Sl))==null||e.call(this),_e(this,Sl,void 0),(t=re(this,Cl))==null||t.call(this),_e(this,Cl,void 0))}isFetching(e){return re(this,pt).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return re(this,on).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=re(this,pt).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=re(this,pt).build(this,t),s=r.state.data;return s===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(sm(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(s))}getQueriesData(e){return re(this,pt).findAll(e).map(({queryKey:t,state:r})=>{const s=r.data;return[t,s]})}setQueryData(e,t,r){const s=this.defaultQueryOptions({queryKey:e}),n=re(this,pt).get(s.queryHash),i=n==null?void 0:n.state.data,l=a5(t,i);if(l!==void 0)return re(this,pt).build(this,s).setData(l,{...r,manual:!0})}setQueriesData(e,t,r){return wr.batch(()=>re(this,pt).findAll(e).map(({queryKey:s})=>[s,this.setQueryData(s,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=re(this,pt).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=re(this,pt);wr.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=re(this,pt);return wr.batch(()=>(r.findAll(e).forEach(s=>{s.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},s=wr.batch(()=>re(this,pt).findAll(e).map(n=>n.cancel(r)));return Promise.all(s).then(Ss).catch(Ss)}invalidateQueries(e,t={}){return wr.batch(()=>(re(this,pt).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},s=wr.batch(()=>re(this,pt).findAll(e).filter(n=>!n.isDisabled()&&!n.isStatic()).map(n=>{let i=n.fetch(void 0,r);return r.throwOnError||(i=i.catch(Ss)),n.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(s).then(Ss)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=re(this,pt).build(this,t);return r.isStaleByTime(sm(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Ss).catch(Ss)}fetchInfiniteQuery(e){return e.behavior=n1(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Ss).catch(Ss)}ensureInfiniteQueryData(e){return e.behavior=n1(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Ld.isOnline()?re(this,on).resumePausedMutations():Promise.resolve()}getQueryCache(){return re(this,pt)}getMutationCache(){return re(this,on)}getDefaultOptions(){return re(this,cn)}setDefaultOptions(e){_e(this,cn,e)}setQueryDefaults(e,t){re(this,_l).set(oc(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...re(this,_l).values()],r={};return t.forEach(s=>{cc(e,s.queryKey)&&Object.assign(r,s.defaultOptions)}),r}setMutationDefaults(e,t){re(this,kl).set(oc(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...re(this,kl).values()],r={};return t.forEach(s=>{cc(e,s.mutationKey)&&Object.assign(r,s.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...re(this,cn).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=Dp(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Ip&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...re(this,cn).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){re(this,pt).clear(),re(this,on).clear()}},pt=new WeakMap,on=new WeakMap,cn=new WeakMap,_l=new WeakMap,kl=new WeakMap,un=new WeakMap,Sl=new WeakMap,Cl=new WeakMap,u2),C5=C.createContext(void 0),T5=({client:e,children:t})=>(C.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(C5.Provider,{value:e,children:t}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function uc(){return uc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},uc.apply(this,arguments)}var hn;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(hn||(hn={}));const l1="popstate";function E5(e){e===void 0&&(e={});function t(s,n){let{pathname:i,search:l,hash:o}=s.location;return im("",{pathname:i,search:l,hash:o},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function r(s,n){return typeof n=="string"?n:Ab(n)}return F5(t,r,null,e)}function Dt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Eb(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function A5(){return Math.random().toString(36).substr(2,8)}function o1(e,t){return{usr:e.state,key:e.key,idx:t}}function im(e,t,r,s){return r===void 0&&(r=null),uc({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Hl(t):t,{state:r,key:t&&t.key||s||A5()})}function Ab(e){let{pathname:t="/",search:r="",hash:s=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),s&&s!=="#"&&(t+=s.charAt(0)==="#"?s:"#"+s),t}function Hl(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let s=e.indexOf("?");s>=0&&(t.search=e.substr(s),e=e.substr(0,s)),e&&(t.pathname=e)}return t}function F5(e,t,r,s){s===void 0&&(s={});let{window:n=document.defaultView,v5Compat:i=!1}=s,l=n.history,o=hn.Pop,c=null,u=d();u==null&&(u=0,l.replaceState(uc({},l.state,{idx:u}),""));function d(){return(l.state||{idx:null}).idx}function f(){o=hn.Pop;let w=d(),b=w==null?null:w-u;u=w,c&&c({action:o,location:p.location,delta:b})}function h(w,b){o=hn.Push;let g=im(p.location,w,b);u=d()+1;let y=o1(g,u),j=p.createHref(g);try{l.pushState(y,"",j)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;n.location.assign(j)}i&&c&&c({action:o,location:p.location,delta:1})}function x(w,b){o=hn.Replace;let g=im(p.location,w,b);u=d();let y=o1(g,u),j=p.createHref(g);l.replaceState(y,"",j),i&&c&&c({action:o,location:p.location,delta:0})}function m(w){let b=n.location.origin!=="null"?n.location.origin:n.location.href,g=typeof w=="string"?w:Ab(w);return g=g.replace(/ $/,"%20"),Dt(b,"No window.location.(origin|href) available to create URL for href: "+g),new URL(g,b)}let p={get action(){return o},get location(){return e(n,l)},listen(w){if(c)throw new Error("A history only accepts one active listener");return n.addEventListener(l1,f),c=w,()=>{n.removeEventListener(l1,f),c=null}},createHref(w){return t(n,w)},createURL:m,encodeLocation(w){let b=m(w);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:h,replace:x,go(w){return l.go(w)}};return p}var c1;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(c1||(c1={}));function R5(e,t,r){return r===void 0&&(r="/"),P5(e,t,r)}function P5(e,t,r,s){let n=typeof t=="string"?Hl(t):t,i=Pb(n.pathname||"/",r);if(i==null)return null;let l=Fb(e);D5(l);let o=null;for(let c=0;o==null&&c<l.length;++c){let u=G5(i);o=z5(l[c],u)}return o}function Fb(e,t,r,s){t===void 0&&(t=[]),r===void 0&&(r=[]),s===void 0&&(s="");let n=(i,l,o)=>{let c={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};c.relativePath.startsWith("/")&&(Dt(c.relativePath.startsWith(s),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(s.length));let u=hi([s,c.relativePath]),d=r.concat(c);i.children&&i.children.length>0&&(Dt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),Fb(i.children,t,d,u)),!(i.path==null&&!i.index)&&t.push({path:u,score:$5(u,i.index),routesMeta:d})};return e.forEach((i,l)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))n(i,l);else for(let c of Rb(i.path))n(i,l,c)}),t}function Rb(e){let t=e.split("/");if(t.length===0)return[];let[r,...s]=t,n=r.endsWith("?"),i=r.replace(/\?$/,"");if(s.length===0)return n?[i,""]:[i];let l=Rb(s.join("/")),o=[];return o.push(...l.map(c=>c===""?i:[i,c].join("/"))),n&&o.push(...l),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function D5(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:V5(t.routesMeta.map(s=>s.childrenIndex),r.routesMeta.map(s=>s.childrenIndex)))}const I5=/^:[\w-]+$/,O5=3,M5=2,L5=1,B5=10,U5=-2,u1=e=>e==="*";function $5(e,t){let r=e.split("/"),s=r.length;return r.some(u1)&&(s+=U5),t&&(s+=M5),r.filter(n=>!u1(n)).reduce((n,i)=>n+(I5.test(i)?O5:i===""?L5:B5),s)}function V5(e,t){return e.length===t.length&&e.slice(0,-1).every((s,n)=>s===t[n])?e[e.length-1]-t[t.length-1]:0}function z5(e,t,r){let{routesMeta:s}=e,n={},i="/",l=[];for(let o=0;o<s.length;++o){let c=s[o],u=o===s.length-1,d=i==="/"?t:t.slice(i.length)||"/",f=H5({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),h=c.route;if(!f)return null;Object.assign(n,f.params),l.push({params:n,pathname:hi([i,f.pathname]),pathnameBase:J5(hi([i,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(i=hi([i,f.pathnameBase]))}return l}function H5(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,s]=W5(e.path,e.caseSensitive,e.end),n=t.match(r);if(!n)return null;let i=n[0],l=i.replace(/(.)\/+$/,"$1"),o=n.slice(1);return{params:s.reduce((u,d,f)=>{let{paramName:h,isOptional:x}=d;if(h==="*"){let p=o[f]||"";l=i.slice(0,i.length-p.length).replace(/(.)\/+$/,"$1")}const m=o[f];return x&&!m?u[h]=void 0:u[h]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:l,pattern:e}}function W5(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),Eb(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let s=[],n="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,c)=>(s.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(s.push({paramName:"*"}),n+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?n+="\\/*$":e!==""&&e!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,t?void 0:"i"),s]}function G5(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Eb(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Pb(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,s=e.charAt(r);return s&&s!=="/"?null:e.slice(r)||"/"}function q5(e,t){t===void 0&&(t="/");let{pathname:r,search:s="",hash:n=""}=typeof e=="string"?Hl(e):e;return{pathname:r?r.startsWith("/")?r:Y5(r,t):t,search:Z5(s),hash:eC(n)}}function Y5(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(n=>{n===".."?r.length>1&&r.pop():n!=="."&&r.push(n)}),r.length>1?r.join("/"):"/"}function Rf(e,t,r,s){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function K5(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function X5(e,t){let r=K5(e);return t?r.map((s,n)=>n===r.length-1?s.pathname:s.pathnameBase):r.map(s=>s.pathnameBase)}function Q5(e,t,r,s){s===void 0&&(s=!1);let n;typeof e=="string"?n=Hl(e):(n=uc({},e),Dt(!n.pathname||!n.pathname.includes("?"),Rf("?","pathname","search",n)),Dt(!n.pathname||!n.pathname.includes("#"),Rf("#","pathname","hash",n)),Dt(!n.search||!n.search.includes("#"),Rf("#","search","hash",n)));let i=e===""||n.pathname==="",l=i?"/":n.pathname,o;if(l==null)o=r;else{let f=t.length-1;if(!s&&l.startsWith("..")){let h=l.split("/");for(;h[0]==="..";)h.shift(),f-=1;n.pathname=h.join("/")}o=f>=0?t[f]:"/"}let c=q5(n,o),u=l&&l!=="/"&&l.endsWith("/"),d=(i||l===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const hi=e=>e.join("/").replace(/\/\/+/g,"/"),J5=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Z5=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,eC=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function tC(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Db=["post","put","patch","delete"];new Set(Db);const rC=["get",...Db];new Set(rC);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function dc(){return dc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},dc.apply(this,arguments)}const Op=C.createContext(null),sC=C.createContext(null),T0=C.createContext(null),E0=C.createContext(null),Ri=C.createContext({outlet:null,matches:[],isDataRoute:!1}),Ib=C.createContext(null);function A0(){return C.useContext(E0)!=null}function F0(){return A0()||Dt(!1),C.useContext(E0).location}function Ob(e){C.useContext(T0).static||C.useLayoutEffect(e)}function ze(){let{isDataRoute:e}=C.useContext(Ri);return e?xC():aC()}function aC(){A0()||Dt(!1);let e=C.useContext(Op),{basename:t,future:r,navigator:s}=C.useContext(T0),{matches:n}=C.useContext(Ri),{pathname:i}=F0(),l=JSON.stringify(X5(n,r.v7_relativeSplatPath)),o=C.useRef(!1);return Ob(()=>{o.current=!0}),C.useCallback(function(u,d){if(d===void 0&&(d={}),!o.current)return;if(typeof u=="number"){s.go(u);return}let f=Q5(u,JSON.parse(l),i,d.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:hi([t,f.pathname])),(d.replace?s.replace:s.push)(f,d.state,d)},[t,s,l,i,e])}function Hs(){let{matches:e}=C.useContext(Ri),t=e[e.length-1];return t?t.params:{}}function nC(e,t){return iC(e,t)}function iC(e,t,r,s){A0()||Dt(!1);let{navigator:n}=C.useContext(T0),{matches:i}=C.useContext(Ri),l=i[i.length-1],o=l?l.params:{};l&&l.pathname;let c=l?l.pathnameBase:"/";l&&l.route;let u=F0(),d;if(t){var f;let w=typeof t=="string"?Hl(t):t;c==="/"||(f=w.pathname)!=null&&f.startsWith(c)||Dt(!1),d=w}else d=u;let h=d.pathname||"/",x=h;if(c!=="/"){let w=c.replace(/^\//,"").split("/");x="/"+h.replace(/^\//,"").split("/").slice(w.length).join("/")}let m=R5(e,{pathname:x}),p=dC(m&&m.map(w=>Object.assign({},w,{params:Object.assign({},o,w.params),pathname:hi([c,n.encodeLocation?n.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?c:hi([c,n.encodeLocation?n.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),i,r,s);return t&&p?C.createElement(E0.Provider,{value:{location:dc({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:hn.Pop}},p):p}function lC(){let e=pC(),t=tC(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},t),r?C.createElement("pre",{style:n},r):null,null)}const oC=C.createElement(lC,null);class cC extends C.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?C.createElement(Ri.Provider,{value:this.props.routeContext},C.createElement(Ib.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function uC(e){let{routeContext:t,match:r,children:s}=e,n=C.useContext(Op);return n&&n.static&&n.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=r.route.id),C.createElement(Ri.Provider,{value:t},s)}function dC(e,t,r,s){var n;if(t===void 0&&(t=[]),r===void 0&&(r=null),s===void 0&&(s=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=s)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let l=e,o=(n=r)==null?void 0:n.errors;if(o!=null){let d=l.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);d>=0||Dt(!1),l=l.slice(0,Math.min(l.length,d+1))}let c=!1,u=-1;if(r&&s&&s.v7_partialHydration)for(let d=0;d<l.length;d++){let f=l[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:h,errors:x}=r,m=f.route.loader&&h[f.route.id]===void 0&&(!x||x[f.route.id]===void 0);if(f.route.lazy||m){c=!0,u>=0?l=l.slice(0,u+1):l=[l[0]];break}}}return l.reduceRight((d,f,h)=>{let x,m=!1,p=null,w=null;r&&(x=o&&f.route.id?o[f.route.id]:void 0,p=f.route.errorElement||oC,c&&(u<0&&h===0?(gC("route-fallback"),m=!0,w=null):u===h&&(m=!0,w=f.route.hydrateFallbackElement||null)));let b=t.concat(l.slice(0,h+1)),g=()=>{let y;return x?y=p:m?y=w:f.route.Component?y=C.createElement(f.route.Component,null):f.route.element?y=f.route.element:y=d,C.createElement(uC,{match:f,routeContext:{outlet:d,matches:b,isDataRoute:r!=null},children:y})};return r&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?C.createElement(cC,{location:r.location,revalidation:r.revalidation,component:p,error:x,children:g(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):g()},null)}var Mb=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Mb||{}),Lb=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Lb||{});function fC(e){let t=C.useContext(Op);return t||Dt(!1),t}function hC(e){let t=C.useContext(sC);return t||Dt(!1),t}function mC(e){let t=C.useContext(Ri);return t||Dt(!1),t}function Bb(e){let t=mC(),r=t.matches[t.matches.length-1];return r.route.id||Dt(!1),r.route.id}function pC(){var e;let t=C.useContext(Ib),r=hC(),s=Bb();return t!==void 0?t:(e=r.errors)==null?void 0:e[s]}function xC(){let{router:e}=fC(Mb.UseNavigateStable),t=Bb(Lb.UseNavigateStable),r=C.useRef(!1);return Ob(()=>{r.current=!0}),C.useCallback(function(n,i){i===void 0&&(i={}),r.current&&(typeof n=="number"?e.navigate(n):e.navigate(n,dc({fromRouteId:t},i)))},[e,t])}const d1={};function gC(e,t,r){d1[e]||(d1[e]=!0)}function yC(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function De(e){Dt(!1)}function vC(e){let{basename:t="/",children:r=null,location:s,navigationType:n=hn.Pop,navigator:i,static:l=!1,future:o}=e;A0()&&Dt(!1);let c=t.replace(/^\/*/,"/"),u=C.useMemo(()=>({basename:c,navigator:i,static:l,future:dc({v7_relativeSplatPath:!1},o)}),[c,o,i,l]);typeof s=="string"&&(s=Hl(s));let{pathname:d="/",search:f="",hash:h="",state:x=null,key:m="default"}=s,p=C.useMemo(()=>{let w=Pb(d,c);return w==null?null:{location:{pathname:w,search:f,hash:h,state:x,key:m},navigationType:n}},[c,d,f,h,x,m,n]);return p==null?null:C.createElement(T0.Provider,{value:u},C.createElement(E0.Provider,{children:r,value:p}))}function wC(e){let{children:t,location:r}=e;return nC(lm(t),r)}new Promise(()=>{});function lm(e,t){t===void 0&&(t=[]);let r=[];return C.Children.forEach(e,(s,n)=>{if(!C.isValidElement(s))return;let i=[...t,n];if(s.type===C.Fragment){r.push.apply(r,lm(s.props.children,i));return}s.type!==De&&Dt(!1),!s.props.index||!s.props.children||Dt(!1);let l={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(l.children=lm(s.props.children,i)),r.push(l)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function om(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let s=e[r];return t.concat(Array.isArray(s)?s.map(n=>[r,n]):[[r,s]])},[]))}function bC(e,t){let r=om(e);return t&&t.forEach((s,n)=>{r.has(n)||t.getAll(n).forEach(i=>{r.append(n,i)})}),r}const jC="6";try{window.__reactRouterVersion=jC}catch{}const NC="startTransition",f1=z4[NC];function _C(e){let{basename:t,children:r,future:s,window:n}=e,i=C.useRef();i.current==null&&(i.current=E5({window:n,v5Compat:!0}));let l=i.current,[o,c]=C.useState({action:l.action,location:l.location}),{v7_startTransition:u}=s||{},d=C.useCallback(f=>{u&&f1?f1(()=>c(f)):c(f)},[c,u]);return C.useLayoutEffect(()=>l.listen(d),[l,d]),C.useEffect(()=>yC(s),[s]),C.createElement(vC,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:l,future:s})}var h1;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(h1||(h1={}));var m1;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(m1||(m1={}));function Mp(e){let t=C.useRef(om(e)),r=C.useRef(!1),s=F0(),n=C.useMemo(()=>bC(s.search,r.current?null:t.current),[s.search]),i=ze(),l=C.useCallback((o,c)=>{const u=om(typeof o=="function"?o(n):o);r.current=!0,i("?"+u,c)},[i,n]);return[n,l]}let kC={data:""},SC=e=>{if(typeof window=="object"){let t=(e?e.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return t.nonce=window.__nonce__,t.parentNode||(e||document.head).appendChild(t),t.firstChild}return e||kC},CC=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,TC=/\/\*[^]*?\*\/|  +/g,p1=/\n+/g,en=(e,t)=>{let r="",s="",n="";for(let i in e){let l=e[i];i[0]=="@"?i[1]=="i"?r=i+" "+l+";":s+=i[1]=="f"?en(l,i):i+"{"+en(l,i[1]=="k"?"":t)+"}":typeof l=="object"?s+=en(l,t?t.replace(/([^,])+/g,o=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,o):o?o+" "+c:c)):i):l!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=en.p?en.p(i,l):i+":"+l+";")}return r+(t&&n?t+"{"+n+"}":n)+s},ya={},Ub=e=>{if(typeof e=="object"){let t="";for(let r in e)t+=r+Ub(e[r]);return t}return e},EC=(e,t,r,s,n)=>{let i=Ub(e),l=ya[i]||(ya[i]=(c=>{let u=0,d=11;for(;u<c.length;)d=101*d+c.charCodeAt(u++)>>>0;return"go"+d})(i));if(!ya[l]){let c=i!==e?e:(u=>{let d,f,h=[{}];for(;d=CC.exec(u.replace(TC,""));)d[4]?h.shift():d[3]?(f=d[3].replace(p1," ").trim(),h.unshift(h[0][f]=h[0][f]||{})):h[0][d[1]]=d[2].replace(p1," ").trim();return h[0]})(e);ya[l]=en(n?{["@keyframes "+l]:c}:c,r?"":"."+l)}let o=r&&ya.g?ya.g:null;return r&&(ya.g=ya[l]),((c,u,d,f)=>{f?u.data=u.data.replace(f,c):u.data.indexOf(c)===-1&&(u.data=d?c+u.data:u.data+c)})(ya[l],t,s,o),l},AC=(e,t,r)=>e.reduce((s,n,i)=>{let l=t[i];if(l&&l.call){let o=l(r),c=o&&o.props&&o.props.className||/^go/.test(o)&&o;l=c?"."+c:o&&typeof o=="object"?o.props?"":en(o,""):o===!1?"":o}return s+n+(l??"")},"");function R0(e){let t=this||{},r=e.call?e(t.p):e;return EC(r.unshift?r.raw?AC(r,[].slice.call(arguments,1),t.p):r.reduce((s,n)=>Object.assign(s,n&&n.call?n(t.p):n),{}):r,SC(t.target),t.g,t.o,t.k)}let $b,cm,um;R0.bind({g:1});let Ma=R0.bind({k:1});function FC(e,t,r,s){en.p=t,$b=e,cm=r,um=s}function In(e,t){let r=this||{};return function(){let s=arguments;function n(i,l){let o=Object.assign({},i),c=o.className||n.className;r.p=Object.assign({theme:cm&&cm()},o),r.o=/ *go\d+/.test(c),o.className=R0.apply(r,s)+(c?" "+c:"");let u=e;return e[0]&&(u=o.as||e,delete o.as),um&&u[0]&&um(o),$b(u,o)}return n}}var RC=e=>typeof e=="function",Bd=(e,t)=>RC(e)?e(t):e,PC=(()=>{let e=0;return()=>(++e).toString()})(),Vb=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),DC=20,Lp="default",zb=(e,t)=>{let{toastLimit:r}=e.settings;switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,r)};case 1:return{...e,toasts:e.toasts.map(l=>l.id===t.toast.id?{...l,...t.toast}:l)};case 2:let{toast:s}=t;return zb(e,{type:e.toasts.find(l=>l.id===s.id)?1:0,toast:s});case 3:let{toastId:n}=t;return{...e,toasts:e.toasts.map(l=>l.id===n||n===void 0?{...l,dismissed:!0,visible:!1}:l)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(l=>l.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let i=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(l=>({...l,pauseDuration:l.pauseDuration+i}))}}},ld=[],Hb={toasts:[],pausedAt:void 0,settings:{toastLimit:DC}},aa={},Wb=(e,t=Lp)=>{aa[t]=zb(aa[t]||Hb,e),ld.forEach(([r,s])=>{r===t&&s(aa[t])})},Gb=e=>Object.keys(aa).forEach(t=>Wb(e,t)),IC=e=>Object.keys(aa).find(t=>aa[t].toasts.some(r=>r.id===e)),P0=(e=Lp)=>t=>{Wb(t,e)},OC={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},MC=(e={},t=Lp)=>{let[r,s]=C.useState(aa[t]||Hb),n=C.useRef(aa[t]);C.useEffect(()=>(n.current!==aa[t]&&s(aa[t]),ld.push([t,s]),()=>{let l=ld.findIndex(([o])=>o===t);l>-1&&ld.splice(l,1)}),[t]);let i=r.toasts.map(l=>{var o,c,u;return{...e,...e[l.type],...l,removeDelay:l.removeDelay||((o=e[l.type])==null?void 0:o.removeDelay)||(e==null?void 0:e.removeDelay),duration:l.duration||((c=e[l.type])==null?void 0:c.duration)||(e==null?void 0:e.duration)||OC[l.type],style:{...e.style,...(u=e[l.type])==null?void 0:u.style,...l.style}}});return{...r,toasts:i}},LC=(e,t="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...r,id:(r==null?void 0:r.id)||PC()}),Mc=e=>(t,r)=>{let s=LC(t,e,r);return P0(s.toasterId||IC(s.id))({type:2,toast:s}),s.id},Ye=(e,t)=>Mc("blank")(e,t);Ye.error=Mc("error");Ye.success=Mc("success");Ye.loading=Mc("loading");Ye.custom=Mc("custom");Ye.dismiss=(e,t)=>{let r={type:3,toastId:e};t?P0(t)(r):Gb(r)};Ye.dismissAll=e=>Ye.dismiss(void 0,e);Ye.remove=(e,t)=>{let r={type:4,toastId:e};t?P0(t)(r):Gb(r)};Ye.removeAll=e=>Ye.remove(void 0,e);Ye.promise=(e,t,r)=>{let s=Ye.loading(t.loading,{...r,...r==null?void 0:r.loading});return typeof e=="function"&&(e=e()),e.then(n=>{let i=t.success?Bd(t.success,n):void 0;return i?Ye.success(i,{id:s,...r,...r==null?void 0:r.success}):Ye.dismiss(s),n}).catch(n=>{let i=t.error?Bd(t.error,n):void 0;i?Ye.error(i,{id:s,...r,...r==null?void 0:r.error}):Ye.dismiss(s)}),e};var BC=1e3,UC=(e,t="default")=>{let{toasts:r,pausedAt:s}=MC(e,t),n=C.useRef(new Map).current,i=C.useCallback((f,h=BC)=>{if(n.has(f))return;let x=setTimeout(()=>{n.delete(f),l({type:4,toastId:f})},h);n.set(f,x)},[]);C.useEffect(()=>{if(s)return;let f=Date.now(),h=r.map(x=>{if(x.duration===1/0)return;let m=(x.duration||0)+x.pauseDuration-(f-x.createdAt);if(m<0){x.visible&&Ye.dismiss(x.id);return}return setTimeout(()=>Ye.dismiss(x.id,t),m)});return()=>{h.forEach(x=>x&&clearTimeout(x))}},[r,s,t]);let l=C.useCallback(P0(t),[t]),o=C.useCallback(()=>{l({type:5,time:Date.now()})},[l]),c=C.useCallback((f,h)=>{l({type:1,toast:{id:f,height:h}})},[l]),u=C.useCallback(()=>{s&&l({type:6,time:Date.now()})},[s,l]),d=C.useCallback((f,h)=>{let{reverseOrder:x=!1,gutter:m=8,defaultPosition:p}=h||{},w=r.filter(y=>(y.position||p)===(f.position||p)&&y.height),b=w.findIndex(y=>y.id===f.id),g=w.filter((y,j)=>j<b&&y.visible).length;return w.filter(y=>y.visible).slice(...x?[g+1]:[0,g]).reduce((y,j)=>y+(j.height||0)+m,0)},[r]);return C.useEffect(()=>{r.forEach(f=>{if(f.dismissed)i(f.id,f.removeDelay);else{let h=n.get(f.id);h&&(clearTimeout(h),n.delete(f.id))}})},[r,i]),{toasts:r,handlers:{updateHeight:c,startPause:o,endPause:u,calculateOffset:d}}},$C=Ma`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,VC=Ma`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,zC=Ma`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,HC=In("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${$C} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${VC} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${zC} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,WC=Ma`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,GC=In("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${WC} 1s linear infinite;
`,qC=Ma`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,YC=Ma`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,KC=In("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${qC} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${YC} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,XC=In("div")`
  position: absolute;
`,QC=In("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,JC=Ma`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,ZC=In("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${JC} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,e3=({toast:e})=>{let{icon:t,type:r,iconTheme:s}=e;return t!==void 0?typeof t=="string"?C.createElement(ZC,null,t):t:r==="blank"?null:C.createElement(QC,null,C.createElement(GC,{...s}),r!=="loading"&&C.createElement(XC,null,r==="error"?C.createElement(HC,{...s}):C.createElement(KC,{...s})))},t3=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,r3=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,s3="0%{opacity:0;} 100%{opacity:1;}",a3="0%{opacity:1;} 100%{opacity:0;}",n3=In("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,i3=In("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,l3=(e,t)=>{let r=e.includes("top")?1:-1,[s,n]=Vb()?[s3,a3]:[t3(r),r3(r)];return{animation:t?`${Ma(s)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Ma(n)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},o3=C.memo(({toast:e,position:t,style:r,children:s})=>{let n=e.height?l3(e.position||t||"top-center",e.visible):{opacity:0},i=C.createElement(e3,{toast:e}),l=C.createElement(i3,{...e.ariaProps},Bd(e.message,e));return C.createElement(n3,{className:e.className,style:{...n,...r,...e.style}},typeof s=="function"?s({icon:i,message:l}):C.createElement(C.Fragment,null,i,l))});FC(C.createElement);var c3=({id:e,className:t,style:r,onHeightUpdate:s,children:n})=>{let i=C.useCallback(l=>{if(l){let o=()=>{let c=l.getBoundingClientRect().height;s(e,c)};o(),new MutationObserver(o).observe(l,{subtree:!0,childList:!0,characterData:!0})}},[e,s]);return C.createElement("div",{ref:i,className:t,style:r},n)},u3=(e,t)=>{let r=e.includes("top"),s=r?{top:0}:{bottom:0},n=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Vb()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(r?1:-1)}px)`,...s,...n}},d3=R0`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Fu=16,f3=({reverseOrder:e,position:t="top-center",toastOptions:r,gutter:s,children:n,toasterId:i,containerStyle:l,containerClassName:o})=>{let{toasts:c,handlers:u}=UC(r,i);return C.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:Fu,left:Fu,right:Fu,bottom:Fu,pointerEvents:"none",...l},className:o,onMouseEnter:u.startPause,onMouseLeave:u.endPause},c.map(d=>{let f=d.position||t,h=u.calculateOffset(d,{reverseOrder:e,gutter:s,defaultPosition:t}),x=u3(f,h);return C.createElement(c3,{id:d.id,key:d.id,onHeightUpdate:u.updateHeight,className:d.visible?d3:"",style:x},d.type==="custom"?Bd(d.message,d):n?n(d):C.createElement(o3,{toast:d,position:f}))}))},de=Ye;const qb=C.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),D0=C.createContext({}),I0=C.createContext(null),O0=typeof document<"u",Bp=O0?C.useLayoutEffect:C.useEffect,Yb=C.createContext({strict:!1}),Up=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),h3="framerAppearId",Kb="data-"+Up(h3);function m3(e,t,r,s){const{visualElement:n}=C.useContext(D0),i=C.useContext(Yb),l=C.useContext(I0),o=C.useContext(qb).reducedMotion,c=C.useRef();s=s||i.renderer,!c.current&&s&&(c.current=s(e,{visualState:t,parent:n,props:r,presenceContext:l,blockInitialAnimation:l?l.initial===!1:!1,reducedMotionConfig:o}));const u=c.current;C.useInsertionEffect(()=>{u&&u.update(r,l)});const d=C.useRef(!!(r[Kb]&&!window.HandoffComplete));return Bp(()=>{u&&(u.render(),d.current&&u.animationState&&u.animationState.animateChanges())}),C.useEffect(()=>{u&&(u.updateFeatures(),!d.current&&u.animationState&&u.animationState.animateChanges(),d.current&&(d.current=!1,window.HandoffComplete=!0))}),u}function il(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function p3(e,t,r){return C.useCallback(s=>{s&&e.mount&&e.mount(s),t&&(s?t.mount(s):t.unmount()),r&&(typeof r=="function"?r(s):il(r)&&(r.current=s))},[t])}function fc(e){return typeof e=="string"||Array.isArray(e)}function M0(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const $p=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Vp=["initial",...$p];function L0(e){return M0(e.animate)||Vp.some(t=>fc(e[t]))}function Xb(e){return!!(L0(e)||e.variants)}function x3(e,t){if(L0(e)){const{initial:r,animate:s}=e;return{initial:r===!1||fc(r)?r:void 0,animate:fc(s)?s:void 0}}return e.inherit!==!1?t:{}}function g3(e){const{initial:t,animate:r}=x3(e,C.useContext(D0));return C.useMemo(()=>({initial:t,animate:r}),[x1(t),x1(r)])}function x1(e){return Array.isArray(e)?e.join(" "):e}const g1={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},hc={};for(const e in g1)hc[e]={isEnabled:t=>g1[e].some(r=>!!t[r])};function y3(e){for(const t in e)hc[t]={...hc[t],...e[t]}}const zp=C.createContext({}),Qb=C.createContext({}),v3=Symbol.for("motionComponentSymbol");function w3({preloadedFeatures:e,createVisualElement:t,useRender:r,useVisualState:s,Component:n}){e&&y3(e);function i(o,c){let u;const d={...C.useContext(qb),...o,layoutId:b3(o)},{isStatic:f}=d,h=g3(o),x=s(o,f);if(!f&&O0){h.visualElement=m3(n,x,d,t);const m=C.useContext(Qb),p=C.useContext(Yb).strict;h.visualElement&&(u=h.visualElement.loadFeatures(d,p,e,m))}return C.createElement(D0.Provider,{value:h},u&&h.visualElement?C.createElement(u,{visualElement:h.visualElement,...d}):null,r(n,o,p3(x,h.visualElement,c),x,f,h.visualElement))}const l=C.forwardRef(i);return l[v3]=n,l}function b3({layoutId:e}){const t=C.useContext(zp).id;return t&&e!==void 0?t+"-"+e:e}function j3(e){function t(s,n={}){return w3(e(s,n))}if(typeof Proxy>"u")return t;const r=new Map;return new Proxy(t,{get:(s,n)=>(r.has(n)||r.set(n,t(n)),r.get(n))})}const N3=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Hp(e){return typeof e!="string"||e.includes("-")?!1:!!(N3.indexOf(e)>-1||/[A-Z]/.test(e))}const Ud={};function _3(e){Object.assign(Ud,e)}const Lc=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Pi=new Set(Lc);function Jb(e,{layout:t,layoutId:r}){return Pi.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!Ud[e]||e==="opacity")}const Br=e=>!!(e&&e.getVelocity),k3={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},S3=Lc.length;function C3(e,{enableHardwareAcceleration:t=!0,allowTransformNone:r=!0},s,n){let i="";for(let l=0;l<S3;l++){const o=Lc[l];if(e[o]!==void 0){const c=k3[o]||o;i+=`${c}(${e[o]}) `}}return t&&!e.z&&(i+="translateZ(0)"),i=i.trim(),n?i=n(e,s?"":i):r&&s&&(i="none"),i}const Zb=e=>t=>typeof t=="string"&&t.startsWith(e),ej=Zb("--"),dm=Zb("var(--"),T3=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,E3=(e,t)=>t&&typeof e=="number"?t.transform(e):e,Tn=(e,t,r)=>Math.min(Math.max(r,e),t),Di={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Ro={...Di,transform:e=>Tn(0,1,e)},Ru={...Di,default:1},Po=e=>Math.round(e*1e5)/1e5,B0=/(-)?([\d]*\.?[\d])+/g,tj=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,A3=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function Bc(e){return typeof e=="string"}const Uc=e=>({test:t=>Bc(t)&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),qa=Uc("deg"),la=Uc("%"),je=Uc("px"),F3=Uc("vh"),R3=Uc("vw"),y1={...la,parse:e=>la.parse(e)/100,transform:e=>la.transform(e*100)},v1={...Di,transform:Math.round},rj={borderWidth:je,borderTopWidth:je,borderRightWidth:je,borderBottomWidth:je,borderLeftWidth:je,borderRadius:je,radius:je,borderTopLeftRadius:je,borderTopRightRadius:je,borderBottomRightRadius:je,borderBottomLeftRadius:je,width:je,maxWidth:je,height:je,maxHeight:je,size:je,top:je,right:je,bottom:je,left:je,padding:je,paddingTop:je,paddingRight:je,paddingBottom:je,paddingLeft:je,margin:je,marginTop:je,marginRight:je,marginBottom:je,marginLeft:je,rotate:qa,rotateX:qa,rotateY:qa,rotateZ:qa,scale:Ru,scaleX:Ru,scaleY:Ru,scaleZ:Ru,skew:qa,skewX:qa,skewY:qa,distance:je,translateX:je,translateY:je,translateZ:je,x:je,y:je,z:je,perspective:je,transformPerspective:je,opacity:Ro,originX:y1,originY:y1,originZ:je,zIndex:v1,fillOpacity:Ro,strokeOpacity:Ro,numOctaves:v1};function Wp(e,t,r,s){const{style:n,vars:i,transform:l,transformOrigin:o}=e;let c=!1,u=!1,d=!0;for(const f in t){const h=t[f];if(ej(f)){i[f]=h;continue}const x=rj[f],m=E3(h,x);if(Pi.has(f)){if(c=!0,l[f]=m,!d)continue;h!==(x.default||0)&&(d=!1)}else f.startsWith("origin")?(u=!0,o[f]=m):n[f]=m}if(t.transform||(c||s?n.transform=C3(e.transform,r,d,s):n.transform&&(n.transform="none")),u){const{originX:f="50%",originY:h="50%",originZ:x=0}=o;n.transformOrigin=`${f} ${h} ${x}`}}const Gp=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function sj(e,t,r){for(const s in t)!Br(t[s])&&!Jb(s,r)&&(e[s]=t[s])}function P3({transformTemplate:e},t,r){return C.useMemo(()=>{const s=Gp();return Wp(s,t,{enableHardwareAcceleration:!r},e),Object.assign({},s.vars,s.style)},[t])}function D3(e,t,r){const s=e.style||{},n={};return sj(n,s,e),Object.assign(n,P3(e,t,r)),e.transformValues?e.transformValues(n):n}function I3(e,t,r){const s={},n=D3(e,t,r);return e.drag&&e.dragListener!==!1&&(s.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(s.tabIndex=0),s.style=n,s}const O3=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function $d(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||O3.has(e)}let aj=e=>!$d(e);function M3(e){e&&(aj=t=>t.startsWith("on")?!$d(t):e(t))}try{M3(require("@emotion/is-prop-valid").default)}catch{}function L3(e,t,r){const s={};for(const n in e)n==="values"&&typeof e.values=="object"||(aj(n)||r===!0&&$d(n)||!t&&!$d(n)||e.draggable&&n.startsWith("onDrag"))&&(s[n]=e[n]);return s}function w1(e,t,r){return typeof e=="string"?e:je.transform(t+r*e)}function B3(e,t,r){const s=w1(t,e.x,e.width),n=w1(r,e.y,e.height);return`${s} ${n}`}const U3={offset:"stroke-dashoffset",array:"stroke-dasharray"},$3={offset:"strokeDashoffset",array:"strokeDasharray"};function V3(e,t,r=1,s=0,n=!0){e.pathLength=1;const i=n?U3:$3;e[i.offset]=je.transform(-s);const l=je.transform(t),o=je.transform(r);e[i.array]=`${l} ${o}`}function qp(e,{attrX:t,attrY:r,attrScale:s,originX:n,originY:i,pathLength:l,pathSpacing:o=1,pathOffset:c=0,...u},d,f,h){if(Wp(e,u,d,h),f){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:x,style:m,dimensions:p}=e;x.transform&&(p&&(m.transform=x.transform),delete x.transform),p&&(n!==void 0||i!==void 0||m.transform)&&(m.transformOrigin=B3(p,n!==void 0?n:.5,i!==void 0?i:.5)),t!==void 0&&(x.x=t),r!==void 0&&(x.y=r),s!==void 0&&(x.scale=s),l!==void 0&&V3(x,l,o,c,!1)}const nj=()=>({...Gp(),attrs:{}}),Yp=e=>typeof e=="string"&&e.toLowerCase()==="svg";function z3(e,t,r,s){const n=C.useMemo(()=>{const i=nj();return qp(i,t,{enableHardwareAcceleration:!1},Yp(s),e.transformTemplate),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};sj(i,e.style,e),n.style={...i,...n.style}}return n}function H3(e=!1){return(r,s,n,{latestValues:i},l)=>{const c=(Hp(r)?z3:I3)(s,i,l,r),d={...L3(s,typeof r=="string",e),...c,ref:n},{children:f}=s,h=C.useMemo(()=>Br(f)?f.get():f,[f]);return C.createElement(r,{...d,children:h})}}function ij(e,{style:t,vars:r},s,n){Object.assign(e.style,t,n&&n.getProjectionStyles(s));for(const i in r)e.style.setProperty(i,r[i])}const lj=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function oj(e,t,r,s){ij(e,t,void 0,s);for(const n in t.attrs)e.setAttribute(lj.has(n)?n:Up(n),t.attrs[n])}function Kp(e,t){const{style:r}=e,s={};for(const n in r)(Br(r[n])||t.style&&Br(t.style[n])||Jb(n,e))&&(s[n]=r[n]);return s}function cj(e,t){const r=Kp(e,t);for(const s in e)if(Br(e[s])||Br(t[s])){const n=Lc.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;r[n]=e[s]}return r}function Xp(e,t,r,s={},n={}){return typeof t=="function"&&(t=t(r!==void 0?r:e.custom,s,n)),typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"&&(t=t(r!==void 0?r:e.custom,s,n)),t}function uj(e){const t=C.useRef(null);return t.current===null&&(t.current=e()),t.current}const Vd=e=>Array.isArray(e),W3=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),G3=e=>Vd(e)?e[e.length-1]||0:e;function od(e){const t=Br(e)?e.get():e;return W3(t)?t.toValue():t}function q3({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:r},s,n,i){const l={latestValues:Y3(s,n,i,e),renderState:t()};return r&&(l.mount=o=>r(s,o,l)),l}const dj=e=>(t,r)=>{const s=C.useContext(D0),n=C.useContext(I0),i=()=>q3(e,t,s,n);return r?i():uj(i)};function Y3(e,t,r,s){const n={},i=s(e,{});for(const h in i)n[h]=od(i[h]);let{initial:l,animate:o}=e;const c=L0(e),u=Xb(e);t&&u&&!c&&e.inherit!==!1&&(l===void 0&&(l=t.initial),o===void 0&&(o=t.animate));let d=r?r.initial===!1:!1;d=d||l===!1;const f=d?o:l;return f&&typeof f!="boolean"&&!M0(f)&&(Array.isArray(f)?f:[f]).forEach(x=>{const m=Xp(e,x);if(!m)return;const{transitionEnd:p,transition:w,...b}=m;for(const g in b){let y=b[g];if(Array.isArray(y)){const j=d?y.length-1:0;y=y[j]}y!==null&&(n[g]=y)}for(const g in p)n[g]=p[g]}),n}const jt=e=>e;class b1{constructor(){this.order=[],this.scheduled=new Set}add(t){if(!this.scheduled.has(t))return this.scheduled.add(t),this.order.push(t),!0}remove(t){const r=this.order.indexOf(t);r!==-1&&(this.order.splice(r,1),this.scheduled.delete(t))}clear(){this.order.length=0,this.scheduled.clear()}}function K3(e){let t=new b1,r=new b1,s=0,n=!1,i=!1;const l=new WeakSet,o={schedule:(c,u=!1,d=!1)=>{const f=d&&n,h=f?t:r;return u&&l.add(c),h.add(c)&&f&&n&&(s=t.order.length),c},cancel:c=>{r.remove(c),l.delete(c)},process:c=>{if(n){i=!0;return}if(n=!0,[t,r]=[r,t],r.clear(),s=t.order.length,s)for(let u=0;u<s;u++){const d=t.order[u];d(c),l.has(d)&&(o.schedule(d),e())}n=!1,i&&(i=!1,o.process(c))}};return o}const Pu=["prepare","read","update","preRender","render","postRender"],X3=40;function Q3(e,t){let r=!1,s=!0;const n={delta:0,timestamp:0,isProcessing:!1},i=Pu.reduce((f,h)=>(f[h]=K3(()=>r=!0),f),{}),l=f=>i[f].process(n),o=()=>{const f=performance.now();r=!1,n.delta=s?1e3/60:Math.max(Math.min(f-n.timestamp,X3),1),n.timestamp=f,n.isProcessing=!0,Pu.forEach(l),n.isProcessing=!1,r&&t&&(s=!1,e(o))},c=()=>{r=!0,s=!0,n.isProcessing||e(o)};return{schedule:Pu.reduce((f,h)=>{const x=i[h];return f[h]=(m,p=!1,w=!1)=>(r||c(),x.schedule(m,p,w)),f},{}),cancel:f=>Pu.forEach(h=>i[h].cancel(f)),state:n,steps:i}}const{schedule:Je,cancel:La,state:sr,steps:Pf}=Q3(typeof requestAnimationFrame<"u"?requestAnimationFrame:jt,!0),J3={useVisualState:dj({scrapeMotionValuesFromProps:cj,createRenderState:nj,onMount:(e,t,{renderState:r,latestValues:s})=>{Je.read(()=>{try{r.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{r.dimensions={x:0,y:0,width:0,height:0}}}),Je.render(()=>{qp(r,s,{enableHardwareAcceleration:!1},Yp(t.tagName),e.transformTemplate),oj(t,r)})}})},Z3={useVisualState:dj({scrapeMotionValuesFromProps:Kp,createRenderState:Gp})};function eT(e,{forwardMotionProps:t=!1},r,s){return{...Hp(e)?J3:Z3,preloadedFeatures:r,useRender:H3(t),createVisualElement:s,Component:e}}function ka(e,t,r,s={passive:!0}){return e.addEventListener(t,r,s),()=>e.removeEventListener(t,r)}const fj=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function U0(e,t="page"){return{point:{x:e[t+"X"],y:e[t+"Y"]}}}const tT=e=>t=>fj(t)&&e(t,U0(t));function Ta(e,t,r,s){return ka(e,t,tT(r),s)}const rT=(e,t)=>r=>t(e(r)),_n=(...e)=>e.reduce(rT);function hj(e){let t=null;return()=>{const r=()=>{t=null};return t===null?(t=e,r):!1}}const j1=hj("dragHorizontal"),N1=hj("dragVertical");function mj(e){let t=!1;if(e==="y")t=N1();else if(e==="x")t=j1();else{const r=j1(),s=N1();r&&s?t=()=>{r(),s()}:(r&&r(),s&&s())}return t}function pj(){const e=mj(!0);return e?(e(),!1):!0}class On{constructor(t){this.isMounted=!1,this.node=t}update(){}}function _1(e,t){const r="pointer"+(t?"enter":"leave"),s="onHover"+(t?"Start":"End"),n=(i,l)=>{if(i.pointerType==="touch"||pj())return;const o=e.getProps();e.animationState&&o.whileHover&&e.animationState.setActive("whileHover",t),o[s]&&Je.update(()=>o[s](i,l))};return Ta(e.current,r,n,{passive:!e.getProps()[s]})}class sT extends On{mount(){this.unmount=_n(_1(this.node,!0),_1(this.node,!1))}unmount(){}}class aT extends On{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=_n(ka(this.node.current,"focus",()=>this.onFocus()),ka(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const xj=(e,t)=>t?e===t?!0:xj(e,t.parentElement):!1;function Df(e,t){if(!t)return;const r=new PointerEvent("pointer"+e);t(r,U0(r))}class nT extends On{constructor(){super(...arguments),this.removeStartListeners=jt,this.removeEndListeners=jt,this.removeAccessibleListeners=jt,this.startPointerPress=(t,r)=>{if(this.isPressing)return;this.removeEndListeners();const s=this.node.getProps(),i=Ta(window,"pointerup",(o,c)=>{if(!this.checkPressEnd())return;const{onTap:u,onTapCancel:d,globalTapTarget:f}=this.node.getProps();Je.update(()=>{!f&&!xj(this.node.current,o.target)?d&&d(o,c):u&&u(o,c)})},{passive:!(s.onTap||s.onPointerUp)}),l=Ta(window,"pointercancel",(o,c)=>this.cancelPress(o,c),{passive:!(s.onTapCancel||s.onPointerCancel)});this.removeEndListeners=_n(i,l),this.startPress(t,r)},this.startAccessiblePress=()=>{const t=i=>{if(i.key!=="Enter"||this.isPressing)return;const l=o=>{o.key!=="Enter"||!this.checkPressEnd()||Df("up",(c,u)=>{const{onTap:d}=this.node.getProps();d&&Je.update(()=>d(c,u))})};this.removeEndListeners(),this.removeEndListeners=ka(this.node.current,"keyup",l),Df("down",(o,c)=>{this.startPress(o,c)})},r=ka(this.node.current,"keydown",t),s=()=>{this.isPressing&&Df("cancel",(i,l)=>this.cancelPress(i,l))},n=ka(this.node.current,"blur",s);this.removeAccessibleListeners=_n(r,n)}}startPress(t,r){this.isPressing=!0;const{onTapStart:s,whileTap:n}=this.node.getProps();n&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),s&&Je.update(()=>s(t,r))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!pj()}cancelPress(t,r){if(!this.checkPressEnd())return;const{onTapCancel:s}=this.node.getProps();s&&Je.update(()=>s(t,r))}mount(){const t=this.node.getProps(),r=Ta(t.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),s=ka(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=_n(r,s)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const fm=new WeakMap,If=new WeakMap,iT=e=>{const t=fm.get(e.target);t&&t(e)},lT=e=>{e.forEach(iT)};function oT({root:e,...t}){const r=e||document;If.has(r)||If.set(r,{});const s=If.get(r),n=JSON.stringify(t);return s[n]||(s[n]=new IntersectionObserver(lT,{root:e,...t})),s[n]}function cT(e,t,r){const s=oT(t);return fm.set(e,r),s.observe(e),()=>{fm.delete(e),s.unobserve(e)}}const uT={some:0,all:1};class dT extends On{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:s,amount:n="some",once:i}=t,l={root:r?r.current:void 0,rootMargin:s,threshold:typeof n=="number"?n:uT[n]},o=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,i&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:f}=this.node.getProps(),h=u?d:f;h&&h(c)};return cT(this.node.current,l,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(fT(t,r))&&this.startObserver()}unmount(){}}function fT({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const hT={inView:{Feature:dT},tap:{Feature:nT},focus:{Feature:aT},hover:{Feature:sT}};function gj(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let s=0;s<r;s++)if(t[s]!==e[s])return!1;return!0}function mT(e){const t={};return e.values.forEach((r,s)=>t[s]=r.get()),t}function pT(e){const t={};return e.values.forEach((r,s)=>t[s]=r.getVelocity()),t}function $0(e,t,r){const s=e.getProps();return Xp(s,t,r!==void 0?r:s.custom,mT(e),pT(e))}let Qp=jt;const mi=e=>e*1e3,Ea=e=>e/1e3,xT={current:!1},yj=e=>Array.isArray(e)&&typeof e[0]=="number";function vj(e){return!!(!e||typeof e=="string"&&wj[e]||yj(e)||Array.isArray(e)&&e.every(vj))}const yo=([e,t,r,s])=>`cubic-bezier(${e}, ${t}, ${r}, ${s})`,wj={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:yo([0,.65,.55,1]),circOut:yo([.55,0,1,.45]),backIn:yo([.31,.01,.66,-.59]),backOut:yo([.33,1.53,.69,.99])};function bj(e){if(e)return yj(e)?yo(e):Array.isArray(e)?e.map(bj):wj[e]}function gT(e,t,r,{delay:s=0,duration:n,repeat:i=0,repeatType:l="loop",ease:o,times:c}={}){const u={[t]:r};c&&(u.offset=c);const d=bj(o);return Array.isArray(d)&&(u.easing=d),e.animate(u,{delay:s,duration:n,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:i+1,direction:l==="reverse"?"alternate":"normal"})}function yT(e,{repeat:t,repeatType:r="loop"}){const s=t&&r!=="loop"&&t%2===1?0:e.length-1;return e[s]}const jj=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,vT=1e-7,wT=12;function bT(e,t,r,s,n){let i,l,o=0;do l=t+(r-t)/2,i=jj(l,s,n)-e,i>0?r=l:t=l;while(Math.abs(i)>vT&&++o<wT);return l}function $c(e,t,r,s){if(e===t&&r===s)return jt;const n=i=>bT(i,0,1,e,r);return i=>i===0||i===1?i:jj(n(i),t,s)}const jT=$c(.42,0,1,1),NT=$c(0,0,.58,1),Nj=$c(.42,0,.58,1),_T=e=>Array.isArray(e)&&typeof e[0]!="number",_j=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,kj=e=>t=>1-e(1-t),Jp=e=>1-Math.sin(Math.acos(e)),Sj=kj(Jp),kT=_j(Jp),Cj=$c(.33,1.53,.69,.99),Zp=kj(Cj),ST=_j(Zp),CT=e=>(e*=2)<1?.5*Zp(e):.5*(2-Math.pow(2,-10*(e-1))),TT={linear:jt,easeIn:jT,easeInOut:Nj,easeOut:NT,circIn:Jp,circInOut:kT,circOut:Sj,backIn:Zp,backInOut:ST,backOut:Cj,anticipate:CT},k1=e=>{if(Array.isArray(e)){Qp(e.length===4);const[t,r,s,n]=e;return $c(t,r,s,n)}else if(typeof e=="string")return TT[e];return e},ex=(e,t)=>r=>!!(Bc(r)&&A3.test(r)&&r.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(r,t)),Tj=(e,t,r)=>s=>{if(!Bc(s))return s;const[n,i,l,o]=s.match(B0);return{[e]:parseFloat(n),[t]:parseFloat(i),[r]:parseFloat(l),alpha:o!==void 0?parseFloat(o):1}},ET=e=>Tn(0,255,e),Of={...Di,transform:e=>Math.round(ET(e))},ti={test:ex("rgb","red"),parse:Tj("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:s=1})=>"rgba("+Of.transform(e)+", "+Of.transform(t)+", "+Of.transform(r)+", "+Po(Ro.transform(s))+")"};function AT(e){let t="",r="",s="",n="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),s=e.substring(5,7),n=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),s=e.substring(3,4),n=e.substring(4,5),t+=t,r+=r,s+=s,n+=n),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(s,16),alpha:n?parseInt(n,16)/255:1}}const hm={test:ex("#"),parse:AT,transform:ti.transform},ll={test:ex("hsl","hue"),parse:Tj("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:s=1})=>"hsla("+Math.round(e)+", "+la.transform(Po(t))+", "+la.transform(Po(r))+", "+Po(Ro.transform(s))+")"},gr={test:e=>ti.test(e)||hm.test(e)||ll.test(e),parse:e=>ti.test(e)?ti.parse(e):ll.test(e)?ll.parse(e):hm.parse(e),transform:e=>Bc(e)?e:e.hasOwnProperty("red")?ti.transform(e):ll.transform(e)},dt=(e,t,r)=>-r*e+r*t+e;function Mf(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function FT({hue:e,saturation:t,lightness:r,alpha:s}){e/=360,t/=100,r/=100;let n=0,i=0,l=0;if(!t)n=i=l=r;else{const o=r<.5?r*(1+t):r+t-r*t,c=2*r-o;n=Mf(c,o,e+1/3),i=Mf(c,o,e),l=Mf(c,o,e-1/3)}return{red:Math.round(n*255),green:Math.round(i*255),blue:Math.round(l*255),alpha:s}}const Lf=(e,t,r)=>{const s=e*e;return Math.sqrt(Math.max(0,r*(t*t-s)+s))},RT=[hm,ti,ll],PT=e=>RT.find(t=>t.test(e));function S1(e){const t=PT(e);let r=t.parse(e);return t===ll&&(r=FT(r)),r}const Ej=(e,t)=>{const r=S1(e),s=S1(t),n={...r};return i=>(n.red=Lf(r.red,s.red,i),n.green=Lf(r.green,s.green,i),n.blue=Lf(r.blue,s.blue,i),n.alpha=dt(r.alpha,s.alpha,i),ti.transform(n))};function DT(e){var t,r;return isNaN(e)&&Bc(e)&&(((t=e.match(B0))===null||t===void 0?void 0:t.length)||0)+(((r=e.match(tj))===null||r===void 0?void 0:r.length)||0)>0}const Aj={regex:T3,countKey:"Vars",token:"${v}",parse:jt},Fj={regex:tj,countKey:"Colors",token:"${c}",parse:gr.parse},Rj={regex:B0,countKey:"Numbers",token:"${n}",parse:Di.parse};function Bf(e,{regex:t,countKey:r,token:s,parse:n}){const i=e.tokenised.match(t);i&&(e["num"+r]=i.length,e.tokenised=e.tokenised.replace(t,s),e.values.push(...i.map(n)))}function zd(e){const t=e.toString(),r={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return r.value.includes("var(--")&&Bf(r,Aj),Bf(r,Fj),Bf(r,Rj),r}function Pj(e){return zd(e).values}function Dj(e){const{values:t,numColors:r,numVars:s,tokenised:n}=zd(e),i=t.length;return l=>{let o=n;for(let c=0;c<i;c++)c<s?o=o.replace(Aj.token,l[c]):c<s+r?o=o.replace(Fj.token,gr.transform(l[c])):o=o.replace(Rj.token,Po(l[c]));return o}}const IT=e=>typeof e=="number"?0:e;function OT(e){const t=Pj(e);return Dj(e)(t.map(IT))}const En={test:DT,parse:Pj,createTransformer:Dj,getAnimatableNone:OT},Ij=(e,t)=>r=>`${r>0?t:e}`;function Oj(e,t){return typeof e=="number"?r=>dt(e,t,r):gr.test(e)?Ej(e,t):e.startsWith("var(")?Ij(e,t):Lj(e,t)}const Mj=(e,t)=>{const r=[...e],s=r.length,n=e.map((i,l)=>Oj(i,t[l]));return i=>{for(let l=0;l<s;l++)r[l]=n[l](i);return r}},MT=(e,t)=>{const r={...e,...t},s={};for(const n in r)e[n]!==void 0&&t[n]!==void 0&&(s[n]=Oj(e[n],t[n]));return n=>{for(const i in s)r[i]=s[i](n);return r}},Lj=(e,t)=>{const r=En.createTransformer(t),s=zd(e),n=zd(t);return s.numVars===n.numVars&&s.numColors===n.numColors&&s.numNumbers>=n.numNumbers?_n(Mj(s.values,n.values),r):Ij(e,t)},mc=(e,t,r)=>{const s=t-e;return s===0?1:(r-e)/s},C1=(e,t)=>r=>dt(e,t,r);function LT(e){return typeof e=="number"?C1:typeof e=="string"?gr.test(e)?Ej:Lj:Array.isArray(e)?Mj:typeof e=="object"?MT:C1}function BT(e,t,r){const s=[],n=r||LT(e[0]),i=e.length-1;for(let l=0;l<i;l++){let o=n(e[l],e[l+1]);if(t){const c=Array.isArray(t)?t[l]||jt:t;o=_n(c,o)}s.push(o)}return s}function Bj(e,t,{clamp:r=!0,ease:s,mixer:n}={}){const i=e.length;if(Qp(i===t.length),i===1)return()=>t[0];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const l=BT(t,s,n),o=l.length,c=u=>{let d=0;if(o>1)for(;d<e.length-2&&!(u<e[d+1]);d++);const f=mc(e[d],e[d+1],u);return l[d](f)};return r?u=>c(Tn(e[0],e[i-1],u)):c}function UT(e,t){const r=e[e.length-1];for(let s=1;s<=t;s++){const n=mc(0,t,s);e.push(dt(r,1,n))}}function $T(e){const t=[0];return UT(t,e.length-1),t}function VT(e,t){return e.map(r=>r*t)}function zT(e,t){return e.map(()=>t||Nj).splice(0,e.length-1)}function Hd({duration:e=300,keyframes:t,times:r,ease:s="easeInOut"}){const n=_T(s)?s.map(k1):k1(s),i={done:!1,value:t[0]},l=VT(r&&r.length===t.length?r:$T(t),e),o=Bj(l,t,{ease:Array.isArray(n)?n:zT(t,n)});return{calculatedDuration:e,next:c=>(i.value=o(c),i.done=c>=e,i)}}function Uj(e,t){return t?e*(1e3/t):0}const HT=5;function $j(e,t,r){const s=Math.max(t-HT,0);return Uj(r-e(s),t-s)}const Uf=.001,WT=.01,GT=10,qT=.05,YT=1;function KT({duration:e=800,bounce:t=.25,velocity:r=0,mass:s=1}){let n,i,l=1-t;l=Tn(qT,YT,l),e=Tn(WT,GT,Ea(e)),l<1?(n=u=>{const d=u*l,f=d*e,h=d-r,x=mm(u,l),m=Math.exp(-f);return Uf-h/x*m},i=u=>{const f=u*l*e,h=f*r+r,x=Math.pow(l,2)*Math.pow(u,2)*e,m=Math.exp(-f),p=mm(Math.pow(u,2),l);return(-n(u)+Uf>0?-1:1)*((h-x)*m)/p}):(n=u=>{const d=Math.exp(-u*e),f=(u-r)*e+1;return-Uf+d*f},i=u=>{const d=Math.exp(-u*e),f=(r-u)*(e*e);return d*f});const o=5/e,c=QT(n,i,o);if(e=mi(e),isNaN(c))return{stiffness:100,damping:10,duration:e};{const u=Math.pow(c,2)*s;return{stiffness:u,damping:l*2*Math.sqrt(s*u),duration:e}}}const XT=12;function QT(e,t,r){let s=r;for(let n=1;n<XT;n++)s=s-e(s)/t(s);return s}function mm(e,t){return e*Math.sqrt(1-t*t)}const JT=["duration","bounce"],ZT=["stiffness","damping","mass"];function T1(e,t){return t.some(r=>e[r]!==void 0)}function eE(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!T1(e,ZT)&&T1(e,JT)){const r=KT(e);t={...t,...r,mass:1},t.isResolvedFromDuration=!0}return t}function Vj({keyframes:e,restDelta:t,restSpeed:r,...s}){const n=e[0],i=e[e.length-1],l={done:!1,value:n},{stiffness:o,damping:c,mass:u,duration:d,velocity:f,isResolvedFromDuration:h}=eE({...s,velocity:-Ea(s.velocity||0)}),x=f||0,m=c/(2*Math.sqrt(o*u)),p=i-n,w=Ea(Math.sqrt(o/u)),b=Math.abs(p)<5;r||(r=b?.01:2),t||(t=b?.005:.5);let g;if(m<1){const y=mm(w,m);g=j=>{const A=Math.exp(-m*w*j);return i-A*((x+m*w*p)/y*Math.sin(y*j)+p*Math.cos(y*j))}}else if(m===1)g=y=>i-Math.exp(-w*y)*(p+(x+w*p)*y);else{const y=w*Math.sqrt(m*m-1);g=j=>{const A=Math.exp(-m*w*j),k=Math.min(y*j,300);return i-A*((x+m*w*p)*Math.sinh(k)+y*p*Math.cosh(k))/y}}return{calculatedDuration:h&&d||null,next:y=>{const j=g(y);if(h)l.done=y>=d;else{let A=x;y!==0&&(m<1?A=$j(g,y,j):A=0);const k=Math.abs(A)<=r,v=Math.abs(i-j)<=t;l.done=k&&v}return l.value=l.done?i:j,l}}}function E1({keyframes:e,velocity:t=0,power:r=.8,timeConstant:s=325,bounceDamping:n=10,bounceStiffness:i=500,modifyTarget:l,min:o,max:c,restDelta:u=.5,restSpeed:d}){const f=e[0],h={done:!1,value:f},x=E=>o!==void 0&&E<o||c!==void 0&&E>c,m=E=>o===void 0?c:c===void 0||Math.abs(o-E)<Math.abs(c-E)?o:c;let p=r*t;const w=f+p,b=l===void 0?w:l(w);b!==w&&(p=b-f);const g=E=>-p*Math.exp(-E/s),y=E=>b+g(E),j=E=>{const S=g(E),N=y(E);h.done=Math.abs(S)<=u,h.value=h.done?b:N};let A,k;const v=E=>{x(h.value)&&(A=E,k=Vj({keyframes:[h.value,m(h.value)],velocity:$j(y,E,h.value),damping:n,stiffness:i,restDelta:u,restSpeed:d}))};return v(0),{calculatedDuration:null,next:E=>{let S=!1;return!k&&A===void 0&&(S=!0,j(E),v(E)),A!==void 0&&E>A?k.next(E-A):(!S&&j(E),h)}}}const tE=e=>{const t=({timestamp:r})=>e(r);return{start:()=>Je.update(t,!0),stop:()=>La(t),now:()=>sr.isProcessing?sr.timestamp:performance.now()}},A1=2e4;function F1(e){let t=0;const r=50;let s=e.next(t);for(;!s.done&&t<A1;)t+=r,s=e.next(t);return t>=A1?1/0:t}const rE={decay:E1,inertia:E1,tween:Hd,keyframes:Hd,spring:Vj};function Wd({autoplay:e=!0,delay:t=0,driver:r=tE,keyframes:s,type:n="keyframes",repeat:i=0,repeatDelay:l=0,repeatType:o="loop",onPlay:c,onStop:u,onComplete:d,onUpdate:f,...h}){let x=1,m=!1,p,w;const b=()=>{w=new Promise(W=>{p=W})};b();let g;const y=rE[n]||Hd;let j;y!==Hd&&typeof s[0]!="number"&&(j=Bj([0,100],s,{clamp:!1}),s=[0,100]);const A=y({...h,keyframes:s});let k;o==="mirror"&&(k=y({...h,keyframes:[...s].reverse(),velocity:-(h.velocity||0)}));let v="idle",E=null,S=null,N=null;A.calculatedDuration===null&&i&&(A.calculatedDuration=F1(A));const{calculatedDuration:D}=A;let F=1/0,Y=1/0;D!==null&&(F=D+l,Y=F*(i+1)-l);let Q=0;const ae=W=>{if(S===null)return;x>0&&(S=Math.min(S,W)),x<0&&(S=Math.min(W-Y/x,S)),E!==null?Q=E:Q=Math.round(W-S)*x;const T=Q-t*(x>=0?1:-1),L=x>=0?T<0:T>Y;Q=Math.max(T,0),v==="finished"&&E===null&&(Q=Y);let B=Q,V=A;if(i){const pe=Math.min(Q,Y)/F;let le=Math.floor(pe),ke=pe%1;!ke&&pe>=1&&(ke=1),ke===1&&le--,le=Math.min(le,i+1),!!(le%2)&&(o==="reverse"?(ke=1-ke,l&&(ke-=l/F)):o==="mirror"&&(V=k)),B=Tn(0,1,ke)*F}const te=L?{done:!1,value:s[0]}:V.next(B);j&&(te.value=j(te.value));let{done:ue}=te;!L&&D!==null&&(ue=x>=0?Q>=Y:Q<=0);const ve=E===null&&(v==="finished"||v==="running"&&ue);return f&&f(te.value),ve&&se(),te},ee=()=>{g&&g.stop(),g=void 0},fe=()=>{v="idle",ee(),p(),b(),S=N=null},se=()=>{v="finished",d&&d(),ee(),p()},H=()=>{if(m)return;g||(g=r(ae));const W=g.now();c&&c(),E!==null?S=W-E:(!S||v==="finished")&&(S=W),v==="finished"&&b(),N=S,E=null,v="running",g.start()};e&&H();const ne={then(W,T){return w.then(W,T)},get time(){return Ea(Q)},set time(W){W=mi(W),Q=W,E!==null||!g||x===0?E=W:S=g.now()-W/x},get duration(){const W=A.calculatedDuration===null?F1(A):A.calculatedDuration;return Ea(W)},get speed(){return x},set speed(W){W===x||!g||(x=W,ne.time=Ea(Q))},get state(){return v},play:H,pause:()=>{v="paused",E=Q},stop:()=>{m=!0,v!=="idle"&&(v="idle",u&&u(),fe())},cancel:()=>{N!==null&&ae(N),fe()},complete:()=>{v="finished"},sample:W=>(S=0,ae(W))};return ne}function sE(e){let t;return()=>(t===void 0&&(t=e()),t)}const aE=sE(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),nE=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),Du=10,iE=2e4,lE=(e,t)=>t.type==="spring"||e==="backgroundColor"||!vj(t.ease);function oE(e,t,{onUpdate:r,onComplete:s,...n}){if(!(aE()&&nE.has(t)&&!n.repeatDelay&&n.repeatType!=="mirror"&&n.damping!==0&&n.type!=="inertia"))return!1;let l=!1,o,c,u=!1;const d=()=>{c=new Promise(y=>{o=y})};d();let{keyframes:f,duration:h=300,ease:x,times:m}=n;if(lE(t,n)){const y=Wd({...n,repeat:0,delay:0});let j={done:!1,value:f[0]};const A=[];let k=0;for(;!j.done&&k<iE;)j=y.sample(k),A.push(j.value),k+=Du;m=void 0,f=A,h=k-Du,x="linear"}const p=gT(e.owner.current,t,f,{...n,duration:h,ease:x,times:m}),w=()=>{u=!1,p.cancel()},b=()=>{u=!0,Je.update(w),o(),d()};return p.onfinish=()=>{u||(e.set(yT(f,n)),s&&s(),b())},{then(y,j){return c.then(y,j)},attachTimeline(y){return p.timeline=y,p.onfinish=null,jt},get time(){return Ea(p.currentTime||0)},set time(y){p.currentTime=mi(y)},get speed(){return p.playbackRate},set speed(y){p.playbackRate=y},get duration(){return Ea(h)},play:()=>{l||(p.play(),La(w))},pause:()=>p.pause(),stop:()=>{if(l=!0,p.playState==="idle")return;const{currentTime:y}=p;if(y){const j=Wd({...n,autoplay:!1});e.setWithVelocity(j.sample(y-Du).value,j.sample(y).value,Du)}b()},complete:()=>{u||p.finish()},cancel:b}}function cE({keyframes:e,delay:t,onUpdate:r,onComplete:s}){const n=()=>(r&&r(e[e.length-1]),s&&s(),{time:0,speed:1,duration:0,play:jt,pause:jt,stop:jt,then:i=>(i(),Promise.resolve()),cancel:jt,complete:jt});return t?Wd({keyframes:[0,1],duration:0,delay:t,onComplete:n}):n()}const uE={type:"spring",stiffness:500,damping:25,restSpeed:10},dE=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),fE={type:"keyframes",duration:.8},hE={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},mE=(e,{keyframes:t})=>t.length>2?fE:Pi.has(e)?e.startsWith("scale")?dE(t[1]):uE:hE,pm=(e,t)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(En.test(t)||t==="0")&&!t.startsWith("url(")),pE=new Set(["brightness","contrast","saturate","opacity"]);function xE(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[s]=r.match(B0)||[];if(!s)return e;const n=r.replace(s,"");let i=pE.has(t)?1:0;return s!==r&&(i*=100),t+"("+i+n+")"}const gE=/([a-z-]*)\(.*?\)/g,xm={...En,getAnimatableNone:e=>{const t=e.match(gE);return t?t.map(xE).join(" "):e}},yE={...rj,color:gr,backgroundColor:gr,outlineColor:gr,fill:gr,stroke:gr,borderColor:gr,borderTopColor:gr,borderRightColor:gr,borderBottomColor:gr,borderLeftColor:gr,filter:xm,WebkitFilter:xm},tx=e=>yE[e];function zj(e,t){let r=tx(e);return r!==xm&&(r=En),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const Hj=e=>/^0[^.\s]+$/.test(e);function vE(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||Hj(e)}function wE(e,t,r,s){const n=pm(t,r);let i;Array.isArray(r)?i=[...r]:i=[null,r];const l=s.from!==void 0?s.from:e.get();let o;const c=[];for(let u=0;u<i.length;u++)i[u]===null&&(i[u]=u===0?l:i[u-1]),vE(i[u])&&c.push(u),typeof i[u]=="string"&&i[u]!=="none"&&i[u]!=="0"&&(o=i[u]);if(n&&c.length&&o)for(let u=0;u<c.length;u++){const d=c[u];i[d]=zj(t,o)}return i}function bE({when:e,delay:t,delayChildren:r,staggerChildren:s,staggerDirection:n,repeat:i,repeatType:l,repeatDelay:o,from:c,elapsed:u,...d}){return!!Object.keys(d).length}function rx(e,t){return e[t]||e.default||e}const jE={skipAnimations:!1},sx=(e,t,r,s={})=>n=>{const i=rx(s,e)||{},l=i.delay||s.delay||0;let{elapsed:o=0}=s;o=o-mi(l);const c=wE(t,e,r,i),u=c[0],d=c[c.length-1],f=pm(e,u),h=pm(e,d);let x={keyframes:c,velocity:t.getVelocity(),ease:"easeOut",...i,delay:-o,onUpdate:m=>{t.set(m),i.onUpdate&&i.onUpdate(m)},onComplete:()=>{n(),i.onComplete&&i.onComplete()}};if(bE(i)||(x={...x,...mE(e,x)}),x.duration&&(x.duration=mi(x.duration)),x.repeatDelay&&(x.repeatDelay=mi(x.repeatDelay)),!f||!h||xT.current||i.type===!1||jE.skipAnimations)return cE(x);if(!s.isHandoff&&t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const m=oE(t,e,x);if(m)return m}return Wd(x)};function Gd(e){return!!(Br(e)&&e.add)}const Wj=e=>/^\-?\d*\.?\d+$/.test(e);function ax(e,t){e.indexOf(t)===-1&&e.push(t)}function nx(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}class ix{constructor(){this.subscriptions=[]}add(t){return ax(this.subscriptions,t),()=>nx(this.subscriptions,t)}notify(t,r,s){const n=this.subscriptions.length;if(n)if(n===1)this.subscriptions[0](t,r,s);else for(let i=0;i<n;i++){const l=this.subscriptions[i];l&&l(t,r,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const NE=e=>!isNaN(parseFloat(e));class _E{constructor(t,r={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(s,n=!0)=>{this.prev=this.current,this.current=s;const{delta:i,timestamp:l}=sr;this.lastUpdated!==l&&(this.timeDelta=i,this.lastUpdated=l,Je.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),n&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>Je.postRender(this.velocityCheck),this.velocityCheck=({timestamp:s})=>{s!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=NE(this.current),this.owner=r.owner}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new ix);const s=this.events[t].add(r);return t==="change"?()=>{s(),Je.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t,r=!0){!r||!this.passiveEffect?this.updateAndNotify(t,r):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,r,s){this.set(r),this.prev=t,this.timeDelta=s}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?Uj(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Il(e,t){return new _E(e,t)}const Gj=e=>t=>t.test(e),kE={test:e=>e==="auto",parse:e=>e},qj=[Di,je,la,qa,R3,F3,kE],co=e=>qj.find(Gj(e)),SE=[...qj,gr,En],CE=e=>SE.find(Gj(e));function TE(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,Il(r))}function EE(e,t){const r=$0(e,t);let{transitionEnd:s={},transition:n={},...i}=r?e.makeTargetAnimatable(r,!1):{};i={...i,...s};for(const l in i){const o=G3(i[l]);TE(e,l,o)}}function AE(e,t,r){var s,n;const i=Object.keys(t).filter(o=>!e.hasValue(o)),l=i.length;if(l)for(let o=0;o<l;o++){const c=i[o],u=t[c];let d=null;Array.isArray(u)&&(d=u[0]),d===null&&(d=(n=(s=r[c])!==null&&s!==void 0?s:e.readValue(c))!==null&&n!==void 0?n:t[c]),d!=null&&(typeof d=="string"&&(Wj(d)||Hj(d))?d=parseFloat(d):!CE(d)&&En.test(u)&&(d=zj(c,u)),e.addValue(c,Il(d,{owner:e})),r[c]===void 0&&(r[c]=d),d!==null&&e.setBaseTarget(c,d))}}function FE(e,t){return t?(t[e]||t.default||t).from:void 0}function RE(e,t,r){const s={};for(const n in e){const i=FE(n,t);if(i!==void 0)s[n]=i;else{const l=r.getValue(n);l&&(s[n]=l.get())}}return s}function PE({protectedKeys:e,needsAnimating:t},r){const s=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,s}function DE(e,t){const r=e.get();if(Array.isArray(t)){for(let s=0;s<t.length;s++)if(t[s]!==r)return!0}else return r!==t}function Yj(e,t,{delay:r=0,transitionOverride:s,type:n}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:l,...o}=e.makeTargetAnimatable(t);const c=e.getValue("willChange");s&&(i=s);const u=[],d=n&&e.animationState&&e.animationState.getState()[n];for(const f in o){const h=e.getValue(f),x=o[f];if(!h||x===void 0||d&&PE(d,f))continue;const m={delay:r,elapsed:0,...rx(i||{},f)};if(window.HandoffAppearAnimations){const b=e.getProps()[Kb];if(b){const g=window.HandoffAppearAnimations(b,f,h,Je);g!==null&&(m.elapsed=g,m.isHandoff=!0)}}let p=!m.isHandoff&&!DE(h,x);if(m.type==="spring"&&(h.getVelocity()||m.velocity)&&(p=!1),h.animation&&(p=!1),p)continue;h.start(sx(f,h,x,e.shouldReduceMotion&&Pi.has(f)?{type:!1}:m));const w=h.animation;Gd(c)&&(c.add(f),w.then(()=>c.remove(f))),u.push(w)}return l&&Promise.all(u).then(()=>{l&&EE(e,l)}),u}function gm(e,t,r={}){const s=$0(e,t,r.custom);let{transition:n=e.getDefaultTransition()||{}}=s||{};r.transitionOverride&&(n=r.transitionOverride);const i=s?()=>Promise.all(Yj(e,s,r)):()=>Promise.resolve(),l=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:f}=n;return IE(e,t,u+c,d,f,r)}:()=>Promise.resolve(),{when:o}=n;if(o){const[c,u]=o==="beforeChildren"?[i,l]:[l,i];return c().then(()=>u())}else return Promise.all([i(),l(r.delay)])}function IE(e,t,r=0,s=0,n=1,i){const l=[],o=(e.variantChildren.size-1)*s,c=n===1?(u=0)=>u*s:(u=0)=>o-u*s;return Array.from(e.variantChildren).sort(OE).forEach((u,d)=>{u.notify("AnimationStart",t),l.push(gm(u,t,{...i,delay:r+c(d)}).then(()=>u.notify("AnimationComplete",t)))}),Promise.all(l)}function OE(e,t){return e.sortNodePosition(t)}function ME(e,t,r={}){e.notify("AnimationStart",t);let s;if(Array.isArray(t)){const n=t.map(i=>gm(e,i,r));s=Promise.all(n)}else if(typeof t=="string")s=gm(e,t,r);else{const n=typeof t=="function"?$0(e,t,r.custom):t;s=Promise.all(Yj(e,n,r))}return s.then(()=>e.notify("AnimationComplete",t))}const LE=[...$p].reverse(),BE=$p.length;function UE(e){return t=>Promise.all(t.map(({animation:r,options:s})=>ME(e,r,s)))}function $E(e){let t=UE(e);const r=zE();let s=!0;const n=(c,u)=>{const d=$0(e,u);if(d){const{transition:f,transitionEnd:h,...x}=d;c={...c,...x,...h}}return c};function i(c){t=c(e)}function l(c,u){const d=e.getProps(),f=e.getVariantContext(!0)||{},h=[],x=new Set;let m={},p=1/0;for(let b=0;b<BE;b++){const g=LE[b],y=r[g],j=d[g]!==void 0?d[g]:f[g],A=fc(j),k=g===u?y.isActive:null;k===!1&&(p=b);let v=j===f[g]&&j!==d[g]&&A;if(v&&s&&e.manuallyAnimateOnMount&&(v=!1),y.protectedKeys={...m},!y.isActive&&k===null||!j&&!y.prevProp||M0(j)||typeof j=="boolean")continue;let S=VE(y.prevProp,j)||g===u&&y.isActive&&!v&&A||b>p&&A,N=!1;const D=Array.isArray(j)?j:[j];let F=D.reduce(n,{});k===!1&&(F={});const{prevResolvedValues:Y={}}=y,Q={...Y,...F},ae=ee=>{S=!0,x.has(ee)&&(N=!0,x.delete(ee)),y.needsAnimating[ee]=!0};for(const ee in Q){const fe=F[ee],se=Y[ee];if(m.hasOwnProperty(ee))continue;let H=!1;Vd(fe)&&Vd(se)?H=!gj(fe,se):H=fe!==se,H?fe!==void 0?ae(ee):x.add(ee):fe!==void 0&&x.has(ee)?ae(ee):y.protectedKeys[ee]=!0}y.prevProp=j,y.prevResolvedValues=F,y.isActive&&(m={...m,...F}),s&&e.blockInitialAnimation&&(S=!1),S&&(!v||N)&&h.push(...D.map(ee=>({animation:ee,options:{type:g,...c}})))}if(x.size){const b={};x.forEach(g=>{const y=e.getBaseTarget(g);y!==void 0&&(b[g]=y)}),h.push({animation:b})}let w=!!h.length;return s&&(d.initial===!1||d.initial===d.animate)&&!e.manuallyAnimateOnMount&&(w=!1),s=!1,w?t(h):Promise.resolve()}function o(c,u,d){var f;if(r[c].isActive===u)return Promise.resolve();(f=e.variantChildren)===null||f===void 0||f.forEach(x=>{var m;return(m=x.animationState)===null||m===void 0?void 0:m.setActive(c,u)}),r[c].isActive=u;const h=l(d,c);for(const x in r)r[x].protectedKeys={};return h}return{animateChanges:l,setActive:o,setAnimateFunction:i,getState:()=>r}}function VE(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!gj(t,e):!1}function zn(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function zE(){return{animate:zn(!0),whileInView:zn(),whileHover:zn(),whileTap:zn(),whileDrag:zn(),whileFocus:zn(),exit:zn()}}class HE extends On{constructor(t){super(t),t.animationState||(t.animationState=$E(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();this.unmount(),M0(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){}}let WE=0;class GE extends On{constructor(){super(...arguments),this.id=WE++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r,custom:s}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===n)return;const i=this.node.animationState.setActive("exit",!t,{custom:s??this.node.getProps().custom});r&&!t&&i.then(()=>r(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const qE={animation:{Feature:HE},exit:{Feature:GE}},R1=(e,t)=>Math.abs(e-t);function YE(e,t){const r=R1(e.x,t.x),s=R1(e.y,t.y);return Math.sqrt(r**2+s**2)}class Kj{constructor(t,r,{transformPagePoint:s,contextWindow:n,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=Vf(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,x=YE(f.offset,{x:0,y:0})>=3;if(!h&&!x)return;const{point:m}=f,{timestamp:p}=sr;this.history.push({...m,timestamp:p});const{onStart:w,onMove:b}=this.handlers;h||(w&&w(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),b&&b(this.lastMoveEvent,f)},this.handlePointerMove=(f,h)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=$f(h,this.transformPagePoint),Je.update(this.updatePoint,!0)},this.handlePointerUp=(f,h)=>{this.end();const{onEnd:x,onSessionEnd:m,resumeAnimation:p}=this.handlers;if(this.dragSnapToOrigin&&p&&p(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=Vf(f.type==="pointercancel"?this.lastMoveEventInfo:$f(h,this.transformPagePoint),this.history);this.startEvent&&x&&x(f,w),m&&m(f,w)},!fj(t))return;this.dragSnapToOrigin=i,this.handlers=r,this.transformPagePoint=s,this.contextWindow=n||window;const l=U0(t),o=$f(l,this.transformPagePoint),{point:c}=o,{timestamp:u}=sr;this.history=[{...c,timestamp:u}];const{onSessionStart:d}=r;d&&d(t,Vf(o,this.history)),this.removeListeners=_n(Ta(this.contextWindow,"pointermove",this.handlePointerMove),Ta(this.contextWindow,"pointerup",this.handlePointerUp),Ta(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),La(this.updatePoint)}}function $f(e,t){return t?{point:t(e.point)}:e}function P1(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Vf({point:e},t){return{point:e,delta:P1(e,Xj(t)),offset:P1(e,KE(t)),velocity:XE(t,.1)}}function KE(e){return e[0]}function Xj(e){return e[e.length-1]}function XE(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,s=null;const n=Xj(e);for(;r>=0&&(s=e[r],!(n.timestamp-s.timestamp>mi(t)));)r--;if(!s)return{x:0,y:0};const i=Ea(n.timestamp-s.timestamp);if(i===0)return{x:0,y:0};const l={x:(n.x-s.x)/i,y:(n.y-s.y)/i};return l.x===1/0&&(l.x=0),l.y===1/0&&(l.y=0),l}function Xr(e){return e.max-e.min}function ym(e,t=0,r=.01){return Math.abs(e-t)<=r}function D1(e,t,r,s=.5){e.origin=s,e.originPoint=dt(t.min,t.max,e.origin),e.scale=Xr(r)/Xr(t),(ym(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=dt(r.min,r.max,e.origin)-e.originPoint,(ym(e.translate)||isNaN(e.translate))&&(e.translate=0)}function Do(e,t,r,s){D1(e.x,t.x,r.x,s?s.originX:void 0),D1(e.y,t.y,r.y,s?s.originY:void 0)}function I1(e,t,r){e.min=r.min+t.min,e.max=e.min+Xr(t)}function QE(e,t,r){I1(e.x,t.x,r.x),I1(e.y,t.y,r.y)}function O1(e,t,r){e.min=t.min-r.min,e.max=e.min+Xr(t)}function Io(e,t,r){O1(e.x,t.x,r.x),O1(e.y,t.y,r.y)}function JE(e,{min:t,max:r},s){return t!==void 0&&e<t?e=s?dt(t,e,s.min):Math.max(e,t):r!==void 0&&e>r&&(e=s?dt(r,e,s.max):Math.min(e,r)),e}function M1(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function ZE(e,{top:t,left:r,bottom:s,right:n}){return{x:M1(e.x,r,n),y:M1(e.y,t,s)}}function L1(e,t){let r=t.min-e.min,s=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,s]=[s,r]),{min:r,max:s}}function eA(e,t){return{x:L1(e.x,t.x),y:L1(e.y,t.y)}}function tA(e,t){let r=.5;const s=Xr(e),n=Xr(t);return n>s?r=mc(t.min,t.max-s,e.min):s>n&&(r=mc(e.min,e.max-n,t.min)),Tn(0,1,r)}function rA(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const vm=.35;function sA(e=vm){return e===!1?e=0:e===!0&&(e=vm),{x:B1(e,"left","right"),y:B1(e,"top","bottom")}}function B1(e,t,r){return{min:U1(e,t),max:U1(e,r)}}function U1(e,t){return typeof e=="number"?e:e[t]||0}const $1=()=>({translate:0,scale:1,origin:0,originPoint:0}),ol=()=>({x:$1(),y:$1()}),V1=()=>({min:0,max:0}),kt=()=>({x:V1(),y:V1()});function is(e){return[e("x"),e("y")]}function Qj({top:e,left:t,right:r,bottom:s}){return{x:{min:t,max:r},y:{min:e,max:s}}}function aA({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function nA(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),s=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:s.y,right:s.x}}function zf(e){return e===void 0||e===1}function wm({scale:e,scaleX:t,scaleY:r}){return!zf(e)||!zf(t)||!zf(r)}function qn(e){return wm(e)||Jj(e)||e.z||e.rotate||e.rotateX||e.rotateY}function Jj(e){return z1(e.x)||z1(e.y)}function z1(e){return e&&e!=="0%"}function qd(e,t,r){const s=e-r,n=t*s;return r+n}function H1(e,t,r,s,n){return n!==void 0&&(e=qd(e,n,s)),qd(e,r,s)+t}function bm(e,t=0,r=1,s,n){e.min=H1(e.min,t,r,s,n),e.max=H1(e.max,t,r,s,n)}function Zj(e,{x:t,y:r}){bm(e.x,t.translate,t.scale,t.originPoint),bm(e.y,r.translate,r.scale,r.originPoint)}function iA(e,t,r,s=!1){const n=r.length;if(!n)return;t.x=t.y=1;let i,l;for(let o=0;o<n;o++){i=r[o],l=i.projectionDelta;const c=i.instance;c&&c.style&&c.style.display==="contents"||(s&&i.options.layoutScroll&&i.scroll&&i!==i.root&&cl(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),l&&(t.x*=l.x.scale,t.y*=l.y.scale,Zj(e,l)),s&&qn(i.latestValues)&&cl(e,i.latestValues))}t.x=W1(t.x),t.y=W1(t.y)}function W1(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function Qa(e,t){e.min=e.min+t,e.max=e.max+t}function G1(e,t,[r,s,n]){const i=t[n]!==void 0?t[n]:.5,l=dt(e.min,e.max,i);bm(e,t[r],t[s],l,t.scale)}const lA=["x","scaleX","originX"],oA=["y","scaleY","originY"];function cl(e,t){G1(e.x,t,lA),G1(e.y,t,oA)}function eN(e,t){return Qj(nA(e.getBoundingClientRect(),t))}function cA(e,t,r){const s=eN(e,r),{scroll:n}=t;return n&&(Qa(s.x,n.offset.x),Qa(s.y,n.offset.y)),s}const tN=({current:e})=>e?e.ownerDocument.defaultView:null,uA=new WeakMap;class dA{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=kt(),this.visualElement=t}start(t,{snapToCursor:r=!1}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const n=d=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(U0(d,"page").point)},i=(d,f)=>{const{drag:h,dragPropagation:x,onDragStart:m}=this.getProps();if(h&&!x&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=mj(h),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),is(w=>{let b=this.getAxisMotionValue(w).get()||0;if(la.test(b)){const{projection:g}=this.visualElement;if(g&&g.layout){const y=g.layout.layoutBox[w];y&&(b=Xr(y)*(parseFloat(b)/100))}}this.originPoint[w]=b}),m&&Je.update(()=>m(d,f),!1,!0);const{animationState:p}=this.visualElement;p&&p.setActive("whileDrag",!0)},l=(d,f)=>{const{dragPropagation:h,dragDirectionLock:x,onDirectionLock:m,onDrag:p}=this.getProps();if(!h&&!this.openGlobalLock)return;const{offset:w}=f;if(x&&this.currentDirection===null){this.currentDirection=fA(w),this.currentDirection!==null&&m&&m(this.currentDirection);return}this.updateAxis("x",f.point,w),this.updateAxis("y",f.point,w),this.visualElement.render(),p&&p(d,f)},o=(d,f)=>this.stop(d,f),c=()=>is(d=>{var f;return this.getAnimationState(d)==="paused"&&((f=this.getAxisMotionValue(d).animation)===null||f===void 0?void 0:f.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new Kj(t,{onSessionStart:n,onStart:i,onMove:l,onSessionEnd:o,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:tN(this.visualElement)})}stop(t,r){const s=this.isDragging;if(this.cancel(),!s)return;const{velocity:n}=r;this.startAnimation(n);const{onDragEnd:i}=this.getProps();i&&Je.update(()=>i(t,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,s){const{drag:n}=this.getProps();if(!s||!Iu(t,n,this.currentDirection))return;const i=this.getAxisMotionValue(t);let l=this.originPoint[t]+s[t];this.constraints&&this.constraints[t]&&(l=JE(l,this.constraints[t],this.elastic[t])),i.set(l)}resolveConstraints(){var t;const{dragConstraints:r,dragElastic:s}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,i=this.constraints;r&&il(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&n?this.constraints=ZE(n.layoutBox,r):this.constraints=!1,this.elastic=sA(s),i!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&is(l=>{this.getAxisMotionValue(l)&&(this.constraints[l]=rA(n.layoutBox[l],this.constraints[l]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!il(t))return!1;const s=t.current,{projection:n}=this.visualElement;if(!n||!n.layout)return!1;const i=cA(s,n.root,this.visualElement.getTransformPagePoint());let l=eA(n.layout.layoutBox,i);if(r){const o=r(aA(l));this.hasMutatedConstraints=!!o,o&&(l=Qj(o))}return l}startAnimation(t){const{drag:r,dragMomentum:s,dragElastic:n,dragTransition:i,dragSnapToOrigin:l,onDragTransitionEnd:o}=this.getProps(),c=this.constraints||{},u=is(d=>{if(!Iu(d,r,this.currentDirection))return;let f=c&&c[d]||{};l&&(f={min:0,max:0});const h=n?200:1e6,x=n?40:1e7,m={type:"inertia",velocity:s?t[d]:0,bounceStiffness:h,bounceDamping:x,timeConstant:750,restDelta:1,restSpeed:10,...i,...f};return this.startAxisValueAnimation(d,m)});return Promise.all(u).then(o)}startAxisValueAnimation(t,r){const s=this.getAxisMotionValue(t);return s.start(sx(t,s,0,r))}stopAnimation(){is(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){is(t=>{var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(t){const r="_drag"+t.toUpperCase(),s=this.visualElement.getProps(),n=s[r];return n||this.visualElement.getValue(t,(s.initial?s.initial[t]:void 0)||0)}snapToCursor(t){is(r=>{const{drag:s}=this.getProps();if(!Iu(r,s,this.currentDirection))return;const{projection:n}=this.visualElement,i=this.getAxisMotionValue(r);if(n&&n.layout){const{min:l,max:o}=n.layout.layoutBox[r];i.set(t[r]-dt(l,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:s}=this.visualElement;if(!il(r)||!s||!this.constraints)return;this.stopAnimation();const n={x:0,y:0};is(l=>{const o=this.getAxisMotionValue(l);if(o){const c=o.get();n[l]=tA({min:c,max:c},this.constraints[l])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),is(l=>{if(!Iu(l,t,null))return;const o=this.getAxisMotionValue(l),{min:c,max:u}=this.constraints[l];o.set(dt(c,u,n[l]))})}addListeners(){if(!this.visualElement.current)return;uA.set(this.visualElement,this);const t=this.visualElement.current,r=Ta(t,"pointerdown",c=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(c)}),s=()=>{const{dragConstraints:c}=this.getProps();il(c)&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,i=n.addEventListener("measure",s);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),s();const l=ka(window,"resize",()=>this.scalePositionWithinConstraints()),o=n.addEventListener("didUpdate",({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(is(d=>{const f=this.getAxisMotionValue(d);f&&(this.originPoint[d]+=c[d].translate,f.set(f.get()+c[d].translate))}),this.visualElement.render())});return()=>{l(),r(),i(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:s=!1,dragPropagation:n=!1,dragConstraints:i=!1,dragElastic:l=vm,dragMomentum:o=!0}=t;return{...t,drag:r,dragDirectionLock:s,dragPropagation:n,dragConstraints:i,dragElastic:l,dragMomentum:o}}}function Iu(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function fA(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class hA extends On{constructor(t){super(t),this.removeGroupControls=jt,this.removeListeners=jt,this.controls=new dA(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||jt}unmount(){this.removeGroupControls(),this.removeListeners()}}const q1=e=>(t,r)=>{e&&Je.update(()=>e(t,r))};class mA extends On{constructor(){super(...arguments),this.removePointerDownListener=jt}onPointerDown(t){this.session=new Kj(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:tN(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:s,onPanEnd:n}=this.node.getProps();return{onSessionStart:q1(t),onStart:q1(r),onMove:s,onEnd:(i,l)=>{delete this.session,n&&Je.update(()=>n(i,l))}}}mount(){this.removePointerDownListener=Ta(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function pA(){const e=C.useContext(I0);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:s}=e,n=C.useId();return C.useEffect(()=>s(n),[]),!t&&r?[!1,()=>r&&r(n)]:[!0]}const cd={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Y1(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const uo={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(je.test(e))e=parseFloat(e);else return e;const r=Y1(e,t.target.x),s=Y1(e,t.target.y);return`${r}% ${s}%`}},xA={correct:(e,{treeScale:t,projectionDelta:r})=>{const s=e,n=En.parse(e);if(n.length>5)return s;const i=En.createTransformer(e),l=typeof n[0]!="number"?1:0,o=r.x.scale*t.x,c=r.y.scale*t.y;n[0+l]/=o,n[1+l]/=c;const u=dt(o,c,.5);return typeof n[2+l]=="number"&&(n[2+l]/=u),typeof n[3+l]=="number"&&(n[3+l]/=u),i(n)}};class gA extends Ei.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:s,layoutId:n}=this.props,{projection:i}=t;_3(yA),i&&(r.group&&r.group.add(i),s&&s.register&&n&&s.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),cd.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:s,drag:n,isPresent:i}=this.props,l=s.projection;return l&&(l.isPresent=i,n||t.layoutDependency!==r||r===void 0?l.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?l.promote():l.relegate()||Je.postRender(()=>{const o=l.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),queueMicrotask(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:s}=this.props,{projection:n}=t;n&&(n.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(n),s&&s.deregister&&s.deregister(n))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function rN(e){const[t,r]=pA(),s=C.useContext(zp);return Ei.createElement(gA,{...e,layoutGroup:s,switchLayoutGroup:C.useContext(Qb),isPresent:t,safeToRemove:r})}const yA={borderRadius:{...uo,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:uo,borderTopRightRadius:uo,borderBottomLeftRadius:uo,borderBottomRightRadius:uo,boxShadow:xA},sN=["TopLeft","TopRight","BottomLeft","BottomRight"],vA=sN.length,K1=e=>typeof e=="string"?parseFloat(e):e,X1=e=>typeof e=="number"||je.test(e);function wA(e,t,r,s,n,i){n?(e.opacity=dt(0,r.opacity!==void 0?r.opacity:1,bA(s)),e.opacityExit=dt(t.opacity!==void 0?t.opacity:1,0,jA(s))):i&&(e.opacity=dt(t.opacity!==void 0?t.opacity:1,r.opacity!==void 0?r.opacity:1,s));for(let l=0;l<vA;l++){const o=`border${sN[l]}Radius`;let c=Q1(t,o),u=Q1(r,o);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||X1(c)===X1(u)?(e[o]=Math.max(dt(K1(c),K1(u),s),0),(la.test(u)||la.test(c))&&(e[o]+="%")):e[o]=u}(t.rotate||r.rotate)&&(e.rotate=dt(t.rotate||0,r.rotate||0,s))}function Q1(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const bA=aN(0,.5,Sj),jA=aN(.5,.95,jt);function aN(e,t,r){return s=>s<e?0:s>t?1:r(mc(e,t,s))}function J1(e,t){e.min=t.min,e.max=t.max}function ss(e,t){J1(e.x,t.x),J1(e.y,t.y)}function Z1(e,t,r,s,n){return e-=t,e=qd(e,1/r,s),n!==void 0&&(e=qd(e,1/n,s)),e}function NA(e,t=0,r=1,s=.5,n,i=e,l=e){if(la.test(t)&&(t=parseFloat(t),t=dt(l.min,l.max,t/100)-l.min),typeof t!="number")return;let o=dt(i.min,i.max,s);e===i&&(o-=t),e.min=Z1(e.min,t,r,o,n),e.max=Z1(e.max,t,r,o,n)}function ey(e,t,[r,s,n],i,l){NA(e,t[r],t[s],t[n],t.scale,i,l)}const _A=["x","scaleX","originX"],kA=["y","scaleY","originY"];function ty(e,t,r,s){ey(e.x,t,_A,r?r.x:void 0,s?s.x:void 0),ey(e.y,t,kA,r?r.y:void 0,s?s.y:void 0)}function ry(e){return e.translate===0&&e.scale===1}function nN(e){return ry(e.x)&&ry(e.y)}function SA(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}function iN(e,t){return Math.round(e.x.min)===Math.round(t.x.min)&&Math.round(e.x.max)===Math.round(t.x.max)&&Math.round(e.y.min)===Math.round(t.y.min)&&Math.round(e.y.max)===Math.round(t.y.max)}function sy(e){return Xr(e.x)/Xr(e.y)}class CA{constructor(){this.members=[]}add(t){ax(this.members,t),t.scheduleRender()}remove(t){if(nx(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(n=>t===n);if(r===0)return!1;let s;for(let n=r;n>=0;n--){const i=this.members[n];if(i.isPresent!==!1){s=i;break}}return s?(this.promote(s),!0):!1}promote(t,r){const s=this.lead;if(t!==s&&(this.prevLead=s,this.lead=t,t.show(),s)){s.instance&&s.scheduleRender(),t.scheduleRender(),t.resumeFrom=s,r&&(t.resumeFrom.preserveOpacity=!0),s.snapshot&&(t.snapshot=s.snapshot,t.snapshot.latestValues=s.animationValues||s.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:n}=t.options;n===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:s}=t;r.onExitComplete&&r.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function ay(e,t,r){let s="";const n=e.x.translate/t.x,i=e.y.translate/t.y;if((n||i)&&(s=`translate3d(${n}px, ${i}px, 0) `),(t.x!==1||t.y!==1)&&(s+=`scale(${1/t.x}, ${1/t.y}) `),r){const{rotate:c,rotateX:u,rotateY:d}=r;c&&(s+=`rotate(${c}deg) `),u&&(s+=`rotateX(${u}deg) `),d&&(s+=`rotateY(${d}deg) `)}const l=e.x.scale*t.x,o=e.y.scale*t.y;return(l!==1||o!==1)&&(s+=`scale(${l}, ${o})`),s||"none"}const TA=(e,t)=>e.depth-t.depth;class EA{constructor(){this.children=[],this.isDirty=!1}add(t){ax(this.children,t),this.isDirty=!0}remove(t){nx(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(TA),this.isDirty=!1,this.children.forEach(t)}}function AA(e,t){const r=performance.now(),s=({timestamp:n})=>{const i=n-r;i>=t&&(La(s),e(i-t))};return Je.read(s,!0),()=>La(s)}function FA(e){window.MotionDebug&&window.MotionDebug.record(e)}function RA(e){return e instanceof SVGElement&&e.tagName!=="svg"}function PA(e,t,r){const s=Br(e)?e:Il(e);return s.start(sx("",s,t,r)),s.animation}const ny=["","X","Y","Z"],DA={visibility:"hidden"},iy=1e3;let IA=0;const Yn={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function lN({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:s,resetTransform:n}){return class{constructor(l={},o=t==null?void 0:t()){this.id=IA++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Yn.totalNodes=Yn.resolvedTargetDeltas=Yn.recalculatedProjection=0,this.nodes.forEach(LA),this.nodes.forEach(zA),this.nodes.forEach(HA),this.nodes.forEach(BA),FA(Yn)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=l,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new EA)}addEventListener(l,o){return this.eventHandlers.has(l)||this.eventHandlers.set(l,new ix),this.eventHandlers.get(l).add(o)}notifyListeners(l,...o){const c=this.eventHandlers.get(l);c&&c.notify(...o)}hasListeners(l){return this.eventHandlers.has(l)}mount(l,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=RA(l),this.instance=l;const{layoutId:c,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(l),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(u||c)&&(this.isLayoutDirty=!0),e){let f;const h=()=>this.root.updateBlockedByResize=!1;e(l,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=AA(h,250),cd.hasAnimatedSinceResize&&(cd.hasAnimatedSinceResize=!1,this.nodes.forEach(oy))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||u)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:h,hasRelativeTargetChanged:x,layout:m})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const p=this.options.transition||d.getDefaultTransition()||KA,{onLayoutAnimationStart:w,onLayoutAnimationComplete:b}=d.getProps(),g=!this.targetLayout||!iN(this.targetLayout,m)||x,y=!h&&x;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||y||h&&(g||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,y);const j={...rx(p,"layout"),onPlay:w,onComplete:b};(d.shouldReduceMotion||this.options.layoutRoot)&&(j.delay=0,j.type=!1),this.startAnimation(j)}else h||oy(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=m})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const l=this.getStack();l&&l.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,La(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(WA),this.animationId++)}getTransformTemplate(){const{visualElement:l}=this.options;return l&&l.getProps().transformTemplate}willUpdate(l=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const f=this.path[d];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:o,layout:c}=this.options;if(o===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),l&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(ly);return}this.isUpdating||this.nodes.forEach($A),this.isUpdating=!1,this.nodes.forEach(VA),this.nodes.forEach(OA),this.nodes.forEach(MA),this.clearAllSnapshots();const o=performance.now();sr.delta=Tn(0,1e3/60,o-sr.timestamp),sr.timestamp=o,sr.isProcessing=!0,Pf.update.process(sr),Pf.preRender.process(sr),Pf.render.process(sr),sr.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(UA),this.sharedNodes.forEach(GA)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Je.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Je.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const l=this.layout;this.layout=this.measure(!1),this.layoutCorrected=kt(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,l?l.layoutBox:void 0)}updateScroll(l="measure"){let o=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===l&&(o=!1),o&&(this.scroll={animationId:this.root.animationId,phase:l,isRoot:s(this.instance),offset:r(this.instance)})}resetTransform(){if(!n)return;const l=this.isLayoutDirty||this.shouldResetTransform,o=this.projectionDelta&&!nN(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;l&&(o||qn(this.latestValues)||d)&&(n(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(l=!0){const o=this.measurePageBox();let c=this.removeElementScroll(o);return l&&(c=this.removeTransform(c)),XA(c),{animationId:this.root.animationId,measuredBox:o,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:l}=this.options;if(!l)return kt();const o=l.measureViewportBox(),{scroll:c}=this.root;return c&&(Qa(o.x,c.offset.x),Qa(o.y,c.offset.y)),o}removeElementScroll(l){const o=kt();ss(o,l);for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:f}=u;if(u!==this.root&&d&&f.layoutScroll){if(d.isRoot){ss(o,l);const{scroll:h}=this.root;h&&(Qa(o.x,-h.offset.x),Qa(o.y,-h.offset.y))}Qa(o.x,d.offset.x),Qa(o.y,d.offset.y)}}return o}applyTransform(l,o=!1){const c=kt();ss(c,l);for(let u=0;u<this.path.length;u++){const d=this.path[u];!o&&d.options.layoutScroll&&d.scroll&&d!==d.root&&cl(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),qn(d.latestValues)&&cl(c,d.latestValues)}return qn(this.latestValues)&&cl(c,this.latestValues),c}removeTransform(l){const o=kt();ss(o,l);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!qn(u.latestValues))continue;wm(u.latestValues)&&u.updateSnapshot();const d=kt(),f=u.measurePageBox();ss(d,f),ty(o,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return qn(this.latestValues)&&ty(o,this.latestValues),o}setTargetDelta(l){this.targetDelta=l,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(l){this.options={...this.options,...l,crossfade:l.crossfade!==void 0?l.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==sr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(l=!1){var o;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(l||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:f,layoutId:h}=this.options;if(!(!this.layout||!(f||h))){if(this.resolvedRelativeTargetAt=sr.timestamp,!this.targetDelta&&!this.relativeTarget){const x=this.getClosestProjectingParent();x&&x.layout&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=kt(),this.relativeTargetOrigin=kt(),Io(this.relativeTargetOrigin,this.layout.layoutBox,x.layout.layoutBox),ss(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=kt(),this.targetWithTransforms=kt()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),QE(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ss(this.target,this.layout.layoutBox),Zj(this.target,this.targetDelta)):ss(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const x=this.getClosestProjectingParent();x&&!!x.resumingFrom==!!this.resumingFrom&&!x.options.layoutScroll&&x.target&&this.animationProgress!==1?(this.relativeParent=x,this.forceRelativeParentToResolveTarget(),this.relativeTarget=kt(),this.relativeTargetOrigin=kt(),Io(this.relativeTargetOrigin,this.target,x.target),ss(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Yn.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||wm(this.parent.latestValues)||Jj(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var l;const o=this.getLead(),c=!!this.resumingFrom||this!==o;let u=!0;if((this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===sr.timestamp&&(u=!1),u)return;const{layout:d,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||f))return;ss(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,x=this.treeScale.y;iA(this.layoutCorrected,this.treeScale,this.path,c),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox);const{target:m}=o;if(!m){this.projectionTransform&&(this.projectionDelta=ol(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=ol(),this.projectionDeltaWithTransform=ol());const p=this.projectionTransform;Do(this.projectionDelta,this.layoutCorrected,m,this.latestValues),this.projectionTransform=ay(this.projectionDelta,this.treeScale),(this.projectionTransform!==p||this.treeScale.x!==h||this.treeScale.y!==x)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",m)),Yn.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(l=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),l){const o=this.getStack();o&&o.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(l,o=!1){const c=this.snapshot,u=c?c.latestValues:{},d={...this.latestValues},f=ol();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const h=kt(),x=c?c.source:void 0,m=this.layout?this.layout.source:void 0,p=x!==m,w=this.getStack(),b=!w||w.members.length<=1,g=!!(p&&!b&&this.options.crossfade===!0&&!this.path.some(YA));this.animationProgress=0;let y;this.mixTargetDelta=j=>{const A=j/1e3;cy(f.x,l.x,A),cy(f.y,l.y,A),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Io(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),qA(this.relativeTarget,this.relativeTargetOrigin,h,A),y&&SA(this.relativeTarget,y)&&(this.isProjectionDirty=!1),y||(y=kt()),ss(y,this.relativeTarget)),p&&(this.animationValues=d,wA(d,u,this.latestValues,A,g,b)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=A},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(l){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(La(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Je.update(()=>{cd.hasAnimatedSinceResize=!0,this.currentAnimation=PA(0,iy,{...l,onUpdate:o=>{this.mixTargetDelta(o),l.onUpdate&&l.onUpdate(o)},onComplete:()=>{l.onComplete&&l.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const l=this.getStack();l&&l.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(iy),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const l=this.getLead();let{targetWithTransforms:o,target:c,layout:u,latestValues:d}=l;if(!(!o||!c||!u)){if(this!==l&&this.layout&&u&&oN(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||kt();const f=Xr(this.layout.layoutBox.x);c.x.min=l.target.x.min,c.x.max=c.x.min+f;const h=Xr(this.layout.layoutBox.y);c.y.min=l.target.y.min,c.y.max=c.y.min+h}ss(o,c),cl(o,d),Do(this.projectionDeltaWithTransform,this.layoutCorrected,o,d)}}registerSharedNode(l,o){this.sharedNodes.has(l)||this.sharedNodes.set(l,new CA),this.sharedNodes.get(l).add(o);const u=o.options.initialPromotionConfig;o.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(o):void 0})}isLead(){const l=this.getStack();return l?l.lead===this:!0}getLead(){var l;const{layoutId:o}=this.options;return o?((l=this.getStack())===null||l===void 0?void 0:l.lead)||this:this}getPrevLead(){var l;const{layoutId:o}=this.options;return o?(l=this.getStack())===null||l===void 0?void 0:l.prevLead:void 0}getStack(){const{layoutId:l}=this.options;if(l)return this.root.sharedNodes.get(l)}promote({needsReset:l,transition:o,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),l&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const l=this.getStack();return l?l.relegate(this):!1}resetRotation(){const{visualElement:l}=this.options;if(!l)return;let o=!1;const{latestValues:c}=l;if((c.rotate||c.rotateX||c.rotateY||c.rotateZ)&&(o=!0),!o)return;const u={};for(let d=0;d<ny.length;d++){const f="rotate"+ny[d];c[f]&&(u[f]=c[f],l.setStaticValue(f,0))}l.render();for(const d in u)l.setStaticValue(d,u[d]);l.scheduleRender()}getProjectionStyles(l){var o,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return DA;const u={visibility:""},d=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=od(l==null?void 0:l.pointerEvents)||"",u.transform=d?d(this.latestValues,""):"none",u;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const p={};return this.options.layoutId&&(p.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,p.pointerEvents=od(l==null?void 0:l.pointerEvents)||""),this.hasProjected&&!qn(this.latestValues)&&(p.transform=d?d({},""):"none",this.hasProjected=!1),p}const h=f.animationValues||f.latestValues;this.applyTransformsToTarget(),u.transform=ay(this.projectionDeltaWithTransform,this.treeScale,h),d&&(u.transform=d(h,u.transform));const{x,y:m}=this.projectionDelta;u.transformOrigin=`${x.origin*100}% ${m.origin*100}% 0`,f.animationValues?u.opacity=f===this?(c=(o=h.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:u.opacity=f===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const p in Ud){if(h[p]===void 0)continue;const{correct:w,applyTo:b}=Ud[p],g=u.transform==="none"?h[p]:w(h[p],f);if(b){const y=b.length;for(let j=0;j<y;j++)u[b[j]]=g}else u[p]=g}return this.options.layoutId&&(u.pointerEvents=f===this?od(l==null?void 0:l.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(l=>{var o;return(o=l.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(ly),this.root.sharedNodes.clear()}}}function OA(e){e.updateLayout()}function MA(e){var t;const r=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&r&&e.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:n}=e.layout,{animationType:i}=e.options,l=r.source!==e.layout.source;i==="size"?is(f=>{const h=l?r.measuredBox[f]:r.layoutBox[f],x=Xr(h);h.min=s[f].min,h.max=h.min+x}):oN(i,r.layoutBox,s)&&is(f=>{const h=l?r.measuredBox[f]:r.layoutBox[f],x=Xr(s[f]);h.max=h.min+x,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[f].max=e.relativeTarget[f].min+x)});const o=ol();Do(o,s,r.layoutBox);const c=ol();l?Do(c,e.applyTransform(n,!0),r.measuredBox):Do(c,s,r.layoutBox);const u=!nN(o);let d=!1;if(!e.resumeFrom){const f=e.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:h,layout:x}=f;if(h&&x){const m=kt();Io(m,r.layoutBox,h.layoutBox);const p=kt();Io(p,s,x.layoutBox),iN(m,p)||(d=!0),f.options.layoutRoot&&(e.relativeTarget=p,e.relativeTargetOrigin=m,e.relativeParent=f)}}}e.notifyListeners("didUpdate",{layout:s,snapshot:r,delta:c,layoutDelta:o,hasLayoutChanged:u,hasRelativeTargetChanged:d})}else if(e.isLead()){const{onExitComplete:s}=e.options;s&&s()}e.options.transition=void 0}function LA(e){Yn.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function BA(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function UA(e){e.clearSnapshot()}function ly(e){e.clearMeasurements()}function $A(e){e.isLayoutDirty=!1}function VA(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function oy(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function zA(e){e.resolveTargetDelta()}function HA(e){e.calcProjection()}function WA(e){e.resetRotation()}function GA(e){e.removeLeadSnapshot()}function cy(e,t,r){e.translate=dt(t.translate,0,r),e.scale=dt(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function uy(e,t,r,s){e.min=dt(t.min,r.min,s),e.max=dt(t.max,r.max,s)}function qA(e,t,r,s){uy(e.x,t.x,r.x,s),uy(e.y,t.y,r.y,s)}function YA(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const KA={duration:.45,ease:[.4,0,.1,1]},dy=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),fy=dy("applewebkit/")&&!dy("chrome/")?Math.round:jt;function hy(e){e.min=fy(e.min),e.max=fy(e.max)}function XA(e){hy(e.x),hy(e.y)}function oN(e,t,r){return e==="position"||e==="preserve-aspect"&&!ym(sy(t),sy(r),.2)}const QA=lN({attachResizeListener:(e,t)=>ka(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Hf={current:void 0},cN=lN({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!Hf.current){const e=new QA({});e.mount(window),e.setOptions({layoutScroll:!0}),Hf.current=e}return Hf.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),JA={pan:{Feature:mA},drag:{Feature:hA,ProjectionNode:cN,MeasureLayout:rN}},ZA=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function e6(e){const t=ZA.exec(e);if(!t)return[,];const[,r,s]=t;return[r,s]}function jm(e,t,r=1){const[s,n]=e6(e);if(!s)return;const i=window.getComputedStyle(t).getPropertyValue(s);if(i){const l=i.trim();return Wj(l)?parseFloat(l):l}else return dm(n)?jm(n,t,r+1):n}function t6(e,{...t},r){const s=e.current;if(!(s instanceof Element))return{target:t,transitionEnd:r};r&&(r={...r}),e.values.forEach(n=>{const i=n.get();if(!dm(i))return;const l=jm(i,s);l&&n.set(l)});for(const n in t){const i=t[n];if(!dm(i))continue;const l=jm(i,s);l&&(t[n]=l,r||(r={}),r[n]===void 0&&(r[n]=i))}return{target:t,transitionEnd:r}}const r6=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),uN=e=>r6.has(e),s6=e=>Object.keys(e).some(uN),my=e=>e===Di||e===je,py=(e,t)=>parseFloat(e.split(", ")[t]),xy=(e,t)=>(r,{transform:s})=>{if(s==="none"||!s)return 0;const n=s.match(/^matrix3d\((.+)\)$/);if(n)return py(n[1],t);{const i=s.match(/^matrix\((.+)\)$/);return i?py(i[1],e):0}},a6=new Set(["x","y","z"]),n6=Lc.filter(e=>!a6.has(e));function i6(e){const t=[];return n6.forEach(r=>{const s=e.getValue(r);s!==void 0&&(t.push([r,s.get()]),s.set(r.startsWith("scale")?1:0))}),t.length&&e.render(),t}const Ol={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:xy(4,13),y:xy(5,14)};Ol.translateX=Ol.x;Ol.translateY=Ol.y;const l6=(e,t,r)=>{const s=t.measureViewportBox(),n=t.current,i=getComputedStyle(n),{display:l}=i,o={};l==="none"&&t.setStaticValue("display",e.display||"block"),r.forEach(u=>{o[u]=Ol[u](s,i)}),t.render();const c=t.measureViewportBox();return r.forEach(u=>{const d=t.getValue(u);d&&d.jump(o[u]),e[u]=Ol[u](c,i)}),e},o6=(e,t,r={},s={})=>{t={...t},s={...s};const n=Object.keys(t).filter(uN);let i=[],l=!1;const o=[];if(n.forEach(c=>{const u=e.getValue(c);if(!e.hasValue(c))return;let d=r[c],f=co(d);const h=t[c];let x;if(Vd(h)){const m=h.length,p=h[0]===null?1:0;d=h[p],f=co(d);for(let w=p;w<m&&h[w]!==null;w++)x?Qp(co(h[w])===x):x=co(h[w])}else x=co(h);if(f!==x)if(my(f)&&my(x)){const m=u.get();typeof m=="string"&&u.set(parseFloat(m)),typeof h=="string"?t[c]=parseFloat(h):Array.isArray(h)&&x===je&&(t[c]=h.map(parseFloat))}else f!=null&&f.transform&&(x!=null&&x.transform)&&(d===0||h===0)?d===0?u.set(x.transform(d)):t[c]=f.transform(h):(l||(i=i6(e),l=!0),o.push(c),s[c]=s[c]!==void 0?s[c]:t[c],u.jump(h))}),o.length){const c=o.indexOf("height")>=0?window.pageYOffset:null,u=l6(t,e,o);return i.length&&i.forEach(([d,f])=>{e.getValue(d).set(f)}),e.render(),O0&&c!==null&&window.scrollTo({top:c}),{target:u,transitionEnd:s}}else return{target:t,transitionEnd:s}};function c6(e,t,r,s){return s6(t)?o6(e,t,r,s):{target:t,transitionEnd:s}}const u6=(e,t,r,s)=>{const n=t6(e,t,s);return t=n.target,s=n.transitionEnd,c6(e,t,r,s)},Nm={current:null},dN={current:!1};function d6(){if(dN.current=!0,!!O0)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>Nm.current=e.matches;e.addListener(t),t()}else Nm.current=!1}function f6(e,t,r){const{willChange:s}=t;for(const n in t){const i=t[n],l=r[n];if(Br(i))e.addValue(n,i),Gd(s)&&s.add(n);else if(Br(l))e.addValue(n,Il(i,{owner:e})),Gd(s)&&s.remove(n);else if(l!==i)if(e.hasValue(n)){const o=e.getValue(n);!o.hasAnimated&&o.set(i)}else{const o=e.getStaticValue(n);e.addValue(n,Il(o!==void 0?o:i,{owner:e}))}}for(const n in r)t[n]===void 0&&e.removeValue(n);return t}const gy=new WeakMap,fN=Object.keys(hc),h6=fN.length,yy=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],m6=Vp.length;class p6{constructor({parent:t,props:r,presenceContext:s,reducedMotionConfig:n,visualState:i},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>Je.render(this.render,!1,!0);const{latestValues:o,renderState:c}=i;this.latestValues=o,this.baseTarget={...o},this.initialValues=r.initial?{...o}:{},this.renderState=c,this.parent=t,this.props=r,this.presenceContext=s,this.depth=t?t.depth+1:0,this.reducedMotionConfig=n,this.options=l,this.isControllingVariants=L0(r),this.isVariantNode=Xb(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(r,{});for(const f in d){const h=d[f];o[f]!==void 0&&Br(h)&&(h.set(o[f],!1),Gd(u)&&u.add(f))}}scrapeMotionValuesFromProps(t,r){return{}}mount(t){this.current=t,gy.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,s)=>this.bindToMotionValue(s,r)),dN.current||d6(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Nm.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){gy.delete(this.current),this.projection&&this.projection.unmount(),La(this.notifyUpdate),La(this.render),this.valueSubscriptions.forEach(t=>t()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,r){const s=Pi.has(t),n=r.on("change",l=>{this.latestValues[t]=l,this.props.onUpdate&&Je.update(this.notifyUpdate,!1,!0),s&&this.projection&&(this.projection.isTransformDirty=!0)}),i=r.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,()=>{n(),i()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}loadFeatures({children:t,...r},s,n,i){let l,o;for(let c=0;c<h6;c++){const u=fN[c],{isEnabled:d,Feature:f,ProjectionNode:h,MeasureLayout:x}=hc[u];h&&(l=h),d(r)&&(!this.features[u]&&f&&(this.features[u]=new f(this)),x&&(o=x))}if((this.type==="html"||this.type==="svg")&&!this.projection&&l){this.projection=new l(this.latestValues,this.parent&&this.parent.projection);const{layoutId:c,layout:u,drag:d,dragConstraints:f,layoutScroll:h,layoutRoot:x}=r;this.projection.setOptions({layoutId:c,layout:u,alwaysMeasureLayout:!!d||f&&il(f),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof u=="string"?u:"both",initialPromotionConfig:i,layoutScroll:h,layoutRoot:x})}return o}updateFeatures(){for(const t in this.features){const r=this.features[t];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):kt()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}makeTargetAnimatable(t,r=!0){return this.makeTargetAnimatableFromInstance(t,this.props,r)}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let s=0;s<yy.length;s++){const n=yy[s];this.propEventSubscriptions[n]&&(this.propEventSubscriptions[n](),delete this.propEventSubscriptions[n]);const i=t["on"+n];i&&(this.propEventSubscriptions[n]=this.on(n,i))}this.prevMotionValues=f6(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const s=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(s.initial=this.props.initial),s}const r={};for(let s=0;s<m6;s++){const n=Vp[s],i=this.props[n];(fc(i)||i===!1)&&(r[n]=i)}return r}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){r!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,r)),this.values.set(t,r),this.latestValues[t]=r.get()}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let s=this.values.get(t);return s===void 0&&r!==void 0&&(s=Il(r,{owner:this}),this.addValue(t,s)),s}readValue(t){var r;return this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(r=this.getBaseTargetFromProps(this.props,t))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,t,this.options)}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var r;const{initial:s}=this.props,n=typeof s=="string"||typeof s=="object"?(r=Xp(this.props,s))===null||r===void 0?void 0:r[t]:void 0;if(s&&n!==void 0)return n;const i=this.getBaseTargetFromProps(this.props,t);return i!==void 0&&!Br(i)?i:this.initialValues[t]!==void 0&&n===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new ix),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}}class hN extends p6{sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:s}){delete r[t],delete s[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:r,...s},{transformValues:n},i){let l=RE(s,t||{},this);if(n&&(r&&(r=n(r)),s&&(s=n(s)),l&&(l=n(l))),i){AE(this,s,l);const o=u6(this,s,l,r);r=o.transitionEnd,s=o.target}return{transition:t,transitionEnd:r,...s}}}function x6(e){return window.getComputedStyle(e)}class g6 extends hN{constructor(){super(...arguments),this.type="html"}readValueFromInstance(t,r){if(Pi.has(r)){const s=tx(r);return s&&s.default||0}else{const s=x6(t),n=(ej(r)?s.getPropertyValue(r):s[r])||0;return typeof n=="string"?n.trim():n}}measureInstanceViewportBox(t,{transformPagePoint:r}){return eN(t,r)}build(t,r,s,n){Wp(t,r,s,n.transformTemplate)}scrapeMotionValuesFromProps(t,r){return Kp(t,r)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Br(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}renderInstance(t,r,s,n){ij(t,r,s,n)}}class y6 extends hN{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(Pi.has(r)){const s=tx(r);return s&&s.default||0}return r=lj.has(r)?r:Up(r),t.getAttribute(r)}measureInstanceViewportBox(){return kt()}scrapeMotionValuesFromProps(t,r){return cj(t,r)}build(t,r,s,n){qp(t,r,s,this.isSVGTag,n.transformTemplate)}renderInstance(t,r,s,n){oj(t,r,s,n)}mount(t){this.isSVGTag=Yp(t.tagName),super.mount(t)}}const v6=(e,t)=>Hp(e)?new y6(t,{enableHardwareAcceleration:!1}):new g6(t,{enableHardwareAcceleration:!0}),w6={layout:{ProjectionNode:cN,MeasureLayout:rN}},b6={...qE,...hT,...JA,...w6},z=j3((e,t)=>eT(e,t,b6,v6));function mN(){const e=C.useRef(!1);return Bp(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function j6(){const e=mN(),[t,r]=C.useState(0),s=C.useCallback(()=>{e.current&&r(t+1)},[t]);return[C.useCallback(()=>Je.postRender(s),[s]),t]}class N6 extends C.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const s=this.props.sizeRef.current;s.height=r.offsetHeight||0,s.width=r.offsetWidth||0,s.top=r.offsetTop,s.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function _6({children:e,isPresent:t}){const r=C.useId(),s=C.useRef(null),n=C.useRef({width:0,height:0,top:0,left:0});return C.useInsertionEffect(()=>{const{width:i,height:l,top:o,left:c}=n.current;if(t||!s.current||!i||!l)return;s.current.dataset.motionPopId=r;const u=document.createElement("style");return document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${l}px !important;
            top: ${o}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[t]),C.createElement(N6,{isPresent:t,childRef:s,sizeRef:n},C.cloneElement(e,{ref:s}))}const Wf=({children:e,initial:t,isPresent:r,onExitComplete:s,custom:n,presenceAffectsLayout:i,mode:l})=>{const o=uj(k6),c=C.useId(),u=C.useMemo(()=>({id:c,initial:t,isPresent:r,custom:n,onExitComplete:d=>{o.set(d,!0);for(const f of o.values())if(!f)return;s&&s()},register:d=>(o.set(d,!1),()=>o.delete(d))}),i?void 0:[r]);return C.useMemo(()=>{o.forEach((d,f)=>o.set(f,!1))},[r]),C.useEffect(()=>{!r&&!o.size&&s&&s()},[r]),l==="popLayout"&&(e=C.createElement(_6,{isPresent:r},e)),C.createElement(I0.Provider,{value:u},e)};function k6(){return new Map}function S6(e){return C.useEffect(()=>()=>e(),[])}const Kn=e=>e.key||"";function C6(e,t){e.forEach(r=>{const s=Kn(r);t.set(s,r)})}function T6(e){const t=[];return C.Children.forEach(e,r=>{C.isValidElement(r)&&t.push(r)}),t}const Xe=({children:e,custom:t,initial:r=!0,onExitComplete:s,exitBeforeEnter:n,presenceAffectsLayout:i=!0,mode:l="sync"})=>{const o=C.useContext(zp).forceRender||j6()[0],c=mN(),u=T6(e);let d=u;const f=C.useRef(new Map).current,h=C.useRef(d),x=C.useRef(new Map).current,m=C.useRef(!0);if(Bp(()=>{m.current=!1,C6(u,x),h.current=d}),S6(()=>{m.current=!0,x.clear(),f.clear()}),m.current)return C.createElement(C.Fragment,null,d.map(g=>C.createElement(Wf,{key:Kn(g),isPresent:!0,initial:r?void 0:!1,presenceAffectsLayout:i,mode:l},g)));d=[...d];const p=h.current.map(Kn),w=u.map(Kn),b=p.length;for(let g=0;g<b;g++){const y=p[g];w.indexOf(y)===-1&&!f.has(y)&&f.set(y,void 0)}return l==="wait"&&f.size&&(d=[]),f.forEach((g,y)=>{if(w.indexOf(y)!==-1)return;const j=x.get(y);if(!j)return;const A=p.indexOf(y);let k=g;if(!k){const v=()=>{f.delete(y);const E=Array.from(x.keys()).filter(S=>!w.includes(S));if(E.forEach(S=>x.delete(S)),h.current=u.filter(S=>{const N=Kn(S);return N===y||E.includes(N)}),!f.size){if(c.current===!1)return;o(),s&&s()}};k=C.createElement(Wf,{key:Kn(j),isPresent:!1,onExitComplete:v,custom:t,presenceAffectsLayout:i,mode:l},j),f.set(y,k)}d.splice(A,0,k)}),d=d.map(g=>{const y=g.key;return f.has(y)?g:C.createElement(Wf,{key:Kn(g),isPresent:!0,presenceAffectsLayout:i,mode:l},g)}),C.createElement(C.Fragment,null,f.size?d:d.map(g=>C.cloneElement(g)))};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var E6={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A6=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),oe=(e,t)=>{const r=C.forwardRef(({color:s="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:o="",children:c,...u},d)=>C.createElement("svg",{ref:d,...E6,width:n,height:n,stroke:s,strokeWidth:l?Number(i)*24/Number(n):i,className:["lucide",`lucide-${A6(e)}`,o].join(" "),...u},[...t.map(([f,h])=>C.createElement(f,h)),...Array.isArray(c)?c:[c]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yd=oe("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=oe("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=oe("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qr=oe("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=oe("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F6=oe("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=oe("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kd=oe("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=oe("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R6=oe("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=oe("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lx=oe("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=oe("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jr=oe("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=oe("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=oe("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xd=oe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pN=oe("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fa=oe("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ox=oe("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P6=oe("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D6=oe("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=oe("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I6=oe("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wl=oe("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O6=oe("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Or=oe("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=oe("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M6=oe("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xN=oe("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cr=oe("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V0=oe("FileCheck",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pc=oe("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=oe("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cx=oe("File",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L6=oe("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pi=oe("FlaskConical",[["path",{d:"M10 2v7.527a2 2 0 0 1-.211.896L4.72 20.55a1 1 0 0 0 .9 1.45h12.76a1 1 0 0 0 .9-1.45l-5.069-10.127A2 2 0 0 1 14 9.527V2",key:"pzvekw"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M7 16h10",key:"wp8him"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xc=oe("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B6=oe("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U6=oe("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $6=oe("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V6=oe("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qd=oe("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z0=oe("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z6=oe("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H6=oe("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ud=oe("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gN=oe("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aa=oe("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W6=oe("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=oe("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G6=oe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ua=oe("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q6=oe("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y6=oe("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K6=oe("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ux=oe("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H0=oe("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X6=oe("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vy=oe("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q6=oe("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J6=oe("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z6=oe("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=oe("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eF=oe("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yN=oe("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tF=oe("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rF=oe("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sF=oe("PlugZap",[["path",{d:"M6.3 20.3a2.4 2.4 0 0 0 3.4 0L12 18l-6-6-2.3 2.3a2.4 2.4 0 0 0 0 3.4Z",key:"goz73y"}],["path",{d:"m2 22 3-3",key:"19mgm9"}],["path",{d:"M7.5 13.5 10 11",key:"7xgeeb"}],["path",{d:"M10.5 16.5 13 14",key:"10btkg"}],["path",{d:"m18 3-4 4h6l-4 4",key:"16psg9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=oe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aF=oe("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wy=oe("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=oe("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vN=oe("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=oe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vc=oe("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nF=oe("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gc=oe("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iF=oe("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yc=oe("ShieldAlert",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lF=oe("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=oe("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vc=oe("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oF=oe("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ml=oe("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ii=oe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W0=oe("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=oe("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cF=oe("UploadCloud",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m16 16-4-4-4 4",key:"119tzi"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=oe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const by=oe("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dx=oe("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ha=oe("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=oe("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tn=oe("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ur=oe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _i=oe("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function wN(e,t){return function(){return e.apply(t,arguments)}}const{toString:uF}=Object.prototype,{getPrototypeOf:fx}=Object,{iterator:G0,toStringTag:bN}=Symbol,q0=(e=>t=>{const r=uF.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Ws=e=>(e=e.toLowerCase(),t=>q0(t)===e),Y0=e=>t=>typeof t===e,{isArray:Gl}=Array,Ll=Y0("undefined");function zc(e){return e!==null&&!Ll(e)&&e.constructor!==null&&!Ll(e.constructor)&&Mr(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const jN=Ws("ArrayBuffer");function dF(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&jN(e.buffer),t}const fF=Y0("string"),Mr=Y0("function"),NN=Y0("number"),Hc=e=>e!==null&&typeof e=="object",hF=e=>e===!0||e===!1,dd=e=>{if(q0(e)!=="object")return!1;const t=fx(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(bN in e)&&!(G0 in e)},mF=e=>{if(!Hc(e)||zc(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},pF=Ws("Date"),xF=Ws("File"),gF=Ws("Blob"),yF=Ws("FileList"),vF=e=>Hc(e)&&Mr(e.pipe),wF=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Mr(e.append)&&((t=q0(e))==="formdata"||t==="object"&&Mr(e.toString)&&e.toString()==="[object FormData]"))},bF=Ws("URLSearchParams"),[jF,NF,_F,kF]=["ReadableStream","Request","Response","Headers"].map(Ws),SF=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Wc(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let s,n;if(typeof e!="object"&&(e=[e]),Gl(e))for(s=0,n=e.length;s<n;s++)t.call(null,e[s],s,e);else{if(zc(e))return;const i=r?Object.getOwnPropertyNames(e):Object.keys(e),l=i.length;let o;for(s=0;s<l;s++)o=i[s],t.call(null,e[o],o,e)}}function _N(e,t){if(zc(e))return null;t=t.toLowerCase();const r=Object.keys(e);let s=r.length,n;for(;s-- >0;)if(n=r[s],t===n.toLowerCase())return n;return null}const ri=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,kN=e=>!Ll(e)&&e!==ri;function _m(){const{caseless:e,skipUndefined:t}=kN(this)&&this||{},r={},s=(n,i)=>{const l=e&&_N(r,i)||i;dd(r[l])&&dd(n)?r[l]=_m(r[l],n):dd(n)?r[l]=_m({},n):Gl(n)?r[l]=n.slice():(!t||!Ll(n))&&(r[l]=n)};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&Wc(arguments[n],s);return r}const CF=(e,t,r,{allOwnKeys:s}={})=>(Wc(t,(n,i)=>{r&&Mr(n)?e[i]=wN(n,r):e[i]=n},{allOwnKeys:s}),e),TF=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),EF=(e,t,r,s)=>{e.prototype=Object.create(t.prototype,s),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},AF=(e,t,r,s)=>{let n,i,l;const o={};if(t=t||{},e==null)return t;do{for(n=Object.getOwnPropertyNames(e),i=n.length;i-- >0;)l=n[i],(!s||s(l,e,t))&&!o[l]&&(t[l]=e[l],o[l]=!0);e=r!==!1&&fx(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},FF=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const s=e.indexOf(t,r);return s!==-1&&s===r},RF=e=>{if(!e)return null;if(Gl(e))return e;let t=e.length;if(!NN(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},PF=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&fx(Uint8Array)),DF=(e,t)=>{const s=(e&&e[G0]).call(e);let n;for(;(n=s.next())&&!n.done;){const i=n.value;t.call(e,i[0],i[1])}},IF=(e,t)=>{let r;const s=[];for(;(r=e.exec(t))!==null;)s.push(r);return s},OF=Ws("HTMLFormElement"),MF=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,s,n){return s.toUpperCase()+n}),jy=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),LF=Ws("RegExp"),SN=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),s={};Wc(r,(n,i)=>{let l;(l=t(n,i,e))!==!1&&(s[i]=l||n)}),Object.defineProperties(e,s)},BF=e=>{SN(e,(t,r)=>{if(Mr(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const s=e[r];if(Mr(s)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},UF=(e,t)=>{const r={},s=n=>{n.forEach(i=>{r[i]=!0})};return Gl(e)?s(e):s(String(e).split(t)),r},$F=()=>{},VF=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function zF(e){return!!(e&&Mr(e.append)&&e[bN]==="FormData"&&e[G0])}const HF=e=>{const t=new Array(10),r=(s,n)=>{if(Hc(s)){if(t.indexOf(s)>=0)return;if(zc(s))return s;if(!("toJSON"in s)){t[n]=s;const i=Gl(s)?[]:{};return Wc(s,(l,o)=>{const c=r(l,n+1);!Ll(c)&&(i[o]=c)}),t[n]=void 0,i}}return s};return r(e,0)},WF=Ws("AsyncFunction"),GF=e=>e&&(Hc(e)||Mr(e))&&Mr(e.then)&&Mr(e.catch),CN=((e,t)=>e?setImmediate:t?((r,s)=>(ri.addEventListener("message",({source:n,data:i})=>{n===ri&&i===r&&s.length&&s.shift()()},!1),n=>{s.push(n),ri.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Mr(ri.postMessage)),qF=typeof queueMicrotask<"u"?queueMicrotask.bind(ri):typeof process<"u"&&process.nextTick||CN,YF=e=>e!=null&&Mr(e[G0]),J={isArray:Gl,isArrayBuffer:jN,isBuffer:zc,isFormData:wF,isArrayBufferView:dF,isString:fF,isNumber:NN,isBoolean:hF,isObject:Hc,isPlainObject:dd,isEmptyObject:mF,isReadableStream:jF,isRequest:NF,isResponse:_F,isHeaders:kF,isUndefined:Ll,isDate:pF,isFile:xF,isBlob:gF,isRegExp:LF,isFunction:Mr,isStream:vF,isURLSearchParams:bF,isTypedArray:PF,isFileList:yF,forEach:Wc,merge:_m,extend:CF,trim:SF,stripBOM:TF,inherits:EF,toFlatObject:AF,kindOf:q0,kindOfTest:Ws,endsWith:FF,toArray:RF,forEachEntry:DF,matchAll:IF,isHTMLForm:OF,hasOwnProperty:jy,hasOwnProp:jy,reduceDescriptors:SN,freezeMethods:BF,toObjectSet:UF,toCamelCase:MF,noop:$F,toFiniteNumber:VF,findKey:_N,global:ri,isContextDefined:kN,isSpecCompliantForm:zF,toJSONObject:HF,isAsyncFn:WF,isThenable:GF,setImmediate:CN,asap:qF,isIterable:YF};function Ee(e,t,r,s,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),s&&(this.request=s),n&&(this.response=n,this.status=n.status?n.status:null)}J.inherits(Ee,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:J.toJSONObject(this.config),code:this.code,status:this.status}}});const TN=Ee.prototype,EN={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{EN[e]={value:e}});Object.defineProperties(Ee,EN);Object.defineProperty(TN,"isAxiosError",{value:!0});Ee.from=(e,t,r,s,n,i)=>{const l=Object.create(TN);J.toFlatObject(e,l,function(d){return d!==Error.prototype},u=>u!=="isAxiosError");const o=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return Ee.call(l,o,c,r,s,n),e&&l.cause==null&&Object.defineProperty(l,"cause",{value:e,configurable:!0}),l.name=e&&e.name||"Error",i&&Object.assign(l,i),l};const KF=null;function km(e){return J.isPlainObject(e)||J.isArray(e)}function AN(e){return J.endsWith(e,"[]")?e.slice(0,-2):e}function Ny(e,t,r){return e?e.concat(t).map(function(n,i){return n=AN(n),!r&&i?"["+n+"]":n}).join(r?".":""):t}function XF(e){return J.isArray(e)&&!e.some(km)}const QF=J.toFlatObject(J,{},null,function(t){return/^is[A-Z]/.test(t)});function K0(e,t,r){if(!J.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=J.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(p,w){return!J.isUndefined(w[p])});const s=r.metaTokens,n=r.visitor||d,i=r.dots,l=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&J.isSpecCompliantForm(t);if(!J.isFunction(n))throw new TypeError("visitor must be a function");function u(m){if(m===null)return"";if(J.isDate(m))return m.toISOString();if(J.isBoolean(m))return m.toString();if(!c&&J.isBlob(m))throw new Ee("Blob is not supported. Use a Buffer instead.");return J.isArrayBuffer(m)||J.isTypedArray(m)?c&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function d(m,p,w){let b=m;if(m&&!w&&typeof m=="object"){if(J.endsWith(p,"{}"))p=s?p:p.slice(0,-2),m=JSON.stringify(m);else if(J.isArray(m)&&XF(m)||(J.isFileList(m)||J.endsWith(p,"[]"))&&(b=J.toArray(m)))return p=AN(p),b.forEach(function(y,j){!(J.isUndefined(y)||y===null)&&t.append(l===!0?Ny([p],j,i):l===null?p:p+"[]",u(y))}),!1}return km(m)?!0:(t.append(Ny(w,p,i),u(m)),!1)}const f=[],h=Object.assign(QF,{defaultVisitor:d,convertValue:u,isVisitable:km});function x(m,p){if(!J.isUndefined(m)){if(f.indexOf(m)!==-1)throw Error("Circular reference detected in "+p.join("."));f.push(m),J.forEach(m,function(b,g){(!(J.isUndefined(b)||b===null)&&n.call(t,b,J.isString(g)?g.trim():g,p,h))===!0&&x(b,p?p.concat(g):[g])}),f.pop()}}if(!J.isObject(e))throw new TypeError("data must be an object");return x(e),t}function _y(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(s){return t[s]})}function hx(e,t){this._pairs=[],e&&K0(e,this,t)}const FN=hx.prototype;FN.append=function(t,r){this._pairs.push([t,r])};FN.toString=function(t){const r=t?function(s){return t.call(this,s,_y)}:_y;return this._pairs.map(function(n){return r(n[0])+"="+r(n[1])},"").join("&")};function JF(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function RN(e,t,r){if(!t)return e;const s=r&&r.encode||JF;J.isFunction(r)&&(r={serialize:r});const n=r&&r.serialize;let i;if(n?i=n(t,r):i=J.isURLSearchParams(t)?t.toString():new hx(t,r).toString(s),i){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class ky{constructor(){this.handlers=[]}use(t,r,s){return this.handlers.push({fulfilled:t,rejected:r,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){J.forEach(this.handlers,function(s){s!==null&&t(s)})}}const PN={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ZF=typeof URLSearchParams<"u"?URLSearchParams:hx,eR=typeof FormData<"u"?FormData:null,tR=typeof Blob<"u"?Blob:null,rR={isBrowser:!0,classes:{URLSearchParams:ZF,FormData:eR,Blob:tR},protocols:["http","https","file","blob","url","data"]},mx=typeof window<"u"&&typeof document<"u",Sm=typeof navigator=="object"&&navigator||void 0,sR=mx&&(!Sm||["ReactNative","NativeScript","NS"].indexOf(Sm.product)<0),aR=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",nR=mx&&window.location.href||"http://localhost",iR=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:mx,hasStandardBrowserEnv:sR,hasStandardBrowserWebWorkerEnv:aR,navigator:Sm,origin:nR},Symbol.toStringTag,{value:"Module"})),ir={...iR,...rR};function lR(e,t){return K0(e,new ir.classes.URLSearchParams,{visitor:function(r,s,n,i){return ir.isNode&&J.isBuffer(r)?(this.append(s,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function oR(e){return J.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function cR(e){const t={},r=Object.keys(e);let s;const n=r.length;let i;for(s=0;s<n;s++)i=r[s],t[i]=e[i];return t}function DN(e){function t(r,s,n,i){let l=r[i++];if(l==="__proto__")return!0;const o=Number.isFinite(+l),c=i>=r.length;return l=!l&&J.isArray(n)?n.length:l,c?(J.hasOwnProp(n,l)?n[l]=[n[l],s]:n[l]=s,!o):((!n[l]||!J.isObject(n[l]))&&(n[l]=[]),t(r,s,n[l],i)&&J.isArray(n[l])&&(n[l]=cR(n[l])),!o)}if(J.isFormData(e)&&J.isFunction(e.entries)){const r={};return J.forEachEntry(e,(s,n)=>{t(oR(s),n,r,0)}),r}return null}function uR(e,t,r){if(J.isString(e))try{return(t||JSON.parse)(e),J.trim(e)}catch(s){if(s.name!=="SyntaxError")throw s}return(r||JSON.stringify)(e)}const Gc={transitional:PN,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const s=r.getContentType()||"",n=s.indexOf("application/json")>-1,i=J.isObject(t);if(i&&J.isHTMLForm(t)&&(t=new FormData(t)),J.isFormData(t))return n?JSON.stringify(DN(t)):t;if(J.isArrayBuffer(t)||J.isBuffer(t)||J.isStream(t)||J.isFile(t)||J.isBlob(t)||J.isReadableStream(t))return t;if(J.isArrayBufferView(t))return t.buffer;if(J.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(i){if(s.indexOf("application/x-www-form-urlencoded")>-1)return lR(t,this.formSerializer).toString();if((o=J.isFileList(t))||s.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return K0(o?{"files[]":t}:t,c&&new c,this.formSerializer)}}return i||n?(r.setContentType("application/json",!1),uR(t)):t}],transformResponse:[function(t){const r=this.transitional||Gc.transitional,s=r&&r.forcedJSONParsing,n=this.responseType==="json";if(J.isResponse(t)||J.isReadableStream(t))return t;if(t&&J.isString(t)&&(s&&!this.responseType||n)){const l=!(r&&r.silentJSONParsing)&&n;try{return JSON.parse(t,this.parseReviver)}catch(o){if(l)throw o.name==="SyntaxError"?Ee.from(o,Ee.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ir.classes.FormData,Blob:ir.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};J.forEach(["delete","get","head","post","put","patch"],e=>{Gc.headers[e]={}});const dR=J.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),fR=e=>{const t={};let r,s,n;return e&&e.split(`
`).forEach(function(l){n=l.indexOf(":"),r=l.substring(0,n).trim().toLowerCase(),s=l.substring(n+1).trim(),!(!r||t[r]&&dR[r])&&(r==="set-cookie"?t[r]?t[r].push(s):t[r]=[s]:t[r]=t[r]?t[r]+", "+s:s)}),t},Sy=Symbol("internals");function fo(e){return e&&String(e).trim().toLowerCase()}function fd(e){return e===!1||e==null?e:J.isArray(e)?e.map(fd):String(e)}function hR(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=r.exec(e);)t[s[1]]=s[2];return t}const mR=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Gf(e,t,r,s,n){if(J.isFunction(s))return s.call(this,t,r);if(n&&(t=r),!!J.isString(t)){if(J.isString(s))return t.indexOf(s)!==-1;if(J.isRegExp(s))return s.test(t)}}function pR(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,s)=>r.toUpperCase()+s)}function xR(e,t){const r=J.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(e,s+r,{value:function(n,i,l){return this[s].call(this,t,n,i,l)},configurable:!0})})}let Lr=class{constructor(t){t&&this.set(t)}set(t,r,s){const n=this;function i(o,c,u){const d=fo(c);if(!d)throw new Error("header name must be a non-empty string");const f=J.findKey(n,d);(!f||n[f]===void 0||u===!0||u===void 0&&n[f]!==!1)&&(n[f||c]=fd(o))}const l=(o,c)=>J.forEach(o,(u,d)=>i(u,d,c));if(J.isPlainObject(t)||t instanceof this.constructor)l(t,r);else if(J.isString(t)&&(t=t.trim())&&!mR(t))l(fR(t),r);else if(J.isObject(t)&&J.isIterable(t)){let o={},c,u;for(const d of t){if(!J.isArray(d))throw TypeError("Object iterator must return a key-value pair");o[u=d[0]]=(c=o[u])?J.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}l(o,r)}else t!=null&&i(r,t,s);return this}get(t,r){if(t=fo(t),t){const s=J.findKey(this,t);if(s){const n=this[s];if(!r)return n;if(r===!0)return hR(n);if(J.isFunction(r))return r.call(this,n,s);if(J.isRegExp(r))return r.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=fo(t),t){const s=J.findKey(this,t);return!!(s&&this[s]!==void 0&&(!r||Gf(this,this[s],s,r)))}return!1}delete(t,r){const s=this;let n=!1;function i(l){if(l=fo(l),l){const o=J.findKey(s,l);o&&(!r||Gf(s,s[o],o,r))&&(delete s[o],n=!0)}}return J.isArray(t)?t.forEach(i):i(t),n}clear(t){const r=Object.keys(this);let s=r.length,n=!1;for(;s--;){const i=r[s];(!t||Gf(this,this[i],i,t,!0))&&(delete this[i],n=!0)}return n}normalize(t){const r=this,s={};return J.forEach(this,(n,i)=>{const l=J.findKey(s,i);if(l){r[l]=fd(n),delete r[i];return}const o=t?pR(i):String(i).trim();o!==i&&delete r[i],r[o]=fd(n),s[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return J.forEach(this,(s,n)=>{s!=null&&s!==!1&&(r[n]=t&&J.isArray(s)?s.join(", "):s)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const s=new this(t);return r.forEach(n=>s.set(n)),s}static accessor(t){const s=(this[Sy]=this[Sy]={accessors:{}}).accessors,n=this.prototype;function i(l){const o=fo(l);s[o]||(xR(n,l),s[o]=!0)}return J.isArray(t)?t.forEach(i):i(t),this}};Lr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);J.reduceDescriptors(Lr.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(s){this[r]=s}}});J.freezeMethods(Lr);function qf(e,t){const r=this||Gc,s=t||r,n=Lr.from(s.headers);let i=s.data;return J.forEach(e,function(o){i=o.call(r,i,n.normalize(),t?t.status:void 0)}),n.normalize(),i}function IN(e){return!!(e&&e.__CANCEL__)}function ql(e,t,r){Ee.call(this,e??"canceled",Ee.ERR_CANCELED,t,r),this.name="CanceledError"}J.inherits(ql,Ee,{__CANCEL__:!0});function ON(e,t,r){const s=r.config.validateStatus;!r.status||!s||s(r.status)?e(r):t(new Ee("Request failed with status code "+r.status,[Ee.ERR_BAD_REQUEST,Ee.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function gR(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function yR(e,t){e=e||10;const r=new Array(e),s=new Array(e);let n=0,i=0,l;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),d=s[i];l||(l=u),r[n]=c,s[n]=u;let f=i,h=0;for(;f!==n;)h+=r[f++],f=f%e;if(n=(n+1)%e,n===i&&(i=(i+1)%e),u-l<t)return;const x=d&&u-d;return x?Math.round(h*1e3/x):void 0}}function vR(e,t){let r=0,s=1e3/t,n,i;const l=(u,d=Date.now())=>{r=d,n=null,i&&(clearTimeout(i),i=null),e(...u)};return[(...u)=>{const d=Date.now(),f=d-r;f>=s?l(u,d):(n=u,i||(i=setTimeout(()=>{i=null,l(n)},s-f)))},()=>n&&l(n)]}const Jd=(e,t,r=3)=>{let s=0;const n=yR(50,250);return vR(i=>{const l=i.loaded,o=i.lengthComputable?i.total:void 0,c=l-s,u=n(c),d=l<=o;s=l;const f={loaded:l,total:o,progress:o?l/o:void 0,bytes:c,rate:u||void 0,estimated:u&&o&&d?(o-l)/u:void 0,event:i,lengthComputable:o!=null,[t?"download":"upload"]:!0};e(f)},r)},Cy=(e,t)=>{const r=e!=null;return[s=>t[0]({lengthComputable:r,total:e,loaded:s}),t[1]]},Ty=e=>(...t)=>J.asap(()=>e(...t)),wR=ir.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,ir.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(ir.origin),ir.navigator&&/(msie|trident)/i.test(ir.navigator.userAgent)):()=>!0,bR=ir.hasStandardBrowserEnv?{write(e,t,r,s,n,i,l){if(typeof document>"u")return;const o=[`${e}=${encodeURIComponent(t)}`];J.isNumber(r)&&o.push(`expires=${new Date(r).toUTCString()}`),J.isString(s)&&o.push(`path=${s}`),J.isString(n)&&o.push(`domain=${n}`),i===!0&&o.push("secure"),J.isString(l)&&o.push(`SameSite=${l}`),document.cookie=o.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function jR(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function NR(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function MN(e,t,r){let s=!jR(t);return e&&(s||r==!1)?NR(e,t):t}const Ey=e=>e instanceof Lr?{...e}:e;function ki(e,t){t=t||{};const r={};function s(u,d,f,h){return J.isPlainObject(u)&&J.isPlainObject(d)?J.merge.call({caseless:h},u,d):J.isPlainObject(d)?J.merge({},d):J.isArray(d)?d.slice():d}function n(u,d,f,h){if(J.isUndefined(d)){if(!J.isUndefined(u))return s(void 0,u,f,h)}else return s(u,d,f,h)}function i(u,d){if(!J.isUndefined(d))return s(void 0,d)}function l(u,d){if(J.isUndefined(d)){if(!J.isUndefined(u))return s(void 0,u)}else return s(void 0,d)}function o(u,d,f){if(f in t)return s(u,d);if(f in e)return s(void 0,u)}const c={url:i,method:i,data:i,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:o,headers:(u,d,f)=>n(Ey(u),Ey(d),f,!0)};return J.forEach(Object.keys({...e,...t}),function(d){const f=c[d]||n,h=f(e[d],t[d],d);J.isUndefined(h)&&f!==o||(r[d]=h)}),r}const LN=e=>{const t=ki({},e);let{data:r,withXSRFToken:s,xsrfHeaderName:n,xsrfCookieName:i,headers:l,auth:o}=t;if(t.headers=l=Lr.from(l),t.url=RN(MN(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&l.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),J.isFormData(r)){if(ir.hasStandardBrowserEnv||ir.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(J.isFunction(r.getHeaders)){const c=r.getHeaders(),u=["content-type","content-length"];Object.entries(c).forEach(([d,f])=>{u.includes(d.toLowerCase())&&l.set(d,f)})}}if(ir.hasStandardBrowserEnv&&(s&&J.isFunction(s)&&(s=s(t)),s||s!==!1&&wR(t.url))){const c=n&&i&&bR.read(i);c&&l.set(n,c)}return t},_R=typeof XMLHttpRequest<"u",kR=_R&&function(e){return new Promise(function(r,s){const n=LN(e);let i=n.data;const l=Lr.from(n.headers).normalize();let{responseType:o,onUploadProgress:c,onDownloadProgress:u}=n,d,f,h,x,m;function p(){x&&x(),m&&m(),n.cancelToken&&n.cancelToken.unsubscribe(d),n.signal&&n.signal.removeEventListener("abort",d)}let w=new XMLHttpRequest;w.open(n.method.toUpperCase(),n.url,!0),w.timeout=n.timeout;function b(){if(!w)return;const y=Lr.from("getAllResponseHeaders"in w&&w.getAllResponseHeaders()),A={data:!o||o==="text"||o==="json"?w.responseText:w.response,status:w.status,statusText:w.statusText,headers:y,config:e,request:w};ON(function(v){r(v),p()},function(v){s(v),p()},A),w=null}"onloadend"in w?w.onloadend=b:w.onreadystatechange=function(){!w||w.readyState!==4||w.status===0&&!(w.responseURL&&w.responseURL.indexOf("file:")===0)||setTimeout(b)},w.onabort=function(){w&&(s(new Ee("Request aborted",Ee.ECONNABORTED,e,w)),w=null)},w.onerror=function(j){const A=j&&j.message?j.message:"Network Error",k=new Ee(A,Ee.ERR_NETWORK,e,w);k.event=j||null,s(k),w=null},w.ontimeout=function(){let j=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const A=n.transitional||PN;n.timeoutErrorMessage&&(j=n.timeoutErrorMessage),s(new Ee(j,A.clarifyTimeoutError?Ee.ETIMEDOUT:Ee.ECONNABORTED,e,w)),w=null},i===void 0&&l.setContentType(null),"setRequestHeader"in w&&J.forEach(l.toJSON(),function(j,A){w.setRequestHeader(A,j)}),J.isUndefined(n.withCredentials)||(w.withCredentials=!!n.withCredentials),o&&o!=="json"&&(w.responseType=n.responseType),u&&([h,m]=Jd(u,!0),w.addEventListener("progress",h)),c&&w.upload&&([f,x]=Jd(c),w.upload.addEventListener("progress",f),w.upload.addEventListener("loadend",x)),(n.cancelToken||n.signal)&&(d=y=>{w&&(s(!y||y.type?new ql(null,e,w):y),w.abort(),w=null)},n.cancelToken&&n.cancelToken.subscribe(d),n.signal&&(n.signal.aborted?d():n.signal.addEventListener("abort",d)));const g=gR(n.url);if(g&&ir.protocols.indexOf(g)===-1){s(new Ee("Unsupported protocol "+g+":",Ee.ERR_BAD_REQUEST,e));return}w.send(i||null)})},SR=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let s=new AbortController,n;const i=function(u){if(!n){n=!0,o();const d=u instanceof Error?u:this.reason;s.abort(d instanceof Ee?d:new ql(d instanceof Error?d.message:d))}};let l=t&&setTimeout(()=>{l=null,i(new Ee(`timeout ${t} of ms exceeded`,Ee.ETIMEDOUT))},t);const o=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),e=null)};e.forEach(u=>u.addEventListener("abort",i));const{signal:c}=s;return c.unsubscribe=()=>J.asap(o),c}},CR=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let s=0,n;for(;s<r;)n=s+t,yield e.slice(s,n),s=n},TR=async function*(e,t){for await(const r of ER(e))yield*CR(r,t)},ER=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:s}=await t.read();if(r)break;yield s}}finally{await t.cancel()}},Ay=(e,t,r,s)=>{const n=TR(e,t);let i=0,l,o=c=>{l||(l=!0,s&&s(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await n.next();if(u){o(),c.close();return}let f=d.byteLength;if(r){let h=i+=f;r(h)}c.enqueue(new Uint8Array(d))}catch(u){throw o(u),u}},cancel(c){return o(c),n.return()}},{highWaterMark:2})},Fy=64*1024,{isFunction:Ou}=J,AR=(({Request:e,Response:t})=>({Request:e,Response:t}))(J.global),{ReadableStream:Ry,TextEncoder:Py}=J.global,Dy=(e,...t)=>{try{return!!e(...t)}catch{return!1}},FR=e=>{e=J.merge.call({skipUndefined:!0},AR,e);const{fetch:t,Request:r,Response:s}=e,n=t?Ou(t):typeof fetch=="function",i=Ou(r),l=Ou(s);if(!n)return!1;const o=n&&Ou(Ry),c=n&&(typeof Py=="function"?(m=>p=>m.encode(p))(new Py):async m=>new Uint8Array(await new r(m).arrayBuffer())),u=i&&o&&Dy(()=>{let m=!1;const p=new r(ir.origin,{body:new Ry,method:"POST",get duplex(){return m=!0,"half"}}).headers.has("Content-Type");return m&&!p}),d=l&&o&&Dy(()=>J.isReadableStream(new s("").body)),f={stream:d&&(m=>m.body)};n&&["text","arrayBuffer","blob","formData","stream"].forEach(m=>{!f[m]&&(f[m]=(p,w)=>{let b=p&&p[m];if(b)return b.call(p);throw new Ee(`Response type '${m}' is not supported`,Ee.ERR_NOT_SUPPORT,w)})});const h=async m=>{if(m==null)return 0;if(J.isBlob(m))return m.size;if(J.isSpecCompliantForm(m))return(await new r(ir.origin,{method:"POST",body:m}).arrayBuffer()).byteLength;if(J.isArrayBufferView(m)||J.isArrayBuffer(m))return m.byteLength;if(J.isURLSearchParams(m)&&(m=m+""),J.isString(m))return(await c(m)).byteLength},x=async(m,p)=>{const w=J.toFiniteNumber(m.getContentLength());return w??h(p)};return async m=>{let{url:p,method:w,data:b,signal:g,cancelToken:y,timeout:j,onDownloadProgress:A,onUploadProgress:k,responseType:v,headers:E,withCredentials:S="same-origin",fetchOptions:N}=LN(m),D=t||fetch;v=v?(v+"").toLowerCase():"text";let F=SR([g,y&&y.toAbortSignal()],j),Y=null;const Q=F&&F.unsubscribe&&(()=>{F.unsubscribe()});let ae;try{if(k&&u&&w!=="get"&&w!=="head"&&(ae=await x(E,b))!==0){let W=new r(p,{method:"POST",body:b,duplex:"half"}),T;if(J.isFormData(b)&&(T=W.headers.get("content-type"))&&E.setContentType(T),W.body){const[L,B]=Cy(ae,Jd(Ty(k)));b=Ay(W.body,Fy,L,B)}}J.isString(S)||(S=S?"include":"omit");const ee=i&&"credentials"in r.prototype,fe={...N,signal:F,method:w.toUpperCase(),headers:E.normalize().toJSON(),body:b,duplex:"half",credentials:ee?S:void 0};Y=i&&new r(p,fe);let se=await(i?D(Y,N):D(p,fe));const H=d&&(v==="stream"||v==="response");if(d&&(A||H&&Q)){const W={};["status","statusText","headers"].forEach(V=>{W[V]=se[V]});const T=J.toFiniteNumber(se.headers.get("content-length")),[L,B]=A&&Cy(T,Jd(Ty(A),!0))||[];se=new s(Ay(se.body,Fy,L,()=>{B&&B(),Q&&Q()}),W)}v=v||"text";let ne=await f[J.findKey(f,v)||"text"](se,m);return!H&&Q&&Q(),await new Promise((W,T)=>{ON(W,T,{data:ne,headers:Lr.from(se.headers),status:se.status,statusText:se.statusText,config:m,request:Y})})}catch(ee){throw Q&&Q(),ee&&ee.name==="TypeError"&&/Load failed|fetch/i.test(ee.message)?Object.assign(new Ee("Network Error",Ee.ERR_NETWORK,m,Y),{cause:ee.cause||ee}):Ee.from(ee,ee&&ee.code,m,Y)}}},RR=new Map,BN=e=>{let t=e&&e.env||{};const{fetch:r,Request:s,Response:n}=t,i=[s,n,r];let l=i.length,o=l,c,u,d=RR;for(;o--;)c=i[o],u=d.get(c),u===void 0&&d.set(c,u=o?new Map:FR(t)),d=u;return u};BN();const px={http:KF,xhr:kR,fetch:{get:BN}};J.forEach(px,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Iy=e=>`- ${e}`,PR=e=>J.isFunction(e)||e===null||e===!1;function DR(e,t){e=J.isArray(e)?e:[e];const{length:r}=e;let s,n;const i={};for(let l=0;l<r;l++){s=e[l];let o;if(n=s,!PR(s)&&(n=px[(o=String(s)).toLowerCase()],n===void 0))throw new Ee(`Unknown adapter '${o}'`);if(n&&(J.isFunction(n)||(n=n.get(t))))break;i[o||"#"+l]=n}if(!n){const l=Object.entries(i).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let o=r?l.length>1?`since :
`+l.map(Iy).join(`
`):" "+Iy(l[0]):"as no adapter specified";throw new Ee("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n}const UN={getAdapter:DR,adapters:px};function Yf(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ql(null,e)}function Oy(e){return Yf(e),e.headers=Lr.from(e.headers),e.data=qf.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),UN.getAdapter(e.adapter||Gc.adapter,e)(e).then(function(s){return Yf(e),s.data=qf.call(e,e.transformResponse,s),s.headers=Lr.from(s.headers),s},function(s){return IN(s)||(Yf(e),s&&s.response&&(s.response.data=qf.call(e,e.transformResponse,s.response),s.response.headers=Lr.from(s.response.headers))),Promise.reject(s)})}const $N="1.13.2",X0={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{X0[e]=function(s){return typeof s===e||"a"+(t<1?"n ":" ")+e}});const My={};X0.transitional=function(t,r,s){function n(i,l){return"[Axios v"+$N+"] Transitional option '"+i+"'"+l+(s?". "+s:"")}return(i,l,o)=>{if(t===!1)throw new Ee(n(l," has been removed"+(r?" in "+r:"")),Ee.ERR_DEPRECATED);return r&&!My[l]&&(My[l]=!0,console.warn(n(l," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,l,o):!0}};X0.spelling=function(t){return(r,s)=>(console.warn(`${s} is likely a misspelling of ${t}`),!0)};function IR(e,t,r){if(typeof e!="object")throw new Ee("options must be an object",Ee.ERR_BAD_OPTION_VALUE);const s=Object.keys(e);let n=s.length;for(;n-- >0;){const i=s[n],l=t[i];if(l){const o=e[i],c=o===void 0||l(o,i,e);if(c!==!0)throw new Ee("option "+i+" must be "+c,Ee.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Ee("Unknown option "+i,Ee.ERR_BAD_OPTION)}}const hd={assertOptions:IR,validators:X0},Ks=hd.validators;let xi=class{constructor(t){this.defaults=t||{},this.interceptors={request:new ky,response:new ky}}async request(t,r){try{return await this._request(t,r)}catch(s){if(s instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const i=n.stack?n.stack.replace(/^.+\n/,""):"";try{s.stack?i&&!String(s.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+i):s.stack=i}catch{}}throw s}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=ki(this.defaults,r);const{transitional:s,paramsSerializer:n,headers:i}=r;s!==void 0&&hd.assertOptions(s,{silentJSONParsing:Ks.transitional(Ks.boolean),forcedJSONParsing:Ks.transitional(Ks.boolean),clarifyTimeoutError:Ks.transitional(Ks.boolean)},!1),n!=null&&(J.isFunction(n)?r.paramsSerializer={serialize:n}:hd.assertOptions(n,{encode:Ks.function,serialize:Ks.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),hd.assertOptions(r,{baseUrl:Ks.spelling("baseURL"),withXsrfToken:Ks.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let l=i&&J.merge(i.common,i[r.method]);i&&J.forEach(["delete","get","head","post","put","patch","common"],m=>{delete i[m]}),r.headers=Lr.concat(l,i);const o=[];let c=!0;this.interceptors.request.forEach(function(p){typeof p.runWhen=="function"&&p.runWhen(r)===!1||(c=c&&p.synchronous,o.unshift(p.fulfilled,p.rejected))});const u=[];this.interceptors.response.forEach(function(p){u.push(p.fulfilled,p.rejected)});let d,f=0,h;if(!c){const m=[Oy.bind(this),void 0];for(m.unshift(...o),m.push(...u),h=m.length,d=Promise.resolve(r);f<h;)d=d.then(m[f++],m[f++]);return d}h=o.length;let x=r;for(;f<h;){const m=o[f++],p=o[f++];try{x=m(x)}catch(w){p.call(this,w);break}}try{d=Oy.call(this,x)}catch(m){return Promise.reject(m)}for(f=0,h=u.length;f<h;)d=d.then(u[f++],u[f++]);return d}getUri(t){t=ki(this.defaults,t);const r=MN(t.baseURL,t.url,t.allowAbsoluteUrls);return RN(r,t.params,t.paramsSerializer)}};J.forEach(["delete","get","head","options"],function(t){xi.prototype[t]=function(r,s){return this.request(ki(s||{},{method:t,url:r,data:(s||{}).data}))}});J.forEach(["post","put","patch"],function(t){function r(s){return function(i,l,o){return this.request(ki(o||{},{method:t,headers:s?{"Content-Type":"multipart/form-data"}:{},url:i,data:l}))}}xi.prototype[t]=r(),xi.prototype[t+"Form"]=r(!0)});let OR=class VN{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const s=this;this.promise.then(n=>{if(!s._listeners)return;let i=s._listeners.length;for(;i-- >0;)s._listeners[i](n);s._listeners=null}),this.promise.then=n=>{let i;const l=new Promise(o=>{s.subscribe(o),i=o}).then(n);return l.cancel=function(){s.unsubscribe(i)},l},t(function(i,l,o){s.reason||(s.reason=new ql(i,l,o),r(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=s=>{t.abort(s)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new VN(function(n){t=n}),cancel:t}}};function MR(e){return function(r){return e.apply(null,r)}}function LR(e){return J.isObject(e)&&e.isAxiosError===!0}const Cm={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Cm).forEach(([e,t])=>{Cm[t]=e});function zN(e){const t=new xi(e),r=wN(xi.prototype.request,t);return J.extend(r,xi.prototype,t,{allOwnKeys:!0}),J.extend(r,t,null,{allOwnKeys:!0}),r.create=function(n){return zN(ki(e,n))},r}const ye=zN(Gc);ye.Axios=xi;ye.CanceledError=ql;ye.CancelToken=OR;ye.isCancel=IN;ye.VERSION=$N;ye.toFormData=K0;ye.AxiosError=Ee;ye.Cancel=ye.CanceledError;ye.all=function(t){return Promise.all(t)};ye.spread=MR;ye.isAxiosError=LR;ye.mergeConfig=ki;ye.AxiosHeaders=Lr;ye.formToJSON=e=>DN(J.isHTMLForm(e)?new FormData(e):e);ye.getAdapter=UN.getAdapter;ye.HttpStatusCode=Cm;ye.default=ye;const{Axios:PU,AxiosError:DU,CanceledError:IU,isCancel:OU,CancelToken:MU,VERSION:LU,all:BU,Cancel:UU,isAxiosError:$U,spread:VU,toFormData:zU,AxiosHeaders:HU,HttpStatusCode:WU,formToJSON:GU,getAdapter:qU,mergeConfig:YU}=ye,BR="https://portal.auraai.toroniandcompany.com/api";function UR(){const e=ze(),[t,r]=C.useState(null),[s,n]=C.useState(""),[i,l]=C.useState(""),[o,c]=C.useState(null),[u,d]=C.useState(!1),f=async x=>{var m,p;x.preventDefault(),r("email"),c(null);try{const w=await ye.post(`${BR}/auth/login`,{email:s,password:i});localStorage.setItem("access_token",w.data.access_token),w.data.refresh_token&&localStorage.setItem("refresh_token",w.data.refresh_token),w.data.user&&localStorage.setItem("user",JSON.stringify(w.data.user)),e("/firm/dashboard")}catch(w){ye.isAxiosError(w)&&((p=(m=w.response)==null?void 0:m.data)!=null&&p.detail)?c(w.response.data.detail):c("Login failed. Please check your credentials and try again."),r(null)}},h=async x=>{r(x),c("OAuth login is not yet configured. Please use email/password login."),r(null)};return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 via-white to-neutral-50 flex items-center justify-center p-4 relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 opacity-30",children:a.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`
            linear-gradient(to right, rgba(0,120,212,0.05) 1px, transparent 1px),
            linear-gradient(to bottom, rgba(0,120,212,0.05) 1px, transparent 1px)
          `,backgroundSize:"4rem 4rem"}})}),a.jsx(z.div,{className:"absolute top-20 left-20 w-64 h-64 bg-primary-200 rounded-full blur-3xl opacity-20",animate:{y:[0,30,0],scale:[1,1.1,1]},transition:{duration:8,repeat:1/0,ease:"easeInOut"}}),a.jsx(z.div,{className:"absolute bottom-20 right-20 w-80 h-80 bg-accent-200 rounded-full blur-3xl opacity-20",animate:{y:[0,-40,0],scale:[1,1.2,1]},transition:{duration:10,repeat:1/0,ease:"easeInOut"}}),a.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:[.1,.9,.2,1]},className:"w-full max-w-md relative z-10",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx(z.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{type:"spring",stiffness:200,damping:20,delay:.1},className:"inline-flex items-center justify-center w-16 h-16 bg-primary-500 rounded-fluent-lg mb-6 shadow-fluent-8",children:a.jsx(Nt,{className:"w-9 h-9 text-white"})}),a.jsx(z.h1,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2,duration:.4},className:"text-display-large text-neutral-900 mb-3 font-semibold",children:"Welcome to Aura CPA"}),a.jsx(z.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3,duration:.4},className:"text-subtitle text-neutral-600",children:"Access your professional accounting portal"})]}),a.jsxs(z.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.4,duration:.4,ease:[.1,.9,.2,1]},className:"fluent-card-elevated p-8 backdrop-blur-sm",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[a.jsx(We,{className:"w-5 h-5 text-primary-500"}),a.jsx("h2",{className:"text-title text-neutral-900",children:"Sign in securely"})]}),o&&a.jsxs(z.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-4 p-3 bg-error-50 border border-error-200 rounded-fluent flex items-center gap-2 text-error-600",children:[a.jsx(Bs,{className:"w-5 h-5 flex-shrink-0"}),a.jsx("span",{className:"text-body",children:o})]}),u?a.jsxs("form",{onSubmit:f,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-body-strong text-neutral-700 mb-2",children:"Email Address"}),a.jsxs("div",{className:"relative",children:[a.jsx(Ua,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-neutral-400"}),a.jsx("input",{id:"email",type:"email",value:s,onChange:x=>n(x.target.value),placeholder:"you@example.com",required:!0,className:"fluent-input pl-10"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-body-strong text-neutral-700 mb-2",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx($s,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-neutral-400"}),a.jsx("input",{id:"password",type:"password",value:i,onChange:x=>l(x.target.value),placeholder:"Enter your password",required:!0,className:"fluent-input pl-10"})]})]}),a.jsx("div",{className:"flex justify-end mb-2",children:a.jsx("button",{type:"button",onClick:()=>e("/forgot-password"),className:"text-caption text-primary-500 hover:text-primary-600 font-medium",children:"Forgot password?"})}),a.jsx(z.button,{type:"submit",whileHover:{scale:1.01},whileTap:{scale:.99},disabled:t==="email",className:"fluent-btn-primary w-full py-3",children:t==="email"?a.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):a.jsxs(a.Fragment,{children:["Sign In",a.jsx(fs,{className:"w-5 h-5"})]})}),a.jsx("button",{type:"button",onClick:()=>d(!1),className:"w-full text-center text-body text-primary-500 hover:text-primary-600 font-medium mt-4",children:"Back to other sign-in options"})]}):a.jsxs("div",{className:"space-y-3",children:[a.jsx(z.button,{whileHover:{scale:1.01},whileTap:{scale:.99},onClick:()=>h("microsoft"),disabled:t!==null,className:"fluent-reveal w-full flex items-center gap-4 px-5 py-4 bg-white border-2 border-neutral-200 rounded-fluent hover:border-primary-300 hover:shadow-fluent-4 active:scale-[0.98] transition-all duration-150 disabled:opacity-50 disabled:cursor-not-allowed group",children:t==="microsoft"?a.jsx("div",{className:"w-6 h-6 border-3 border-primary-500 border-t-transparent rounded-full animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"w-6 h-6 flex-shrink-0",viewBox:"0 0 23 23",children:[a.jsx("path",{fill:"#f35325",d:"M0 0h11v11H0z"}),a.jsx("path",{fill:"#81bc06",d:"M12 0h11v11H12z"}),a.jsx("path",{fill:"#05a6f0",d:"M0 12h11v11H0z"}),a.jsx("path",{fill:"#ffba08",d:"M12 12h11v11H12z"})]}),a.jsx("span",{className:"text-body-strong text-neutral-900 flex-1 text-left",children:"Continue with Microsoft 365"}),a.jsx(fs,{className:"w-5 h-5 text-neutral-400 group-hover:text-primary-500 group-hover:translate-x-1 transition-all"})]})}),a.jsx(z.button,{whileHover:{scale:1.01},whileTap:{scale:.99},onClick:()=>h("google"),disabled:t!==null,className:"fluent-reveal w-full flex items-center gap-4 px-5 py-4 bg-white border-2 border-neutral-200 rounded-fluent hover:border-primary-300 hover:shadow-fluent-4 active:scale-[0.98] transition-all duration-150 disabled:opacity-50 disabled:cursor-not-allowed group",children:t==="google"?a.jsx("div",{className:"w-6 h-6 border-3 border-primary-500 border-t-transparent rounded-full animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsxs("svg",{className:"w-6 h-6 flex-shrink-0",viewBox:"0 0 24 24",children:[a.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),a.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),a.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),a.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),a.jsx("span",{className:"text-body-strong text-neutral-900 flex-1 text-left",children:"Continue with Google Workspace"}),a.jsx(fs,{className:"w-5 h-5 text-neutral-400 group-hover:text-primary-500 group-hover:translate-x-1 transition-all"})]})}),a.jsxs("div",{className:"flex items-center gap-4 my-4",children:[a.jsx("div",{className:"flex-1 h-px bg-neutral-200"}),a.jsx("span",{className:"text-caption text-neutral-500",children:"or"}),a.jsx("div",{className:"flex-1 h-px bg-neutral-200"})]}),a.jsxs(z.button,{whileHover:{scale:1.01},whileTap:{scale:.99},onClick:()=>d(!0),className:"fluent-reveal w-full flex items-center gap-4 px-5 py-4 bg-white border-2 border-neutral-200 rounded-fluent hover:border-primary-300 hover:shadow-fluent-4 active:scale-[0.98] transition-all duration-150 group",children:[a.jsx(Ua,{className:"w-6 h-6 flex-shrink-0 text-neutral-600"}),a.jsx("span",{className:"text-body-strong text-neutral-900 flex-1 text-left",children:"Sign in with Email"}),a.jsx(fs,{className:"w-5 h-5 text-neutral-400 group-hover:text-primary-500 group-hover:translate-x-1 transition-all"})]})]}),a.jsxs("div",{className:"mt-6 pt-6 border-t border-neutral-200",children:[a.jsxs("p",{className:"text-caption text-neutral-600 text-center mb-4",children:["Don't have an account?"," ",a.jsx("button",{onClick:()=>e("/register"),className:"text-primary-500 hover:text-primary-600 font-semibold hover:underline transition-colors",children:"Create Account"})]}),a.jsxs("p",{className:"text-caption text-neutral-600 text-center leading-relaxed",children:["By signing in, you agree to our"," ",a.jsx("a",{href:"/terms",className:"text-primary-500 hover:text-primary-600 font-semibold hover:underline transition-colors",children:"Terms of Service"})," ","and"," ",a.jsx("a",{href:"/privacy",className:"text-primary-500 hover:text-primary-600 font-semibold hover:underline transition-colors",children:"Privacy Policy"})]})]})]}),a.jsx(z.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.4},className:"mt-6 text-center",children:a.jsxs("p",{className:"text-body text-neutral-600",children:["Need assistance?"," ",a.jsx("a",{href:"mailto:support@aura-cpa.com",className:"text-primary-500 hover:text-primary-600 font-semibold hover:underline transition-colors",children:"Contact Support"})]})}),a.jsxs(z.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.7,duration:.4},className:"mt-8 flex items-center justify-center gap-2 text-caption text-neutral-500",children:[a.jsx(We,{className:"w-4 h-4"}),a.jsx("span",{children:"Enterprise-grade security & compliance"})]})]})]})}const Ly="https://portal.auraai.toroniandcompany.com/api";function $R(){const e=ze(),[t,r]=C.useState(!1),[s,n]=C.useState(""),[i,l]=C.useState(""),[o,c]=C.useState(""),[u,d]=C.useState(""),[f,h]=C.useState(""),[x,m]=C.useState(null),[p,w]=C.useState("register"),b=async g=>{var y,j;if(g.preventDefault(),r(!0),m(null),!s||!i||!o||!f){m("Please fill in all required fields"),r(!1);return}if(o!==u){m("Passwords do not match"),r(!1);return}if(o.length<8){m("Password must be at least 8 characters long"),r(!1);return}try{const k=(await ye.post(`${Ly}/identity/admin/organizations`,{firm_name:f,legal_name:f,primary_contact_name:s,primary_contact_email:i,subscription_tier:"professional",subscription_status:"trial",max_users:25})).data.id;await ye.post(`${Ly}/identity/auth/register`,{email:i,password:o,full_name:s,organization_id:k,role:"partner"}),w("success")}catch(A){ye.isAxiosError(A)&&((j=(y=A.response)==null?void 0:y.data)!=null&&j.detail)?m(A.response.data.detail):m("Registration failed. Please try again."),r(!1)}};return p==="success"?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 via-white to-neutral-50 flex items-center justify-center p-4",children:a.jsx(z.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"w-full max-w-md",children:a.jsxs("div",{className:"fluent-card-elevated p-8 text-center backdrop-blur-sm",children:[a.jsx(z.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200,damping:20},className:"inline-flex items-center justify-center w-16 h-16 bg-success-500 rounded-full mb-6",children:a.jsx(Ut,{className:"w-9 h-9 text-white"})}),a.jsx("h1",{className:"text-title-large text-neutral-900 mb-3",children:"Registration Successful!"}),a.jsx("p",{className:"text-body text-neutral-600 mb-6",children:"Your account has been created. You can now sign in to access your CPA portal."}),a.jsxs("button",{onClick:()=>e("/login"),className:"fluent-btn-primary w-full",children:[a.jsx(fs,{className:"w-5 h-5"}),"Sign In Now"]})]})})}):a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 via-white to-neutral-50 flex items-center justify-center p-4 relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 opacity-30",children:a.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`
            linear-gradient(to right, rgba(0,120,212,0.05) 1px, transparent 1px),
            linear-gradient(to bottom, rgba(0,120,212,0.05) 1px, transparent 1px)
          `,backgroundSize:"4rem 4rem"}})}),a.jsx(z.div,{className:"absolute top-20 left-20 w-64 h-64 bg-primary-200 rounded-full blur-3xl opacity-20",animate:{y:[0,30,0],scale:[1,1.1,1]},transition:{duration:8,repeat:1/0,ease:"easeInOut"}}),a.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:[.1,.9,.2,1]},className:"w-full max-w-md relative z-10",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx(z.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{type:"spring",stiffness:200,damping:20,delay:.1},className:"inline-flex items-center justify-center w-16 h-16 bg-primary-500 rounded-fluent-lg mb-6 shadow-fluent-8",children:a.jsx(Nt,{className:"w-9 h-9 text-white"})}),a.jsx(z.h1,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2,duration:.4},className:"text-display-large text-neutral-900 mb-3 font-semibold",children:"Register Your Firm"}),a.jsx(z.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3,duration:.4},className:"text-subtitle text-neutral-600",children:"Create a new CPA firm account on Aura Audit AI"})]}),a.jsxs(z.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.4,duration:.4,ease:[.1,.9,.2,1]},className:"fluent-card-elevated p-8 backdrop-blur-sm",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[a.jsx(We,{className:"w-5 h-5 text-primary-500"}),a.jsx("h2",{className:"text-title text-neutral-900",children:"Register your CPA firm"})]}),x&&a.jsxs(z.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-4 p-3 bg-error-50 border border-error-200 rounded-fluent flex items-center gap-2 text-error-600",children:[a.jsx(Bs,{className:"w-5 h-5 flex-shrink-0"}),a.jsx("span",{className:"text-body",children:x})]}),a.jsxs("form",{onSubmit:b,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"organizationName",className:"block text-body-strong text-neutral-700 mb-2",children:"Firm Name *"}),a.jsxs("div",{className:"relative",children:[a.jsx(Nt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-neutral-400"}),a.jsx("input",{id:"organizationName",type:"text",value:f,onChange:g=>h(g.target.value),placeholder:"Your CPA Firm Name",required:!0,className:"fluent-input pl-10"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"fullName",className:"block text-body-strong text-neutral-700 mb-2",children:"Full Name *"}),a.jsxs("div",{className:"relative",children:[a.jsx(ha,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-neutral-400"}),a.jsx("input",{id:"fullName",type:"text",value:s,onChange:g=>n(g.target.value),placeholder:"John Smith",required:!0,className:"fluent-input pl-10"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-body-strong text-neutral-700 mb-2",children:"Email Address *"}),a.jsxs("div",{className:"relative",children:[a.jsx(Ua,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-neutral-400"}),a.jsx("input",{id:"email",type:"email",value:i,onChange:g=>l(g.target.value),placeholder:"you@yourfirm.com",required:!0,className:"fluent-input pl-10"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-body-strong text-neutral-700 mb-2",children:"Password *"}),a.jsxs("div",{className:"relative",children:[a.jsx($s,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-neutral-400"}),a.jsx("input",{id:"password",type:"password",value:o,onChange:g=>c(g.target.value),placeholder:"At least 8 characters",required:!0,className:"fluent-input pl-10"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"confirmPassword",className:"block text-body-strong text-neutral-700 mb-2",children:"Confirm Password *"}),a.jsxs("div",{className:"relative",children:[a.jsx($s,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-neutral-400"}),a.jsx("input",{id:"confirmPassword",type:"password",value:u,onChange:g=>d(g.target.value),placeholder:"Confirm your password",required:!0,className:"fluent-input pl-10"})]})]}),a.jsx(z.button,{type:"submit",whileHover:{scale:1.01},whileTap:{scale:.99},disabled:t,className:"fluent-btn-primary w-full py-3",children:t?a.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):a.jsxs(a.Fragment,{children:["Create Account",a.jsx(fs,{className:"w-5 h-5"})]})})]}),a.jsxs("div",{className:"mt-6 pt-6 border-t border-neutral-200 space-y-4",children:[a.jsxs("p",{className:"text-caption text-neutral-600 text-center",children:["Already have an account?"," ",a.jsx("button",{onClick:()=>e("/login"),className:"text-primary-500 hover:text-primary-600 font-semibold hover:underline transition-colors",children:"Sign In"})]}),a.jsx("div",{className:"p-3 bg-neutral-50 rounded-fluent border border-neutral-200",children:a.jsxs("p",{className:"text-caption text-neutral-600 text-center",children:[a.jsx("strong",{children:"Been invited to join an existing firm?"}),a.jsx("br",{}),"Check your email for an invitation link from your firm administrator."]})})]})]}),a.jsxs(z.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.7,duration:.4},className:"mt-8 flex items-center justify-center gap-2 text-caption text-neutral-500",children:[a.jsx(We,{className:"w-4 h-4"}),a.jsx("span",{children:"Enterprise-grade security & compliance"})]})]})]})}const By="https://portal.auraai.toroniandcompany.com/api",Mu=[{label:"At least 8 characters",test:e=>e.length>=8},{label:"One uppercase letter",test:e=>/[A-Z]/.test(e)},{label:"One lowercase letter",test:e=>/[a-z]/.test(e)},{label:"One number",test:e=>/\d/.test(e)}],Uy=e=>({partner:"Partner",manager:"Manager",senior:"Senior Associate",staff:"Staff",qc_reviewer:"QC Reviewer",client_contact:"Client Contact"})[e]||e;function VR(){const e=ze(),[t]=Mp(),r=t.get("token"),[s,n]=C.useState(!1),[i,l]=C.useState(!0),[o,c]=C.useState(""),[u,d]=C.useState(""),[f,h]=C.useState(""),[x,m]=C.useState(!1),[p,w]=C.useState(null),[b,g]=C.useState("loading"),[y,j]=C.useState(null);C.useEffect(()=>{if(!r){g("invalid"),l(!1);return}A()},[r]);const A=async()=>{var S;try{l(!0);const N=await ye.get(`${By}/identity/invitations/validate`,{params:{token:r}});j(N.data),g("form")}catch(N){ye.isAxiosError(N)&&((S=N.response)==null?void 0:S.status)===410?g("expired"):g("invalid")}finally{l(!1)}},k=async S=>{var N,D;if(S.preventDefault(),n(!0),w(null),!o.trim()){w("Please enter your full name"),n(!1);return}if(!Mu.every(F=>F.test(u))){w("Password does not meet all requirements"),n(!1);return}if(u!==f){w("Passwords do not match"),n(!1);return}try{const F=await ye.post(`${By}/identity/invitations/accept`,{token:r,full_name:o.trim(),password:u});F.data.access_token&&(localStorage.setItem("access_token",F.data.access_token),F.data.user&&localStorage.setItem("user",JSON.stringify(F.data.user))),g("success")}catch(F){ye.isAxiosError(F)&&((D=(N=F.response)==null?void 0:N.data)!=null&&D.detail)?w(F.response.data.detail):w("Failed to create account. Please try again."),n(!1)}},E=(()=>{const S=Mu.filter(N=>N.test(u)).length;return S===0?{level:0,label:"",color:""}:S===1?{level:1,label:"Weak",color:"bg-red-500"}:S===2?{level:2,label:"Fair",color:"bg-orange-500"}:S===3?{level:3,label:"Good",color:"bg-yellow-500"}:{level:4,label:"Strong",color:"bg-green-500"}})();return i||b==="loading"?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-gray-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Aa,{className:"w-12 h-12 text-blue-500 animate-spin mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Validating your invitation..."})]})}):b==="invalid"?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-gray-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"w-full max-w-md bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-red-100 rounded-full mb-6",children:a.jsx(ur,{className:"w-9 h-9 text-red-500"})}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Invalid Invitation"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"This invitation link is invalid or has already been used. Please contact the person who invited you to request a new invitation."}),a.jsx("button",{onClick:()=>e("/login"),className:"btn-secondary w-full",children:"Go to Login"})]})}):b==="expired"?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-gray-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"w-full max-w-md bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-yellow-100 rounded-full mb-6",children:a.jsx(nt,{className:"w-9 h-9 text-yellow-600"})}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Invitation Expired"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"This invitation has expired. Invitations are valid for 7 days. Please contact the person who invited you to request a new invitation."}),a.jsx("button",{onClick:()=>e("/login"),className:"btn-secondary w-full",children:"Go to Login"})]})}):b==="success"?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-gray-50 flex items-center justify-center p-4",children:a.jsx(z.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"w-full max-w-md",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx(z.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200,damping:20},className:"inline-flex items-center justify-center w-16 h-16 bg-green-500 rounded-full mb-6",children:a.jsx(Ut,{className:"w-9 h-9 text-white"})}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Welcome to the Team!"}),a.jsx("p",{className:"text-gray-600 mb-2",children:"Your account has been created successfully."}),y&&a.jsxs("p",{className:"text-gray-600 mb-6",children:["You've joined ",a.jsx("strong",{children:y.organization_name})," as a ",a.jsx("strong",{children:Uy(y.role)}),"."]}),a.jsxs("button",{onClick:()=>e("/firm/dashboard"),className:"btn-primary w-full flex items-center justify-center gap-2",children:[a.jsx(fs,{className:"w-5 h-5"}),"Go to Dashboard"]})]})})}):a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-gray-50 flex items-center justify-center p-4",children:a.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-lg",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-green-500 rounded-xl mb-6 shadow-lg",children:a.jsx(dx,{className:"w-9 h-9 text-white"})}),a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-3",children:"Join Your Team"}),a.jsx("p",{className:"text-gray-600",children:"Complete your account setup to get started"})]}),y&&a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 mb-6",children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(Nt,{className:"w-5 h-5 text-white"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm text-gray-700",children:"You've been invited to join"}),a.jsx("p",{className:"text-lg font-semibold text-blue-700",children:y.organization_name}),a.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-600",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(We,{className:"w-4 h-4"}),Uy(y.role)]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Ua,{className:"w-4 h-4"}),y.email]})]})]})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[a.jsx(We,{className:"w-5 h-5 text-blue-500"}),a.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Create Your Account"})]}),p&&a.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2 text-red-600",children:[a.jsx(Bs,{className:"w-5 h-5 flex-shrink-0"}),a.jsx("span",{children:p})]}),a.jsxs("form",{onSubmit:k,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name *"}),a.jsxs("div",{className:"relative",children:[a.jsx(ha,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",value:o,onChange:S=>c(S.target.value),placeholder:"John Smith",required:!0,className:"input-field pl-10"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Create Password *"}),a.jsxs("div",{className:"relative",children:[a.jsx($s,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:x?"text":"password",value:u,onChange:S=>d(S.target.value),placeholder:"Create a secure password",required:!0,className:"input-field pl-10 pr-10"}),a.jsx("button",{type:"button",onClick:()=>m(!x),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:x?a.jsx(xN,{className:"w-5 h-5"}):a.jsx(cr,{className:"w-5 h-5"})})]}),u&&a.jsxs("div",{className:"mt-2",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("div",{className:"flex-1 h-1.5 bg-gray-200 rounded-full overflow-hidden",children:a.jsx("div",{className:`h-full ${E.color} transition-all`,style:{width:`${E.level/4*100}%`}})}),a.jsx("span",{className:`text-xs font-medium ${E.level<=1?"text-red-600":E.level===2?"text-orange-600":E.level===3?"text-yellow-600":"text-green-600"}`,children:E.label})]}),a.jsx("div",{className:"grid grid-cols-2 gap-1",children:Mu.map((S,N)=>a.jsxs("div",{className:"flex items-center gap-1.5",children:[S.test(u)?a.jsx(Xd,{className:"w-3.5 h-3.5 text-green-500"}):a.jsx(ur,{className:"w-3.5 h-3.5 text-gray-400"}),a.jsx("span",{className:`text-xs ${S.test(u)?"text-green-700":"text-gray-500"}`,children:S.label})]},N))})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password *"}),a.jsxs("div",{className:"relative",children:[a.jsx($s,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"password",value:f,onChange:S=>h(S.target.value),placeholder:"Confirm your password",required:!0,className:"input-field pl-10"})]}),f&&u!==f&&a.jsxs("p",{className:"mt-1 text-xs text-red-500 flex items-center gap-1",children:[a.jsx(ur,{className:"w-3.5 h-3.5"})," Passwords do not match"]}),f&&u===f&&a.jsxs("p",{className:"mt-1 text-xs text-green-600 flex items-center gap-1",children:[a.jsx(Xd,{className:"w-3.5 h-3.5"})," Passwords match"]})]}),a.jsx("button",{type:"submit",disabled:s||!Mu.every(S=>S.test(u))||u!==f,className:"btn-primary w-full py-3 flex items-center justify-center gap-2 disabled:opacity-50",children:s?a.jsx(Aa,{className:"w-5 h-5 animate-spin"}):a.jsxs(a.Fragment,{children:["Create Account & Join Team",a.jsx(fs,{className:"w-5 h-5"})]})})]}),a.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200 text-center",children:a.jsxs("p",{className:"text-sm text-gray-600",children:["Already have an account?"," ",a.jsx("button",{onClick:()=>e("/login"),className:"text-blue-500 hover:underline font-semibold",children:"Sign In"})]})})]}),a.jsxs("div",{className:"mt-6 flex items-center justify-center gap-2 text-sm text-gray-500",children:[a.jsx(We,{className:"w-4 h-4"}),a.jsx("span",{children:"Enterprise-grade security & SOC 2 compliant"})]})]})})}const zR="https://portal.auraai.toroniandcompany.com/api";function HR(){const e=ze(),[t,r]=C.useState(""),[s,n]=C.useState(!1),[i,l]=C.useState(!1),[o,c]=C.useState(null),u=async d=>{d.preventDefault(),n(!0),c(null);try{await ye.post(`${zR}/auth/forgot-password`,{email:t}),l(!0)}catch{l(!0)}finally{n(!1)}};return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 via-white to-neutral-50 flex items-center justify-center p-4 relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 opacity-30",children:a.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`
            linear-gradient(to right, rgba(0,120,212,0.05) 1px, transparent 1px),
            linear-gradient(to bottom, rgba(0,120,212,0.05) 1px, transparent 1px)
          `,backgroundSize:"4rem 4rem"}})}),a.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:[.1,.9,.2,1]},className:"w-full max-w-md relative z-10",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx(z.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200,damping:20},className:"inline-flex items-center justify-center w-16 h-16 bg-primary-500 rounded-fluent-lg mb-6 shadow-fluent-8",children:a.jsx(Nt,{className:"w-9 h-9 text-white"})}),a.jsx("h1",{className:"text-display text-neutral-900 mb-3 font-semibold",children:"Reset Password"}),a.jsx("p",{className:"text-body text-neutral-600",children:"Enter your email to receive a password reset link"})]}),a.jsx(z.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.2},className:"fluent-card-elevated p-8",children:i?a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-success-50 rounded-full mb-4",children:a.jsx(Ut,{className:"w-8 h-8 text-success-500"})}),a.jsx("h2",{className:"text-title text-neutral-900 mb-2",children:"Check your email"}),a.jsxs("p",{className:"text-body text-neutral-600 mb-6",children:["If an account exists with ",t,", you will receive a password reset link shortly."]}),a.jsx("button",{onClick:()=>e("/login"),className:"fluent-btn-primary w-full",children:"Return to Login"})]}):a.jsxs("form",{onSubmit:u,className:"space-y-4",children:[o&&a.jsxs("div",{className:"p-3 bg-error-50 border border-error-200 rounded-fluent flex items-center gap-2 text-error-600",children:[a.jsx(Bs,{className:"w-5 h-5"}),a.jsx("span",{className:"text-body",children:o})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-body-strong text-neutral-700 mb-2",children:"Email Address"}),a.jsxs("div",{className:"relative",children:[a.jsx(Ua,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-neutral-400"}),a.jsx("input",{id:"email",type:"email",value:t,onChange:d=>r(d.target.value),placeholder:"you@example.com",required:!0,className:"fluent-input pl-10"})]})]}),a.jsx(z.button,{type:"submit",whileHover:{scale:1.01},whileTap:{scale:.99},disabled:s,className:"fluent-btn-primary w-full py-3",children:s?a.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):"Send Reset Link"}),a.jsxs("button",{type:"button",onClick:()=>e("/login"),className:"w-full flex items-center justify-center gap-2 text-body text-primary-500 hover:text-primary-600 font-medium mt-4",children:[a.jsx(Qr,{className:"w-4 h-4"}),"Back to Login"]})]})})]})]})}const WR="https://portal.auraai.toroniandcompany.com/api";function GR(){const e=ze(),[t]=Mp(),r=t.get("token"),[s,n]=C.useState(""),[i,l]=C.useState(""),[o,c]=C.useState(!1),[u,d]=C.useState(!1),[f,h]=C.useState(!1),[x,m]=C.useState(null),p=b=>b.length<8?"Password must be at least 8 characters":/[A-Z]/.test(b)?/[a-z]/.test(b)?/[0-9]/.test(b)?null:"Password must contain at least one digit":"Password must contain at least one lowercase letter":"Password must contain at least one uppercase letter",w=async b=>{var y,j;b.preventDefault(),m(null);const g=p(s);if(g){m(g);return}if(s!==i){m("Passwords do not match");return}if(!r){m("Invalid reset link. Please request a new password reset.");return}d(!0);try{await ye.post(`${WR}/auth/reset-password`,{token:r,new_password:s}),h(!0)}catch(A){ye.isAxiosError(A)&&((j=(y=A.response)==null?void 0:y.data)!=null&&j.detail)?m(A.response.data.detail):m("Failed to reset password. The link may have expired.")}finally{d(!1)}};return r?a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 via-white to-neutral-50 flex items-center justify-center p-4 relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 opacity-30",children:a.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`
            linear-gradient(to right, rgba(0,120,212,0.05) 1px, transparent 1px),
            linear-gradient(to bottom, rgba(0,120,212,0.05) 1px, transparent 1px)
          `,backgroundSize:"4rem 4rem"}})}),a.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:[.1,.9,.2,1]},className:"w-full max-w-md relative z-10",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx(z.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200,damping:20},className:"inline-flex items-center justify-center w-16 h-16 bg-primary-500 rounded-fluent-lg mb-6 shadow-fluent-8",children:a.jsx(Nt,{className:"w-9 h-9 text-white"})}),a.jsx("h1",{className:"text-display text-neutral-900 mb-3 font-semibold",children:"Set New Password"}),a.jsx("p",{className:"text-body text-neutral-600",children:"Create a strong password for your account"})]}),a.jsx(z.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.2},className:"fluent-card-elevated p-8",children:f?a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-success-50 rounded-full mb-4",children:a.jsx(Ut,{className:"w-8 h-8 text-success-500"})}),a.jsx("h2",{className:"text-title text-neutral-900 mb-2",children:"Password Reset Successfully"}),a.jsx("p",{className:"text-body text-neutral-600 mb-6",children:"Your password has been updated. You can now sign in with your new password."}),a.jsx("button",{onClick:()=>e("/login"),className:"fluent-btn-primary w-full",children:"Sign In"})]}):a.jsxs("form",{onSubmit:w,className:"space-y-4",children:[x&&a.jsxs("div",{className:"p-3 bg-error-50 border border-error-200 rounded-fluent flex items-center gap-2 text-error-600",children:[a.jsx(Bs,{className:"w-5 h-5"}),a.jsx("span",{className:"text-body",children:x})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-body-strong text-neutral-700 mb-2",children:"New Password"}),a.jsxs("div",{className:"relative",children:[a.jsx($s,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-neutral-400"}),a.jsx("input",{id:"password",type:o?"text":"password",value:s,onChange:b=>n(b.target.value),placeholder:"Enter new password",required:!0,className:"fluent-input pl-10 pr-10"}),a.jsx("button",{type:"button",onClick:()=>c(!o),className:"absolute right-3 top-1/2 -translate-y-1/2 text-neutral-400 hover:text-neutral-600",children:o?a.jsx(xN,{className:"w-5 h-5"}):a.jsx(cr,{className:"w-5 h-5"})})]}),a.jsx("p",{className:"text-caption text-neutral-500 mt-1",children:"At least 8 characters with uppercase, lowercase, and number"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"confirmPassword",className:"block text-body-strong text-neutral-700 mb-2",children:"Confirm Password"}),a.jsxs("div",{className:"relative",children:[a.jsx($s,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-neutral-400"}),a.jsx("input",{id:"confirmPassword",type:o?"text":"password",value:i,onChange:b=>l(b.target.value),placeholder:"Confirm new password",required:!0,className:"fluent-input pl-10"})]})]}),a.jsx(z.button,{type:"submit",whileHover:{scale:1.01},whileTap:{scale:.99},disabled:u,className:"fluent-btn-primary w-full py-3",children:u?a.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):"Reset Password"})]})})]})]}):a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 via-white to-neutral-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"fluent-card-elevated p-8 max-w-md text-center",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-error-50 rounded-full mb-4",children:a.jsx(Bs,{className:"w-8 h-8 text-error-500"})}),a.jsx("h2",{className:"text-title text-neutral-900 mb-2",children:"Invalid Reset Link"}),a.jsx("p",{className:"text-body text-neutral-600 mb-6",children:"This password reset link is invalid or has expired. Please request a new one."}),a.jsx("button",{onClick:()=>e("/forgot-password"),className:"fluent-btn-primary w-full",children:"Request New Reset Link"})]})})}const qR=[{icon:V0,title:"Automated Auditing",description:"AI-powered audit workflows that reduce manual effort by 80%",color:"bg-blue-500"},{icon:Ba,title:"Real-time Analytics",description:"Comprehensive dashboards with actionable insights",color:"bg-emerald-500"},{icon:We,title:"Enterprise Security",description:"SOC 2 Type II certified with end-to-end encryption",color:"bg-purple-500"},{icon:zs,title:"Team Collaboration",description:"Seamless collaboration tools for distributed teams",color:"bg-amber-500"}],YR=[{value:"99.9%",label:"Uptime SLA"},{value:"50K+",label:"Audits Completed"},{value:"500+",label:"CPA Firms"},{value:"<2s",label:"Response Time"}];function $y(){const e=ze(),t=window.location.hostname.startsWith("cpa."),r=()=>{e("/login")},s={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.2}}},n={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}};return a.jsxs("div",{className:"min-h-screen bg-[#faf9f8] overflow-hidden",children:[a.jsx(z.nav,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"fixed top-0 left-0 right-0 z-50 bg-white/80 backdrop-blur-xl border-b border-neutral-200/50",children:a.jsx("div",{className:"max-w-7xl mx-auto px-6 py-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-[#0078d4] to-[#106ebe] rounded-xl flex items-center justify-center shadow-lg shadow-blue-500/20",children:a.jsx(Nt,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-bold text-neutral-900",children:"Aura Audit AI"}),a.jsx("p",{className:"text-xs text-neutral-500",children:t?"CPA Portal":"Client Portal"})]})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("a",{href:"#features",className:"text-sm font-medium text-neutral-600 hover:text-neutral-900 transition-colors",children:"Features"}),a.jsx("a",{href:"#security",className:"text-sm font-medium text-neutral-600 hover:text-neutral-900 transition-colors",children:"Security"}),a.jsxs(z.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:r,className:"px-6 py-2.5 bg-[#0078d4] text-white text-sm font-semibold rounded-lg hover:bg-[#106ebe] transition-all shadow-lg shadow-blue-500/20 flex items-center gap-2",children:["Login",a.jsx(fs,{className:"w-4 h-4"})]})]})]})})}),a.jsxs("section",{className:"relative pt-32 pb-20 px-6",children:[a.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`
              radial-gradient(circle at 20% 50%, rgba(0, 120, 212, 0.08) 0%, transparent 50%),
              radial-gradient(circle at 80% 80%, rgba(16, 110, 190, 0.06) 0%, transparent 40%)
            `}}),a.jsx(z.div,{className:"absolute top-40 left-20 w-96 h-96 bg-blue-400/10 rounded-full blur-3xl",animate:{y:[0,30,0],scale:[1,1.1,1]},transition:{duration:8,repeat:1/0,ease:"easeInOut"}}),a.jsx(z.div,{className:"absolute bottom-20 right-20 w-80 h-80 bg-purple-400/10 rounded-full blur-3xl",animate:{y:[0,-40,0],scale:[1,1.2,1]},transition:{duration:10,repeat:1/0,ease:"easeInOut"}})]}),a.jsx(z.div,{variants:s,initial:"hidden",animate:"visible",className:"max-w-7xl mx-auto relative z-10",children:a.jsxs("div",{className:"grid lg:grid-cols-2 gap-16 items-center",children:[a.jsxs("div",{children:[a.jsxs(z.div,{variants:n,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-50 text-[#0078d4] rounded-full text-sm font-medium mb-6",children:[a.jsx(_i,{className:"w-4 h-4"}),"AI-Powered Audit Platform"]}),a.jsxs(z.h1,{variants:n,className:"text-5xl lg:text-6xl font-bold text-neutral-900 leading-tight mb-6",children:["Transform Your"," ",a.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-[#0078d4] to-[#50e6ff]",children:"Audit Practice"})," ","with AI"]}),a.jsx(z.p,{variants:n,className:"text-xl text-neutral-600 leading-relaxed mb-8 max-w-xl",children:"Streamline compliance, automate workflows, and deliver exceptional client service with enterprise-grade AI technology built for CPAs."}),a.jsxs(z.div,{variants:n,className:"flex flex-wrap gap-4 mb-10",children:[a.jsxs(z.button,{whileHover:{scale:1.02,boxShadow:"0 20px 40px rgba(0, 120, 212, 0.3)"},whileTap:{scale:.98},onClick:r,className:"px-8 py-4 bg-gradient-to-r from-[#0078d4] to-[#106ebe] text-white text-lg font-semibold rounded-xl hover:from-[#106ebe] hover:to-[#0078d4] transition-all shadow-xl shadow-blue-500/25 flex items-center gap-3",children:["Login to Your Account",a.jsx(fs,{className:"w-5 h-5"})]}),a.jsxs(z.a,{href:"#features",whileHover:{scale:1.02},whileTap:{scale:.98},className:"px-8 py-4 bg-white text-neutral-700 text-lg font-semibold rounded-xl border-2 border-neutral-200 hover:border-neutral-300 hover:bg-neutral-50 transition-all flex items-center gap-3",children:["Learn More",a.jsx(fa,{className:"w-5 h-5"})]})]}),a.jsx(z.div,{variants:n,className:"flex items-center gap-6",children:[{icon:We,text:"SOC 2 Certified"},{icon:$s,text:"Bank-Level Security"},{icon:Re,text:"AICPA Compliant"}].map((i,l)=>a.jsxs("div",{className:"flex items-center gap-2 text-sm text-neutral-600",children:[a.jsx(i.icon,{className:"w-4 h-4 text-emerald-500"}),a.jsx("span",{children:i.text})]},l))})]}),a.jsx(z.div,{variants:n,className:"relative",children:a.jsxs("div",{className:"relative",children:[a.jsxs(z.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.5,duration:.6},className:"bg-white rounded-2xl shadow-2xl shadow-neutral-200/50 border border-neutral-200/50 overflow-hidden",children:[a.jsx("div",{className:"bg-gradient-to-r from-[#0078d4] to-[#50e6ff] p-4",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 rounded-full bg-white/30"}),a.jsx("div",{className:"w-3 h-3 rounded-full bg-white/30"}),a.jsx("div",{className:"w-3 h-3 rounded-full bg-white/30"})]})}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsx("div",{className:"grid grid-cols-3 gap-4",children:[{label:"Active Audits",value:"24"},{label:"Completed",value:"156"},{label:"Compliance",value:"98%"}].map((i,l)=>a.jsxs(z.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.7+l*.1},className:"bg-neutral-50 rounded-xl p-4 text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-neutral-900",children:i.value}),a.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:i.label})]},l))}),a.jsx(z.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1},className:"h-32 bg-gradient-to-br from-neutral-50 to-neutral-100 rounded-xl flex items-end justify-around p-4",children:[40,65,45,80,55,70,90].map((i,l)=>a.jsx(z.div,{initial:{height:0},animate:{height:`${i}%`},transition:{delay:1.2+l*.05,duration:.5},className:"w-6 bg-gradient-to-t from-[#0078d4] to-[#50e6ff] rounded-t-lg"},l))})]})]}),a.jsx(z.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1.2},className:"absolute -left-8 top-20 bg-white rounded-xl shadow-xl p-4 border border-neutral-200/50",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center",children:a.jsx(Re,{className:"w-5 h-5 text-emerald-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-neutral-900",children:"Audit Complete"}),a.jsx("p",{className:"text-xs text-neutral-500",children:"Client ABC Corp"})]})]})}),a.jsx(z.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:1.4},className:"absolute -right-4 bottom-20 bg-white rounded-xl shadow-xl p-4 border border-neutral-200/50",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(_i,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-neutral-900",children:"AI Analysis"}),a.jsx("p",{className:"text-xs text-neutral-500",children:"3 risks identified"})]})]})})]})})]})})]}),a.jsx("section",{className:"py-16 px-6 bg-white border-y border-neutral-200",children:a.jsx("div",{className:"max-w-7xl mx-auto",children:a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-8",children:YR.map((i,l)=>a.jsxs(z.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:l*.1},className:"text-center",children:[a.jsx("p",{className:"text-4xl md:text-5xl font-bold text-[#0078d4] mb-2",children:i.value}),a.jsx("p",{className:"text-neutral-600 font-medium",children:i.label})]},l))})})}),a.jsx("section",{id:"features",className:"py-24 px-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsxs(z.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"text-center mb-16",children:[a.jsx("h2",{className:"text-4xl font-bold text-neutral-900 mb-4",children:"Everything you need to scale your practice"}),a.jsx("p",{className:"text-xl text-neutral-600 max-w-2xl mx-auto",children:"Purpose-built tools designed for modern CPA firms and their clients"})]}),a.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6",children:qR.map((i,l)=>a.jsxs(z.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:l*.1},whileHover:{y:-8,boxShadow:"0 20px 40px rgba(0,0,0,0.1)"},className:"bg-white rounded-2xl p-6 border border-neutral-200 transition-all cursor-pointer",children:[a.jsx("div",{className:`w-12 h-12 ${i.color} rounded-xl flex items-center justify-center mb-4`,children:a.jsx(i.icon,{className:"w-6 h-6 text-white"})}),a.jsx("h3",{className:"text-lg font-bold text-neutral-900 mb-2",children:i.title}),a.jsx("p",{className:"text-neutral-600",children:i.description})]},l))})]})}),a.jsx("section",{id:"security",className:"py-24 px-6 bg-gradient-to-br from-neutral-900 to-neutral-800",children:a.jsx("div",{className:"max-w-7xl mx-auto",children:a.jsxs("div",{className:"grid lg:grid-cols-2 gap-16 items-center",children:[a.jsxs(z.div,{initial:{opacity:0,x:-20},whileInView:{opacity:1,x:0},viewport:{once:!0},children:[a.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-white/10 text-white/80 rounded-full text-sm font-medium mb-6",children:[a.jsx(We,{className:"w-4 h-4"}),"Enterprise Security"]}),a.jsx("h2",{className:"text-4xl font-bold text-white mb-6",children:"Security that meets the highest standards"}),a.jsx("p",{className:"text-lg text-neutral-400 mb-8",children:"Your data is protected with bank-level encryption, comprehensive audit trails, and compliance certifications that exceed industry standards."}),a.jsx("div",{className:"space-y-4",children:["SOC 2 Type II Certified","AICPA Security Standards","End-to-end AES-256 Encryption","Multi-factor Authentication","Role-based Access Control"].map((i,l)=>a.jsxs(z.div,{initial:{opacity:0,x:-10},whileInView:{opacity:1,x:0},viewport:{once:!0},transition:{delay:l*.1},className:"flex items-center gap-3",children:[a.jsx(Re,{className:"w-5 h-5 text-emerald-400"}),a.jsx("span",{className:"text-white",children:i})]},l))})]}),a.jsxs(z.div,{initial:{opacity:0,x:20},whileInView:{opacity:1,x:0},viewport:{once:!0},className:"relative",children:[a.jsx("div",{className:"w-64 h-64 bg-gradient-to-br from-[#0078d4]/20 to-[#50e6ff]/20 rounded-full blur-3xl absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"}),a.jsx("div",{className:"relative bg-white/5 backdrop-blur-sm rounded-2xl p-8 border border-white/10",children:a.jsx("div",{className:"grid grid-cols-2 gap-4",children:[{icon:We,label:"SOC 2"},{icon:$s,label:"GDPR"},{icon:Re,label:"HIPAA"},{icon:V0,label:"ISO 27001"}].map((i,l)=>a.jsxs(z.div,{whileHover:{scale:1.05},className:"bg-white/10 rounded-xl p-6 text-center",children:[a.jsx(i.icon,{className:"w-8 h-8 text-[#50e6ff] mx-auto mb-2"}),a.jsx("p",{className:"text-white font-semibold",children:i.label})]},l))})})]})]})})}),a.jsx("section",{className:"py-24 px-6",children:a.jsx("div",{className:"max-w-4xl mx-auto text-center",children:a.jsxs(z.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},children:[a.jsx("h2",{className:"text-4xl font-bold text-neutral-900 mb-6",children:"Ready to transform your audit practice?"}),a.jsx("p",{className:"text-xl text-neutral-600 mb-10",children:"Join hundreds of CPA firms already using Aura Audit AI to streamline their workflows and deliver exceptional client service."}),a.jsxs(z.button,{whileHover:{scale:1.02,boxShadow:"0 20px 40px rgba(0, 120, 212, 0.3)"},whileTap:{scale:.98},onClick:r,className:"px-10 py-5 bg-gradient-to-r from-[#0078d4] to-[#106ebe] text-white text-lg font-semibold rounded-xl hover:from-[#106ebe] hover:to-[#0078d4] transition-all shadow-xl shadow-blue-500/25 inline-flex items-center gap-3",children:["Login to Your Account",a.jsx(fs,{className:"w-5 h-5"})]})]})})}),a.jsx("footer",{className:"bg-neutral-900 text-white py-12 px-6",children:a.jsx("div",{className:"max-w-7xl mx-auto",children:a.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-[#0078d4] to-[#106ebe] rounded-xl flex items-center justify-center",children:a.jsx(Nt,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold",children:"Aura Audit AI"}),a.jsx("p",{className:"text-xs text-neutral-400",children:"Enterprise Audit Platform"})]})]}),a.jsxs("div",{className:"flex items-center gap-6 text-sm text-neutral-400",children:[a.jsx("a",{href:"/privacy",className:"hover:text-white transition-colors",children:"Privacy"}),a.jsx("a",{href:"/terms",className:"hover:text-white transition-colors",children:"Terms"}),a.jsx("a",{href:"/security",className:"hover:text-white transition-colors",children:"Security"}),a.jsx("a",{href:"/contact",className:"hover:text-white transition-colors",children:"Contact"})]}),a.jsx("p",{className:"text-sm text-neutral-500",children:"2025 Aura Audit AI. All rights reserved."})]})})})]})}const KR="https://portal.auraai.toroniandcompany.com/api";class XR{constructor(){Wt(this,"api");this.api=ye.create({baseURL:`${KR}/identity`,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(t=>{const r=localStorage.getItem("access_token");return r&&(t.headers.Authorization=`Bearer ${r}`),t}),this.api.interceptors.response.use(t=>t,t=>{var r;return((r=t.response)==null?void 0:r.status)===401&&(localStorage.removeItem("access_token"),window.location.href="/login"),Promise.reject(t)})}async getOrganization(t){return(await this.api.get(`/organizations/${t}`)).data}async getMyOrganization(){return(await this.api.get("/organizations/me/details")).data}async updateOrganization(t,r){return(await this.api.patch(`/organizations/${t}`,r)).data}async listUsers(){return(await this.api.get("/users")).data}async updateUser(t,r){return(await this.api.patch(`/users/${t}`,r)).data}async deactivateUser(t){await this.api.patch(`/users/${t}/deactivate`)}async createInvitation(t){return(await this.api.post("/invitations",t)).data}async listInvitations(){return(await this.api.get("/invitations")).data}async acceptInvitation(t,r,s){return(await this.api.post("/invitations/accept",{token:t,full_name:r,password:s})).data}async resendInvitation(t){return(await this.api.post(`/invitations/${t}/resend`)).data}async getUserPermissions(t){return(await this.api.get(`/users/${t}/permissions`)).data}async updateUserPermissions(t,r){return(await this.api.patch(`/users/${t}/permissions`,r)).data}async uploadLogo(t){const r=new FormData;return r.append("file",t),(await this.api.post("/upload/logo",r,{headers:{"Content-Type":"multipart/form-data"}})).data}async getFirmStats(){const t=await this.listUsers(),r=await this.listInvitations();return{total_employees:t.length,active_engagements:0,pending_invitations:r.filter(s=>!s.is_expired&&!s.accepted_at).length,total_clients:0,documents_uploaded_this_month:0,active_integrations:0}}}const Hr=new XR,QR="https://portal.auraai.toroniandcompany.com/api";class JR{constructor(){Wt(this,"api");this.api=ye.create({baseURL:`${QR}/identity`,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(t=>{const r=localStorage.getItem("access_token");return r&&(t.headers.Authorization=`Bearer ${r}`),t}),this.api.interceptors.response.use(t=>t,t=>{var r;return((r=t.response)==null?void 0:r.status)===401&&(localStorage.removeItem("access_token"),window.location.href="/login"),Promise.reject(t)})}async getRecentActivity(t){try{return(await this.api.get("/activity",{params:t})).data.map(this.transformActivity)}catch(r){return console.error("Failed to fetch activity:",r),this.getDefaultActivity()}}async getFirmActivity(t=10){try{return(await this.api.get("/activity/firm",{params:{limit:t}})).data.map(this.transformActivity)}catch(r){return console.error("Failed to fetch firm activity:",r),this.getDefaultActivity()}}async getEngagementActivity(t,r=20){try{return(await this.api.get(`/activity/engagement/${t}`,{params:{limit:r}})).data.map(this.transformActivity)}catch(s){return console.error("Failed to fetch engagement activity:",s),[]}}transformActivity(t){const r={user:"Users",engagement:"FileText",settings:"Settings",document:"File",client:"Building2"},s={user:"primary",engagement:"success",settings:"accent",document:"warning",client:"primary"};return{id:t.id,type:t.type||t.activity_type||"user",title:t.title||t.action,description:t.description||t.details,time:t.time||t.created_at||new Date().toISOString(),icon:r[t.type]||"Circle",color:s[t.type]||"neutral",userId:t.user_id,userName:t.user_name,entityId:t.entity_id,entityType:t.entity_type}}getDefaultActivity(){return[{id:1,type:"user",title:"New employee joined",description:"Team member accepted invitation",time:"2 hours ago",icon:"Users",color:"primary"},{id:2,type:"engagement",title:"Engagement completed",description:"Financial Audit finalized",time:"1 day ago",icon:"CheckCircle2",color:"success"},{id:3,type:"settings",title:"Settings updated",description:"Firm preferences modified",time:"3 days ago",icon:"Settings",color:"accent"}]}}const ZR=new JR,eP={Users:zs,FileText:$e,Settings:gc,CheckCircle2:Re,File:cx,Building2:Nt,Circle:ox},tP=()=>{const e=ze(),[t,r]=C.useState(null),[s,n]=C.useState(null),[i,l]=C.useState([]),[o,c]=C.useState([]),[u,d]=C.useState(!0);C.useEffect(()=>{f()},[]);const f=async()=>{try{d(!0);const[p,w,b,g]=await Promise.all([Hr.getFirmStats(),Hr.getMyOrganization(),Hr.listUsers(),ZR.getFirmActivity(5)]);r(p),n(w),l(b.slice(0,5)),c(g)}catch(p){console.error("Failed to load dashboard data:",p),de.error("Failed to load dashboard data")}finally{d(!1)}},h=[{title:"Total Employees",value:(t==null?void 0:t.total_employees)||0,change:"+12%",trend:"up",icon:zs,color:"primary",action:()=>e("/firm/employees")},{title:"Active Engagements",value:(t==null?void 0:t.active_engagements)||0,change:"+8%",trend:"up",icon:$e,color:"success",action:()=>e("/firm/audits")},{title:"Pending Invitations",value:(t==null?void 0:t.pending_invitations)||0,change:"-3%",trend:"down",icon:Ua,color:"accent",action:()=>e("/firm/employees")},{title:"Total Clients",value:(t==null?void 0:t.total_clients)||0,change:"+24%",trend:"up",icon:Nt,color:"primary",action:()=>e("/firm/clients")}],x=[{title:"Invite Team Member",description:"Send invitation to join your firm",icon:dx,action:()=>e("/firm/employees?action=invite")},{title:"Firm Settings",description:"Manage profile and preferences",icon:gc,action:()=>e("/firm/settings")},{title:"View Reports",description:"Access analytics and insights",icon:Ba,action:()=>e("/firm/reports")}],m=p=>eP[p||"Circle"]||ox;return u?a.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:a.jsxs("div",{className:"flex flex-col items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 border-4 border-primary-500 border-t-transparent rounded-full animate-spin"}),a.jsx("p",{className:"text-body text-neutral-600",children:"Loading your dashboard..."})]})}):a.jsxs("div",{className:"space-y-6 max-w-[1600px]",children:[a.jsx(z.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-gradient-to-r from-[#10893e] to-[#16a34a] rounded-2xl px-8 py-4 text-white text-center shadow-lg",children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsx(Nt,{className:"w-5 h-5"}),a.jsx("h1",{className:"text-xl font-semibold tracking-wide",children:"CPA FIRM PORTAL - MANAGE YOUR CLIENTS & ENGAGEMENTS"})]})}),a.jsxs(z.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[(s==null?void 0:s.logo_url)&&a.jsx(z.img,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200,damping:20},src:s.logo_url,alt:s.name,className:"w-14 h-14 rounded-fluent-lg object-cover shadow-fluent-4"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-display text-neutral-900 mb-1",children:(s==null?void 0:s.name)||"Your Firm"}),a.jsx("p",{className:"text-body text-neutral-600",children:"Welcome back! Here's your firm overview"})]})]}),a.jsxs(z.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>e("/firm/settings"),className:"fluent-btn-secondary",children:[a.jsx(gc,{className:"w-4 h-4"}),"Settings"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:h.map((p,w)=>{const b=p.icon,g=p.trend==="up"?ua:W0;return a.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:w*.05,duration:.3,ease:[.1,.9,.2,1]},onClick:p.action,className:"fluent-card-interactive p-6 group",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsx("div",{className:`p-2.5 rounded-fluent bg-${p.color}-50`,children:a.jsx(b,{className:`w-5 h-5 text-${p.color}-600`})}),a.jsxs("div",{className:`flex items-center gap-1 text-caption font-semibold ${p.trend==="up"?"text-success-600":"text-neutral-500"}`,children:[a.jsx(g,{className:"w-3.5 h-3.5"}),p.change]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-caption text-neutral-600 font-medium",children:p.title}),a.jsx("p",{className:"text-display text-neutral-900 font-semibold",children:p.value.toLocaleString()})]}),a.jsxs("div",{className:"mt-4 flex items-center text-caption text-neutral-500 group-hover:text-primary-600 transition-colors",children:["View details",a.jsx(fs,{className:"w-3.5 h-3.5 ml-1 group-hover:translate-x-1 transition-transform"})]})]},p.title)})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"lg:col-span-2 space-y-6",children:[a.jsxs("div",{className:"fluent-card p-6",children:[a.jsx("div",{className:"flex items-center justify-between mb-4",children:a.jsx("h2",{className:"text-title text-neutral-900",children:"Quick Actions"})}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:x.map((p,w)=>{const b=p.icon;return a.jsxs(z.button,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.3+w*.05},whileHover:{scale:1.02},whileTap:{scale:.98},onClick:p.action,className:"fluent-list-item flex-col items-start text-left p-4 bg-neutral-50 hover:bg-neutral-100 border border-neutral-200",children:[a.jsx("div",{className:"p-2 rounded-fluent-sm bg-primary-100 mb-3",children:a.jsx(b,{className:"w-5 h-5 text-primary-600"})}),a.jsx("h3",{className:"text-body-strong text-neutral-900 mb-1",children:p.title}),a.jsx("p",{className:"text-caption text-neutral-600",children:p.description})]},p.title)})})]}),a.jsxs("div",{className:"fluent-card p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-title text-neutral-900",children:"Recent Activity"}),a.jsx(nt,{className:"w-5 h-5 text-neutral-400"})]}),a.jsx("div",{className:"space-y-3",children:o.map((p,w)=>{const b=m(p.icon),g=p.color||"primary";return a.jsxs(z.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.4+w*.05},className:"flex items-start gap-3 p-3 rounded-fluent hover:bg-neutral-50 transition-colors",children:[a.jsx("div",{className:`p-2 rounded-fluent-sm bg-${g}-50 flex-shrink-0`,children:a.jsx(b,{className:`w-4 h-4 text-${g}-600`})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-body-strong text-neutral-900 mb-0.5",children:p.title}),a.jsx("p",{className:"text-caption text-neutral-600",children:p.description})]}),a.jsx("span",{className:"text-caption text-neutral-500 flex-shrink-0",children:p.time})]},p.id)})}),a.jsx("button",{className:"w-full mt-4 py-2.5 text-body-strong text-primary-600 hover:bg-primary-50 rounded-fluent transition-colors",children:"View all activity"})]})]}),a.jsxs(z.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.25},className:"space-y-6",children:[a.jsxs("div",{className:"fluent-card p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-title text-neutral-900",children:"Team"}),a.jsx(zs,{className:"w-5 h-5 text-neutral-400"})]}),a.jsxs("div",{className:"space-y-2",children:[i.map((p,w)=>a.jsxs(z.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.3+w*.05},className:"flex items-center gap-3 p-2.5 rounded-fluent hover:bg-neutral-50 transition-colors",children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"w-9 h-9 rounded-full bg-gradient-to-br from-primary-400 to-primary-600 flex items-center justify-center text-white text-body-strong flex-shrink-0",children:p.full_name.charAt(0).toUpperCase()}),p.is_active&&a.jsx("span",{className:"absolute bottom-0 right-0 w-2.5 h-2.5 bg-success-500 rounded-full ring-2 ring-white"})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-body-strong text-neutral-900 truncate",children:p.full_name}),a.jsx("p",{className:"text-caption text-neutral-600 capitalize truncate",children:p.role.replace("_"," ")})]})]},p.id)),a.jsx("button",{onClick:()=>e("/firm/employees"),className:"w-full py-2.5 text-body-strong text-primary-600 hover:bg-primary-50 rounded-fluent transition-colors mt-2",children:"View all team members"})]})]}),a.jsxs("div",{className:"fluent-card p-6 bg-gradient-to-br from-primary-50 to-white border-primary-200",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("div",{className:"w-10 h-10 rounded-fluent bg-primary-500 flex items-center justify-center mb-3",children:a.jsx(ua,{className:"w-5 h-5 text-white"})}),a.jsx("h3",{className:"text-title text-neutral-900 mb-2",children:"Performance Insight"}),a.jsxs("p",{className:"text-body text-neutral-700 leading-relaxed",children:["Your team productivity is up ",a.jsx("span",{className:"font-semibold text-success-600",children:"24%"})," this month. Keep up the great work!"]})]}),a.jsxs("button",{className:"fluent-btn-primary w-full",children:[a.jsx(Ba,{className:"w-4 h-4"}),"View Analytics"]})]})]})]})]})},rP=()=>{const e=ze(),[t,r]=C.useState(null),[s,n]=C.useState(!0),[i,l]=C.useState(!1),[o,c]=C.useState("general"),[u,d]=C.useState({}),[f,h]=C.useState(null),[x,m]=C.useState(null);C.useEffect(()=>{p()},[]);const p=async()=>{try{n(!0);const j=await Hr.getMyOrganization();r(j),d({name:j.name,tax_id:j.tax_id,industry_code:j.industry_code,logo_url:j.logo_url,primary_color:j.primary_color,secondary_color:j.secondary_color,address:j.address,phone:j.phone,website:j.website,timezone:j.timezone,date_format:j.date_format}),j.logo_url&&h(j.logo_url)}catch(j){console.error("Failed to load organization:",j),de.error("Failed to load firm settings")}finally{n(!1)}},w=j=>{var k;const A=(k=j.target.files)==null?void 0:k[0];if(A){if(A.size>5*1024*1024){de.error("Logo file size must be less than 5MB");return}if(!A.type.startsWith("image/")){de.error("Please upload an image file");return}m(A);const v=new FileReader;v.onloadend=()=>{h(v.result)},v.readAsDataURL(A)}},b=async()=>{var j,A;if(t)try{if(l(!0),x){const{url:v}=await Hr.uploadLogo(x);u.logo_url=v}const k=await Hr.updateOrganization(t.id,u);r(k),de.success("Firm settings saved successfully!")}catch(k){console.error("Failed to save settings:",k),de.error(((A=(j=k.response)==null?void 0:j.data)==null?void 0:A.detail)||"Failed to save settings")}finally{l(!1)}},g=(j,A)=>{d(k=>({...k,[j]:A}))},y=[{id:"general",label:"General Info",icon:Nt},{id:"branding",label:"Branding",icon:vy},{id:"preferences",label:"Preferences",icon:nt}];return s?a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsxs("div",{className:"flex flex-col items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"}),a.jsx("p",{className:"text-gray-600",children:"Loading settings..."})]})}):a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[a.jsx("div",{className:"bg-white border-b border-gray-200",children:a.jsx("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("button",{onClick:()=>e("/firm/dashboard"),className:"text-sm text-gray-600 hover:text-gray-900 mb-2 flex items-center gap-1",children:" Back to Dashboard"}),a.jsx("h1",{className:"text-3xl font-bold text-gradient",children:"Firm Settings"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your firm's profile, branding, and preferences"})]})})})}),a.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a.jsx("div",{className:"flex gap-2 mb-6 bg-white rounded-lg p-1 shadow-sm",children:y.map(j=>{const A=j.icon;return a.jsxs("button",{onClick:()=>c(j.id),className:`flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-md font-medium transition-all ${o===j.id?"bg-blue-500 text-white shadow-md":"text-gray-600 hover:bg-gray-100"}`,children:[a.jsx(A,{className:"w-5 h-5"}),j.label]},j.id)})}),o==="general"&&a.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"card",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"General Information"}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Firm Name *"}),a.jsx("input",{type:"text",value:u.name||"",onChange:j=>g("name",j.target.value),className:"input-field",placeholder:"Enter firm name"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tax ID / EIN"}),a.jsx("input",{type:"text",value:u.tax_id||"",onChange:j=>g("tax_id",j.target.value),className:"input-field",placeholder:"XX-XXXXXXX"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Industry Code"}),a.jsx("input",{type:"text",value:u.industry_code||"",onChange:j=>g("industry_code",j.target.value),className:"input-field",placeholder:"NAICS Code"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[a.jsx(q6,{className:"w-4 h-4 inline mr-1"}),"Address"]}),a.jsx("textarea",{value:u.address||"",onChange:j=>g("address",j.target.value),className:"input-field",rows:3,placeholder:"Street address, city, state, ZIP"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[a.jsx(yN,{className:"w-4 h-4 inline mr-1"}),"Phone"]}),a.jsx("input",{type:"tel",value:u.phone||"",onChange:j=>g("phone",j.target.value),className:"input-field",placeholder:"(555) 123-4567"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[a.jsx(B6,{className:"w-4 h-4 inline mr-1"}),"Website"]}),a.jsx("input",{type:"url",value:u.website||"",onChange:j=>g("website",j.target.value),className:"input-field",placeholder:"https://yourfirm.com"})]})]})]})]}),o==="branding"&&a.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"card",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Branding & Logo"}),a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:[a.jsx(Qd,{className:"w-4 h-4 inline mr-1"}),"Firm Logo"]}),a.jsxs("div",{className:"flex items-start gap-6",children:[a.jsx("div",{className:"w-32 h-32 rounded-lg border-2 border-dashed border-gray-300 flex items-center justify-center bg-gray-50 overflow-hidden",children:f?a.jsx("img",{src:f,alt:"Logo preview",className:"w-full h-full object-contain"}):a.jsx(Qd,{className:"w-12 h-12 text-gray-400"})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("label",{className:"btn-primary cursor-pointer inline-flex items-center gap-2",children:[a.jsx(oa,{className:"w-4 h-4"}),"Upload Logo",a.jsx("input",{type:"file",accept:"image/*",onChange:w,className:"hidden"})]}),f&&a.jsxs("button",{onClick:()=>{h(null),m(null),g("logo_url",null)},className:"btn-secondary ml-2",children:[a.jsx(ur,{className:"w-4 h-4"}),"Remove"]}),a.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Recommended: Square image, at least 200x200px, PNG or JPG, max 5MB"})]})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:[a.jsx(vy,{className:"w-4 h-4 inline mr-1"}),"Color Scheme"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"Primary Color"}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("input",{type:"color",value:u.primary_color||"#2563eb",onChange:j=>g("primary_color",j.target.value),className:"w-12 h-12 rounded-lg border-2 border-gray-300 cursor-pointer"}),a.jsx("input",{type:"text",value:u.primary_color||"#2563eb",onChange:j=>g("primary_color",j.target.value),className:"input-field flex-1",placeholder:"#2563eb",pattern:"^#[0-9A-Fa-f]{6}$"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-2",children:"Secondary Color"}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("input",{type:"color",value:u.secondary_color||"#7c3aed",onChange:j=>g("secondary_color",j.target.value),className:"w-12 h-12 rounded-lg border-2 border-gray-300 cursor-pointer"}),a.jsx("input",{type:"text",value:u.secondary_color||"#7c3aed",onChange:j=>g("secondary_color",j.target.value),className:"input-field flex-1",placeholder:"#7c3aed",pattern:"^#[0-9A-Fa-f]{6}$"})]})]})]}),a.jsxs("div",{className:"mt-6 p-6 rounded-lg border-2 border-gray-200 bg-gray-50",children:[a.jsx("p",{className:"text-sm font-medium text-gray-700 mb-3",children:"Preview"}),a.jsxs("div",{className:"flex gap-4",children:[a.jsx("div",{className:"flex-1 h-20 rounded-lg shadow-md flex items-center justify-center text-white font-semibold",style:{backgroundColor:u.primary_color||"#2563eb"},children:"Primary"}),a.jsx("div",{className:"flex-1 h-20 rounded-lg shadow-md flex items-center justify-center text-white font-semibold",style:{backgroundColor:u.secondary_color||"#7c3aed"},children:"Secondary"})]})]})]})]})]}),o==="preferences"&&a.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"card",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Preferences"}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[a.jsx(nt,{className:"w-4 h-4 inline mr-1"}),"Timezone"]}),a.jsxs("select",{value:u.timezone||"America/New_York",onChange:j=>g("timezone",j.target.value),className:"input-field",children:[a.jsx("option",{value:"America/New_York",children:"Eastern Time (ET)"}),a.jsx("option",{value:"America/Chicago",children:"Central Time (CT)"}),a.jsx("option",{value:"America/Denver",children:"Mountain Time (MT)"}),a.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time (PT)"}),a.jsx("option",{value:"America/Anchorage",children:"Alaska Time (AKT)"}),a.jsx("option",{value:"Pacific/Honolulu",children:"Hawaii Time (HT)"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[a.jsx(Jr,{className:"w-4 h-4 inline mr-1"}),"Date Format"]}),a.jsxs("select",{value:u.date_format||"MM/DD/YYYY",onChange:j=>g("date_format",j.target.value),className:"input-field",children:[a.jsx("option",{value:"MM/DD/YYYY",children:"MM/DD/YYYY (e.g., 12/31/2024)"}),a.jsx("option",{value:"DD/MM/YYYY",children:"DD/MM/YYYY (e.g., 31/12/2024)"}),a.jsx("option",{value:"YYYY-MM-DD",children:"YYYY-MM-DD (e.g., 2024-12-31)"})]})]})]})]}),a.jsxs("div",{className:"flex items-center justify-end gap-3 mt-6",children:[a.jsx("button",{onClick:()=>e("/firm/dashboard"),className:"btn-secondary",disabled:i,children:"Cancel"}),a.jsx("button",{onClick:b,disabled:i,className:"btn-primary flex items-center gap-2",children:i?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(vN,{className:"w-4 h-4"}),"Save Changes"]})})]})]})]})},sP=()=>{var ne,W;const e=ze(),[t]=Mp(),[r,s]=C.useState([]),[n,i]=C.useState([]),[l,o]=C.useState(!0),[c,u]=C.useState("employees"),[d,f]=C.useState(""),[h,x]=C.useState("all"),[m,p]=C.useState(!1),[w,b]=C.useState(!1),[g,y]=C.useState(null),[j,A]=C.useState(null),[k,v]=C.useState({email:"",role:"staff",message:""});C.useEffect(()=>{E(),t.get("action")==="invite"&&p(!0)},[t]);const E=async()=>{try{o(!0);const[T,L]=await Promise.all([Hr.listUsers(),Hr.listInvitations()]);s(T),i(L)}catch(T){console.error("Failed to load data:",T),de.error("Failed to load employee data")}finally{o(!1)}},S=async()=>{var T,L;if(!k.email||!k.role){de.error("Please fill in all required fields");return}try{await Hr.createInvitation(k),de.success(`Invitation sent to ${k.email}`),p(!1),v({email:"",role:"staff",message:""}),E()}catch(B){console.error("Failed to send invitation:",B),de.error(((L=(T=B.response)==null?void 0:T.data)==null?void 0:L.detail)||"Failed to send invitation")}},N=async T=>{var L,B;if(confirm(`Are you sure you want to deactivate ${T.full_name}?`))try{await Hr.deactivateUser(T.id),de.success("User deactivated successfully"),E()}catch(V){console.error("Failed to deactivate user:",V),de.error(((B=(L=V.response)==null?void 0:L.data)==null?void 0:B.detail)||"Failed to deactivate user")}},D=async T=>{try{const L=await Hr.getUserPermissions(T.id);y(T),A(L),b(!0)}catch(L){console.error("Failed to load permissions:",L),de.error("Failed to load user permissions")}},F=async T=>{var L,B;if(g)try{const V=await Hr.updateUserPermissions(g.id,T);A(V),de.success("Permissions updated successfully")}catch(V){console.error("Failed to update permissions:",V),de.error(((B=(L=V.response)==null?void 0:L.data)==null?void 0:B.detail)||"Failed to update permissions")}},Y=r.filter(T=>{const L=T.full_name.toLowerCase().includes(d.toLowerCase())||T.email.toLowerCase().includes(d.toLowerCase()),B=h==="all"||T.role===h;return L&&B}),Q=n.filter(T=>!T.is_expired&&!T.accepted_at),ae=n.filter(T=>T.is_expired||T.accepted_at),ee=[{value:"partner",label:"Partner",color:"purple",description:"Full access including firm settings, billing, and user management"},{value:"manager",label:"Manager",color:"blue",description:"Manage engagements, supervise staff, and invite team members"},{value:"senior",label:"Senior",color:"green",description:"Lead fieldwork, review workpapers, and edit engagements"},{value:"staff",label:"Staff",color:"gray",description:"Perform testing procedures and upload documents"},{value:"qc_reviewer",label:"QC Reviewer",color:"orange",description:"Review completed work and approve quality control"},{value:"client_contact",label:"Client Contact",color:"pink",description:"View shared documents and communicate with audit team"}],fe=async T=>{const B=`${window.location.origin}/accept-invitation?token=${T.token}`;try{await navigator.clipboard.writeText(B),de.success("Invitation link copied to clipboard")}catch{de.error("Failed to copy link")}},se=async T=>{var L,B;try{await Hr.resendInvitation(T.id),de.success(`Invitation resent to ${T.email}`),E()}catch(V){de.error(((B=(L=V.response)==null?void 0:L.data)==null?void 0:B.detail)||"Failed to resend invitation")}},H=T=>{const L=ee.find(B=>B.value===T);return(L==null?void 0:L.color)||"gray"};return l?a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsxs("div",{className:"flex flex-col items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"}),a.jsx("p",{className:"text-gray-600",children:"Loading employees..."})]})}):a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[a.jsx("div",{className:"bg-white border-b border-gray-200",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("button",{onClick:()=>e("/firm/dashboard"),className:"text-sm text-gray-600 hover:text-gray-900 mb-2 flex items-center gap-1",children:" Back to Dashboard"}),a.jsx("h1",{className:"text-3xl font-bold text-gradient",children:"Employee Management"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your team members, invitations, and permissions"})]}),a.jsxs("button",{onClick:()=>p(!0),className:"btn-primary flex items-center gap-2",children:[a.jsx(dx,{className:"w-4 h-4"}),"Invite Employee"]})]})})}),a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[a.jsxs("div",{className:"flex gap-2 mb-6",children:[a.jsxs("button",{onClick:()=>u("employees"),className:`flex items-center gap-2 px-6 py-3 rounded-lg font-medium transition-all ${c==="employees"?"bg-white shadow-md text-blue-600":"bg-white/50 text-gray-600 hover:bg-white"}`,children:[a.jsx(zs,{className:"w-5 h-5"}),"Employees",a.jsx("span",{className:"badge-primary",children:r.length})]}),a.jsxs("button",{onClick:()=>u("invitations"),className:`flex items-center gap-2 px-6 py-3 rounded-lg font-medium transition-all ${c==="invitations"?"bg-white shadow-md text-blue-600":"bg-white/50 text-gray-600 hover:bg-white"}`,children:[a.jsx(Ua,{className:"w-5 h-5"}),"Invitations",Q.length>0&&a.jsx("span",{className:"badge-warning",children:Q.length})]})]}),c==="employees"&&a.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[a.jsx("div",{className:"card",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(Vs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",value:d,onChange:T=>f(T.target.value),placeholder:"Search employees...",className:"input-field pl-10"})]}),a.jsxs("select",{value:h,onChange:T=>x(T.target.value),className:"input-field w-full sm:w-48",children:[a.jsx("option",{value:"all",children:"All Roles"}),ee.map(T=>a.jsx("option",{value:T.value,children:T.label},T.value))]})]})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Y.map((T,L)=>{var V;const B=H(T.role);return a.jsxs(z.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:L*.05},className:"card hover:shadow-lg transition-shadow",children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-semibold text-lg flex-shrink-0",children:T.full_name.charAt(0).toUpperCase()}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:T.full_name}),T.is_active&&a.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"})]}),a.jsx("p",{className:"text-sm text-gray-600 truncate",children:T.email}),a.jsx("span",{className:`badge-${B} mt-2 inline-block text-xs`,children:(V=ee.find(te=>te.value===T.role))==null?void 0:V.label})]})]}),a.jsxs("div",{className:"flex gap-2 ml-2",children:[a.jsx("button",{onClick:()=>D(T),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"Manage permissions",children:a.jsx(We,{className:"w-4 h-4 text-gray-600"})}),a.jsx("button",{onClick:()=>N(T),className:"p-2 hover:bg-red-50 rounded-lg transition-colors",title:"Deactivate user",children:a.jsx(Ii,{className:"w-4 h-4 text-red-600"})})]})]}),T.last_login_at&&a.jsxs("p",{className:"text-xs text-gray-500 mt-3",children:["Last login: ",new Date(T.last_login_at).toLocaleDateString()]})]},T.id)})}),Y.length===0&&a.jsxs("div",{className:"card text-center py-12",children:[a.jsx(zs,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"No employees found"})]})]}),c==="invitations"&&a.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[a.jsxs("div",{className:"card",children:[a.jsxs("h2",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2",children:[a.jsx(nt,{className:"w-5 h-5 text-orange-500"}),"Pending Invitations"]}),Q.length>0?a.jsx("div",{className:"space-y-3",children:Q.map(T=>{var L;return a.jsxs("div",{className:"flex items-center justify-between p-4 bg-orange-50 rounded-lg border border-orange-200",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium text-gray-900",children:T.email}),a.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[a.jsx("span",{className:`badge-${H(T.role)} text-xs`,children:(L=ee.find(B=>B.value===T.role))==null?void 0:L.label}),a.jsxs("span",{className:"text-xs text-gray-600",children:["Expires: ",new Date(T.expires_at).toLocaleDateString()]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>fe(T),className:"p-2 hover:bg-orange-100 rounded-lg transition-colors",title:"Copy invitation link",children:a.jsx(I6,{className:"w-4 h-4 text-gray-600"})}),a.jsx("button",{onClick:()=>se(T),className:"p-2 hover:bg-orange-100 rounded-lg transition-colors",title:"Resend invitation email",children:a.jsx(zr,{className:"w-4 h-4 text-gray-600"})}),a.jsx("span",{className:"badge-warning",children:"Pending"})]})]},T.id)})}):a.jsx("p",{className:"text-gray-600 text-center py-8",children:"No pending invitations"})]}),ae.length>0&&a.jsxs("div",{className:"card",children:[a.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:"Past Invitations"}),a.jsx("div",{className:"space-y-3",children:ae.map(T=>{var L;return a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium text-gray-700",children:T.email}),a.jsx("span",{className:`badge-${H(T.role)} text-xs mt-1 inline-block`,children:(L=ee.find(B=>B.value===T.role))==null?void 0:L.label})]}),T.accepted_at?a.jsx("span",{className:"badge-success",children:"Accepted"}):a.jsx("span",{className:"badge-error",children:"Expired"})]},T.id)})})]})]})]}),a.jsx(Xe,{children:m&&a.jsx(z.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>p(!1),children:a.jsxs(z.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:T=>T.stopPropagation(),className:"bg-white rounded-xl p-6 max-w-md w-full shadow-2xl",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Invite Employee"}),a.jsx("button",{onClick:()=>p(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(ur,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address *"}),a.jsx("input",{type:"email",value:k.email,onChange:T=>v({...k,email:T.target.value}),className:"input-field",placeholder:"colleague@example.com"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role *"}),a.jsx("select",{value:k.role,onChange:T=>v({...k,role:T.target.value}),className:"input-field",children:ee.map(T=>a.jsx("option",{value:T.value,children:T.label},T.value))}),a.jsx("div",{className:"mt-2 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(z0,{className:"w-4 h-4 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-blue-800",children:(ne=ee.find(T=>T.value===k.role))==null?void 0:ne.label}),a.jsx("p",{className:"text-xs text-blue-600 mt-0.5",children:(W=ee.find(T=>T.value===k.role))==null?void 0:W.description})]})]})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message (Optional)"}),a.jsx("textarea",{value:k.message,onChange:T=>v({...k,message:T.target.value}),className:"input-field",rows:3,placeholder:"Welcome to the team!"})]})]}),a.jsxs("div",{className:"flex gap-3 mt-6",children:[a.jsx("button",{onClick:()=>p(!1),className:"btn-secondary flex-1",children:"Cancel"}),a.jsx("button",{onClick:S,className:"btn-primary flex-1",children:"Send Invitation"})]})]})})}),a.jsx(Xe,{children:w&&g&&j&&a.jsx(z.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 overflow-y-auto",onClick:()=>b(!1),children:a.jsxs(z.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:T=>T.stopPropagation(),className:"bg-white rounded-xl p-6 max-w-2xl w-full shadow-2xl my-8",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Manage Permissions"}),a.jsx("p",{className:"text-gray-600 mt-1",children:g.full_name})]}),a.jsx("button",{onClick:()=>b(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(ur,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Engagement Permissions"}),a.jsx("div",{className:"space-y-2",children:["can_create_engagements","can_edit_engagements","can_delete_engagements","can_view_all_engagements"].map(T=>a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100",children:[a.jsx("input",{type:"checkbox",checked:j[T],onChange:L=>F({[T]:L.target.checked}),className:"w-5 h-5 text-blue-600 rounded"}),a.jsx("span",{className:"text-sm text-gray-900",children:T.replace(/_/g," ").replace(/can /g,"Can ").replace(/\b\w/g,L=>L.toUpperCase())})]},T))})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"User Management"}),a.jsx("div",{className:"space-y-2",children:["can_invite_users","can_manage_users","can_manage_roles"].map(T=>a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100",children:[a.jsx("input",{type:"checkbox",checked:j[T],onChange:L=>F({[T]:L.target.checked}),className:"w-5 h-5 text-blue-600 rounded"}),a.jsx("span",{className:"text-sm text-gray-900",children:T.replace(/_/g," ").replace(/can /g,"Can ").replace(/\b\w/g,L=>L.toUpperCase())})]},T))})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Firm Settings"}),a.jsx("div",{className:"space-y-2",children:["can_edit_firm_settings","can_manage_billing"].map(T=>a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100",children:[a.jsx("input",{type:"checkbox",checked:j[T],onChange:L=>F({[T]:L.target.checked}),className:"w-5 h-5 text-blue-600 rounded"}),a.jsx("span",{className:"text-sm text-gray-900",children:T.replace(/_/g," ").replace(/can /g,"Can ").replace(/\b\w/g,L=>L.toUpperCase())})]},T))})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Document Management"}),a.jsx("div",{className:"space-y-2",children:["can_upload_documents","can_delete_documents"].map(T=>a.jsxs("label",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100",children:[a.jsx("input",{type:"checkbox",checked:j[T],onChange:L=>F({[T]:L.target.checked}),className:"w-5 h-5 text-blue-600 rounded"}),a.jsx("span",{className:"text-sm text-gray-900",children:T.replace(/_/g," ").replace(/can /g,"Can ").replace(/\b\w/g,L=>L.toUpperCase())})]},T))})]})]}),a.jsx("div",{className:"flex justify-end gap-3 mt-6 pt-6 border-t",children:a.jsx("button",{onClick:()=>b(!1),className:"btn-primary",children:"Done"})})]})})})]})},aP="https://portal.auraai.toroniandcompany.com/api";class nP{constructor(){Wt(this,"api");this.api=ye.create({baseURL:`${aP}/clients`,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(t=>{const r=localStorage.getItem("access_token");return r&&(t.headers.Authorization=`Bearer ${r}`),t}),this.api.interceptors.response.use(t=>t,t=>{var r;return((r=t.response)==null?void 0:r.status)===401&&(localStorage.removeItem("access_token"),window.location.href="/login"),Promise.reject(t)})}async listClients(){const t=await this.api.get("");return Array.isArray(t.data)?t.data:t.data.clients||[]}async getClient(t){return(await this.api.get(`/${t}`)).data}async createClient(t){const r={};for(const[n,i]of Object.entries(t))r[n]=i===""?null:i;return(await this.api.post("",r)).data}async updateClient(t,r){const s={};for(const[i,l]of Object.entries(r))s[i]=l===""?null:l;return(await this.api.patch(`/${t}`,s)).data}async deleteClient(t){await this.api.delete(`/${t}`)}async getClientEngagements(t){return(await this.api.get(`/${t}/engagements`)).data.engagements||[]}}const si=new nP,iP=()=>{ze();const[e,t]=C.useState([]),[r,s]=C.useState(!0),[n,i]=C.useState(""),[l,o]=C.useState("all"),[c,u]=C.useState(!1),[d,f]=C.useState(null),[h,x]=C.useState(null),[m,p]=C.useState({name:"",ein:"",industry:"",address:"",phone:"",email:"",primary_contact_name:"",primary_contact_email:"",primary_contact_phone:"",status:"active",fiscal_year_end:"",notes:""});C.useEffect(()=>{w()},[]);const w=async()=>{var v,E;try{s(!0);const S=await si.listClients();t(S)}catch(S){console.error("Failed to load clients:",S),de.error(((E=(v=S.response)==null?void 0:v.data)==null?void 0:E.detail)||"Failed to load clients")}finally{s(!1)}},b=async()=>{var v,E;if(!m.name){de.error("Client name is required");return}try{h?(await si.updateClient(h.id,m),de.success("Client updated successfully!")):(await si.createClient(m),de.success("Client created successfully!")),u(!1),x(null),j(),w()}catch(S){console.error("Failed to save client:",S),de.error(((E=(v=S.response)==null?void 0:v.data)==null?void 0:E.detail)||"Failed to save client")}},g=v=>{x(v),p({name:v.name,ein:v.ein||"",industry:v.industry||"",address:v.address||"",phone:v.phone||"",email:v.email||"",primary_contact_name:v.primary_contact_name||"",primary_contact_email:v.primary_contact_email||"",primary_contact_phone:v.primary_contact_phone||"",status:v.status,fiscal_year_end:v.fiscal_year_end||"",notes:v.notes||""}),u(!0),f(null)},y=async v=>{var E,S;if(confirm(`Are you sure you want to delete "${v.name}"?`))try{await si.deleteClient(v.id),de.success("Client deleted successfully"),w()}catch(N){console.error("Failed to delete client:",N),de.error(((S=(E=N.response)==null?void 0:E.data)==null?void 0:S.detail)||"Failed to delete client")}},j=()=>{p({name:"",ein:"",industry:"",address:"",phone:"",email:"",primary_contact_name:"",primary_contact_email:"",primary_contact_phone:"",status:"active",fiscal_year_end:"",notes:""})},A=e.filter(v=>{const E=v.name.toLowerCase().includes(n.toLowerCase())||v.email&&v.email.toLowerCase().includes(n.toLowerCase())||v.primary_contact_name&&v.primary_contact_name.toLowerCase().includes(n.toLowerCase()),S=l==="all"||v.status===l;return E&&S}),k=v=>{const E={active:{label:"Active",color:"green",icon:Re},inactive:{label:"Inactive",color:"gray",icon:ox},prospect:{label:"Prospect",color:"yellow",icon:Bs}};return E[v]||E.active};return r?a.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:a.jsxs("div",{className:"flex flex-col items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 border-4 border-primary-500 border-t-transparent rounded-full animate-spin"}),a.jsx("p",{className:"text-body text-neutral-600",children:"Loading clients..."})]})}):a.jsxs("div",{className:"space-y-6 max-w-[1600px]",children:[a.jsxs(z.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-display text-neutral-900 mb-1",children:"Clients"}),a.jsx("p",{className:"text-body text-neutral-600",children:"Manage your audit clients and their information"})]}),a.jsxs(z.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{j(),x(null),u(!0)},className:"fluent-btn-primary",children:[a.jsx($t,{className:"w-4 h-4"}),"Add Client"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[{label:"Total Clients",value:e.length,color:"primary"},{label:"Active",value:e.filter(v=>v.status==="active").length,color:"success"},{label:"Prospects",value:e.filter(v=>v.status==="prospect").length,color:"accent"},{label:"Inactive",value:e.filter(v=>v.status==="inactive").length,color:"neutral"}].map((v,E)=>a.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:E*.05},className:"fluent-card p-4",children:[a.jsx("p",{className:"text-caption text-neutral-600 mb-1",children:v.label}),a.jsx("p",{className:`text-title-large text-${v.color}-600 font-semibold`,children:v.value})]},v.label))}),a.jsx("div",{className:"fluent-card p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(Vs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-neutral-400"}),a.jsx("input",{type:"text",value:n,onChange:v=>i(v.target.value),placeholder:"Search clients...",className:"fluent-input pl-10"})]}),a.jsxs("select",{value:l,onChange:v=>o(v.target.value),className:"fluent-input w-full sm:w-48",children:[a.jsx("option",{value:"all",children:"All Statuses"}),a.jsx("option",{value:"active",children:"Active"}),a.jsx("option",{value:"prospect",children:"Prospect"}),a.jsx("option",{value:"inactive",children:"Inactive"})]})]})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:A.map((v,E)=>{const S=k(v.status),N=S.icon;return a.jsxs(z.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:E*.03},className:"fluent-card-interactive p-5 relative",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"text-body-strong text-neutral-900 truncate mb-1",children:v.name}),v.industry&&a.jsxs("div",{className:"flex items-center gap-2 text-caption text-neutral-600",children:[a.jsx(R6,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"truncate",children:v.industry})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>f(d===v.id?null:v.id),className:"p-1.5 hover:bg-neutral-100 rounded-fluent-sm transition-colors",children:a.jsx(H0,{className:"w-4 h-4 text-neutral-600"})}),a.jsx(Xe,{children:d===v.id&&a.jsxs(z.div,{initial:{opacity:0,scale:.95,y:-5},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95},className:"absolute right-0 top-full mt-1 bg-white rounded-fluent shadow-fluent-8 py-1 z-10 min-w-[140px]",children:[a.jsxs("button",{onClick:()=>g(v),className:"w-full flex items-center gap-2 px-3 py-2 text-body text-neutral-700 hover:bg-neutral-50",children:[a.jsx(Os,{className:"w-4 h-4"}),"Edit"]}),a.jsxs("button",{onClick:()=>y(v),className:"w-full flex items-center gap-2 px-3 py-2 text-body text-error-600 hover:bg-error-50",children:[a.jsx(Ii,{className:"w-4 h-4"}),"Delete"]})]})})]})]}),a.jsx("div",{className:"flex items-center gap-2 mb-3",children:a.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-fluent-sm text-caption font-medium bg-${S.color}-50 text-${S.color}-700`,children:[a.jsx(N,{className:"w-3.5 h-3.5"}),S.label]})}),a.jsxs("div",{className:"space-y-2 text-caption text-neutral-600",children:[v.primary_contact_name&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ha,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"truncate",children:v.primary_contact_name})]}),v.email&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ua,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"truncate",children:v.email})]}),v.phone&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(yN,{className:"w-3.5 h-3.5"}),a.jsx("span",{children:v.phone})]})]})]},v.id)})}),A.length===0&&a.jsxs("div",{className:"fluent-card text-center py-16",children:[a.jsx(Nt,{className:"w-16 h-16 text-neutral-300 mx-auto mb-4"}),a.jsx("h3",{className:"text-title text-neutral-900 mb-2",children:"No clients found"}),a.jsx("p",{className:"text-body text-neutral-600 mb-6",children:"Get started by adding your first client"}),a.jsxs("button",{onClick:()=>u(!0),className:"fluent-btn-primary",children:[a.jsx($t,{className:"w-4 h-4"}),"Add Client"]})]}),a.jsx(Xe,{children:c&&a.jsx(z.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:()=>{u(!1),x(null),j()},children:a.jsxs(z.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:v=>v.stopPropagation(),className:"bg-white rounded-fluent-lg p-6 max-w-3xl w-full shadow-fluent-16 max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-title-large text-neutral-900",children:h?"Edit Client":"Add New Client"}),a.jsx("button",{onClick:()=>{u(!1),x(null),j()},className:"p-2 hover:bg-neutral-100 rounded-fluent-sm",children:a.jsx(ur,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-body-strong text-neutral-900 mb-4",children:"Basic Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Client Name *"}),a.jsx("input",{type:"text",value:m.name,onChange:v=>p({...m,name:v.target.value}),className:"fluent-input",placeholder:"ABC Corporation"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"EIN"}),a.jsx("input",{type:"text",value:m.ein,onChange:v=>p({...m,ein:v.target.value}),className:"fluent-input",placeholder:"XX-XXXXXXX"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Industry"}),a.jsx("input",{type:"text",value:m.industry,onChange:v=>p({...m,industry:v.target.value}),className:"fluent-input",placeholder:"Manufacturing, Healthcare, etc."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Status"}),a.jsxs("select",{value:m.status,onChange:v=>p({...m,status:v.target.value}),className:"fluent-input",children:[a.jsx("option",{value:"active",children:"Active"}),a.jsx("option",{value:"prospect",children:"Prospect"}),a.jsx("option",{value:"inactive",children:"Inactive"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Fiscal Year End"}),a.jsx("input",{type:"date",value:m.fiscal_year_end,onChange:v=>p({...m,fiscal_year_end:v.target.value}),className:"fluent-input"})]})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-body-strong text-neutral-900 mb-4",children:"Contact Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Primary Contact Name"}),a.jsx("input",{type:"text",value:m.primary_contact_name,onChange:v=>p({...m,primary_contact_name:v.target.value}),className:"fluent-input",placeholder:"John Doe"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Contact Email"}),a.jsx("input",{type:"email",value:m.primary_contact_email,onChange:v=>p({...m,primary_contact_email:v.target.value}),className:"fluent-input",placeholder:"contact@client.com"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Contact Phone"}),a.jsx("input",{type:"tel",value:m.primary_contact_phone,onChange:v=>p({...m,primary_contact_phone:v.target.value}),className:"fluent-input",placeholder:"(555) 123-4567"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Client Email"}),a.jsx("input",{type:"email",value:m.email,onChange:v=>p({...m,email:v.target.value}),className:"fluent-input",placeholder:"info@client.com"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Address"}),a.jsx("textarea",{value:m.address,onChange:v=>p({...m,address:v.target.value}),className:"fluent-input",rows:2,placeholder:"Street address, city, state, ZIP"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Phone"}),a.jsx("input",{type:"tel",value:m.phone,onChange:v=>p({...m,phone:v.target.value}),className:"fluent-input",placeholder:"(555) 123-4567"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Notes"}),a.jsx("textarea",{value:m.notes,onChange:v=>p({...m,notes:v.target.value}),className:"fluent-input",rows:3,placeholder:"Additional notes about this client..."})]})]}),a.jsxs("div",{className:"flex gap-3 mt-6 pt-6 border-t border-neutral-200",children:[a.jsx("button",{onClick:()=>{u(!1),x(null),j()},className:"fluent-btn-secondary flex-1",children:"Cancel"}),a.jsx("button",{onClick:b,className:"fluent-btn-primary flex-1",children:h?"Update Client":"Add Client"})]})]})})})]})},lP="https://portal.auraai.toroniandcompany.com/api";class oP{constructor(){Wt(this,"api");this.api=ye.create({baseURL:`${lP}/engagement`,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(t=>{const r=localStorage.getItem("access_token");return r&&(t.headers.Authorization=`Bearer ${r}`),t}),this.api.interceptors.response.use(t=>t,t=>{var r;return((r=t.response)==null?void 0:r.status)===401&&(localStorage.removeItem("access_token"),window.location.href="/login"),Promise.reject(t)})}async listEngagements(){const t=await this.api.get("/engagements");return Array.isArray(t.data)?t.data:t.data.engagements||[]}async getEngagement(t){return(await this.api.get(`/engagements/${t}`)).data}async createEngagement(t){const r={};for(const[n,i]of Object.entries(t))r[n]=i===""?null:i;return(await this.api.post("/engagements",r)).data}async updateEngagement(t,r){return(await this.api.patch(`/engagements/${t}`,r)).data}async deleteEngagement(t){await this.api.delete(`/engagements/${t}`)}async transitionStatus(t,r,s){return(await this.api.post(`/engagements/${t}/transition`,{new_status:r,notes:s})).data}async getEngagementTeam(t){try{const r=await this.api.get(`/engagements/${t}/team`);return r.data.team||r.data||[]}catch{return console.log("Team endpoint not available"),[]}}async addTeamMember(t,r,s){return(await this.api.post(`/engagements/${t}/team`,{user_id:r,role:s})).data}async getBinderTree(t){try{return(await this.api.get(`/engagements/${t}/binder/tree`)).data||[]}catch{return console.log("Binder tree not available"),[]}}async getWorkspaceStats(t){try{const r=await this.getBinderTree(t),s=d=>{let f=0,h=0;for(const x of d)if(x.node_type==="workpaper"&&(f++,(x.status==="completed"||x.status==="reviewed"||x.status==="signed_off")&&h++),x.children&&x.children.length>0){const m=s(x.children);f+=m.total,h+=m.completed}return{total:f,completed:h}},n=s(r);let i={total:0,completed:0};try{const d=await fetch(`/api/documents/engagements/${t}/stats`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(d.ok){const f=await d.json();i={total:f.total_documents||0,completed:f.processed_documents||f.total_documents||0}}}catch{console.log("Document stats not available")}let l={total:0,completed:0},o={total:0,completed:0},c={total:0,completed:0},u={total:0,completed:0};try{const d=await fetch(`/api/financial-analysis/engagements/${t}/stats`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(d.ok){const f=await d.json();l={total:f.total_procedures||0,completed:f.completed_procedures||0}}}catch{console.log("Analytics stats not available")}try{const d=await fetch(`/api/substantive-testing/engagements/${t}/stats`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(d.ok){const f=await d.json();o={total:f.total_tests||0,completed:f.completed_tests||0}}}catch{console.log("Testing stats not available")}try{const d=await fetch(`/api/risk-monitor/engagements/${t}/stats`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(d.ok){const f=await d.json();c={total:f.total_assessments||0,completed:f.completed_assessments||0}}}catch{console.log("Risk stats not available")}try{const d=await fetch(`/api/reporting/engagements/${t}/stats`,{headers:{Authorization:`Bearer ${localStorage.getItem("access_token")}`}});if(d.ok){const f=await d.json();u={total:f.total_reports||0,completed:f.completed_reports||0}}}catch{console.log("Report stats not available")}return{workpapers:n,analytics:l,testing:o,risk:c,documents:i,reports:u}}catch(r){return console.error("Failed to fetch workspace stats:",r),{workpapers:{total:0,completed:0},analytics:{total:0,completed:0},testing:{total:0,completed:0},risk:{total:0,completed:0},documents:{total:0,completed:0},reports:{total:0,completed:0}}}}}const ca=new oP,cP=()=>{const e=ze(),[t,r]=C.useState([]),[s,n]=C.useState([]),[i,l]=C.useState(!0),[o,c]=C.useState(""),[u,d]=C.useState("all"),[f,h]=C.useState("all"),[x,m]=C.useState(!1),[p,w]=C.useState(null),[b,g]=C.useState({client_id:"",client_name:"",name:"",engagement_type:"audit",fiscal_year_end:"",start_date:"",expected_completion_date:""});C.useEffect(()=>{y(),j()},[]);const y=async()=>{var N,D;try{l(!0);const F=await ca.listEngagements();r(F)}catch(F){console.error("Failed to load engagements:",F),de.error(((D=(N=F.response)==null?void 0:N.data)==null?void 0:D.detail)||"Failed to load engagements")}finally{l(!1)}},j=async()=>{try{const N=await si.listClients();n(N)}catch(N){console.error("Failed to load clients:",N)}},A=async()=>{var D,F;if(!(s.length>0?b.client_id:b.client_name)||!b.name||!b.fiscal_year_end){de.error("Please fill in all required fields");return}try{await ca.createEngagement(b),de.success("Engagement created successfully!"),m(!1),g({client_id:"",client_name:"",name:"",engagement_type:"audit",fiscal_year_end:"",start_date:"",expected_completion_date:""}),y()}catch(Y){console.error("Failed to create engagement:",Y),de.error(((F=(D=Y.response)==null?void 0:D.data)==null?void 0:F.detail)||"Failed to create engagement")}},k=async N=>{var D,F;if(confirm(`Are you sure you want to delete "${N.name}"?`))try{await ca.deleteEngagement(N.id),de.success("Engagement deleted successfully"),y()}catch(Y){console.error("Failed to delete engagement:",Y),de.error(((F=(D=Y.response)==null?void 0:D.data)==null?void 0:F.detail)||"Failed to delete engagement")}},v=t.filter(N=>{const D=N.name.toLowerCase().includes(o.toLowerCase())||N.client_id&&N.client_id.toLowerCase().includes(o.toLowerCase()),F=u==="all"||N.status===u,Y=f==="all"||N.engagement_type===f;return D&&F&&Y}),E=N=>{const D={draft:{label:"Draft",color:"gray",icon:Os},planning:{label:"Planning",color:"blue",icon:Jr},fieldwork:{label:"Fieldwork",color:"yellow",icon:nt},review:{label:"Review",color:"purple",icon:cr},finalized:{label:"Finalized",color:"green",icon:Re}};return D[N]||D.draft},S=N=>({audit:"Audit",review:"Review",compilation:"Compilation"})[N]||N;return i?a.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:a.jsxs("div",{className:"flex flex-col items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 border-4 border-primary-500 border-t-transparent rounded-full animate-spin"}),a.jsx("p",{className:"text-body text-neutral-600",children:"Loading engagements..."})]})}):a.jsxs("div",{className:"space-y-6 max-w-[1600px]",children:[a.jsxs(z.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-display text-neutral-900 mb-1",children:"Audits & Engagements"}),a.jsx("p",{className:"text-body text-neutral-600",children:"Manage audit engagements, reviews, and compilations"})]}),a.jsxs(z.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>m(!0),className:"fluent-btn-primary",children:[a.jsx($t,{className:"w-4 h-4"}),"New Engagement"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[{label:"Total Engagements",value:t.length,color:"primary"},{label:"In Progress",value:t.filter(N=>["planning","fieldwork","review"].includes(N.status)).length,color:"accent"},{label:"Finalized",value:t.filter(N=>N.status==="finalized").length,color:"success"},{label:"Draft",value:t.filter(N=>N.status==="draft").length,color:"neutral"}].map((N,D)=>a.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:D*.05},className:"fluent-card p-4",children:[a.jsx("p",{className:"text-caption text-neutral-600 mb-1",children:N.label}),a.jsx("p",{className:`text-title-large text-${N.color}-600 font-semibold`,children:N.value})]},N.label))}),a.jsx("div",{className:"fluent-card p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(Vs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-neutral-400"}),a.jsx("input",{type:"text",value:o,onChange:N=>c(N.target.value),placeholder:"Search engagements...",className:"fluent-input pl-10"})]}),a.jsxs("select",{value:u,onChange:N=>d(N.target.value),className:"fluent-input w-full sm:w-48",children:[a.jsx("option",{value:"all",children:"All Statuses"}),a.jsx("option",{value:"draft",children:"Draft"}),a.jsx("option",{value:"planning",children:"Planning"}),a.jsx("option",{value:"fieldwork",children:"Fieldwork"}),a.jsx("option",{value:"review",children:"Review"}),a.jsx("option",{value:"finalized",children:"Finalized"})]}),a.jsxs("select",{value:f,onChange:N=>h(N.target.value),className:"fluent-input w-full sm:w-48",children:[a.jsx("option",{value:"all",children:"All Types"}),a.jsx("option",{value:"audit",children:"Audit"}),a.jsx("option",{value:"review",children:"Review"}),a.jsx("option",{value:"compilation",children:"Compilation"})]})]})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:v.map((N,D)=>{const F=E(N.status),Y=F.icon;return a.jsxs(z.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:D*.03},className:"fluent-card-interactive p-5 relative",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"text-body-strong text-neutral-900 truncate mb-1",children:N.name}),a.jsxs("div",{className:"flex items-center gap-2 text-caption text-neutral-600",children:[a.jsx(Nt,{className:"w-3.5 h-3.5"}),a.jsxs("span",{className:"truncate",children:["Client ID: ",N.client_id]})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>w(p===N.id?null:N.id),className:"p-1.5 hover:bg-neutral-100 rounded-fluent-sm transition-colors",children:a.jsx(H0,{className:"w-4 h-4 text-neutral-600"})}),a.jsx(Xe,{children:p===N.id&&a.jsxs(z.div,{initial:{opacity:0,scale:.95,y:-5},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95},className:"absolute right-0 top-full mt-1 bg-white rounded-fluent shadow-fluent-8 py-1 z-10 min-w-[180px]",children:[a.jsxs("button",{onClick:()=>e(`/firm/engagements/${N.id}/workspace`),className:"w-full flex items-center gap-2 px-3 py-2 text-body text-neutral-700 hover:bg-neutral-50",children:[a.jsx(cr,{className:"w-4 h-4"}),"Open Workspace"]}),a.jsxs("button",{className:"w-full flex items-center gap-2 px-3 py-2 text-body text-neutral-700 hover:bg-neutral-50",children:[a.jsx(Os,{className:"w-4 h-4"}),"Edit"]}),a.jsxs("button",{onClick:()=>k(N),className:"w-full flex items-center gap-2 px-3 py-2 text-body text-error-600 hover:bg-error-50",children:[a.jsx(Ii,{className:"w-4 h-4"}),"Delete"]})]})})]})]}),a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-fluent-sm text-caption font-medium bg-${F.color}-50 text-${F.color}-700`,children:[a.jsx(Y,{className:"w-3.5 h-3.5"}),F.label]}),a.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-fluent-sm text-caption font-medium bg-neutral-100 text-neutral-700",children:S(N.engagement_type)})]}),a.jsxs("div",{className:"space-y-2 text-caption text-neutral-600",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Jr,{className:"w-3.5 h-3.5"}),a.jsxs("span",{children:["FYE: ",new Date(N.fiscal_year_end).toLocaleDateString()]})]}),N.expected_completion_date&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(nt,{className:"w-3.5 h-3.5"}),a.jsxs("span",{children:["Due: ",new Date(N.expected_completion_date).toLocaleDateString()]})]})]})]},N.id)})}),v.length===0&&a.jsxs("div",{className:"fluent-card text-center py-16",children:[a.jsx($e,{className:"w-16 h-16 text-neutral-300 mx-auto mb-4"}),a.jsx("h3",{className:"text-title text-neutral-900 mb-2",children:"No engagements found"}),a.jsx("p",{className:"text-body text-neutral-600 mb-6",children:"Get started by creating your first engagement"}),a.jsxs("button",{onClick:()=>m(!0),className:"fluent-btn-primary",children:[a.jsx($t,{className:"w-4 h-4"}),"Create Engagement"]})]}),a.jsx(Xe,{children:x&&a.jsx(z.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:()=>m(!1),children:a.jsxs(z.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:N=>N.stopPropagation(),className:"bg-white rounded-fluent-lg p-6 max-w-2xl w-full shadow-fluent-16 max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-title-large text-neutral-900",children:"Create New Engagement"}),a.jsx("button",{onClick:()=>m(!1),className:"p-2 hover:bg-neutral-100 rounded-fluent-sm",children:a.jsx(ur,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Client *"}),s.length>0?a.jsxs("select",{value:b.client_id,onChange:N=>{const D=s.find(F=>F.id===N.target.value);g({...b,client_id:N.target.value,client_name:(D==null?void 0:D.name)||""})},className:"fluent-input",children:[a.jsx("option",{value:"",children:"Select a client"}),s.map(N=>a.jsx("option",{value:N.id,children:N.name},N.id))]}):a.jsxs("div",{className:"space-y-2",children:[a.jsx("input",{type:"text",value:b.client_name,onChange:N=>g({...b,client_name:N.target.value}),className:"fluent-input",placeholder:"Enter client name"}),a.jsxs("p",{className:"text-caption text-neutral-600",children:[a.jsx("button",{onClick:()=>{m(!1),e("/firm/clients")},className:"text-primary-500 hover:text-primary-600 font-medium",children:"Add clients"})," ","first for easier engagement setup"]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Engagement Name *"}),a.jsx("input",{type:"text",value:b.name,onChange:N=>g({...b,name:N.target.value}),className:"fluent-input",placeholder:"e.g., FY 2024 Financial Audit"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Engagement Type *"}),a.jsxs("select",{value:b.engagement_type,onChange:N=>g({...b,engagement_type:N.target.value}),className:"fluent-input",children:[a.jsx("option",{value:"audit",children:"Audit"}),a.jsx("option",{value:"review",children:"Review"}),a.jsx("option",{value:"compilation",children:"Compilation"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Fiscal Year End *"}),a.jsx("input",{type:"date",value:b.fiscal_year_end,onChange:N=>g({...b,fiscal_year_end:N.target.value}),className:"fluent-input"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Start Date"}),a.jsx("input",{type:"date",value:b.start_date,onChange:N=>g({...b,start_date:N.target.value}),className:"fluent-input"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Expected Completion"}),a.jsx("input",{type:"date",value:b.expected_completion_date,onChange:N=>g({...b,expected_completion_date:N.target.value}),className:"fluent-input"})]})]})]}),a.jsxs("div",{className:"flex gap-3 mt-6 pt-6 border-t border-neutral-200",children:[a.jsx("button",{onClick:()=>m(!1),className:"fluent-btn-secondary flex-1",children:"Cancel"}),a.jsx("button",{onClick:A,className:"fluent-btn-primary flex-1",children:"Create Engagement"})]})]})})})]})},uP="https://portal.auraai.toroniandcompany.com/api";class dP{constructor(){Wt(this,"api");this.api=ye.create({baseURL:`${uP}/reporting`,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(t=>{const r=localStorage.getItem("access_token");return r&&(t.headers.Authorization=`Bearer ${r}`),t}),this.api.interceptors.response.use(t=>t,t=>{var r;return((r=t.response)==null?void 0:r.status)===401&&(localStorage.removeItem("access_token"),window.location.href="/login"),Promise.reject(t)})}async listReports(){return(await this.api.get("/reports")).data.reports||[]}async getReport(t){return(await this.api.get(`/reports/${t}`)).data}async createReport(t){return(await this.api.post("/reports",t)).data}async generateReport(t){return(await this.api.post(`/reports/${t}/generate`)).data}async downloadReport(t){return(await this.api.get(`/reports/${t}/download`,{responseType:"blob"})).data}async getStats(){return(await this.api.get("/stats")).data}}const Lu=new dP,fP=()=>{ze();const[e,t]=C.useState([]),[r,s]=C.useState([]),[n,i]=C.useState(!0),[l,o]=C.useState(""),[c,u]=C.useState("all"),[d,f]=C.useState("all"),[h,x]=C.useState(!1),[m,p]=C.useState(null),[w,b]=C.useState({engagement_id:"",report_type:"financial_statement",title:"",description:"",report_data:{},fiscal_year:new Date().getFullYear().toString()});C.useEffect(()=>{g()},[]);const g=async()=>{var N,D;try{i(!0);const[F,Y]=await Promise.all([Lu.listReports(),ca.listEngagements()]);t(F),s(Y)}catch(F){console.error("Failed to load data:",F),de.error(((D=(N=F.response)==null?void 0:N.data)==null?void 0:D.detail)||"Failed to load reports")}finally{i(!1)}},y=async()=>{var N,D;if(!w.engagement_id||!w.title){de.error("Please fill in all required fields");return}try{const F=await Lu.createReport(w);de.success("Report created successfully!"),x(!1),b({engagement_id:"",report_type:"financial_statement",title:"",description:"",report_data:{},fiscal_year:new Date().getFullYear().toString()}),g();try{await Lu.generateReport(F.id),de.success("Report generation started"),g()}catch(Y){console.error("Failed to generate report:",Y)}}catch(F){console.error("Failed to create report:",F),de.error(((D=(N=F.response)==null?void 0:N.data)==null?void 0:D.detail)||"Failed to create report")}},j=async N=>{var D,F;try{const Y=await Lu.downloadReport(N.id),Q=window.URL.createObjectURL(Y),ae=document.createElement("a");ae.href=Q,ae.download=`${N.title}.pdf`,document.body.appendChild(ae),ae.click(),document.body.removeChild(ae),window.URL.revokeObjectURL(Q),de.success("Report downloaded successfully")}catch(Y){console.error("Failed to download report:",Y),de.error(((F=(D=Y.response)==null?void 0:D.data)==null?void 0:F.detail)||"Failed to download report")}},A=e.filter(N=>{const D=N.title.toLowerCase().includes(l.toLowerCase())||N.description&&N.description.toLowerCase().includes(l.toLowerCase()),F=c==="all"||N.status===c,Y=d==="all"||N.report_type===d;return D&&F&&Y}),k=N=>{const D={draft:{label:"Draft",color:"neutral",icon:$e},generating:{label:"Generating",color:"blue",icon:W6},completed:{label:"Completed",color:"success",icon:Re},failed:{label:"Failed",color:"error",icon:Bs}};return D[N]||D.draft},v=[{value:"financial_statement",label:"Financial Statement"},{value:"audit_report",label:"Audit Report"},{value:"management_letter",label:"Management Letter"},{value:"tax_return",label:"Tax Return"},{value:"compilation_report",label:"Compilation Report"},{value:"review_report",label:"Review Report"}],E=N=>{var D;return((D=v.find(F=>F.value===N))==null?void 0:D.label)||N},S={total:e.length,completed:e.filter(N=>N.status==="completed").length,generating:e.filter(N=>N.status==="generating").length,failed:e.filter(N=>N.status==="failed").length};return n?a.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:a.jsxs("div",{className:"flex flex-col items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 border-4 border-primary-500 border-t-transparent rounded-full animate-spin"}),a.jsx("p",{className:"text-body text-neutral-600",children:"Loading reports..."})]})}):a.jsxs("div",{className:"space-y-6 max-w-[1600px]",children:[a.jsxs(z.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-display text-neutral-900 mb-1",children:"Reports & Analytics"}),a.jsx("p",{className:"text-body text-neutral-600",children:"Generate and manage audit reports, financial statements, and more"})]}),a.jsxs(z.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>x(!0),className:"fluent-btn-primary",children:[a.jsx($t,{className:"w-4 h-4"}),"Generate Report"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[{label:"Total Reports",value:S.total,color:"primary",icon:Ba},{label:"Completed",value:S.completed,color:"success",icon:Re},{label:"Generating",value:S.generating,color:"accent",icon:nt},{label:"Failed",value:S.failed,color:"error",icon:Bs}].map((N,D)=>{const F=N.icon;return a.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:D*.05},className:"fluent-card p-4",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsx("p",{className:"text-caption text-neutral-600",children:N.label}),a.jsx(F,{className:`w-4 h-4 text-${N.color}-500`})]}),a.jsx("p",{className:`text-title-large text-${N.color}-600 font-semibold`,children:N.value})]},N.label)})}),a.jsx("div",{className:"fluent-card p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(Vs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-neutral-400"}),a.jsx("input",{type:"text",value:l,onChange:N=>o(N.target.value),placeholder:"Search reports...",className:"fluent-input pl-10"})]}),a.jsxs("select",{value:c,onChange:N=>u(N.target.value),className:"fluent-input w-full sm:w-48",children:[a.jsx("option",{value:"all",children:"All Statuses"}),a.jsx("option",{value:"draft",children:"Draft"}),a.jsx("option",{value:"generating",children:"Generating"}),a.jsx("option",{value:"completed",children:"Completed"}),a.jsx("option",{value:"failed",children:"Failed"})]}),a.jsxs("select",{value:d,onChange:N=>f(N.target.value),className:"fluent-input w-full sm:w-48",children:[a.jsx("option",{value:"all",children:"All Types"}),v.map(N=>a.jsx("option",{value:N.value,children:N.label},N.value))]})]})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:A.map((N,D)=>{const F=k(N.status),Y=F.icon;return a.jsxs(z.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:D*.03},className:"fluent-card-interactive p-5 relative",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"text-body-strong text-neutral-900 mb-1",children:N.title}),N.description&&a.jsx("p",{className:"text-caption text-neutral-600 line-clamp-2",children:N.description})]}),a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>p(m===N.id?null:N.id),className:"p-1.5 hover:bg-neutral-100 rounded-fluent-sm transition-colors",children:a.jsx(H0,{className:"w-4 h-4 text-neutral-600"})}),a.jsx(Xe,{children:m===N.id&&a.jsxs(z.div,{initial:{opacity:0,scale:.95,y:-5},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95},className:"absolute right-0 top-full mt-1 bg-white rounded-fluent shadow-fluent-8 py-1 z-10 min-w-[140px]",children:[N.status==="completed"&&a.jsxs("button",{onClick:()=>j(N),className:"w-full flex items-center gap-2 px-3 py-2 text-body text-neutral-700 hover:bg-neutral-50",children:[a.jsx(xs,{className:"w-4 h-4"}),"Download PDF"]}),a.jsxs("button",{className:"w-full flex items-center gap-2 px-3 py-2 text-body text-neutral-700 hover:bg-neutral-50",children:[a.jsx(cr,{className:"w-4 h-4"}),"View Details"]}),a.jsxs("button",{className:"w-full flex items-center gap-2 px-3 py-2 text-body text-error-600 hover:bg-error-50",children:[a.jsx(Ii,{className:"w-4 h-4"}),"Delete"]})]})})]})]}),a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-fluent-sm text-caption font-medium bg-${F.color}-50 text-${F.color}-700`,children:[a.jsx(Y,{className:`w-3.5 h-3.5 ${N.status==="generating"?"animate-spin":""}`}),F.label]}),a.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-fluent-sm text-caption font-medium bg-neutral-100 text-neutral-700",children:E(N.report_type)})]}),a.jsxs("div",{className:"space-y-2 text-caption text-neutral-600",children:[N.fiscal_year&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Jr,{className:"w-3.5 h-3.5"}),a.jsxs("span",{children:["FY ",N.fiscal_year]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(nt,{className:"w-3.5 h-3.5"}),a.jsxs("span",{children:["Created ",new Date(N.created_at).toLocaleDateString()]})]})]}),N.status==="completed"&&a.jsxs(z.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>j(N),className:"w-full mt-3 fluent-btn-primary py-2",children:[a.jsx(xs,{className:"w-4 h-4"}),"Download PDF"]})]},N.id)})}),A.length===0&&a.jsxs("div",{className:"fluent-card text-center py-16",children:[a.jsx(Ba,{className:"w-16 h-16 text-neutral-300 mx-auto mb-4"}),a.jsx("h3",{className:"text-title text-neutral-900 mb-2",children:"No reports found"}),a.jsx("p",{className:"text-body text-neutral-600 mb-6",children:"Generate your first report to get started"}),a.jsxs("button",{onClick:()=>x(!0),className:"fluent-btn-primary",children:[a.jsx($t,{className:"w-4 h-4"}),"Generate Report"]})]}),a.jsx(Xe,{children:h&&a.jsx(z.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:()=>x(!1),children:a.jsxs(z.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:N=>N.stopPropagation(),className:"bg-white rounded-fluent-lg p-6 max-w-2xl w-full shadow-fluent-16 max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-title-large text-neutral-900",children:"Generate New Report"}),a.jsx("button",{onClick:()=>x(!1),className:"p-2 hover:bg-neutral-100 rounded-fluent-sm",children:a.jsx(ur,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Engagement *"}),a.jsxs("select",{value:w.engagement_id,onChange:N=>b({...w,engagement_id:N.target.value}),className:"fluent-input",children:[a.jsx("option",{value:"",children:"Select engagement"}),r.map(N=>a.jsx("option",{value:N.id,children:N.name},N.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Report Type *"}),a.jsx("select",{value:w.report_type,onChange:N=>b({...w,report_type:N.target.value}),className:"fluent-input",children:v.map(N=>a.jsx("option",{value:N.value,children:N.label},N.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Report Title *"}),a.jsx("input",{type:"text",value:w.title,onChange:N=>b({...w,title:N.target.value}),className:"fluent-input",placeholder:"e.g., FY 2024 Audit Report"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Description"}),a.jsx("textarea",{value:w.description,onChange:N=>b({...w,description:N.target.value}),className:"fluent-input",rows:3,placeholder:"Optional description"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Fiscal Year"}),a.jsx("input",{type:"text",value:w.fiscal_year,onChange:N=>b({...w,fiscal_year:N.target.value}),className:"fluent-input",placeholder:"2024"})]})]}),a.jsxs("div",{className:"flex gap-3 mt-6 pt-6 border-t border-neutral-200",children:[a.jsx("button",{onClick:()=>x(!1),className:"fluent-btn-secondary flex-1",children:"Cancel"}),a.jsx("button",{onClick:y,className:"fluent-btn-primary flex-1",children:"Generate Report"})]})]})})})]})},Vy=72,Kf=2*Math.PI*52,hP=[{label:"Documents received",value:"48 / 62",meta:"4 approved today",icon:$e,accent:"bg-primary-50 text-primary-600"},{label:"Data connections",value:"5 / 6",meta:"Payroll refresh in 22m",icon:gN,accent:"bg-success-50 text-success-600"},{label:"Engagement progress",value:"72%",meta:"On track",icon:Yd,accent:"bg-accent-50 text-accent-600"},{label:"Team responses",value:"3 pending",meta:"Avg. SLA 2h",icon:zs,accent:"bg-warning-50 text-warning-700"}],mP=[{name:"Financial statements",owner:"Controller",progress:82,status:"On track"},{name:"Internal controls",owner:"Compliance",progress:64,status:"Monitoring"},{name:"Tax & payroll",owner:"Payroll",progress:58,status:"Action needed"},{name:"Reg AB schedules",owner:"Treasury",progress:38,status:"Behind"}],pP=[{id:1,title:"Upload signed management representation letter",detail:"Signed by CFO & Controller",due:"Due tomorrow  9:00 AM",priority:"critical"},{id:2,title:"Approve Q4 bank confirmations",detail:"2 confirmations awaiting signature",due:"Due in 3 days",priority:"high"},{id:3,title:"Schedule walkthrough with engagement team",detail:"Focus on revenue recognition",due:"Due next week",priority:"medium"}],xP=[{id:1,title:"Bank confirmations approved",detail:"Primary, Sweep, Payroll accounts",time:"Today  09:12 AM",status:"Completed"},{id:2,title:"QuickBooks sync finished",detail:"Imported 1,248 transactions",time:"Yesterday  05:18 PM",status:"Synced"},{id:3,title:"Control evidence uploaded",detail:"Revenue cut-off walkthrough files",time:"Yesterday  02:44 PM",status:"Reviewed"}],gP=[{label:"Trial balance",status:"Approved",tone:"text-success-600 bg-success-50",icon:P6},{label:"Bank recs",status:"In review",tone:"text-warning-700 bg-warning-50",icon:$e},{label:"Contracts",status:"Pending upload",tone:"text-primary-600 bg-primary-50",icon:cF}],yP=[{label:"QuickBooks Online",status:"Connected",meta:"Synced 12m ago",tone:"text-success-600 bg-success-50"},{label:"ADP Workforce",status:"Syncing",meta:"Payroll batch running",tone:"text-warning-700 bg-warning-50"},{label:"Plaid Banking",status:"Secure hold",meta:"Waiting on MFA",tone:"text-accent-600 bg-accent-50"}],zy=()=>a.jsx("div",{className:"min-h-screen bg-[radial-gradient(circle_at_top,_#eef5ff,_#f8fafc_45%,_#f4f6fb)] px-6 py-10",children:a.jsxs("div",{className:"mx-auto flex w-full max-w-[1440px] flex-col gap-8",children:[a.jsx(z.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-gradient-to-r from-[#0f5ed5] to-[#2563eb] rounded-2xl px-8 py-4 text-white text-center shadow-lg",children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsx(Re,{className:"w-5 h-5"}),a.jsx("h1",{className:"text-xl font-semibold tracking-wide",children:"AUDIT CLIENT DASHBOARD - FOR COMPANIES BEING AUDITED"})]})}),a.jsxs(z.section,{initial:{opacity:0,y:16},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.1,.9,.2,1]},className:"relative overflow-hidden rounded-[32px] border border-white/60 bg-gradient-to-br from-[#0f5ed5] via-[#2563eb] to-[#4f46e5] p-10 text-white shadow-[0_20px_60px_rgba(15,94,213,0.25)]",children:[a.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:"radial-gradient(circle at 20% 20%, rgba(255,255,255,0.4), transparent 40%)"}}),a.jsxs("div",{className:"relative grid gap-10 md:grid-cols-[1.6fr_1fr]",children:[a.jsxs("div",{className:"space-y-6",children:[a.jsx("p",{className:"text-sm font-semibold uppercase tracking-[0.2em] text-white/80",children:"Anderson & Co.  Financial Statement Audit"}),a.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[a.jsx("span",{className:"rounded-full bg-white/15 px-4 py-1 text-sm font-medium backdrop-blur",children:"FY24 Audit Binder"}),a.jsx("span",{className:"rounded-full bg-white/10 px-4 py-1 text-sm font-medium backdrop-blur",children:"Due Jan 30, 2025"}),a.jsx("span",{className:"rounded-full bg-emerald-500/20 px-4 py-1 text-sm font-medium",children:"Status  On track"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-8",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm uppercase tracking-[0.2em] text-white/70",children:"Overall progress"}),a.jsxs("div",{className:"mt-2 flex items-end gap-3",children:[a.jsxs("span",{className:"text-6xl font-semibold leading-none",children:[Vy,"%"]}),a.jsx("span",{className:"text-white/70",children:"(+6% this week)"})]})]}),a.jsxs("div",{className:"relative h-32 w-32",children:[a.jsxs("svg",{className:"h-full w-full -rotate-90",viewBox:"0 0 120 120",children:[a.jsx("circle",{cx:"60",cy:"60",r:"52",stroke:"rgba(255,255,255,0.2)",strokeWidth:"12",fill:"none"}),a.jsx("circle",{cx:"60",cy:"60",r:"52",stroke:"url(#progressGradient)",strokeWidth:"12",strokeLinecap:"round",fill:"none",strokeDasharray:Kf,strokeDashoffset:Kf-Vy/100*Kf}),a.jsx("defs",{children:a.jsxs("linearGradient",{id:"progressGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[a.jsx("stop",{offset:"0%",stopColor:"#a5b4fc"}),a.jsx("stop",{offset:"100%",stopColor:"#22d3ee"})]})})]}),a.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-center",children:[a.jsx("p",{className:"text-sm text-white/80",children:"Phase"}),a.jsx("p",{className:"text-xl font-semibold",children:"Fieldwork"})]})]})]}),a.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[a.jsxs("button",{className:"flex items-center justify-between rounded-2xl bg-white/10 px-6 py-4 text-left text-white shadow-lg shadow-black/10 backdrop-blur transition hover:bg-white/20",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-white/70",children:"Next milestone"}),a.jsx("p",{className:"text-lg font-semibold",children:"Management letter draft"})]}),a.jsx(F6,{className:"h-5 w-5"})]}),a.jsxs("button",{className:"flex items-center justify-between rounded-2xl border border-white/30 px-6 py-4 text-left text-white/90 backdrop-blur transition hover:bg-white/10",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm",children:"Engagement lead"}),a.jsx("p",{className:"text-lg font-semibold",children:"Sloane Mitchell, CPA"})]}),a.jsx(K6,{className:"h-5 w-5"})]})]})]}),a.jsxs("div",{className:"rounded-[28px] border border-white/30 bg-white/15 p-6 backdrop-blur-md",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(We,{className:"h-5 w-5"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm uppercase tracking-[0.25em] text-white/70",children:"Critical timeline"}),a.jsx("p",{className:"text-lg font-semibold",children:"Next 7 days"})]})]}),a.jsx("div",{className:"mt-6 space-y-5",children:[{label:"Walkthrough w/ audit senior",time:"Tomorrow  10:00 AM"},{label:"Revenue controls evidence",time:"In 3 days  Upload window"},{label:"Fieldwork checkpoint",time:"Jan 18  Partner & CFO"}].map(e=>a.jsxs("div",{className:"flex items-center gap-4 rounded-2xl border border-white/20 px-4 py-3",children:[a.jsx(Jr,{className:"h-10 w-10 text-white/70"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-white/70",children:e.time}),a.jsx("p",{className:"font-semibold",children:e.label})]})]},e.label))})]})]})]}),a.jsx("section",{className:"grid gap-5 md:grid-cols-2 xl:grid-cols-4",children:hP.map(e=>a.jsxs(z.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},transition:{duration:.3},className:"rounded-3xl border border-white/60 bg-white/80 p-6 shadow-[0_4px_24px_rgba(15,23,42,0.05)] backdrop-blur",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`rounded-2xl px-3 py-2 text-sm font-semibold ${e.accent}`,children:a.jsx(e.icon,{className:"h-4 w-4"})}),a.jsx("p",{className:"text-sm font-medium text-neutral-500",children:e.label})]}),a.jsx("p",{className:"mt-4 text-3xl font-semibold tracking-tight text-neutral-900",children:e.value}),a.jsx("p",{className:"mt-1 text-sm text-neutral-500",children:e.meta})]},e.label))}),a.jsxs("section",{className:"grid gap-6 xl:grid-cols-[2fr_1.3fr]",children:[a.jsxs("div",{className:"rounded-3xl border border-white/80 bg-white/90 p-6 shadow-[0_15px_45px_rgba(15,23,42,0.08)]",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-neutral-500",children:"Workstreams"}),a.jsx("p",{className:"text-2xl font-semibold text-neutral-900",children:"Engagement readiness"})]}),a.jsx("span",{className:"rounded-full bg-primary-50 px-4 py-1 text-sm font-semibold text-primary-600",children:"Fieldwork phase"})]}),a.jsx("div",{className:"mt-6 space-y-5",children:mP.map(e=>a.jsxs("div",{className:"rounded-2xl border border-neutral-100 bg-neutral-50/60 p-5",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-lg font-semibold text-neutral-900",children:e.name}),a.jsxs("p",{className:"text-sm text-neutral-500",children:["Owner  ",e.owner]})]}),a.jsx("span",{className:"rounded-full bg-white px-3 py-1 text-sm font-semibold text-neutral-600 shadow-sm",children:e.status})]}),a.jsx("div",{className:"mt-4 h-2 rounded-full bg-neutral-200",children:a.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-primary-500 to-cyan-400 transition-all",style:{width:`${e.progress}%`}})}),a.jsxs("p",{className:"mt-2 text-sm font-medium text-neutral-600",children:[e.progress,"% complete"]})]},e.name))})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"rounded-3xl border border-white/80 bg-white/95 p-6 shadow-lg",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-xl font-semibold text-neutral-900",children:"Action center"}),a.jsx("span",{className:"text-sm font-medium text-neutral-500",children:"High-priority queue"})]}),a.jsx("div",{className:"mt-4 space-y-4",children:pP.map(e=>a.jsx("div",{className:"rounded-2xl border border-neutral-100 bg-neutral-50/60 p-4",children:a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-neutral-900",children:e.title}),a.jsx("p",{className:"text-sm text-neutral-500",children:e.detail})]}),a.jsx("span",{className:`rounded-full px-3 py-1 text-xs font-semibold ${e.priority==="critical"?"bg-error-50 text-error-600":e.priority==="high"?"bg-warning-50 text-warning-700":"bg-neutral-100 text-neutral-600"}`,children:e.due})]})},e.id))})]}),a.jsxs("div",{className:"rounded-3xl border border-white/80 bg-white/95 p-6 shadow-lg",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(vc,{className:"h-5 w-5 text-primary-500"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-primary-500",children:"AI assistant"}),a.jsx("p",{className:"text-xl font-semibold text-neutral-900",children:"Insights & nudges"})]})]}),a.jsxs("ul",{className:"mt-4 space-y-3 text-sm text-neutral-600",children:[a.jsxs("li",{className:"flex items-start gap-3 rounded-2xl bg-primary-50/80 p-4",children:[a.jsx(Re,{className:"mt-0.5 h-4 w-4 text-primary-500"}),"Revenue cut-off testing can start once contracts upload completes."]}),a.jsxs("li",{className:"flex items-start gap-3 rounded-2xl bg-neutral-50 p-4",children:[a.jsx(Qe,{className:"mt-0.5 h-4 w-4 text-warning-700"}),"2 payroll variance items exceed 15% threshold  flag for reviewer."]}),a.jsxs("li",{className:"flex items-start gap-3 rounded-2xl bg-neutral-50 p-4",children:[a.jsx(We,{className:"mt-0.5 h-4 w-4 text-success-600"}),"SOC 1 Type II report uploaded and ready for auditor download."]})]})]})]})]}),a.jsxs("section",{className:"grid gap-6 xl:grid-cols-[1.5fr_1fr]",children:[a.jsxs("div",{className:"rounded-3xl border border-white/80 bg-white p-6 shadow-[0_25px_65px_rgba(15,23,42,0.06)]",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-2xl font-semibold text-neutral-900",children:"Engagement timeline"}),a.jsx("span",{className:"text-sm text-neutral-500",children:"Last 24 hours"})]}),a.jsx("div",{className:"mt-6 space-y-6",children:xP.map(e=>a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsxs("div",{className:"relative flex h-12 w-12 items-center justify-center rounded-2xl bg-neutral-50",children:[a.jsx("span",{className:"text-sm font-semibold text-primary-600",children:e.status}),a.jsx("span",{className:"absolute -bottom-6 left-1/2 h-6 w-px -translate-x-1/2 bg-neutral-200"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-lg font-semibold text-neutral-900",children:e.title}),a.jsx("p",{className:"text-sm text-neutral-500",children:e.detail}),a.jsx("p",{className:"text-sm text-neutral-400",children:e.time})]})]},e.id))})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"rounded-3xl border border-white/80 bg-white/95 p-6 shadow-lg",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-xl font-semibold text-neutral-900",children:"Document readiness"}),a.jsx("span",{className:"text-sm text-neutral-500",children:"Live sync"})]}),a.jsx("div",{className:"mt-4 space-y-3",children:gP.map(e=>a.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-neutral-100 px-4 py-3",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(e.icon,{className:"h-5 w-5 text-neutral-500"}),a.jsx("span",{className:"font-medium text-neutral-800",children:e.label})]}),a.jsx("span",{className:`rounded-full px-3 py-1 text-xs font-semibold ${e.tone}`,children:e.status})]},e.label))})]}),a.jsxs("div",{className:"rounded-3xl border border-white/80 bg-white/95 p-6 shadow-lg",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-xl font-semibold text-neutral-900",children:"Integration health"}),a.jsx("span",{className:"rounded-full bg-neutral-100 px-3 py-1 text-xs font-semibold text-neutral-600",children:"SOC 2 compliant"})]}),a.jsx("div",{className:"mt-4 space-y-3",children:yP.map(e=>a.jsx("div",{className:"rounded-2xl border border-neutral-100 px-4 py-3",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-neutral-900",children:e.label}),a.jsx("p",{className:"text-sm text-neutral-500",children:e.meta})]}),a.jsx("span",{className:`rounded-full px-3 py-1 text-xs font-semibold ${e.tone}`,children:e.status})]})},e.label))})]})]})]}),a.jsx("section",{className:"rounded-[32px] border border-white/70 bg-white/90 p-8 shadow-[0_20px_65px_rgba(15,23,42,0.05)]",children:a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-6",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold uppercase tracking-[0.3em] text-neutral-500",children:"Concierge support"}),a.jsx("p",{className:"mt-2 text-2xl font-semibold text-neutral-900",children:"CPA engagement team on standby"}),a.jsx("p",{className:"mt-1 text-neutral-500",children:"Dedicated audit channel with guaranteed 1-hour SLA during fieldwork"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[a.jsx("button",{className:"rounded-2xl border border-neutral-200 px-5 py-3 text-sm font-semibold text-neutral-700 transition hover:bg-neutral-50",children:"Message audit senior"}),a.jsx("button",{className:"rounded-2xl bg-neutral-900 px-5 py-3 text-sm font-semibold text-white shadow-lg shadow-neutral-900/20 transition hover:bg-neutral-800",children:"Book checkpoint"})]})]})})]})}),Hn="https://portal.auraai.toroniandcompany.com/api";class vP{async uploadDocument(t,r,s){const n=new FormData;return n.append("file",t),n.append("category",r),s&&n.append("engagementId",s),(await ye.post(`${Hn}/documents/upload`,n,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:l=>{const o=Math.round(l.loaded*100/(l.total||1));window.dispatchEvent(new CustomEvent("document-upload-progress",{detail:{fileName:t.name,progress:o}}))}})).data}async uploadMultipleDocuments(t,r,s){const n=t.map(i=>this.uploadDocument(i,r,s));return Promise.all(n)}async getDocuments(t){const r=t?{engagementId:t}:{};return(await ye.get(`${Hn}/documents`,{params:r})).data}async getDocumentRequirements(t){return(await ye.get(`${Hn}/documents/requirements/${t}`)).data}async deleteDocument(t){await ye.delete(`${Hn}/documents/${t}`)}async downloadDocument(t){return(await ye.get(`${Hn}/documents/${t}/download`,{responseType:"blob"})).data}getDocumentCategories(){return[{value:"financial_statements",label:"Financial Statements",description:"Balance sheet, income statement, cash flow statement",icon:"FileSpreadsheet"},{value:"bank_statements",label:"Bank Statements",description:"Monthly bank statements and reconciliations",icon:"Building2"},{value:"invoices",label:"Invoices",description:"Sales invoices and accounts receivable",icon:"Receipt"},{value:"receipts",label:"Receipts",description:"Expense receipts and supporting documentation",icon:"FileText"},{value:"contracts",label:"Contracts",description:"Agreements, leases, and legal documents",icon:"FileSignature"},{value:"tax_documents",label:"Tax Documents",description:"Tax returns, 1099s, W-2s, and tax filings",icon:"Calculator"},{value:"payroll",label:"Payroll",description:"Payroll registers, tax filings, and employee records",icon:"Users"},{value:"other",label:"Other",description:"Additional supporting documentation",icon:"Folder"}]}async extractDocumentData(t){return(await ye.post(`${Hn}/documents/${t}/extract`)).data}getDocumentPreviewUrl(t){return`${Hn}/documents/${t}/preview`}}const Gi=new vP,Hy=[{value:"financial_statements",label:"Financial Statements",accent:"bg-primary-50 text-primary-600"},{value:"bank_statements",label:"Bank Statements",accent:"bg-success-50 text-success-600"},{value:"invoices",label:"Invoices",accent:"bg-accent-50 text-accent-600"},{value:"receipts",label:"Receipts",accent:"bg-rose-50 text-rose-600"},{value:"payroll",label:"Payroll Records",accent:"bg-warning-50 text-warning-700"},{value:"tax_documents",label:"Tax Documents",accent:"bg-neutral-100 text-neutral-700"},{value:"contracts",label:"Contracts",accent:"bg-purple-50 text-purple-600"},{value:"other",label:"Other",accent:"bg-neutral-50 text-neutral-600"}],wP={uploaded:"bg-primary-50 text-primary-600",processing:"bg-warning-50 text-warning-700",approved:"bg-success-50 text-success-600",rejected:"bg-error-50 text-error-600"},bP=()=>`doc-${Date.now()}-${Math.random().toString(16).slice(2)}`,Wy=()=>{const[e,t]=C.useState([]),[r,s]=C.useState(!1),[n,i]=C.useState("financial_statements"),l=C.useMemo(()=>{const d=e.filter(x=>x.status==="approved").length,f=e.filter(x=>x.status!=="approved").length,h=e.reduce((x,m)=>x+m.fileSize,0);return{approved:d,pending:f,totalSize:h}},[e]),o=async d=>{const f=d.target.files;if(!(!f||f.length===0)){s(!0);try{for(const h of Array.from(f))await Gi.uploadDocument(h,n,"engagement-123"),t(x=>[{id:bP(),fileName:h.name,fileSize:h.size,category:n,status:"uploaded",uploadedAt:new Date().toISOString()},...x])}catch(h){console.error("Upload failed:",h),alert("Failed to upload files")}finally{s(!1)}}},c=d=>{var h;const f=(h=d.split(".").pop())==null?void 0:h.toLowerCase();return["jpg","jpeg","png"].includes(f||"")?a.jsx(Qd,{className:"h-10 w-10 text-primary-500"}):["xlsx","xls","csv"].includes(f||"")?a.jsx(pc,{className:"h-10 w-10 text-success-500"}):["pdf","doc","docx"].includes(f||"")?a.jsx($e,{className:"h-10 w-10 text-accent-500"}):a.jsx(cx,{className:"h-10 w-10 text-neutral-400"})},u=d=>d<1024?`${d} B`:d<1024*1024?`${(d/1024).toFixed(1)} KB`:`${(d/(1024*1024)).toFixed(1)} MB`;return a.jsx("div",{className:"min-h-screen bg-[radial-gradient(circle_at_top,_#eef5ff,_#f8fafc_45%,_#f4f6fb)] px-6 py-10",children:a.jsxs("div",{className:"mx-auto flex w-full max-w-[1400px] flex-col gap-8",children:[a.jsx(z.section,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},className:"rounded-[32px] border border-white/70 bg-gradient-to-br from-[#0f5ed5] via-[#2563eb] to-[#4f46e5] p-8 text-white shadow-[0_30px_80px_rgba(15,94,213,0.25)]",children:a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-6",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm uppercase tracking-[0.2em] text-white/70",children:"Secure workspace"}),a.jsx("h1",{className:"mt-2 text-3xl font-semibold",children:"Document exchange hub"}),a.jsx("p",{className:"mt-1 text-white/80",children:"SOC 2 Type II certified data room  AES-256 encryption  WORM retention"})]}),a.jsxs("div",{className:"rounded-2xl bg-white/10 px-4 py-3 text-center backdrop-blur",children:[a.jsx("p",{className:"text-sm uppercase tracking-[0.3em] text-white/70",children:"SLA"}),a.jsx("p",{className:"text-2xl font-semibold",children:"4h reviewer turn"})]})]})}),a.jsx("section",{className:"grid gap-5 md:grid-cols-3",children:[{label:"Approved documents",value:l.approved,meta:"Ready for auditor download"},{label:"Pending actions",value:l.pending,meta:"Awaiting review or upload"},{label:"Data volume",value:u(l.totalSize),meta:"Encrypted at rest"}].map(d=>a.jsxs("div",{className:"rounded-3xl border border-white/80 bg-white/95 p-6 shadow-[0_15px_60px_rgba(15,23,42,0.05)] backdrop-blur",children:[a.jsx("p",{className:"text-sm font-medium text-neutral-500",children:d.label}),a.jsx("p",{className:"mt-2 text-3xl font-semibold text-neutral-900",children:d.value}),a.jsx("p",{className:"text-sm text-neutral-500",children:d.meta})]},d.label))}),a.jsxs("section",{className:"grid gap-6 xl:grid-cols-[1.5fr_1fr]",children:[a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"rounded-[28px] border border-dashed border-primary-200 bg-white/70 p-8 shadow-[0_20px_60px_rgba(37,99,235,0.08)]",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 border-b border-primary-100 pb-6",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-primary-600",children:"Select category"}),a.jsx("p",{className:"text-2xl font-semibold text-neutral-900",children:"What are you uploading?"})]}),a.jsx("span",{className:"rounded-full bg-primary-50 px-4 py-2 text-sm font-semibold text-primary-600",children:"Encrypted in transit"})]}),a.jsx("div",{className:"mt-6 flex flex-wrap gap-3",children:Hy.map(d=>a.jsx("button",{onClick:()=>i(d.value),className:`rounded-2xl px-4 py-2 text-sm font-semibold transition ${n===d.value?`${d.accent} border border-transparent`:"bg-neutral-50 text-neutral-600 border border-neutral-100"}`,children:d.label},d.value))}),a.jsxs("label",{htmlFor:"document-upload",className:"mt-8 flex cursor-pointer flex-col items-center justify-center rounded-[24px] border border-dashed border-neutral-300 bg-gradient-to-b from-white to-neutral-50 px-6 py-10 text-center transition hover:border-primary-300",children:[a.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-2xl bg-primary-50 text-primary-600",children:a.jsx(oa,{className:"h-7 w-7"})}),a.jsx("p",{className:"mt-4 text-xl font-semibold text-neutral-900",children:r?"Uploading files...":"Drag files here or browse"}),a.jsx("p",{className:"text-sm text-neutral-500",children:"PDF, Excel, Word, CSV, Images  up to 50MB each"}),a.jsx("input",{id:"document-upload",type:"file",multiple:!0,className:"hidden",disabled:r,accept:".pdf,.xlsx,.xls,.doc,.docx,.csv,.jpg,.jpeg,.png",onChange:o}),a.jsx("span",{className:"mt-3 rounded-full bg-neutral-100 px-3 py-1 text-xs font-semibold text-neutral-600",children:"Auto virus scan & AI tagging enabled"})]})]}),a.jsxs("div",{className:"rounded-[28px] border border-white/80 bg-white/95 p-6 shadow-[0_20px_60px_rgba(15,23,42,0.04)]",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"text-2xl font-semibold text-neutral-900",children:"Recent uploads"}),a.jsx("span",{className:"text-sm text-neutral-500",children:"Sorted by newest first"})]}),e.length===0?a.jsxs("div",{className:"mt-10 flex flex-col items-center gap-4 text-center text-neutral-500",children:[a.jsx("div",{className:"flex h-16 w-16 items-center justify-center rounded-2xl bg-neutral-50",children:a.jsx($e,{className:"h-8 w-8 text-neutral-400"})}),a.jsx("p",{className:"text-lg font-medium text-neutral-600",children:"Your secure binder is waiting for documents"}),a.jsx("p",{className:"text-sm text-neutral-500",children:"Upload financials, controls evidence, tax packages, and more"})]}):a.jsx("div",{className:"mt-6 space-y-4",children:a.jsx(Xe,{initial:!1,children:e.map(d=>{var f;return a.jsxs(z.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},exit:{opacity:0,y:-6},className:"flex flex-wrap items-center gap-4 rounded-2xl border border-neutral-100 bg-neutral-50/60 px-5 py-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[c(d.fileName),a.jsxs("div",{children:[a.jsx("p",{className:"text-lg font-semibold text-neutral-900",children:d.fileName}),a.jsxs("p",{className:"text-sm text-neutral-500",children:[(f=Hy.find(h=>h.value===d.category))==null?void 0:f.label," "," ",u(d.fileSize)]})]})]}),a.jsxs("span",{className:`rounded-full px-3 py-1 text-xs font-semibold ${wP[d.status]}`,children:[d.status==="uploaded"&&"Uploaded",d.status==="processing"&&"Processing",d.status==="approved"&&"Approved",d.status==="rejected"&&"Needs attention"]}),a.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[a.jsx("button",{className:"rounded-2xl border border-neutral-200 p-2 text-neutral-600 transition hover:bg-neutral-100",children:a.jsx(xs,{className:"h-5 w-5"})}),a.jsx("button",{className:"rounded-2xl border border-neutral-200 p-2 text-neutral-600 transition hover:bg-neutral-100",children:a.jsx(Ii,{className:"h-5 w-5"})})]})]},d.id)})})})]})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"rounded-[28px] border border-white/70 bg-white/95 p-6 shadow-lg",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(We,{className:"h-5 w-5 text-primary-500"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-primary-500",children:"Best practice"}),a.jsx("p",{className:"text-xl font-semibold text-neutral-900",children:"Submission checklist"})]})]}),a.jsxs("ul",{className:"mt-4 space-y-3 text-sm text-neutral-600",children:[a.jsxs("li",{className:"flex items-start gap-3 rounded-2xl bg-neutral-50 p-4",children:[a.jsx(Ut,{className:"mt-0.5 h-4 w-4 text-success-600"}),"Export reports directly from source systems to preserve metadata."]}),a.jsxs("li",{className:"flex items-start gap-3 rounded-2xl bg-neutral-50 p-4",children:[a.jsx(Ut,{className:"mt-0.5 h-4 w-4 text-success-600"}),"Combine related support (PBC listing, walkthrough notes) into a single upload."]}),a.jsxs("li",{className:"flex items-start gap-3 rounded-2xl bg-neutral-50 p-4",children:[a.jsx(Ut,{className:"mt-0.5 h-4 w-4 text-success-600"}),"Use descriptive naming: `FY24_Q4_BankRec_MainOperating.pdf`."]})]})]}),a.jsxs("div",{className:"rounded-[28px] border border-white/70 bg-white/95 p-6 shadow-lg",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-neutral-500",children:"Need help?"}),a.jsx("p",{className:"text-2xl font-semibold text-neutral-900",children:"Concierge document desk"})]}),a.jsx("span",{className:"rounded-full bg-neutral-100 px-4 py-2 text-xs font-semibold text-neutral-600",children:"15 min average response"})]}),a.jsxs("div",{className:"mt-4 space-y-3 text-sm text-neutral-600",children:[a.jsx("p",{children:" Schedule white-glove onboarding for ERP exports"}),a.jsx("p",{children:" Let us bulk ingest zipped folders up to 10GB"}),a.jsx("p",{children:" Secure portal for third-party confirmations"})]}),a.jsx("button",{className:"mt-6 w-full rounded-2xl bg-neutral-900 py-3 text-sm font-semibold text-white transition hover:bg-neutral-800",children:"Message file concierge"})]})]})]})]})})},Xs="https://portal.auraai.toroniandcompany.com/api";class jP{async getAvailableIntegrations(){return(await ye.get(`${Xs}/integrations/available`)).data}async getConnectedIntegrations(){return(await ye.get(`${Xs}/integrations/connected`)).data}async initiateConnection(t){const r=await ye.post(`${Xs}/integrations/${t}/connect`);return localStorage.setItem(`integration_state_${t}`,r.data.state),r.data}async handleIntegrationCallback(t,r,s){const n=localStorage.getItem(`integration_state_${t}`);if(s!==n)throw new Error("Invalid state parameter");return localStorage.removeItem(`integration_state_${t}`),(await ye.post(`${Xs}/integrations/${t}/callback`,{code:r,state:s})).data}async disconnectIntegration(t){await ye.delete(`${Xs}/integrations/${t}`)}async syncIntegration(t){await ye.post(`${Xs}/integrations/${t}/sync`)}getIntegrationDetails(){return{quickbooks:{type:"quickbooks",name:"QuickBooks Online",description:"Automatically sync your financial statements, general ledger, and transaction data",icon:"/icons/quickbooks.svg",dataCategories:["Financial Statements","General Ledger","Transactions","Account Balances"]},xero:{type:"xero",name:"Xero",description:"Connect your Xero account to import financial data and reports",icon:"/icons/xero.svg",dataCategories:["Financial Statements","Bank Transactions","Invoices","Bills"]},sage:{type:"sage",name:"Sage Intacct",description:"Sync your Sage Intacct data including GL accounts and financial reports",icon:"/icons/sage.svg",dataCategories:["General Ledger","Financial Reports","Dimensions","Transactions"]},netsuite:{type:"netsuite",name:"NetSuite",description:"Enterprise ERP integration for comprehensive financial data",icon:"/icons/netsuite.svg",dataCategories:["Financial Statements","Subsidiaries","Revenue Recognition","Multi-Entity"]},adp:{type:"adp",name:"ADP Workforce",description:"Connect ADP to sync payroll data, tax filings, and employee information",icon:"/icons/adp.svg",dataCategories:["Payroll Data","Tax Filings","Employee Records","Compensation"]},gusto:{type:"gusto",name:"Gusto",description:"Import payroll information, benefits, and contractor payments",icon:"/icons/gusto.svg",dataCategories:["Payroll","Benefits","Contractors","Time Tracking"]},paychex:{type:"paychex",name:"Paychex",description:"Sync payroll and HR data from Paychex",icon:"/icons/paychex.svg",dataCategories:["Payroll Processing","Tax Services","HR Data","Retirement Services"]},plaid:{type:"plaid",name:"Bank Account (Plaid)",description:"Securely connect your bank accounts for fraud monitoring and transaction analysis",icon:"/icons/plaid.svg",dataCategories:["Bank Transactions","Account Balances","Transaction Categorization","Fraud Detection"]}}}async initiatePlaidConnection(){return(await ye.post(`${Xs}/integrations/plaid/link-token`)).data}async exchangePlaidToken(t,r){return(await ye.post(`${Xs}/integrations/plaid/exchange`,{publicToken:t,metadata:r})).data}async getSyncStatus(t){return(await ye.get(`${Xs}/integrations/${t}/sync-status`)).data}async testConnection(t){return(await ye.post(`${Xs}/integrations/${t}/test`)).data}async connect(t){return this.initiateConnection(t)}async disconnect(t){return this.disconnectIntegration(t)}async syncData(t){return this.syncIntegration(t)}}const Xf=new jP,NP=[{id:"qb",name:"QuickBooks Online",type:"quickbooks",description:"Two-way sync for GL, subledgers, and class tracking",category:"accounting",badge:"Accounting",connected:!0,lastSync:new Date(Date.now()-12*6e4).toISOString(),status:"active"},{id:"xero",name:"Xero",type:"xero",description:"Multi-entity financial data ingestion with auto-tagging",category:"accounting",badge:"Multi-entity",connected:!1},{id:"adp",name:"ADP Workforce",type:"adp",description:"Payroll, tax, and benefits sync with SOC 1 evidence",category:"payroll",badge:"Payroll",connected:!0,lastSync:new Date(Date.now()-45*6e4).toISOString(),status:"syncing"},{id:"gusto",name:"Gusto",type:"gusto",description:"Automated payroll variance testing & approvals",category:"payroll",badge:"People Ops",connected:!1},{id:"plaid",name:"Plaid Banking",type:"plaid",description:"Real-time banking feeds, confirmation packages, and alerts",category:"banking",badge:"Treasury",connected:!0,lastSync:new Date(Date.now()-5*6e4).toISOString(),status:"active"},{id:"netsuite",name:"NetSuite ERP",type:"netsuite",description:"Consolidations, intercompany eliminations, and SOX support",category:"erp",badge:"ERP",connected:!1}],_P={accounting:"bg-primary-50 text-primary-600",payroll:"bg-success-50 text-success-600",banking:"bg-accent-50 text-accent-600",erp:"bg-purple-50 text-purple-600"},kP=e=>{if(!e)return"Never";const t=Math.floor((Date.now()-new Date(e).getTime())/6e4);return t<1?"Just now":t<60?`${t} minutes ago`:t<1440?`${Math.floor(t/60)} hours ago`:`${Math.floor(t/1440)} days ago`},Gy=()=>{const[e,t]=C.useState(NP),[r,s]=C.useState(null),n=async c=>{s(c.id);try{const u=await Xf.connect(c.type);window.open(u.authUrl,"_blank","width=600,height=700"),setTimeout(()=>{t(d=>d.map(f=>f.id===c.id?{...f,connected:!0,status:"active",lastSync:new Date().toISOString()}:f)),s(null)},1500)}catch(u){console.error("Connection failed:",u),alert("Failed to connect integration"),s(null)}},i=async c=>{if(confirm("Disconnect this integration?"))try{await Xf.disconnect(c.id),t(u=>u.map(d=>d.id===c.id?{...d,connected:!1,lastSync:void 0,status:void 0}:d))}catch(u){console.error("Disconnect failed:",u),alert("Failed to disconnect integration")}},l=async c=>{try{t(u=>u.map(d=>d.id===c.id?{...d,status:"syncing"}:d)),await Xf.syncData(c.id),t(u=>u.map(d=>d.id===c.id?{...d,status:"active",lastSync:new Date().toISOString()}:d))}catch(u){console.error("Sync failed:",u),t(d=>d.map(f=>f.id===c.id?{...f,status:"error"}:f))}},o=c=>c==="syncing"?"Syncing":c==="error"?"Attention":c==="active"?"Connected":"Not connected";return a.jsx("div",{className:"min-h-screen bg-[radial-gradient(circle_at_top,_#eef5ff,_#f8fafc_45%,_#f4f6fb)] px-6 py-10",children:a.jsxs("div",{className:"mx-auto flex w-full max-w-[1400px] flex-col gap-8",children:[a.jsx(z.section,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},className:"rounded-[32px] border border-white/70 bg-gradient-to-br from-[#0f5ed5] via-[#2563eb] to-[#4f46e5] p-8 text-white shadow-[0_30px_80px_rgba(15,94,213,0.25)]",children:a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-6",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm uppercase tracking-[0.2em] text-white/70",children:"Trusted data fabric"}),a.jsx("h1",{className:"mt-2 text-3xl font-semibold",children:"Enterprise-grade integrations"}),a.jsx("p",{className:"mt-1 text-white/80",children:"OAuth 2.0 + mutual TLS  SOC 2 Type II  Continuous monitoring & alerting"})]}),a.jsxs("div",{className:"rounded-2xl bg-white/10 px-4 py-3 text-center backdrop-blur",children:[a.jsx("p",{className:"text-sm uppercase tracking-[0.3em] text-white/70",children:"Uptime"}),a.jsx("p",{className:"text-2xl font-semibold",children:"99.99%"})]})]})}),a.jsxs("section",{className:"grid gap-6 xl:grid-cols-[1.6fr_1fr]",children:[a.jsxs("div",{className:"rounded-[32px] border border-white/80 bg-white/95 p-6 shadow-[0_25px_70px_rgba(15,23,42,0.06)]",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-neutral-500",children:"Connected surfaces"}),a.jsx("p",{className:"text-2xl font-semibold text-neutral-900",children:"Data pipelines"})]}),a.jsx("span",{className:"rounded-full bg-neutral-100 px-4 py-1 text-xs font-semibold text-neutral-600",children:"Real-time monitoring"})]}),a.jsx("div",{className:"mt-6 grid gap-6 md:grid-cols-2",children:e.map(c=>a.jsxs("div",{className:"rounded-[24px] border border-neutral-100 bg-neutral-50/70 p-5 shadow-inner shadow-white/60",children:[a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-lg font-semibold text-neutral-900",children:c.name}),a.jsx("p",{className:"text-sm text-neutral-500",children:c.description})]}),a.jsx("span",{className:`rounded-full px-3 py-1 text-xs font-semibold ${_P[c.category]}`,children:c.badge})]}),a.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-3",children:[a.jsx("span",{className:`rounded-full px-3 py-1 text-xs font-semibold ${c.connected?c.status==="error"?"bg-error-50 text-error-600":"bg-success-50 text-success-600":"bg-neutral-100 text-neutral-600"}`,children:o(c.status)}),c.connected&&a.jsxs("span",{className:"text-xs text-neutral-500",children:["Last sync  ",kP(c.lastSync)]})]}),a.jsx("div",{className:"mt-4 flex flex-wrap gap-3",children:c.connected?a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>l(c),disabled:c.status==="syncing",className:"flex flex-1 items-center justify-center gap-2 rounded-2xl bg-neutral-900 px-4 py-2 text-sm font-semibold text-white transition hover:bg-neutral-800 disabled:opacity-60",children:[a.jsx(zr,{className:`h-4 w-4 ${c.status==="syncing"?"animate-spin":""}`}),c.status==="syncing"?"Syncing":"Sync now"]}),a.jsx("button",{onClick:()=>i(c),className:"flex flex-1 items-center justify-center gap-2 rounded-2xl border border-neutral-300 px-4 py-2 text-sm font-semibold text-neutral-700 transition hover:bg-neutral-100",children:"Disconnect"})]}):a.jsx("button",{onClick:()=>n(c),disabled:r===c.id,className:"flex w-full items-center justify-center gap-2 rounded-2xl border border-neutral-300 bg-white px-4 py-2 text-sm font-semibold text-neutral-900 transition hover:border-neutral-400 disabled:opacity-60",children:r===c.id?a.jsxs(a.Fragment,{children:[a.jsx(zr,{className:"h-4 w-4 animate-spin"}),"Authorizing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(M6,{className:"h-4 w-4"}),"Connect securely"]})})})]},c.id))})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"rounded-[28px] border border-white/70 bg-white/95 p-6 shadow-lg",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(We,{className:"h-5 w-5 text-primary-500"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-primary-500",children:"Security posture"}),a.jsx("p",{className:"text-xl font-semibold text-neutral-900",children:"Zero-trust integration bus"})]})]}),a.jsxs("ul",{className:"mt-4 space-y-3 text-sm text-neutral-600",children:[a.jsx("li",{className:"rounded-2xl bg-neutral-50 p-4",children:"OAuth 2.0 + PKCE with scoped, revocable tokens."}),a.jsx("li",{className:"rounded-2xl bg-neutral-50 p-4",children:"Secrets stored in Azure Key Vault (HSM-backed)."}),a.jsx("li",{className:"rounded-2xl bg-neutral-50 p-4",children:"Automatic anomaly detection and replay protection."})]})]}),a.jsxs("div",{className:"rounded-[28px] border border-white/70 bg-white/95 p-6 shadow-lg",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(sF,{className:"h-5 w-5 text-accent-500"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-accent-500",children:"Connection center"}),a.jsx("p",{className:"text-xl font-semibold text-neutral-900",children:"Observability"})]})]}),a.jsxs("div",{className:"mt-4 space-y-3 text-sm text-neutral-600",children:[a.jsx("p",{children:" 3 active webhooks  152k events this week"}),a.jsx("p",{children:" 0 failed OAuth refresh tokens"}),a.jsx("p",{children:" 7 queued sync jobs  avg throughput 1.2s"})]})]}),a.jsxs("div",{className:"rounded-[28px] border border-white/70 bg-neutral-900/90 p-6 text-white shadow-2xl",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(vc,{className:"h-5 w-5 text-amber-300"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm uppercase tracking-[0.3em] text-white/70",children:"Concierge"}),a.jsx("p",{className:"text-xl font-semibold",children:"White-glove onboarding"})]})]}),a.jsx("p",{className:"mt-2 text-sm text-white/80",children:"Let our solutions architects connect ERP, payroll, and custom data lakes without leaving the portal."}),a.jsx("button",{className:"mt-5 w-full rounded-2xl border border-white/30 px-4 py-3 text-sm font-semibold text-white transition hover:bg-white/10",children:"Schedule integration session"}),a.jsxs("div",{className:"mt-4 flex items-center gap-2 text-xs text-white/70",children:[a.jsx($s,{className:"h-4 w-4"}),"NDA-backed access, SOC 1 / SOC 2 controls enforced"]})]})]})]})]})})},js="https://portal.auraai.toroniandcompany.com/api";class SP{async getDashboardStats(t){const r=t?{engagementId:t}:{};return(await ye.get(`${js}/dashboard/stats`,{params:r})).data}async getEngagements(){return(await ye.get(`${js}/engagements`)).data}async getEngagement(t){return(await ye.get(`${js}/engagements/${t}`)).data}async getEngagementProgress(t){return(await ye.get(`${js}/engagements/${t}/progress`)).data}async getChatMessages(t){const r=t?{engagementId:t}:{};return(await ye.get(`${js}/ai/chat/messages`,{params:r})).data}async sendChatMessage(t,r){return(await ye.post(`${js}/ai/chat/send`,{message:t,engagementId:r})).data}async getAISuggestions(t){const r=t?{engagementId:t}:{};return(await ye.get(`${js}/ai/suggestions`,{params:r})).data}async getNotifications(){return(await ye.get(`${js}/notifications`)).data}async markNotificationRead(t){await ye.post(`${js}/notifications/${t}/read`)}async markAllNotificationsRead(){await ye.post(`${js}/notifications/read-all`)}async getActivityFeed(t){const r=t?{engagementId:t}:{};return(await ye.get(`${js}/activity`,{params:r})).data}}const qy=new SP,Yy=()=>{const{id:e}=Hs(),t=ze(),[r,s]=C.useState(null),[n,i]=C.useState(!0),[l,o]=C.useState([]),[c,u]=C.useState([]),[d,f]=C.useState([]),[h,x]=C.useState({workpapers:{total:0,completed:0},analytics:{total:0,completed:0},testing:{total:0,completed:0},risk:{total:0,completed:0},documents:{total:0,completed:0},reports:{total:0,completed:0}});C.useEffect(()=>{e&&(m(e),p(e),w(e),b(e),g(e))},[e]);const m=async S=>{try{i(!0);const N=await ca.getEngagement(S);s(N)}catch(N){console.error("Failed to load engagement:",N),de.error("Failed to load engagement"),t("/firm/audits")}finally{i(!1)}},p=async S=>{try{const D=(await qy.getAISuggestions(S)).map(F=>({type:F.type||"insight",title:F.title||F.message,description:F.description||F.details,severity:F.priority==="high"?"high":F.priority==="medium"?"medium":"low"}));o(D)}catch{console.log("AI insights not available, using defaults"),o([{type:"planning",title:"Start with Risk Assessment",description:"Begin by completing the risk assessment to determine audit approach and materiality",severity:"medium"},{type:"document",title:"Upload Client Documents",description:"Upload trial balance, bank statements, and other source documents to enable AI analysis",severity:"high"}])}},w=async S=>{try{const D=(await qy.getActivityFeed(S)).activities.map(F=>({type:F.type,title:F.title,user:F.description||"System",time:new Date(F.timestamp).toLocaleString(),status:F.type==="warning"?"warning":F.type==="error"?"error":"completed"}));u(D)}catch{console.log("Activity feed not available"),u([])}},b=async S=>{try{const D=(await ca.getEngagementTeam(S)).map(F=>({name:F.user_name||F.email||"Team Member",role:F.role||"Staff",avatar:(F.user_name||"TM").split(" ").map(Y=>Y[0]).join("").toUpperCase().slice(0,2),status:"active"}));f(D)}catch{console.log("Team members not available"),f([])}},g=async S=>{try{const N=await ca.getWorkspaceStats(S);x(N)}catch{console.log("Workspace stats not available")}},y=()=>{t(`/firm/engagements/${e}/documents`)},j=()=>{t(`/firm/engagements/${e}/workpapers`)},A=()=>{t(`/firm/engagements/${e}/ai-planning`)},k=S=>({draft:0,planning:20,fieldwork:50,review:75,finalized:100})[S]||0,v=[{id:"workpapers",title:"Workpapers",description:"Electronic workpaper library and management",icon:$e,color:"blue",path:`/firm/engagements/${e}/workpapers`,stats:h.workpapers},{id:"analytics",title:"Analytical Procedures",description:"AI-powered financial analysis and benchmarking",icon:ua,color:"purple",path:`/firm/engagements/${e}/analytics`,stats:h.analytics},{id:"testing",title:"Audit Testing",description:"Testing modules for all audit areas",icon:D6,color:"green",path:`/firm/engagements/${e}/testing`,stats:h.testing},{id:"risk",title:"Risk Assessment",description:"Risk matrix, materiality, and fraud assessment",icon:We,color:"orange",path:`/firm/engagements/${e}/risk`,stats:h.risk},{id:"documents",title:"Documents",description:"Client documents and file repository",icon:xc,color:"cyan",path:`/firm/engagements/${e}/documents`,stats:h.documents},{id:"reports",title:"Reports",description:"Audit reports and deliverables",icon:Ba,color:"indigo",path:`/firm/engagements/${e}/reports`,stats:h.reports}];if(n)return a.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:a.jsxs("div",{className:"flex flex-col items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 border-4 border-primary-500 border-t-transparent rounded-full animate-spin"}),a.jsx("p",{className:"text-body text-neutral-600",children:"Loading workspace..."})]})});if(!r)return null;const E=k(r.status);return a.jsxs("div",{className:"space-y-6 max-w-[1800px]",children:[a.jsxs(z.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center gap-4",children:[a.jsx("button",{onClick:()=>t("/firm/audits"),className:"p-2 hover:bg-neutral-100 rounded-fluent-sm transition-colors",children:a.jsx(Qr,{className:"w-5 h-5 text-neutral-700"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h1",{className:"text-display text-neutral-900 mb-1",children:r.name}),a.jsxs("div",{className:"flex items-center gap-4 text-body text-neutral-600",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Nt,{className:"w-4 h-4"}),a.jsxs("span",{children:["Client: ",r.client_id]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Jr,{className:"w-4 h-4"}),a.jsxs("span",{children:["FYE: ",new Date(r.fiscal_year_end).toLocaleDateString()]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(nt,{className:"w-4 h-4"}),a.jsx("span",{children:r.engagement_type.charAt(0).toUpperCase()+r.engagement_type.slice(1)})]})]})]})]}),a.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"fluent-card p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-title text-neutral-900",children:"Engagement Progress"}),a.jsxs("span",{className:"text-body-strong text-primary-600",children:[E,"% Complete"]})]}),a.jsx("div",{className:"relative",children:a.jsx("div",{className:"h-2 bg-neutral-200 rounded-full overflow-hidden",children:a.jsx(z.div,{initial:{width:0},animate:{width:`${E}%`},transition:{duration:1,ease:"easeOut"},className:"h-full bg-gradient-to-r from-primary-500 to-primary-600 rounded-full"})})}),a.jsx("div",{className:"grid grid-cols-5 gap-4 mt-6",children:["Draft","Planning","Fieldwork","Review","Finalized"].map((S,N)=>{const D=r.status===S.toLowerCase(),F=k(r.status)>k(S.toLowerCase());return a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:`mx-auto w-10 h-10 rounded-full flex items-center justify-center mb-2 transition-all ${D?"bg-primary-500 text-white ring-4 ring-primary-100":F?"bg-success-500 text-white":"bg-neutral-200 text-neutral-500"}`,children:F?a.jsx(Re,{className:"w-5 h-5"}):a.jsx("span",{className:"text-caption font-semibold",children:N+1})}),a.jsx("p",{className:`text-caption font-medium ${D?"text-primary-600":F?"text-success-600":"text-neutral-600"}`,children:S})]},S)})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-title text-neutral-900 mb-4",children:"Audit Workspace"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:v.map((S,N)=>{const D=S.icon,F=S.stats.total>0?Math.round(S.stats.completed/S.stats.total*100):0;return a.jsxs(z.button,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:N*.05},onClick:()=>t(S.path),className:"fluent-card-interactive p-6 text-left group",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsx("div",{className:`w-12 h-12 rounded-fluent bg-${S.color}-100 flex items-center justify-center group-hover:scale-110 transition-transform`,children:a.jsx(D,{className:`w-6 h-6 text-${S.color}-600`})}),a.jsx(fa,{className:"w-5 h-5 text-neutral-400 group-hover:text-primary-500 group-hover:translate-x-1 transition-all"})]}),a.jsx("h3",{className:"text-body-strong text-neutral-900 mb-1",children:S.title}),a.jsx("p",{className:"text-caption text-neutral-600 mb-4",children:S.description}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("span",{className:"text-caption text-neutral-600",children:[S.stats.completed," of ",S.stats.total]}),a.jsxs("span",{className:"text-caption font-semibold text-primary-600",children:[F,"%"]})]}),a.jsx("div",{className:"mt-2 h-1.5 bg-neutral-200 rounded-full overflow-hidden",children:a.jsx("div",{className:`h-full bg-${S.color}-500 rounded-full transition-all`,style:{width:`${F}%`}})})]},S.id)})})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(Rt,{className:"w-5 h-5 text-primary-600"}),a.jsx("h2",{className:"text-title text-neutral-900",children:"AI-Powered Insights"})]}),a.jsx("div",{className:"space-y-3",children:l.map((S,N)=>{const F={high:{color:"error",icon:Qe},medium:{color:"warning",icon:Qe},low:{color:"success",icon:Re}}[S.severity],Y=F.icon;return a.jsx(z.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:N*.1},className:`fluent-card p-4 border-l-4 border-${F.color}-500`,children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:`w-8 h-8 rounded-fluent bg-${F.color}-100 flex items-center justify-center flex-shrink-0`,children:a.jsx(Y,{className:`w-4 h-4 text-${F.color}-600`})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"text-body-strong text-neutral-900 mb-1",children:S.title}),a.jsx("p",{className:"text-caption text-neutral-600",children:S.description})]})]})},N)})})]})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"fluent-card p-5",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-body-strong text-neutral-900",children:"Team"}),a.jsx("button",{className:"text-caption text-primary-600 hover:text-primary-700 font-medium",children:"Manage"})]}),a.jsx("div",{className:"space-y-3",children:d.length>0?d.map((S,N)=>a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-primary-500 to-primary-600 flex items-center justify-center text-white text-caption font-semibold",children:S.avatar}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-body-strong text-neutral-900 truncate",children:S.name}),a.jsx("p",{className:"text-caption text-neutral-600",children:S.role})]}),a.jsx("div",{className:`w-2 h-2 rounded-full ${S.status==="active"?"bg-success-500":"bg-warning-500"}`})]},N)):a.jsxs("div",{className:"text-center py-4",children:[a.jsx(zs,{className:"w-8 h-8 text-neutral-300 mx-auto mb-2"}),a.jsx("p",{className:"text-caption text-neutral-500",children:"No team members assigned"})]})})]}),a.jsxs("div",{className:"fluent-card p-5",children:[a.jsx("h3",{className:"text-body-strong text-neutral-900 mb-4",children:"Recent Activity"}),a.jsx("div",{className:"space-y-4",children:c.length>0?c.map((S,N)=>{const F={completed:"success",info:"primary",warning:"warning"}[S.status]||"primary";return a.jsxs("div",{className:"flex gap-3",children:[a.jsx("div",{className:`w-2 h-2 rounded-full bg-${F}-500 mt-2 flex-shrink-0`}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-caption font-medium text-neutral-900",children:S.title}),a.jsx("p",{className:"text-caption text-neutral-600 truncate",children:S.user}),a.jsx("p",{className:"text-caption text-neutral-500",children:S.time})]})]},N)}):a.jsxs("div",{className:"text-center py-4",children:[a.jsx(nt,{className:"w-8 h-8 text-neutral-300 mx-auto mb-2"}),a.jsx("p",{className:"text-caption text-neutral-500",children:"No recent activity"}),a.jsx("p",{className:"text-caption text-neutral-400",children:"Activity will appear as you work"})]})})]}),a.jsxs("div",{className:"fluent-card p-5",children:[a.jsx("h3",{className:"text-body-strong text-neutral-900 mb-4",children:"Quick Actions"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("button",{onClick:y,className:"w-full fluent-btn-secondary text-left justify-start",children:[a.jsx(oa,{className:"w-4 h-4"}),"Upload Documents"]}),a.jsxs("button",{onClick:j,className:"w-full fluent-btn-secondary text-left justify-start",children:[a.jsx(Os,{className:"w-4 h-4"}),"Add Workpaper"]}),a.jsxs("button",{onClick:A,className:"w-full fluent-btn-primary text-left justify-start",children:[a.jsx(Rt,{className:"w-4 h-4"}),"Start AI Planning"]}),a.jsxs("button",{onClick:()=>t(`/firm/engagements/${e}/risk`),className:"w-full fluent-btn-secondary text-left justify-start",children:[a.jsx(We,{className:"w-4 h-4"}),"Risk Assessment"]}),a.jsxs("button",{onClick:()=>t(`/firm/engagements/${e}/reports`),className:"w-full fluent-btn-secondary text-left justify-start",children:[a.jsx(xs,{className:"w-4 h-4"}),"Generate Reports"]})]})]})]})]})]})},CP=()=>{const{id:e}=Hs(),t=ze(),[r,s]=C.useState([]),[n,i]=C.useState("planning"),[l,o]=C.useState(""),[c,u]=C.useState("all"),[d,f]=C.useState(!1),[h,x]=C.useState(!1),[m,p]=C.useState(null);C.useEffect(()=>{w()},[]);const w=()=>{s([{id:"1",reference:"A-1",title:"Planning Memorandum",section:"planning",preparer:"John Smith",reviewer:"Sarah Johnson",status:"completed",created_at:"2024-11-01",updated_at:"2024-11-05",procedure:"Document overall audit strategy and planning decisions",results:"Completed comprehensive planning including risk assessment",conclusion:"Planning phase completed satisfactorily",attachments:3,cross_references:["A-2","B-1"]},{id:"2",reference:"A-2",title:"Risk Assessment Matrix",section:"planning",preparer:"Sarah Johnson",status:"completed",created_at:"2024-11-02",updated_at:"2024-11-06",attachments:1,cross_references:["A-1"]},{id:"3",reference:"B-1",title:"Revenue Recognition Testing",section:"revenue",preparer:"John Smith",status:"in_progress",created_at:"2024-11-10",updated_at:"2024-11-20",attachments:5,cross_references:["B-2","B-3"]},{id:"4",reference:"B-2",title:"Revenue Sample Selection",section:"revenue",preparer:"Emily Davis",status:"review",created_at:"2024-11-12",updated_at:"2024-11-18",attachments:2,cross_references:["B-1"]},{id:"5",reference:"C-1",title:"Cash Reconciliation",section:"assets",preparer:"John Smith",status:"completed",created_at:"2024-11-08",updated_at:"2024-11-15",attachments:4,cross_references:[]},{id:"6",reference:"C-2",title:"Accounts Receivable Aging",section:"assets",preparer:"Emily Davis",status:"in_progress",created_at:"2024-11-14",updated_at:"2024-11-22",attachments:1,cross_references:["C-3"]}])},b=[{id:"planning",title:"Planning & Risk Assessment",icon:Bs,color:"blue"},{id:"controls",title:"Internal Controls Testing",icon:Re,color:"green"},{id:"revenue",title:"Revenue & Receivables",icon:$e,color:"purple"},{id:"assets",title:"Assets",icon:xc,color:"cyan"},{id:"liabilities",title:"Liabilities & Equity",icon:$e,color:"orange"},{id:"analytical",title:"Analytical Procedures",icon:$e,color:"indigo"},{id:"conclusions",title:"Conclusions & Reporting",icon:Re,color:"green"}],g=[{category:"Planning",items:["Planning Memorandum","Risk Assessment Matrix","Materiality Calculation","Engagement Letter Review","Independence Checklist"]},{category:"Revenue",items:["Revenue Recognition Testing","Sample Selection - Revenue","Cut-off Testing","Revenue Analytics"]},{category:"Assets",items:["Cash Reconciliation","AR Aging Analysis","AR Confirmations","Inventory Observation","Fixed Assets Schedule"]},{category:"Liabilities",items:["AP Testing","Debt Schedule","Covenant Compliance","Subsequent Events"]}],y=v=>{const E={not_started:{label:"Not Started",color:"gray",icon:nt},in_progress:{label:"In Progress",color:"blue",icon:Os},review:{label:"In Review",color:"yellow",icon:cr},completed:{label:"Completed",color:"green",icon:Re}};return E[v]||E.not_started},j=r.filter(v=>{const E=v.title.toLowerCase().includes(l.toLowerCase())||v.reference.toLowerCase().includes(l.toLowerCase()),S=c==="all"||v.status===c;return E&&S}),A=v=>j.filter(E=>E.section===v),k=v=>{const E=r.filter(N=>N.section===v),S=E.filter(N=>N.status==="completed").length;return{total:E.length,completed:S}};return a.jsxs("div",{className:"space-y-6 max-w-[1800px]",children:[a.jsxs(z.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center gap-4",children:[a.jsx("button",{onClick:()=>t(`/firm/engagements/${e}/workspace`),className:"p-2 hover:bg-neutral-100 rounded-fluent-sm transition-colors",children:a.jsx(Qr,{className:"w-5 h-5 text-neutral-700"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h1",{className:"text-display text-neutral-900 mb-1",children:"Workpapers"}),a.jsx("p",{className:"text-body text-neutral-600",children:"Electronic workpaper library and management"})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs(z.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>x(!0),className:"fluent-btn-secondary",children:[a.jsx(xc,{className:"w-4 h-4"}),"Template Library"]}),a.jsxs(z.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>f(!0),className:"fluent-btn-primary",children:[a.jsx($t,{className:"w-4 h-4"}),"Create Workpaper"]})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[{label:"Total Workpapers",value:r.length,color:"primary",icon:$e},{label:"In Progress",value:r.filter(v=>v.status==="in_progress").length,color:"blue",icon:Os},{label:"In Review",value:r.filter(v=>v.status==="review").length,color:"yellow",icon:cr},{label:"Completed",value:r.filter(v=>v.status==="completed").length,color:"success",icon:Re}].map((v,E)=>{const S=v.icon;return a.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:E*.05},className:"fluent-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("p",{className:"text-caption text-neutral-600",children:v.label}),a.jsx(S,{className:`w-4 h-4 text-${v.color}-600`})]}),a.jsx("p",{className:`text-title-large text-${v.color}-600 font-semibold`,children:v.value})]},v.label)})}),a.jsx("div",{className:"fluent-card p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(Vs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-neutral-400"}),a.jsx("input",{type:"text",value:l,onChange:v=>o(v.target.value),placeholder:"Search workpapers...",className:"fluent-input pl-10"})]}),a.jsxs("select",{value:c,onChange:v=>u(v.target.value),className:"fluent-input w-full sm:w-48",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"not_started",children:"Not Started"}),a.jsx("option",{value:"in_progress",children:"In Progress"}),a.jsx("option",{value:"review",children:"In Review"}),a.jsx("option",{value:"completed",children:"Completed"})]})]})}),a.jsx("div",{className:"space-y-4",children:b.map((v,E)=>{const S=v.icon,N=k(v.id),D=A(v.id),F=n===v.id,Y=N.total>0?Math.round(N.completed/N.total*100):0;return a.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:E*.05},className:"fluent-card overflow-hidden",children:[a.jsxs("button",{onClick:()=>i(F?null:v.id),className:"w-full p-5 flex items-center justify-between hover:bg-neutral-50 transition-colors",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:`w-10 h-10 rounded-fluent bg-${v.color}-100 flex items-center justify-center`,children:a.jsx(S,{className:`w-5 h-5 text-${v.color}-600`})}),a.jsxs("div",{className:"text-left",children:[a.jsx("h3",{className:"text-body-strong text-neutral-900",children:v.title}),a.jsxs("p",{className:"text-caption text-neutral-600",children:[N.completed," of ",N.total," completed (",Y,"%)"]})]})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-32 h-2 bg-neutral-200 rounded-full overflow-hidden",children:a.jsx("div",{className:`h-full bg-${v.color}-500 transition-all`,style:{width:`${Y}%`}})}),F?a.jsx(pN,{className:"w-5 h-5 text-neutral-600"}):a.jsx(fa,{className:"w-5 h-5 text-neutral-600"})]})]}),a.jsx(Xe,{children:F&&a.jsx(z.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"border-t border-neutral-200",children:a.jsx("div",{className:"p-5 space-y-3",children:D.length>0?D.map(Q=>{const ae=y(Q.status),ee=ae.icon;return a.jsxs("div",{className:"p-4 border border-neutral-200 rounded-fluent hover:border-primary-300 hover:shadow-sm transition-all cursor-pointer",onClick:()=>p(Q),children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:"text-caption font-mono font-semibold text-primary-600",children:Q.reference}),a.jsx("span",{className:"text-body-strong text-neutral-900",children:Q.title})]}),a.jsxs("div",{className:"flex items-center gap-4 text-caption text-neutral-600",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(ha,{className:"w-3.5 h-3.5"}),a.jsx("span",{children:Q.preparer})]}),Q.reviewer&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(cr,{className:"w-3.5 h-3.5"}),a.jsx("span",{children:Q.reviewer})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Jr,{className:"w-3.5 h-3.5"}),a.jsx("span",{children:new Date(Q.updated_at).toLocaleDateString()})]})]})]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-fluent-sm text-caption font-medium bg-${ae.color}-50 text-${ae.color}-700`,children:[a.jsx(ee,{className:"w-3.5 h-3.5"}),ae.label]})})]}),a.jsxs("div",{className:"flex items-center gap-4 text-caption text-neutral-600",children:[Q.attachments>0&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Q6,{className:"w-3.5 h-3.5"}),a.jsxs("span",{children:[Q.attachments," files"]})]}),Q.cross_references.length>0&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(gN,{className:"w-3.5 h-3.5"}),a.jsxs("span",{children:[Q.cross_references.length," references"]})]})]})]},Q.id)}):a.jsxs("div",{className:"text-center py-8",children:[a.jsx($e,{className:"w-12 h-12 text-neutral-300 mx-auto mb-3"}),a.jsx("p",{className:"text-body text-neutral-600 mb-4",children:"No workpapers in this section"}),a.jsxs("button",{onClick:()=>f(!0),className:"fluent-btn-secondary inline-flex",children:[a.jsx($t,{className:"w-4 h-4"}),"Add Workpaper"]})]})})})})]},v.id)})}),a.jsx(Xe,{children:h&&a.jsx(z.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:()=>x(!1),children:a.jsxs(z.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:v=>v.stopPropagation(),className:"bg-white rounded-fluent-lg p-6 max-w-4xl w-full shadow-fluent-16 max-h-[80vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-title-large text-neutral-900",children:"Workpaper Template Library"}),a.jsx("button",{onClick:()=>x(!1),className:"p-2 hover:bg-neutral-100 rounded-fluent-sm",children:a.jsx(ur,{className:"w-5 h-5"})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:g.map(v=>a.jsxs("div",{children:[a.jsx("h3",{className:"text-body-strong text-neutral-900 mb-3",children:v.category}),a.jsx("div",{className:"space-y-2",children:v.items.map(E=>a.jsx("button",{className:"w-full text-left p-3 border border-neutral-200 rounded-fluent hover:border-primary-300 hover:bg-primary-50 transition-all group",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-body text-neutral-900",children:E}),a.jsx($t,{className:"w-4 h-4 text-neutral-400 group-hover:text-primary-600"})]})},E))})]},v.category))})]})})}),a.jsx(Xe,{children:d&&a.jsx(z.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:()=>f(!1),children:a.jsxs(z.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:v=>v.stopPropagation(),className:"bg-white rounded-fluent-lg p-6 max-w-2xl w-full shadow-fluent-16 max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-title-large text-neutral-900",children:"Create New Workpaper"}),a.jsx("button",{onClick:()=>f(!1),className:"p-2 hover:bg-neutral-100 rounded-fluent-sm",children:a.jsx(ur,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Section *"}),a.jsxs("select",{className:"fluent-input",children:[a.jsx("option",{value:"",children:"Select section"}),b.map(v=>a.jsx("option",{value:v.id,children:v.title},v.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Title *"}),a.jsx("input",{type:"text",className:"fluent-input",placeholder:"Workpaper title"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Reference Number *"}),a.jsx("input",{type:"text",className:"fluent-input",placeholder:"e.g., A-1, B-2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Procedure"}),a.jsx("textarea",{className:"fluent-input min-h-[100px]",placeholder:"Describe the audit procedure..."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Preparer"}),a.jsxs("select",{className:"fluent-input",children:[a.jsx("option",{value:"",children:"Select preparer"}),a.jsx("option",{value:"john",children:"John Smith"}),a.jsx("option",{value:"sarah",children:"Sarah Johnson"}),a.jsx("option",{value:"emily",children:"Emily Davis"})]})]})]}),a.jsxs("div",{className:"flex gap-3 mt-6 pt-6 border-t border-neutral-200",children:[a.jsx("button",{onClick:()=>f(!1),className:"fluent-btn-secondary flex-1",children:"Cancel"}),a.jsx("button",{onClick:()=>{de.success("Workpaper created successfully!"),f(!1)},className:"fluent-btn-primary flex-1",children:"Create Workpaper"})]})]})})})]})},Ky="https://portal.auraai.toroniandcompany.com/api";class TP{constructor(){Wt(this,"api");Wt(this,"analyticsApi");this.api=ye.create({baseURL:`${Ky}/financial-analysis`,headers:{"Content-Type":"application/json"}}),this.analyticsApi=ye.create({baseURL:`${Ky}/analytics`,headers:{"Content-Type":"application/json"}}),[this.api,this.analyticsApi].forEach(t=>{t.interceptors.request.use(r=>{const s=localStorage.getItem("access_token");return s&&(r.headers.Authorization=`Bearer ${s}`),r}),t.interceptors.response.use(r=>r,r=>{var s;return((s=r.response)==null?void 0:s.status)===401&&(localStorage.removeItem("access_token"),window.location.href="/login"),Promise.reject(r)})})}async getFinancialAnalysis(t){try{const[r,s,n]=await Promise.all([this.api.get(`/engagements/${t}/ratios`).catch(()=>({data:null})),this.api.get(`/engagements/${t}/trends`).catch(()=>({data:null})),this.analyticsApi.get(`/engagements/${t}/insights`).catch(()=>({data:null}))]);return{ratios:r.data||this.getDefaultRatios(),trends:s.data||this.getDefaultTrends(),insights:n.data||this.getDefaultInsights()}}catch(r){return console.error("Failed to fetch financial analysis:",r),{ratios:this.getDefaultRatios(),trends:this.getDefaultTrends(),insights:this.getDefaultInsights()}}}async getRatios(t){try{return(await this.api.get(`/engagements/${t}/ratios`)).data}catch{return this.getDefaultRatios()}}async getTrends(t){try{return(await this.api.get(`/engagements/${t}/trends`)).data}catch{return this.getDefaultTrends()}}async getAIInsights(t){try{return(await this.analyticsApi.get(`/engagements/${t}/insights`)).data}catch{return this.getDefaultInsights()}}async runAIAnalysis(t){return(await this.analyticsApi.post(`/engagements/${t}/run-analysis`)).data}async importFinancials(t,r){return(await this.api.post(`/engagements/${t}/import`,r,{headers:{"Content-Type":"multipart/form-data"}})).data}async exportAnalysis(t,r){return(await this.api.get(`/engagements/${t}/export`,{params:{format:r},responseType:"blob"})).data}getDefaultRatios(){return[{name:"Current Ratio",value:2.3,priorYear:2.5,industry:2.1,category:"Liquidity",description:"Ability to pay short-term obligations",variance:-8,status:"normal"},{name:"Quick Ratio",value:1.5,priorYear:1.8,industry:1.4,category:"Liquidity",description:"Ability to meet short-term obligations with liquid assets",variance:-16.7,status:"warning"},{name:"Gross Margin %",value:42.5,priorYear:45.2,industry:44,category:"Profitability",description:"Percentage of revenue retained after COGS",variance:-6,status:"warning"},{name:"Net Profit Margin %",value:8.2,priorYear:10.5,industry:9.8,category:"Profitability",description:"Net income as percentage of revenue",variance:-21.9,status:"alert"},{name:"Return on Assets",value:7.5,priorYear:8.1,industry:8,category:"Profitability",description:"Efficiency in using assets to generate profit",variance:-7.4,status:"normal"},{name:"Debt to Equity",value:.65,priorYear:.58,industry:.7,category:"Leverage",description:"Financial leverage and capital structure",variance:12.1,status:"normal"},{name:"Interest Coverage",value:4.2,priorYear:5.8,industry:5,category:"Leverage",description:"Ability to meet interest payments",variance:-27.6,status:"warning"},{name:"Inventory Turnover",value:6.8,priorYear:7.2,industry:7.5,category:"Efficiency",description:"How quickly inventory is sold",variance:-5.6,status:"normal"},{name:"Days Sales Outstanding",value:52,priorYear:48,industry:45,category:"Efficiency",description:"Average collection period for receivables",variance:8.3,status:"warning"},{name:"Asset Turnover",value:1.45,priorYear:1.52,industry:1.5,category:"Efficiency",description:"Efficiency in using assets to generate revenue",variance:-4.6,status:"normal"}]}getDefaultTrends(){return[{period:"Q1 2023",revenue:25e5,expenses:21e5,netIncome:4e5,grossMargin:44},{period:"Q2 2023",revenue:265e4,expenses:22e5,netIncome:45e4,grossMargin:45.5},{period:"Q3 2023",revenue:28e5,expenses:235e4,netIncome:45e4,grossMargin:46.2},{period:"Q4 2023",revenue:32e5,expenses:275e4,netIncome:45e4,grossMargin:45.8},{period:"Q1 2024",revenue:245e4,expenses:205e4,netIncome:4e5,grossMargin:43.5},{period:"Q2 2024",revenue:26e5,expenses:218e4,netIncome:42e4,grossMargin:42.8},{period:"Q3 2024",revenue:275e4,expenses:23e5,netIncome:45e4,grossMargin:42.2},{period:"Q4 2024",revenue:29e5,expenses:248e4,netIncome:42e4,grossMargin:41.5}]}getDefaultInsights(){return[{type:"critical",title:"Significant Margin Compression",description:"Gross margin has declined from 45.2% to 42.5% year-over-year. Net profit margin down 21.9%. Investigate: 1) Pricing pressure, 2) COGS increases, 3) Product mix changes.",recommendations:["Perform detailed variance analysis on COGS by product line","Review pricing strategy and competitive positioning","Analyze product mix shift impact on margins"],impact:"high"},{type:"warning",title:"Declining Interest Coverage",description:"Interest coverage ratio decreased 27.6% to 4.2x. While still adequate, this trend warrants attention given increasing debt levels.",recommendations:["Review debt covenant compliance","Assess refinancing opportunities","Evaluate debt repayment schedule"],impact:"medium"},{type:"info",title:"Working Capital Management",description:"Days Sales Outstanding increased from 48 to 52 days. Collection efficiency has declined slightly but remains close to industry average.",recommendations:["Review aging of receivables","Assess credit policies","Identify slow-paying customers"],impact:"medium"},{type:"positive",title:"Strong Liquidity Position",description:"Current ratio of 2.3x exceeds industry average of 2.1x. Quick ratio of 1.5x also above industry norm, indicating solid short-term liquidity.",recommendations:["Continue monitoring working capital","Evaluate optimal cash levels"],impact:"low"}]}}const EP=new TP,AP=()=>{const{id:e}=Hs(),t=ze(),[r,s]=C.useState("ratios"),[n,i]=C.useState(!0),[l,o]=C.useState(!0),[c,u]=C.useState([]),[d,f]=C.useState([]),[h,x]=C.useState([]);C.useEffect(()=>{m()},[e]);const m=async()=>{if(e)try{o(!0);const k=await EP.getFinancialAnalysis(e);u(k.ratios),f(k.trends),x(k.insights)}catch(k){console.error("Failed to load financial data:",k),de.error("Failed to load financial analysis data")}finally{o(!1)}},p=["All","Liquidity","Profitability","Leverage","Efficiency"],[w,b]=C.useState("All"),g=w==="All"?c:c.filter(k=>k.category===w),y=k=>({normal:"success",warning:"warning",alert:"error"})[k]||"neutral",j=k=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(k),A=(k,v=1)=>`${k.toFixed(v)}%`;return l?a.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:a.jsxs("div",{className:"flex flex-col items-center gap-4",children:[a.jsx(Aa,{className:"w-12 h-12 text-primary-500 animate-spin"}),a.jsx("p",{className:"text-body text-neutral-600",children:"Loading financial analysis..."})]})}):a.jsxs("div",{className:"space-y-6 max-w-[1800px]",children:[a.jsxs(z.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center gap-4",children:[a.jsx("button",{onClick:()=>t(`/firm/engagements/${e}/workspace`),className:"p-2 hover:bg-neutral-100 rounded-fluent-sm transition-colors",children:a.jsx(Qr,{className:"w-5 h-5 text-neutral-700"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h1",{className:"text-display text-neutral-900 mb-1",children:"Analytical Procedures"}),a.jsx("p",{className:"text-body text-neutral-600",children:"AI-powered financial analysis and benchmarking"})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{className:"fluent-btn-secondary",children:[a.jsx(oa,{className:"w-4 h-4"}),"Import Financials"]}),a.jsxs("button",{className:"fluent-btn-primary",children:[a.jsx(xs,{className:"w-4 h-4"}),"Export Analysis"]})]})]}),a.jsx(Xe,{children:n&&a.jsx(z.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"fluent-card bg-gradient-to-r from-primary-50 to-purple-50 p-5 border-l-4 border-primary-500",children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"w-10 h-10 rounded-fluent bg-primary-500 flex items-center justify-center flex-shrink-0",children:a.jsx(Rt,{className:"w-5 h-5 text-white"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-body-strong text-neutral-900 mb-1",children:"AI Analysis Complete - 4 Insights Generated"}),a.jsx("p",{className:"text-caption text-neutral-700",children:"Our AI has analyzed financial data and identified key trends, anomalies, and areas requiring attention."})]}),a.jsx("button",{onClick:()=>i(!1),className:"p-1 hover:bg-primary-100 rounded-fluent-sm",children:a.jsx(_i,{className:"w-5 h-5 text-primary-600"})})]})})}),a.jsx("div",{className:"fluent-card p-1",children:a.jsx("div",{className:"flex gap-1",children:[{id:"ratios",label:"Financial Ratios",icon:eF},{id:"trends",label:"Trend Analysis",icon:ua},{id:"variance",label:"Variance Analysis",icon:Yd},{id:"benchmarks",label:"Industry Benchmarks",icon:Ml}].map(k=>{const v=k.icon;return a.jsxs("button",{onClick:()=>s(k.id),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-fluent transition-all ${r===k.id?"bg-primary-500 text-white shadow-sm":"text-neutral-700 hover:bg-neutral-100"}`,children:[a.jsx(v,{className:"w-4 h-4"}),a.jsx("span",{className:"text-body-strong",children:k.label})]},k.id)})})}),r==="ratios"&&a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"flex gap-2",children:p.map(k=>a.jsx("button",{onClick:()=>b(k),className:`px-4 py-2 rounded-fluent transition-all ${w===k?"bg-primary-500 text-white":"bg-neutral-100 text-neutral-700 hover:bg-neutral-200"}`,children:k},k))}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:g.map((k,v)=>{const E=y(k.status),S=k.variance>0;return a.jsxs(z.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:v*.05},className:"fluent-card p-5",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"text-body-strong text-neutral-900 mb-1",children:k.name}),a.jsx("p",{className:"text-caption text-neutral-600",children:k.description})]}),a.jsx("div",{className:`w-8 h-8 rounded-fluent bg-${E}-100 flex items-center justify-center flex-shrink-0 ml-2`,children:k.status==="normal"?a.jsx(Re,{className:`w-4 h-4 text-${E}-600`}):a.jsx(Qe,{className:`w-4 h-4 text-${E}-600`})})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-baseline gap-2 mb-1",children:[a.jsxs("span",{className:"text-title-large text-neutral-900 font-semibold",children:[k.value.toFixed(k.name.includes("%")?1:2),k.name.includes("%")&&"%"]}),a.jsxs("div",{className:`flex items-center gap-1 text-${S?"success":"error"}-600`,children:[S?a.jsx(ua,{className:"w-4 h-4"}):a.jsx(W0,{className:"w-4 h-4"}),a.jsxs("span",{className:"text-caption font-medium",children:[Math.abs(k.variance).toFixed(1),"%"]})]})]}),a.jsx("p",{className:"text-caption text-neutral-600",children:"Current Year"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 pt-3 border-t border-neutral-200",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-caption text-neutral-600 mb-1",children:"Prior Year"}),a.jsxs("p",{className:"text-body-strong text-neutral-900",children:[k.priorYear.toFixed(k.name.includes("%")?1:2),k.name.includes("%")&&"%"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-caption text-neutral-600 mb-1",children:"Industry Avg"}),a.jsxs("p",{className:"text-body-strong text-neutral-900",children:[k.industry.toFixed(k.name.includes("%")?1:2),k.name.includes("%")&&"%"]})]})]})]})]},k.name)})})]}),r==="trends"&&a.jsx("div",{className:"space-y-6",children:a.jsxs("div",{className:"fluent-card p-6",children:[a.jsx("h3",{className:"text-title text-neutral-900 mb-6",children:"Quarterly Performance Trends"}),a.jsxs("div",{className:"mb-8",children:[a.jsx("h4",{className:"text-body-strong text-neutral-900 mb-4",children:"Revenue Trend"}),a.jsx("div",{className:"space-y-2",children:d.map((k,v)=>{const E=Math.max(...d.map(F=>F.revenue)),S=k.revenue/E*100,N=v>0?d[v-1].revenue:k.revenue,D=(k.revenue-N)/N*100;return a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("span",{className:"text-caption text-neutral-700",children:k.period}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"text-body-strong text-neutral-900",children:j(k.revenue)}),v>0&&a.jsxs("span",{className:`text-caption font-medium ${D>=0?"text-success-600":"text-error-600"}`,children:[D>=0?"+":"",D.toFixed(1),"%"]})]})]}),a.jsx("div",{className:"h-8 bg-neutral-100 rounded-fluent overflow-hidden",children:a.jsx("div",{className:"h-full bg-gradient-to-r from-primary-500 to-primary-600 flex items-center justify-end px-3",style:{width:`${S}%`},children:S>30&&a.jsx("span",{className:"text-caption text-white font-medium",children:j(k.revenue)})})})]},k.period)})})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-body-strong text-neutral-900 mb-4",children:"Gross Margin Trend"}),a.jsx("div",{className:"space-y-2",children:d.map((k,v)=>{const E=v>0?d[v-1].grossMargin:k.grossMargin,S=k.grossMargin-E;return a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("span",{className:"text-caption text-neutral-700",children:k.period}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"text-body-strong text-neutral-900",children:A(k.grossMargin)}),v>0&&a.jsxs("span",{className:`text-caption font-medium ${S>=0?"text-success-600":"text-error-600"}`,children:[S>=0?"+":"",S.toFixed(1),"pp"]})]})]}),a.jsx("div",{className:"h-2 bg-neutral-100 rounded-full overflow-hidden",children:a.jsx("div",{className:`h-full rounded-full ${k.grossMargin>=44?"bg-success-500":"bg-warning-500"}`,style:{width:`${k.grossMargin/50*100}%`}})})]},k.period)})})]})]})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Rt,{className:"w-5 h-5 text-primary-600"}),a.jsx("h2",{className:"text-title text-neutral-900",children:"AI-Powered Insights"})]}),h.map((k,v)=>{const S={critical:{color:"error",icon:Qe,bg:"error"},warning:{color:"warning",icon:Qe,bg:"warning"},info:{color:"primary",icon:z0,bg:"primary"},positive:{color:"success",icon:Re,bg:"success"}}[k.type],N=S.icon;return a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:v*.1},className:`fluent-card p-5 border-l-4 border-${S.color}-500`,children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:`w-10 h-10 rounded-fluent bg-${S.bg}-100 flex items-center justify-center flex-shrink-0`,children:a.jsx(N,{className:`w-5 h-5 text-${S.color}-600`})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsx("h4",{className:"text-body-strong text-neutral-900",children:k.title}),a.jsxs("span",{className:`px-2 py-0.5 rounded-fluent-sm text-caption font-medium bg-${S.bg}-100 text-${S.color}-700`,children:[k.impact.toUpperCase()," IMPACT"]})]}),a.jsx("p",{className:"text-body text-neutral-700 mb-4",children:k.description}),a.jsxs("div",{children:[a.jsx("p",{className:"text-caption font-semibold text-neutral-900 mb-2",children:"Recommended Actions:"}),a.jsx("ul",{className:"space-y-1",children:k.recommendations.map((D,F)=>a.jsxs("li",{className:"flex items-start gap-2 text-caption text-neutral-700",children:[a.jsx(fa,{className:"w-3.5 h-3.5 text-primary-500 flex-shrink-0 mt-0.5"}),a.jsx("span",{children:D})]},F))})]})]})]})},v)})]})]})},Xy="https://portal.auraai.toroniandcompany.com/api";class FP{constructor(){Wt(this,"testingApi");Wt(this,"samplingApi");this.testingApi=ye.create({baseURL:`${Xy}/substantive-testing`,headers:{"Content-Type":"application/json"}}),this.samplingApi=ye.create({baseURL:`${Xy}/sampling`,headers:{"Content-Type":"application/json"}}),[this.testingApi,this.samplingApi].forEach(t=>{t.interceptors.request.use(r=>{const s=localStorage.getItem("access_token");return s&&(r.headers.Authorization=`Bearer ${s}`),r}),t.interceptors.response.use(r=>r,r=>{var s;return((s=r.response)==null?void 0:s.status)===401&&(localStorage.removeItem("access_token"),window.location.href="/login"),Promise.reject(r)})})}async getTestModules(t){try{return(await this.testingApi.get(`/engagements/${t}/modules`)).data}catch(r){return console.error("Failed to fetch test modules:",r),this.getDefaultTestModules()}}async getTestsForModule(t,r){try{return(await this.testingApi.get(`/engagements/${t}/modules/${r}/tests`)).data}catch(s){return console.error("Failed to fetch tests:",s),this.getDefaultRevenueTests()}}async getAIAnomalies(t,r){try{const s=r?`/engagements/${t}/modules/${r}/anomalies`:`/engagements/${t}/anomalies`;return(await this.testingApi.get(s)).data}catch(s){return console.error("Failed to fetch AI anomalies:",s),this.getDefaultAIAnomalies()}}async updateTestStatus(t,r,s){return(await this.testingApi.patch(`/engagements/${t}/tests/${r}`,{status:s})).data}async runAIAnalysis(t,r){return(await this.testingApi.post(`/engagements/${t}/modules/${r}/ai-analysis`)).data}async generateSample(t,r){return(await this.samplingApi.post(`/engagements/${t}/generate-sample`,r)).data}async createTest(t,r,s){return(await this.testingApi.post(`/engagements/${t}/modules/${r}/tests`,s)).data}getDefaultTestModules(){return[{id:"revenue",name:"Revenue Testing",icon:"DollarSign",color:"green",description:"Revenue recognition, invoicing, and cut-off testing",tests:8,completed:6,anomalies:3},{id:"receivables",name:"Accounts Receivable",icon:"FileText",color:"blue",description:"AR aging, confirmations, and collectability",tests:6,completed:5,anomalies:2},{id:"inventory",name:"Inventory",icon:"Package",color:"purple",description:"Observation, valuation, and obsolescence",tests:7,completed:4,anomalies:1},{id:"fixed_assets",name:"Fixed Assets",icon:"Building",color:"cyan",description:"Additions, disposals, and depreciation",tests:5,completed:3,anomalies:0},{id:"liabilities",name:"Liabilities & Equity",icon:"CreditCard",color:"orange",description:"Debt, payables, and covenant compliance",tests:6,completed:2,anomalies:1}]}getDefaultRevenueTests(){return[{id:"1",name:"Revenue Recognition Testing",description:"Test revenue recognition policies and procedures",status:"completed",sampleSize:60,exceptions:0,aiFlags:2,moduleId:"revenue"},{id:"2",name:"Statistical Sample Selection",description:"Select statistically valid revenue sample",status:"completed",sampleSize:60,moduleId:"revenue"},{id:"3",name:"Invoice Testing",description:"Test invoice to supporting documentation",status:"in_progress",sampleSize:60,exceptions:1,aiFlags:3,moduleId:"revenue"},{id:"4",name:"Cut-off Testing",description:"Test revenue recorded in correct period",status:"completed",sampleSize:30,exceptions:0,moduleId:"revenue"},{id:"5",name:"Completeness Testing",description:"Test completeness of revenue recording",status:"completed",sampleSize:40,exceptions:0,moduleId:"revenue"},{id:"6",name:"AI Anomaly Detection",description:"AI-powered pattern and anomaly analysis",status:"completed",aiFlags:5,moduleId:"revenue"},{id:"7",name:"Revenue Analytics",description:"Analytical procedures and trend analysis",status:"in_progress",moduleId:"revenue"},{id:"8",name:"Contract Review",description:"Review revenue contracts for ASC 606 compliance",status:"not_started",sampleSize:15,moduleId:"revenue"}]}getDefaultAIAnomalies(){return[{type:"high",title:"Unusual Revenue Spike - Customer XYZ",description:"Revenue from Customer XYZ increased 450% in Q4. Single invoice for $1.2M on Dec 30.",recommendation:"Review invoice, contract, and delivery documentation. Verify revenue recognition timing.",testArea:"Revenue Recognition"},{type:"medium",title:"Pricing Variance Detected",description:"12 invoices show pricing 15-20% below standard rates without documented approvals.",recommendation:"Obtain pricing approval documentation. Assess impact on revenue completeness.",testArea:"Invoice Testing"},{type:"medium",title:"Missing Sequential Invoice Numbers",description:"Invoice sequence shows gaps: #1045-1048 missing. May indicate completeness issue.",recommendation:"Investigate missing invoices. Confirm void/cancelled or potential completeness concern.",testArea:"Completeness"}]}}const Bu=new FP,RP={DollarSign:Or,FileText:$e,Package:X6,Building:lx,CreditCard:Wl},PP=()=>{const{id:e}=Hs(),t=ze(),[r,s]=C.useState(null),[n,i]=C.useState(!1),[l,o]=C.useState(!1),[c,u]=C.useState(!0),[d,f]=C.useState([]),[h,x]=C.useState([]),[m,p]=C.useState([]);C.useEffect(()=>{w()},[e]),C.useEffect(()=>{r&&b(r)},[r]);const w=async()=>{if(e)try{u(!0);const A=(await Bu.getTestModules(e)).map(k=>({...k,icon:RP[k.icon]||Or}));f(A)}catch(j){console.error("Failed to load test modules:",j),de.error("Failed to load test modules")}finally{u(!1)}},b=async j=>{if(e)try{const[A,k]=await Promise.all([Bu.getTestsForModule(e,j),Bu.getAIAnomalies(e,j)]);x(A),p(k)}catch(A){console.error("Failed to load module tests:",A)}},g=j=>{const A={not_started:{label:"Not Started",color:"gray",icon:J6},in_progress:{label:"In Progress",color:"blue",icon:rF},completed:{label:"Completed",color:"green",icon:Re}};return A[j]||A.not_started},y=async()=>{if(!(!e||!r)){o(!0),de.success("Running AI-powered test analysis...");try{const j=await Bu.runAIAnalysis(e,r);p(j),de.success(`Test completed - ${j.length} anomalies detected`)}catch{de.error("AI analysis failed")}finally{o(!1)}}};return c?a.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:a.jsxs("div",{className:"flex flex-col items-center gap-4",children:[a.jsx(Aa,{className:"w-12 h-12 text-primary-500 animate-spin"}),a.jsx("p",{className:"text-body text-neutral-600",children:"Loading audit tests..."})]})}):a.jsxs("div",{className:"space-y-6 max-w-[1800px]",children:[a.jsxs(z.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center gap-4",children:[a.jsx("button",{onClick:()=>t(`/firm/engagements/${e}/workspace`),className:"p-2 hover:bg-neutral-100 rounded-fluent-sm transition-colors",children:a.jsx(Qr,{className:"w-5 h-5 text-neutral-700"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h1",{className:"text-display text-neutral-900 mb-1",children:"Audit Testing"}),a.jsx("p",{className:"text-body text-neutral-600",children:"Comprehensive testing modules for all audit areas"})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{className:"fluent-btn-secondary",children:[a.jsx(oa,{className:"w-4 h-4"}),"Import Data"]}),a.jsxs("button",{className:"fluent-btn-primary",children:[a.jsx(xs,{className:"w-4 h-4"}),"Export Results"]})]})]}),!r&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map((j,A)=>{const k=j.icon,v=Math.round(j.completed/j.tests*100);return a.jsxs(z.button,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:A*.05},onClick:()=>s(j.id),className:"fluent-card-interactive p-6 text-left",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsx("div",{className:`w-12 h-12 rounded-fluent bg-${j.color}-100 flex items-center justify-center`,children:a.jsx(k,{className:`w-6 h-6 text-${j.color}-600`})}),a.jsx(fa,{className:"w-5 h-5 text-neutral-400"})]}),a.jsx("h3",{className:"text-body-strong text-neutral-900 mb-2",children:j.name}),a.jsx("p",{className:"text-caption text-neutral-600 mb-4",children:j.description}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between text-caption",children:[a.jsx("span",{className:"text-neutral-600",children:"Progress"}),a.jsxs("span",{className:"font-semibold text-neutral-900",children:[j.completed,"/",j.tests," tests"]})]}),a.jsx("div",{className:"h-2 bg-neutral-200 rounded-full overflow-hidden",children:a.jsx("div",{className:`h-full bg-${j.color}-500`,style:{width:`${v}%`}})}),j.anomalies>0&&a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded-fluent bg-warning-50 border border-warning-200",children:[a.jsx(Qe,{className:"w-4 h-4 text-warning-600"}),a.jsxs("span",{className:"text-caption font-medium text-warning-700",children:[j.anomalies," anomalies detected"]})]})]})]},j.id)})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"fluent-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("p",{className:"text-caption text-neutral-600",children:"Total Tests"}),a.jsx(Ml,{className:"w-4 h-4 text-primary-600"})]}),a.jsx("p",{className:"text-title-large text-primary-600 font-semibold",children:d.reduce((j,A)=>j+A.tests,0)})]}),a.jsxs("div",{className:"fluent-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("p",{className:"text-caption text-neutral-600",children:"Completed"}),a.jsx(Re,{className:"w-4 h-4 text-success-600"})]}),a.jsx("p",{className:"text-title-large text-success-600 font-semibold",children:d.reduce((j,A)=>j+A.completed,0)})]}),a.jsxs("div",{className:"fluent-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("p",{className:"text-caption text-neutral-600",children:"AI Anomalies"}),a.jsx(Rt,{className:"w-4 h-4 text-warning-600"})]}),a.jsx("p",{className:"text-title-large text-warning-600 font-semibold",children:d.reduce((j,A)=>j+A.anomalies,0)})]}),a.jsxs("div",{className:"fluent-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("p",{className:"text-caption text-neutral-600",children:"Completion"}),a.jsx(Ba,{className:"w-4 h-4 text-accent-600"})]}),a.jsxs("p",{className:"text-title-large text-accent-600 font-semibold",children:[Math.round(d.reduce((j,A)=>j+A.completed,0)/d.reduce((j,A)=>j+A.tests,0)*100),"%"]})]})]})]}),r==="revenue"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("button",{onClick:()=>s(null),className:"fluent-btn-secondary",children:[a.jsx(Qr,{className:"w-4 h-4"}),"Back to Modules"]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{onClick:()=>i(!0),className:"fluent-btn-secondary",children:[a.jsx($t,{className:"w-4 h-4"}),"New Test"]}),a.jsxs("button",{onClick:y,disabled:l,className:"fluent-btn-primary",children:[a.jsx(_i,{className:"w-4 h-4"}),l?"Running AI Analysis...":"Run AI Analysis"]})]})]}),a.jsx("div",{className:"space-y-3",children:h.map((j,A)=>{const k=g(j.status),v=k.icon;return a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:A*.05},className:"fluent-card p-5 hover:shadow-md transition-shadow",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("h4",{className:"text-body-strong text-neutral-900",children:j.name}),a.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-fluent-sm text-caption font-medium bg-${k.color}-50 text-${k.color}-700`,children:[a.jsx(v,{className:"w-3.5 h-3.5"}),k.label]})]}),a.jsx("p",{className:"text-caption text-neutral-600 mb-4",children:j.description}),a.jsxs("div",{className:"flex items-center gap-6 text-caption text-neutral-600",children:[j.sampleSize&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Ml,{className:"w-3.5 h-3.5"}),a.jsxs("span",{children:["Sample: ",j.sampleSize]})]}),j.exceptions!==void 0&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Qe,{className:`w-3.5 h-3.5 ${j.exceptions>0?"text-warning-600":"text-success-600"}`}),a.jsxs("span",{children:["Exceptions: ",j.exceptions]})]}),j.aiFlags&&j.aiFlags>0&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Rt,{className:"w-3.5 h-3.5 text-purple-600"}),a.jsxs("span",{className:"text-purple-700 font-medium",children:[j.aiFlags," AI flags"]})]})]})]}),a.jsx("button",{className:"fluent-btn-secondary ml-4",children:"View Details"})]})},j.id)})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(Rt,{className:"w-5 h-5 text-primary-600"}),a.jsx("h3",{className:"text-title text-neutral-900",children:"AI-Detected Anomalies"})]}),a.jsx("div",{className:"space-y-3",children:m.map((j,A)=>{const v={high:{color:"error",bg:"error",icon:Qe},medium:{color:"warning",bg:"warning",icon:Qe},low:{color:"primary",bg:"primary",icon:Rt}}[j.type],E=v.icon;return a.jsx(z.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:A*.1},className:`fluent-card p-5 border-l-4 border-${v.color}-500`,children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:`w-10 h-10 rounded-fluent bg-${v.bg}-100 flex items-center justify-center flex-shrink-0`,children:a.jsx(E,{className:`w-5 h-5 text-${v.color}-600`})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsx("h4",{className:"text-body-strong text-neutral-900",children:j.title}),a.jsxs("span",{className:`px-2 py-0.5 rounded-fluent-sm text-caption font-medium bg-${v.bg}-100 text-${v.color}-700`,children:[j.type.toUpperCase()," RISK"]})]}),a.jsx("p",{className:"text-body text-neutral-700 mb-3",children:j.description}),a.jsxs("div",{className:"bg-neutral-50 border border-neutral-200 rounded-fluent p-3",children:[a.jsx("p",{className:"text-caption font-semibold text-neutral-900 mb-1",children:"Recommendation:"}),a.jsx("p",{className:"text-caption text-neutral-700",children:j.recommendation})]}),a.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[a.jsx("span",{className:"text-caption text-neutral-600",children:"Test Area:"}),a.jsx("span",{className:"text-caption font-medium text-primary-600",children:j.testArea})]})]})]})},A)})})]})]}),a.jsx(Xe,{children:n&&a.jsx(z.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:()=>i(!1),children:a.jsxs(z.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:j=>j.stopPropagation(),className:"bg-white rounded-fluent-lg p-6 max-w-2xl w-full shadow-fluent-16",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-title-large text-neutral-900",children:"Sample Selection"}),a.jsx("button",{onClick:()=>i(!1),className:"p-2 hover:bg-neutral-100 rounded-fluent-sm",children:a.jsx(ur,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Sampling Method"}),a.jsxs("select",{className:"fluent-input",children:[a.jsx("option",{children:"Statistical Sampling"}),a.jsx("option",{children:"Judgmental Sampling"}),a.jsx("option",{children:"Stratified Sampling"}),a.jsx("option",{children:"Random Sampling"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Population Size"}),a.jsx("input",{type:"number",className:"fluent-input",placeholder:"1000"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Sample Size"}),a.jsx("input",{type:"number",className:"fluent-input",placeholder:"60"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Confidence Level"}),a.jsxs("select",{className:"fluent-input",children:[a.jsx("option",{children:"95%"}),a.jsx("option",{children:"90%"}),a.jsx("option",{children:"99%"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Expected Error Rate"}),a.jsx("input",{type:"number",className:"fluent-input",placeholder:"2.5"})]})]}),a.jsxs("div",{className:"flex gap-3 mt-6 pt-6 border-t border-neutral-200",children:[a.jsx("button",{onClick:()=>i(!1),className:"fluent-btn-secondary flex-1",children:"Cancel"}),a.jsx("button",{onClick:()=>{de.success("Sample generated successfully!"),i(!1)},className:"fluent-btn-primary flex-1",children:"Generate Sample"})]})]})})})]})},Qy="https://portal.auraai.toroniandcompany.com/api";class DP{constructor(){Wt(this,"riskApi");Wt(this,"fraudApi");this.riskApi=ye.create({baseURL:`${Qy}/risk-monitor`,headers:{"Content-Type":"application/json"}}),this.fraudApi=ye.create({baseURL:`${Qy}/fraud-detection`,headers:{"Content-Type":"application/json"}}),[this.riskApi,this.fraudApi].forEach(t=>{t.interceptors.request.use(r=>{const s=localStorage.getItem("access_token");return s&&(r.headers.Authorization=`Bearer ${s}`),r}),t.interceptors.response.use(r=>r,r=>{var s;return((s=r.response)==null?void 0:s.status)===401&&(localStorage.removeItem("access_token"),window.location.href="/login"),Promise.reject(r)})})}async getRiskAssessment(t){try{const[r,s,n]=await Promise.all([this.riskApi.get(`/engagements/${t}/risk-areas`).catch(()=>({data:null})),this.fraudApi.get(`/engagements/${t}/fraud-risks`).catch(()=>({data:null})),this.riskApi.get(`/engagements/${t}/going-concern`).catch(()=>({data:null}))]);return{riskAreas:r.data||this.getDefaultRiskAreas(),fraudRisks:s.data||this.getDefaultFraudRisks(),goingConcernIndicators:n.data||this.getDefaultGoingConcernIndicators()}}catch(r){return console.error("Failed to fetch risk assessment data:",r),{riskAreas:this.getDefaultRiskAreas(),fraudRisks:this.getDefaultFraudRisks(),goingConcernIndicators:this.getDefaultGoingConcernIndicators()}}}async saveRiskArea(t,r){return(await this.riskApi.post(`/engagements/${t}/risk-areas`,r)).data}async updateRiskArea(t,r,s){return(await this.riskApi.put(`/engagements/${t}/risk-areas/${encodeURIComponent(r)}`,s)).data}async saveFraudRisk(t,r){return(await this.fraudApi.post(`/engagements/${t}/fraud-risks`,r)).data}async saveGoingConcernIndicator(t,r){return(await this.riskApi.post(`/engagements/${t}/going-concern`,r)).data}async runAIRiskAnalysis(t){return(await this.riskApi.post(`/engagements/${t}/ai-analysis`)).data}getDefaultRiskAreas(){return[{area:"Revenue Recognition",inherentRisk:"high",controlRisk:"medium",detectionRisk:"low",auditRisk:"medium",rationale:"Complex revenue streams with multiple performance obligations. Controls are adequate but require substantive testing."},{area:"Inventory Valuation",inherentRisk:"medium",controlRisk:"low",detectionRisk:"medium",auditRisk:"low",rationale:"Established valuation methods with strong controls. Annual physical count with reconciliation."},{area:"Accounts Receivable",inherentRisk:"medium",controlRisk:"medium",detectionRisk:"medium",auditRisk:"medium",rationale:"Aging showing some collectability concerns. Allowance estimation requires judgment."},{area:"Management Override",inherentRisk:"high",controlRisk:"high",detectionRisk:"low",auditRisk:"high",rationale:"Presumed fraud risk per auditing standards. Requires unpredictable procedures and professional skepticism."},{area:"Payroll",inherentRisk:"low",controlRisk:"low",detectionRisk:"high",auditRisk:"low",rationale:"Routine transactions with strong automated controls and segregation of duties."}]}getDefaultFraudRisks(){return[{type:"Fraudulent Financial Reporting",risk:"medium",factors:["Pressure to meet earnings targets","Complex revenue recognition","Significant estimates and judgments"],procedures:["Test journal entries near year-end","Review significant estimates for bias","Test revenue recognition near period end"]},{type:"Misappropriation of Assets",risk:"low",factors:["Inventory susceptible to theft","Cash handling at retail locations"],procedures:["Observe inventory counts","Test cash reconciliations","Review unusual transactions"]},{type:"Management Override",risk:"high",factors:["Presumed risk per AU-C 240","Management has ability to override controls","Bonus structure tied to performance"],procedures:["Test appropriateness of journal entries","Review accounting estimates for bias","Review unusual or one-time transactions"]}]}getDefaultGoingConcernIndicators(){return[{indicator:"Negative working capital",present:!1,impact:"high"},{indicator:"Recurring operating losses",present:!1,impact:"high"},{indicator:"Negative cash flows from operations",present:!1,impact:"high"},{indicator:"Debt covenant violations",present:!1,impact:"high"},{indicator:"Loss of major customer",present:!1,impact:"medium"},{indicator:"Legal proceedings",present:!1,impact:"low"},{indicator:"Difficulty in paying obligations",present:!1,impact:"high"},{indicator:"Need for major refinancing",present:!1,impact:"medium"}]}}const IP=new DP,OP=()=>{const{id:e}=Hs(),t=ze(),[r,s]=C.useState("matrix"),[n,i]=C.useState(!0),[l,o]=C.useState([]),[c,u]=C.useState([]),[d,f]=C.useState([]),[h,x]=C.useState(1e7),[m,p]=C.useState(8e6),[w,b]=C.useState(5e5);C.useEffect(()=>{g()},[e]);const g=async()=>{if(e)try{i(!0);const v=await IP.getRiskAssessment(e);o(v.riskAreas),u(v.fraudRisks),f(v.goingConcernIndicators)}catch(v){console.error("Failed to load risk data:",v),de.error("Failed to load risk assessment data")}finally{i(!1)}},j=(()=>{const v=h*.005,E=m*.01;return{planning:Math.min(v,E),performance:Math.min(v,E)*.75,trivial:Math.min(v,E)*.05}})(),A=v=>({low:"success",medium:"warning",high:"error"})[v]||"neutral",k=v=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(v);return n?a.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:a.jsxs("div",{className:"flex flex-col items-center gap-4",children:[a.jsx(Aa,{className:"w-12 h-12 text-primary-500 animate-spin"}),a.jsx("p",{className:"text-body text-neutral-600",children:"Loading risk assessment..."})]})}):a.jsxs("div",{className:"space-y-6 max-w-[1800px]",children:[a.jsxs(z.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center gap-4",children:[a.jsx("button",{onClick:()=>t(`/firm/engagements/${e}/workspace`),className:"p-2 hover:bg-neutral-100 rounded-fluent-sm transition-colors",children:a.jsx(Qr,{className:"w-5 h-5 text-neutral-700"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h1",{className:"text-display text-neutral-900 mb-1",children:"Risk Assessment"}),a.jsx("p",{className:"text-body text-neutral-600",children:"Risk matrix, materiality, fraud assessment, and going concern"})]}),a.jsxs("button",{className:"fluent-btn-primary",children:[a.jsx(xs,{className:"w-4 h-4"}),"Export Assessment"]})]}),a.jsx("div",{className:"fluent-card p-1",children:a.jsx("div",{className:"flex gap-1",children:[{id:"matrix",label:"Risk Matrix",icon:We},{id:"materiality",label:"Materiality",icon:Us},{id:"fraud",label:"Fraud Risk",icon:Qe},{id:"going_concern",label:"Going Concern",icon:W0}].map(v=>{const E=v.icon;return a.jsxs("button",{onClick:()=>s(v.id),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-fluent transition-all ${r===v.id?"bg-primary-500 text-white shadow-sm":"text-neutral-700 hover:bg-neutral-100"}`,children:[a.jsx(E,{className:"w-4 h-4"}),a.jsx("span",{className:"text-body-strong",children:v.label})]},v.id)})})}),r==="matrix"&&a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"fluent-card p-6",children:[a.jsx("h3",{className:"text-title text-neutral-900 mb-4",children:"Risk Assessment Matrix"}),a.jsx("p",{className:"text-body text-neutral-600 mb-6",children:"Assessment of inherent risk, control risk, detection risk, and overall audit risk by area"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b-2 border-neutral-200",children:[a.jsx("th",{className:"text-left py-3 px-4 text-body-strong text-neutral-900",children:"Audit Area"}),a.jsx("th",{className:"text-center py-3 px-4 text-body-strong text-neutral-900",children:"Inherent Risk"}),a.jsx("th",{className:"text-center py-3 px-4 text-body-strong text-neutral-900",children:"Control Risk"}),a.jsx("th",{className:"text-center py-3 px-4 text-body-strong text-neutral-900",children:"Detection Risk"}),a.jsx("th",{className:"text-center py-3 px-4 text-body-strong text-neutral-900",children:"Audit Risk"})]})}),a.jsx("tbody",{children:l.map((v,E)=>a.jsxs(Ei.Fragment,{children:[a.jsxs("tr",{className:"border-b border-neutral-200 hover:bg-neutral-50",children:[a.jsx("td",{className:"py-4 px-4 text-body-strong text-neutral-900",children:v.area}),a.jsx("td",{className:"py-4 px-4 text-center",children:a.jsx("span",{className:`inline-flex px-3 py-1 rounded-fluent text-caption font-medium bg-${A(v.inherentRisk)}-100 text-${A(v.inherentRisk)}-700`,children:v.inherentRisk.toUpperCase()})}),a.jsx("td",{className:"py-4 px-4 text-center",children:a.jsx("span",{className:`inline-flex px-3 py-1 rounded-fluent text-caption font-medium bg-${A(v.controlRisk)}-100 text-${A(v.controlRisk)}-700`,children:v.controlRisk.toUpperCase()})}),a.jsx("td",{className:"py-4 px-4 text-center",children:a.jsx("span",{className:`inline-flex px-3 py-1 rounded-fluent text-caption font-medium bg-${A(v.detectionRisk)}-100 text-${A(v.detectionRisk)}-700`,children:v.detectionRisk.toUpperCase()})}),a.jsx("td",{className:"py-4 px-4 text-center",children:a.jsx("span",{className:`inline-flex px-3 py-1 rounded-fluent text-caption font-semibold bg-${A(v.auditRisk)}-100 text-${A(v.auditRisk)}-700 border-2 border-${A(v.auditRisk)}-300`,children:v.auditRisk.toUpperCase()})})]}),a.jsx("tr",{className:"border-b border-neutral-200 bg-neutral-50",children:a.jsx("td",{colSpan:5,className:"py-3 px-4",children:a.jsxs("p",{className:"text-caption text-neutral-700",children:[a.jsx("span",{className:"font-semibold",children:"Rationale:"})," ",v.rationale]})})})]},E))})]})})]})}),r==="materiality"&&a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"fluent-card p-6",children:[a.jsx("h3",{className:"text-title text-neutral-900 mb-4",children:"Financial Inputs"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Annual Revenue"}),a.jsxs("div",{className:"relative",children:[a.jsx(Or,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-neutral-500"}),a.jsx("input",{type:"number",value:h,onChange:v=>x(Number(v.target.value)),className:"fluent-input pl-10"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Total Assets"}),a.jsxs("div",{className:"relative",children:[a.jsx(Or,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-neutral-500"}),a.jsx("input",{type:"number",value:m,onChange:v=>p(Number(v.target.value)),className:"fluent-input pl-10"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Net Income"}),a.jsxs("div",{className:"relative",children:[a.jsx(Or,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-neutral-500"}),a.jsx("input",{type:"number",value:w,onChange:v=>b(Number(v.target.value)),className:"fluent-input pl-10"})]})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-primary-50 border border-primary-200 rounded-fluent",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Us,{className:"w-4 h-4 text-primary-600"}),a.jsx("p",{className:"text-caption font-semibold text-primary-900",children:"Calculation Methodology"})]}),a.jsxs("ul",{className:"text-caption text-primary-800 space-y-1",children:[a.jsx("li",{children:" Planning Materiality: Lesser of 0.5% revenue or 1% assets"}),a.jsx("li",{children:" Performance Materiality: 75% of planning materiality"}),a.jsx("li",{children:" Trivial Threshold: 5% of planning materiality"})]})]})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs(z.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"fluent-card p-6 bg-gradient-to-br from-primary-50 to-purple-50",children:[a.jsx("h4",{className:"text-body-strong text-neutral-900 mb-4",children:"Planning Materiality"}),a.jsx("p",{className:"text-display text-primary-600 font-bold mb-2",children:k(j.planning)}),a.jsx("p",{className:"text-caption text-neutral-600",children:"Overall materiality for planning and evaluating misstatements"})]}),a.jsxs(z.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.1},className:"fluent-card p-6 bg-gradient-to-br from-accent-50 to-blue-50",children:[a.jsx("h4",{className:"text-body-strong text-neutral-900 mb-4",children:"Performance Materiality"}),a.jsx("p",{className:"text-display text-accent-600 font-bold mb-2",children:k(j.performance)}),a.jsx("p",{className:"text-caption text-neutral-600",children:"Amount set to reduce probability that aggregate uncorrected misstatements exceed planning materiality"})]}),a.jsxs(z.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.2},className:"fluent-card p-6 bg-gradient-to-br from-neutral-50 to-neutral-100",children:[a.jsx("h4",{className:"text-body-strong text-neutral-900 mb-4",children:"Trivial Threshold"}),a.jsx("p",{className:"text-display text-neutral-700 font-bold mb-2",children:k(j.trivial)}),a.jsx("p",{className:"text-caption text-neutral-600",children:"Amount below which misstatements need not be accumulated"})]})]})]}),r==="fraud"&&a.jsx("div",{className:"space-y-4",children:c.map((v,E)=>{const S=A(v.risk);return a.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:E*.1},className:`fluent-card p-6 border-l-4 border-${S}-500`,children:[a.jsx("div",{className:"flex items-start justify-between mb-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-10 h-10 rounded-fluent bg-${S}-100 flex items-center justify-center`,children:a.jsx(Qe,{className:`w-5 h-5 text-${S}-600`})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-body-strong text-neutral-900",children:v.type}),a.jsxs("span",{className:`inline-flex px-2 py-0.5 rounded-fluent-sm text-caption font-medium bg-${S}-100 text-${S}-700 mt-1`,children:[v.risk.toUpperCase()," RISK"]})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-caption font-semibold text-neutral-900 mb-2",children:"Risk Factors:"}),a.jsx("ul",{className:"space-y-1",children:v.factors.map((N,D)=>a.jsxs("li",{className:"flex items-start gap-2 text-caption text-neutral-700",children:[a.jsx("span",{className:"text-error-500 mt-1",children:""}),a.jsx("span",{children:N})]},D))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-caption font-semibold text-neutral-900 mb-2",children:"Audit Procedures:"}),a.jsx("ul",{className:"space-y-1",children:v.procedures.map((N,D)=>a.jsxs("li",{className:"flex items-start gap-2 text-caption text-neutral-700",children:[a.jsx(Re,{className:"w-3.5 h-3.5 text-success-600 flex-shrink-0 mt-0.5"}),a.jsx("span",{children:N})]},D))})]})]})]},E)})}),r==="going_concern"&&a.jsxs("div",{className:"fluent-card p-6",children:[a.jsx("h3",{className:"text-title text-neutral-900 mb-4",children:"Going Concern Assessment"}),a.jsx("p",{className:"text-body text-neutral-600 mb-6",children:"Evaluation of indicators that may raise substantial doubt about the entity's ability to continue as a going concern"}),a.jsx("div",{className:"space-y-3",children:d.map((v,E)=>a.jsx(z.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:E*.05},className:`p-4 border rounded-fluent ${v.present?"border-warning-300 bg-warning-50":"border-neutral-200 bg-white"}`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[v.present?a.jsx(tn,{className:"w-5 h-5 text-warning-600"}):a.jsx(Re,{className:"w-5 h-5 text-success-600"}),a.jsx("span",{className:"text-body-strong text-neutral-900",children:v.indicator})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("span",{className:`px-2 py-0.5 rounded-fluent-sm text-caption font-medium ${v.impact==="high"?"bg-error-100 text-error-700":v.impact==="medium"?"bg-warning-100 text-warning-700":"bg-primary-100 text-primary-700"}`,children:[v.impact.toUpperCase()," IMPACT"]}),a.jsx("span",{className:`text-body-strong ${v.present?"text-warning-700":"text-success-700"}`,children:v.present?"Present":"Not Present"})]})]})},E))}),a.jsx("div",{className:"mt-6 p-5 bg-primary-50 border border-primary-200 rounded-fluent",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Rt,{className:"w-5 h-5 text-primary-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-body-strong text-primary-900 mb-2",children:"AI Assessment"}),a.jsxs("p",{className:"text-body text-primary-800 mb-3",children:["Based on the indicators present, there is ",a.jsx("strong",{children:"no substantial doubt"})," about the entity's ability to continue as a going concern. The legal proceedings indicator has low impact and does not materially affect the assessment."]}),a.jsx("p",{className:"text-caption text-primary-700",children:"Continue monitoring financial condition and update assessment if circumstances change."})]})]})})]})]})},MP=()=>{const{id:e}=Hs(),t=ze(),[r,s]=C.useState([]),[n,i]=C.useState(!0),[l,o]=C.useState(!1),[c,u]=C.useState(""),[d,f]=C.useState("all"),[h,x]=C.useState(!1),[m,p]=C.useState(null),[w,b]=C.useState([]),[g,y]=C.useState("Financial Statements"),[j,A]=C.useState(""),[k,v]=C.useState(""),E=C.useRef(null);C.useEffect(()=>{S()},[e]);const S=async()=>{try{i(!0);const T=(await Gi.getDocuments(e)).map(L=>({id:L.id,name:L.name||L.filename||"Unnamed Document",type:N(L.name||L.filename||""),size:D(L.size||0),uploadedBy:L.uploaded_by||L.uploadedBy||"Unknown",uploadedAt:L.created_at||L.uploadedAt||new Date().toISOString(),category:L.category||"Other",workpaperRef:L.workpaper_ref||L.workpaperRef,ocrStatus:L.ocr_status||L.ocrStatus||"pending",aiExtracted:L.ai_extracted||L.aiExtracted||!1,tags:L.tags||[]}));s(T)}catch{console.log("Documents API not available, starting with empty list"),s([])}finally{i(!1)}},N=W=>{var L;const T=(L=W.split(".").pop())==null?void 0:L.toLowerCase();return["pdf"].includes(T||"")?"pdf":["xlsx","xls","csv"].includes(T||"")?"spreadsheet":["png","jpg","jpeg","gif"].includes(T||"")?"image":"document"},D=W=>{if(W===0)return"0 Bytes";const T=1024,L=["Bytes","KB","MB","GB"],B=Math.floor(Math.log(W)/Math.log(T));return parseFloat((W/Math.pow(T,B)).toFixed(2))+" "+L[B]},F=["All","Financial Statements","Bank Statements","Receivables","Payables","Revenue","Fixed Assets","Contracts","Other"],Y=W=>{switch(W){case"pdf":return $e;case"spreadsheet":return pc;case"image":return Qd;default:return cx}},Q=r.filter(W=>{const T=W.name.toLowerCase().includes(c.toLowerCase())||W.tags.some(B=>B.toLowerCase().includes(c.toLowerCase())),L=d==="all"||W.category===d;return T&&L}),ae=W=>{const T=Array.from(W.target.files||[]);b(T)},ee=W=>{W.preventDefault();const T=Array.from(W.dataTransfer.files);b(T)},fe=W=>{W.preventDefault()},se=async()=>{if(w.length===0){de.error("Please select files to upload");return}o(!0);const W=de.loading(`Uploading ${w.length} file(s)...`);try{for(const T of w)await Gi.uploadDocument(T,g,e);de.dismiss(W),de.success("Documents uploaded successfully! AI extraction in progress..."),x(!1),b([]),y("Financial Statements"),A(""),v(""),S()}catch(T){de.dismiss(W),de.error(T.message||"Failed to upload documents")}finally{o(!1)}},H=async W=>{if(confirm("Are you sure you want to delete this document?"))try{await Gi.deleteDocument(W),de.success("Document deleted"),s(r.filter(T=>T.id!==W))}catch{de.error("Failed to delete document")}},ne=async W=>{try{const T=await Gi.downloadDocument(W.id),L=window.URL.createObjectURL(T),B=document.createElement("a");B.href=L,B.download=W.name,document.body.appendChild(B),B.click(),window.URL.revokeObjectURL(L),document.body.removeChild(B)}catch{de.error("Failed to download document")}};return n?a.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:a.jsxs("div",{className:"flex flex-col items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 border-4 border-primary-500 border-t-transparent rounded-full animate-spin"}),a.jsx("p",{className:"text-body text-neutral-600",children:"Loading documents..."})]})}):a.jsxs("div",{className:"space-y-6 max-w-[1800px]",children:[a.jsxs(z.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center gap-4",children:[a.jsx("button",{onClick:()=>t(`/firm/engagements/${e}/workspace`),className:"p-2 hover:bg-neutral-100 rounded-fluent-sm transition-colors",children:a.jsx(Qr,{className:"w-5 h-5 text-neutral-700"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h1",{className:"text-display text-neutral-900 mb-1",children:"Document Repository"}),a.jsx("p",{className:"text-body text-neutral-600",children:"Client documents with OCR and AI extraction"})]}),a.jsxs("button",{onClick:()=>x(!0),className:"fluent-btn-primary",children:[a.jsx(oa,{className:"w-4 h-4"}),"Upload Documents"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"fluent-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("p",{className:"text-caption text-neutral-600",children:"Total Documents"}),a.jsx(xc,{className:"w-4 h-4 text-primary-600"})]}),a.jsx("p",{className:"text-title-large text-primary-600 font-semibold",children:r.length})]}),a.jsxs("div",{className:"fluent-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("p",{className:"text-caption text-neutral-600",children:"AI Processed"}),a.jsx(Rt,{className:"w-4 h-4 text-purple-600"})]}),a.jsx("p",{className:"text-title-large text-purple-600 font-semibold",children:r.filter(W=>W.aiExtracted).length})]}),a.jsxs("div",{className:"fluent-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("p",{className:"text-caption text-neutral-600",children:"Linked to Workpapers"}),a.jsx($e,{className:"w-4 h-4 text-accent-600"})]}),a.jsx("p",{className:"text-title-large text-accent-600 font-semibold",children:r.filter(W=>W.workpaperRef).length})]}),a.jsxs("div",{className:"fluent-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("p",{className:"text-caption text-neutral-600",children:"Total Size"}),a.jsx(pc,{className:"w-4 h-4 text-success-600"})]}),a.jsx("p",{className:"text-title-large text-success-600 font-semibold",children:r.reduce((W,T)=>{const B=T.size.match(/([\d.]+)\s*(Bytes|KB|MB|GB)/);if(B){const V=parseFloat(B[1]),te=B[2],ue={Bytes:1,KB:1024,MB:1024*1024,GB:1024*1024*1024};return W+V*(ue[te]||1)}return W},0)>0?D(r.reduce((W,T)=>{const B=T.size.match(/([\d.]+)\s*(Bytes|KB|MB|GB)/);if(B){const V=parseFloat(B[1]),te=B[2],ue={Bytes:1,KB:1024,MB:1024*1024,GB:1024*1024*1024};return W+V*(ue[te]||1)}return W},0)):"0 Bytes"})]})]}),a.jsx("div",{className:"fluent-card p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(Vs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-neutral-400"}),a.jsx("input",{type:"text",value:c,onChange:W=>u(W.target.value),placeholder:"Search documents...",className:"fluent-input pl-10"})]}),a.jsx("select",{value:d,onChange:W=>f(W.target.value),className:"fluent-input w-full sm:w-64",children:F.map(W=>a.jsx("option",{value:W==="All"?"all":W,children:W},W))})]})}),a.jsx("div",{className:"space-y-3",children:Q.map((W,T)=>{const L=Y(W.type);return a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:T*.05},className:"fluent-card p-5 hover:shadow-md transition-all",children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-fluent flex items-center justify-center flex-shrink-0",children:a.jsx(L,{className:"w-6 h-6 text-primary-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"text-body-strong text-neutral-900 truncate mb-1",children:W.name}),a.jsxs("div",{className:"flex items-center gap-4 text-caption text-neutral-600",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(ha,{className:"w-3.5 h-3.5"}),a.jsx("span",{children:W.uploadedBy})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(nt,{className:"w-3.5 h-3.5"}),a.jsx("span",{children:new Date(W.uploadedAt).toLocaleDateString()})]}),a.jsx("span",{children:W.size}),W.workpaperRef&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx($e,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"font-medium text-primary-600",children:W.workpaperRef})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[W.aiExtracted&&a.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-purple-50 border border-purple-200 rounded-fluent",children:[a.jsx(Rt,{className:"w-3.5 h-3.5 text-purple-600"}),a.jsx("span",{className:"text-caption font-medium text-purple-700",children:"AI Extracted"})]}),W.ocrStatus==="completed"&&a.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-success-50 border border-success-200 rounded-fluent",children:[a.jsx(Re,{className:"w-3.5 h-3.5 text-success-600"}),a.jsx("span",{className:"text-caption font-medium text-success-700",children:"OCR Done"})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx("span",{className:"text-caption px-2 py-0.5 bg-neutral-100 text-neutral-700 rounded-fluent",children:W.category}),W.tags.map((B,V)=>a.jsx("span",{className:"text-caption px-2 py-0.5 bg-primary-50 text-primary-700 rounded-fluent",children:B},V))]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:()=>window.open(Gi.getDocumentPreviewUrl(W.id),"_blank"),className:"fluent-btn-secondary text-sm",children:[a.jsx(cr,{className:"w-3.5 h-3.5"}),"View"]}),a.jsxs("button",{onClick:()=>ne(W),className:"fluent-btn-secondary text-sm",children:[a.jsx(xs,{className:"w-3.5 h-3.5"}),"Download"]}),W.aiExtracted&&a.jsxs("button",{className:"fluent-btn-secondary text-sm",children:[a.jsx(_i,{className:"w-3.5 h-3.5"}),"AI Insights"]}),a.jsxs("button",{onClick:()=>H(W.id),className:"text-error-600 hover:bg-error-50 px-3 py-1.5 rounded-fluent transition-colors text-sm flex items-center gap-1.5",children:[a.jsx(Ii,{className:"w-3.5 h-3.5"}),"Delete"]})]})]})]})},W.id)})}),Q.length===0&&a.jsxs("div",{className:"fluent-card text-center py-16",children:[a.jsx(xc,{className:"w-16 h-16 text-neutral-300 mx-auto mb-4"}),a.jsx("h3",{className:"text-title text-neutral-900 mb-2",children:"No documents found"}),a.jsx("p",{className:"text-body text-neutral-600 mb-6",children:"Upload client documents to get started"}),a.jsxs("button",{onClick:()=>x(!0),className:"fluent-btn-primary",children:[a.jsx(oa,{className:"w-4 h-4"}),"Upload Documents"]})]}),a.jsx(Xe,{children:h&&a.jsx(z.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:()=>x(!1),children:a.jsxs(z.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:W=>W.stopPropagation(),className:"bg-white rounded-fluent-lg p-6 max-w-2xl w-full shadow-fluent-16",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-title-large text-neutral-900",children:"Upload Documents"}),a.jsx("button",{onClick:()=>x(!1),className:"p-2 hover:bg-neutral-100 rounded-fluent-sm",children:a.jsx(ur,{className:"w-5 h-5"})})]}),a.jsx("input",{type:"file",ref:E,onChange:ae,multiple:!0,accept:".pdf,.xlsx,.xls,.csv,.doc,.docx,.png,.jpg,.jpeg",className:"hidden"}),a.jsxs("div",{onClick:()=>{var W;return(W=E.current)==null?void 0:W.click()},onDrop:ee,onDragOver:fe,className:"border-2 border-dashed border-neutral-300 rounded-fluent-lg p-12 text-center mb-6 hover:border-primary-400 hover:bg-primary-50 transition-all cursor-pointer",children:[a.jsx(oa,{className:"w-12 h-12 text-neutral-400 mx-auto mb-4"}),w.length>0?a.jsxs(a.Fragment,{children:[a.jsxs("p",{className:"text-body-strong text-neutral-900 mb-2",children:[w.length," file(s) selected"]}),a.jsx("div",{className:"text-caption text-neutral-600 space-y-1",children:w.map((W,T)=>a.jsxs("div",{children:[W.name," (",D(W.size),")"]},T))})]}):a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-body-strong text-neutral-900 mb-2",children:"Drag and drop files here, or click to browse"}),a.jsx("p",{className:"text-caption text-neutral-600",children:"Supported formats: PDF, Excel, Word, Images (Max 50MB per file)"})]})]}),a.jsxs("div",{className:"space-y-4 mb-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Category"}),a.jsx("select",{className:"fluent-input",value:g,onChange:W=>y(W.target.value),children:F.filter(W=>W!=="All").map(W=>a.jsx("option",{value:W,children:W},W))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Link to Workpaper (Optional)"}),a.jsx("input",{type:"text",className:"fluent-input",placeholder:"e.g., A-1, B-2",value:j,onChange:W=>A(W.target.value)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Tags (Optional)"}),a.jsx("input",{type:"text",className:"fluent-input",placeholder:"Separate tags with commas",value:k,onChange:W=>v(W.target.value)})]}),a.jsxs("div",{className:"flex items-center gap-2 p-4 bg-purple-50 border border-purple-200 rounded-fluent",children:[a.jsx(Rt,{className:"w-5 h-5 text-purple-600 flex-shrink-0"}),a.jsxs("div",{className:"text-caption text-purple-800",children:[a.jsx("strong",{children:"AI Processing:"})," Documents will be automatically processed with OCR and data extraction for faster audit procedures."]})]})]}),a.jsxs("div",{className:"flex gap-3 pt-6 border-t border-neutral-200",children:[a.jsx("button",{onClick:()=>{x(!1),b([])},className:"fluent-btn-secondary flex-1",disabled:l,children:"Cancel"}),a.jsx("button",{onClick:se,className:"fluent-btn-primary flex-1",disabled:l||w.length===0,children:l?a.jsxs(a.Fragment,{children:[a.jsx(Aa,{className:"w-4 h-4 animate-spin"}),"Uploading..."]}):"Upload"})]})]})})})]})},LP=()=>{const{id:e}=Hs(),t=ze(),[r,s]=C.useState(null),n=[{id:"1",title:"Independent Auditor's Report",type:"Audit Opinion",status:"review",lastModified:"2024-11-22",generatedBy:"Sarah Johnson",aiAssisted:!0},{id:"2",title:"Management Letter",type:"Management Communication",status:"draft",lastModified:"2024-11-21",generatedBy:"AI Assistant",aiAssisted:!0},{id:"3",title:"Financial Statements with Notes",type:"Financial Statements",status:"draft",lastModified:"2024-11-20",generatedBy:"John Smith",aiAssisted:!1},{id:"4",title:"Internal Control Recommendations",type:"Management Communication",status:"draft",lastModified:"2024-11-19",generatedBy:"AI Assistant",aiAssisted:!0},{id:"5",title:"Audit Summary Memorandum",type:"Internal Documentation",status:"finalized",lastModified:"2024-11-18",generatedBy:"Sarah Johnson",aiAssisted:!1}],i=[{category:"Audit Opinions",templates:["Unmodified Opinion - Standard","Modified Opinion - Qualified","Modified Opinion - Adverse","Modified Opinion - Disclaimer"]},{category:"Management Communications",templates:["Management Letter","Management Representation Letter","Internal Control Recommendations","Required Communications Letter"]},{category:"Financial Statements",templates:["Balance Sheet","Income Statement","Cash Flow Statement","Statement of Changes in Equity","Notes to Financial Statements"]},{category:"Internal Documentation",templates:["Audit Summary Memorandum","Engagement Completion Checklist","Independence Confirmation","Workpaper Binder Index"]}],l=[{title:"Enhance Management Letter",description:"AI has identified 3 additional recommendations based on audit findings",action:"Review Suggestions"},{title:"Update Risk Disclosures",description:"New industry risks identified that may require disclosure in notes",action:"View Risks"},{title:"Improve Clarity",description:"AI suggests simplified language for 2 complex note disclosures",action:"Apply Changes"}],o=u=>{const d={draft:{label:"Draft",color:"gray",icon:Os},review:{label:"In Review",color:"yellow",icon:cr},finalized:{label:"Finalized",color:"green",icon:Re}};return d[u]||d.draft},c=u=>{de.success(`Generating ${u} with AI assistance...`)};return a.jsxs("div",{className:"space-y-6 max-w-[1800px]",children:[a.jsxs(z.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center gap-4",children:[a.jsx("button",{onClick:()=>t(`/firm/engagements/${e}/workspace`),className:"p-2 hover:bg-neutral-100 rounded-fluent-sm transition-colors",children:a.jsx(Qr,{className:"w-5 h-5 text-neutral-700"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h1",{className:"text-display text-neutral-900 mb-1",children:"Audit Reports & Deliverables"}),a.jsx("p",{className:"text-body text-neutral-600",children:"Generate audit reports, management letters, and client deliverables"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"fluent-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("p",{className:"text-caption text-neutral-600",children:"Total Reports"}),a.jsx($e,{className:"w-4 h-4 text-primary-600"})]}),a.jsx("p",{className:"text-title-large text-primary-600 font-semibold",children:n.length})]}),a.jsxs("div",{className:"fluent-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("p",{className:"text-caption text-neutral-600",children:"Draft"}),a.jsx(Os,{className:"w-4 h-4 text-neutral-600"})]}),a.jsx("p",{className:"text-title-large text-neutral-600 font-semibold",children:n.filter(u=>u.status==="draft").length})]}),a.jsxs("div",{className:"fluent-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("p",{className:"text-caption text-neutral-600",children:"In Review"}),a.jsx(cr,{className:"w-4 h-4 text-warning-600"})]}),a.jsx("p",{className:"text-title-large text-warning-600 font-semibold",children:n.filter(u=>u.status==="review").length})]}),a.jsxs("div",{className:"fluent-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("p",{className:"text-caption text-neutral-600",children:"Finalized"}),a.jsx(Re,{className:"w-4 h-4 text-success-600"})]}),a.jsx("p",{className:"text-title-large text-success-600 font-semibold",children:n.filter(u=>u.status==="finalized").length})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-title text-neutral-900 mb-4",children:"Generated Reports"}),a.jsx("div",{className:"space-y-3",children:n.map((u,d)=>{const f=o(u.status),h=f.icon;return a.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:d*.05},className:"fluent-card p-5 hover:shadow-md transition-shadow",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("h3",{className:"text-body-strong text-neutral-900",children:u.title}),u.aiAssisted&&a.jsxs("div",{className:"flex items-center gap-1 px-2 py-0.5 bg-purple-50 border border-purple-200 rounded-fluent",children:[a.jsx(vc,{className:"w-3 h-3 text-purple-600"}),a.jsx("span",{className:"text-caption font-medium text-purple-700",children:"AI Assisted"})]})]}),a.jsxs("div",{className:"flex items-center gap-4 text-caption text-neutral-600",children:[a.jsx("span",{children:u.type}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(nt,{className:"w-3.5 h-3.5"}),a.jsx("span",{children:new Date(u.lastModified).toLocaleDateString()})]}),u.generatedBy&&a.jsxs("span",{children:["By ",u.generatedBy]})]})]}),a.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-fluent-sm text-caption font-medium bg-${f.color}-50 text-${f.color}-700`,children:[a.jsx(h,{className:"w-3.5 h-3.5"}),f.label]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{className:"fluent-btn-secondary text-sm",children:[a.jsx(cr,{className:"w-3.5 h-3.5"}),"View"]}),a.jsxs("button",{className:"fluent-btn-secondary text-sm",children:[a.jsx(Os,{className:"w-3.5 h-3.5"}),"Edit"]}),a.jsxs("button",{className:"fluent-btn-secondary text-sm",children:[a.jsx(xs,{className:"w-3.5 h-3.5"}),"Download"]}),u.status==="finalized"&&a.jsxs("button",{className:"fluent-btn-primary text-sm",children:[a.jsx(Vc,{className:"w-3.5 h-3.5"}),"Send to Client"]})]})]},u.id)})})]}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-title text-neutral-900 mb-4",children:"Report Templates"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.map((u,d)=>a.jsxs(z.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:d*.05},className:"fluent-card p-5",children:[a.jsx("h3",{className:"text-body-strong text-neutral-900 mb-3",children:u.category}),a.jsx("div",{className:"space-y-2",children:u.templates.map((f,h)=>a.jsx("button",{onClick:()=>c(f),className:"w-full text-left px-3 py-2 border border-neutral-200 rounded-fluent hover:border-primary-300 hover:bg-primary-50 transition-all text-caption text-neutral-700 hover:text-primary-700",children:f},h))})]},d))})]})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"fluent-card p-5",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(Rt,{className:"w-5 h-5 text-primary-600"}),a.jsx("h3",{className:"text-body-strong text-neutral-900",children:"AI Suggestions"})]}),a.jsx("div",{className:"space-y-3",children:l.map((u,d)=>a.jsxs("div",{className:"p-3 bg-purple-50 border border-purple-200 rounded-fluent",children:[a.jsx("h4",{className:"text-caption font-semibold text-purple-900 mb-1",children:u.title}),a.jsx("p",{className:"text-caption text-purple-800 mb-3",children:u.description}),a.jsxs("button",{className:"text-caption font-medium text-purple-600 hover:text-purple-700",children:[u.action," "]})]},d))})]}),a.jsxs("div",{className:"fluent-card p-5",children:[a.jsx("h3",{className:"text-body-strong text-neutral-900 mb-4",children:"Quick Actions"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("button",{className:"w-full fluent-btn-secondary text-left justify-start",children:[a.jsx(Rt,{className:"w-4 h-4"}),"Generate AI Report"]}),a.jsxs("button",{className:"w-full fluent-btn-secondary text-left justify-start",children:[a.jsx(xs,{className:"w-4 h-4"}),"Download All Reports"]}),a.jsxs("button",{className:"w-full fluent-btn-secondary text-left justify-start",children:[a.jsx(Ua,{className:"w-4 h-4"}),"Email to Client"]}),a.jsxs("button",{className:"w-full fluent-btn-secondary text-left justify-start",children:[a.jsx(aF,{className:"w-4 h-4"}),"Print Package"]}),a.jsxs("button",{className:"w-full fluent-btn-secondary text-left justify-start",children:[a.jsx(iF,{className:"w-4 h-4"}),"Share Securely"]})]})]}),a.jsxs("div",{className:"fluent-card p-5",children:[a.jsx("h3",{className:"text-body-strong text-neutral-900 mb-4",children:"Delivery Checklist"}),a.jsx("div",{className:"space-y-2",children:[{item:"Audit Opinion Signed",done:!0},{item:"Financial Statements Reviewed",done:!0},{item:"Management Letter Approved",done:!1},{item:"Required Communications Sent",done:!1},{item:"Client Acceptance Obtained",done:!1}].map((u,d)=>a.jsxs("div",{className:"flex items-center gap-2",children:[u.done?a.jsx(Re,{className:"w-4 h-4 text-success-600"}):a.jsx("div",{className:"w-4 h-4 border-2 border-neutral-300 rounded-full"}),a.jsx("span",{className:`text-caption ${u.done?"text-success-700 font-medium":"text-neutral-700"}`,children:u.item})]},d))})]})]})]})]})},BP="https://portal.auraai.toroniandcompany.com/api";class UP{constructor(){Wt(this,"api");this.api=ye.create({baseURL:`${BP}/soc-copilot`,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(t=>{const r=localStorage.getItem("access_token");return r&&(t.headers.Authorization=`Bearer ${r}`),t}),this.api.interceptors.response.use(t=>t,t=>{var r;return((r=t.response)==null?void 0:r.status)===401&&(localStorage.removeItem("access_token"),window.location.href="/login"),Promise.reject(t)})}async listEngagements(t,r){const s={};return t&&(s.status_filter=t),r&&(s.engagement_type=r),(await this.api.get("/engagements",{params:s})).data}async getEngagement(t){return(await this.api.get(`/engagements/${t}`)).data}async createEngagement(t){return(await this.api.post("/engagements",t)).data}async transitionEngagementStatus(t,r){return(await this.api.post(`/engagements/${t}/transition`,null,{params:{new_status:r}})).data}async createControlObjective(t,r){return(await this.api.post(`/engagements/${t}/objectives`,r)).data}async createControl(t,r){return(await this.api.post(`/engagements/${t}/controls`,r)).data}async createTestPlan(t,r){return(await this.api.post(`/engagements/${t}/test-plans`,r)).data}async createTestResult(t,r){return(await this.api.post(`/engagements/${t}/test-results`,r)).data}async createReport(t,r){return(await this.api.post(`/engagements/${t}/reports`,r)).data}async getAuditTrail(t,r=100,s=0){return(await this.api.get(`/engagements/${t}/audit-trail`,{params:{limit:r,offset:s}})).data}}const Jy=new UP,$P=()=>{const e=ze(),[t,r]=C.useState([]),[s,n]=C.useState([]),[i,l]=C.useState(!0),[o,c]=C.useState(""),[u,d]=C.useState("all"),[f,h]=C.useState("all"),[x,m]=C.useState(!1),[p,w]=C.useState(null),[b,g]=C.useState({client_name:"",service_description:"",engagement_type:"SOC2",report_type:"TYPE2",tsc_categories:["SECURITY"],review_period_start:"",review_period_end:"",point_in_time_date:"",partner_id:"",manager_id:""}),y=[{id:"SECURITY",label:"Security",icon:We,description:"Common criteria - required"},{id:"AVAILABILITY",label:"Availability",icon:nF,description:"System uptime & recovery"},{id:"PROCESSING_INTEGRITY",label:"Processing Integrity",icon:O6,description:"Accurate & complete processing"},{id:"CONFIDENTIALITY",label:"Confidentiality",icon:$s,description:"Data protection"},{id:"PRIVACY",label:"Privacy",icon:by,description:"Personal information handling"}];C.useEffect(()=>{j(),A()},[]);const j=async()=>{try{l(!0);const N=await Jy.listEngagements();r(N)}catch(N){console.error("Failed to load SOC engagements:",N),r([])}finally{l(!1)}},A=async()=>{try{const N=await si.listClients();n(N)}catch(N){console.error("Failed to load clients:",N)}},k=async()=>{var N,D;if(!b.client_name||!b.service_description){de.error("Please fill in all required fields");return}if(b.report_type==="TYPE2"&&(!b.review_period_start||!b.review_period_end)){de.error("Type 2 reports require a review period");return}if(b.report_type==="TYPE1"&&!b.point_in_time_date){de.error("Type 1 reports require a point-in-time date");return}try{await Jy.createEngagement(b),de.success("SOC engagement created successfully!"),m(!1),g({client_name:"",service_description:"",engagement_type:"SOC2",report_type:"TYPE2",tsc_categories:["SECURITY"],review_period_start:"",review_period_end:"",point_in_time_date:"",partner_id:"",manager_id:""}),j()}catch(F){console.error("Failed to create SOC engagement:",F),de.error(((D=(N=F.response)==null?void 0:N.data)==null?void 0:D.detail)||"Failed to create SOC engagement")}},v=t.filter(N=>{const D=N.client_name.toLowerCase().includes(o.toLowerCase())||N.service_description.toLowerCase().includes(o.toLowerCase()),F=u==="all"||N.status===u,Y=f==="all"||N.engagement_type===f;return D&&F&&Y}),E=N=>{const D={DRAFT:{label:"Draft",color:"gray",icon:Os},PLANNING:{label:"Planning",color:"blue",icon:Jr},FIELDWORK:{label:"Fieldwork",color:"yellow",icon:nt},REVIEW:{label:"Review",color:"purple",icon:cr},PARTNER_REVIEW:{label:"Partner Review",color:"indigo",icon:by},SIGNED:{label:"Signed",color:"green",icon:Re},RELEASED:{label:"Released",color:"emerald",icon:lF},ARCHIVED:{label:"Archived",color:"neutral",icon:$e}};return D[N]||D.DRAFT},S=N=>{if(N==="SECURITY")return;const D=b.tsc_categories||[];D.includes(N)?g({...b,tsc_categories:D.filter(F=>F!==N)}):g({...b,tsc_categories:[...D,N]})};return i?a.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:a.jsxs("div",{className:"flex flex-col items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 border-4 border-primary-500 border-t-transparent rounded-full animate-spin"}),a.jsx("p",{className:"text-body text-neutral-600",children:"Loading SOC engagements..."})]})}):a.jsxs("div",{className:"space-y-6 max-w-[1600px]",children:[a.jsxs(z.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[a.jsx(We,{className:"w-8 h-8 text-primary-500"}),a.jsx("h1",{className:"text-display text-neutral-900",children:"SOC Engagements"})]}),a.jsx("p",{className:"text-body text-neutral-600",children:"Manage SOC 1 and SOC 2 audit engagements with AI-powered control testing"})]}),a.jsxs(z.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>m(!0),className:"fluent-btn-primary",children:[a.jsx($t,{className:"w-4 h-4"}),"New SOC Engagement"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[{label:"Total SOC Engagements",value:t.length,color:"primary"},{label:"SOC 1 Reports",value:t.filter(N=>N.engagement_type==="SOC1").length,color:"blue"},{label:"SOC 2 Reports",value:t.filter(N=>N.engagement_type==="SOC2").length,color:"accent"},{label:"Released",value:t.filter(N=>N.status==="RELEASED").length,color:"success"}].map((N,D)=>a.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:D*.05},className:"fluent-card p-4",children:[a.jsx("p",{className:"text-caption text-neutral-600 mb-1",children:N.label}),a.jsx("p",{className:`text-title-large text-${N.color}-600 font-semibold`,children:N.value})]},N.label))}),a.jsx("div",{className:"fluent-card p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(Vs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-neutral-400"}),a.jsx("input",{type:"text",value:o,onChange:N=>c(N.target.value),placeholder:"Search SOC engagements...",className:"fluent-input pl-10"})]}),a.jsxs("select",{value:u,onChange:N=>d(N.target.value),className:"fluent-input w-full sm:w-48",children:[a.jsx("option",{value:"all",children:"All Statuses"}),a.jsx("option",{value:"DRAFT",children:"Draft"}),a.jsx("option",{value:"PLANNING",children:"Planning"}),a.jsx("option",{value:"FIELDWORK",children:"Fieldwork"}),a.jsx("option",{value:"REVIEW",children:"Review"}),a.jsx("option",{value:"PARTNER_REVIEW",children:"Partner Review"}),a.jsx("option",{value:"SIGNED",children:"Signed"}),a.jsx("option",{value:"RELEASED",children:"Released"})]}),a.jsxs("select",{value:f,onChange:N=>h(N.target.value),className:"fluent-input w-full sm:w-48",children:[a.jsx("option",{value:"all",children:"All Types"}),a.jsx("option",{value:"SOC1",children:"SOC 1"}),a.jsx("option",{value:"SOC2",children:"SOC 2"})]})]})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:v.map((N,D)=>{const F=E(N.status),Y=F.icon;return a.jsxs(z.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:D*.03},className:"fluent-card-interactive p-5 relative",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-bold ${N.engagement_type==="SOC1"?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700"}`,children:N.engagement_type}),a.jsxs("span",{className:"text-caption text-neutral-500",children:["Type ",N.report_type==="TYPE1"?"I":"II"]})]}),a.jsx("h3",{className:"text-body-strong text-neutral-900 truncate",children:N.client_name}),a.jsx("p",{className:"text-caption text-neutral-600 truncate",children:N.service_description})]}),a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>w(p===N.id?null:N.id),className:"p-1.5 hover:bg-neutral-100 rounded-fluent-sm transition-colors",children:a.jsx(H0,{className:"w-4 h-4 text-neutral-600"})}),a.jsx(Xe,{children:p===N.id&&a.jsxs(z.div,{initial:{opacity:0,scale:.95,y:-5},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95},className:"absolute right-0 top-full mt-1 bg-white rounded-fluent shadow-fluent-8 py-1 z-10 min-w-[180px]",children:[a.jsxs("button",{onClick:()=>e(`/firm/soc-engagements/${N.id}/workspace`),className:"w-full flex items-center gap-2 px-3 py-2 text-body text-neutral-700 hover:bg-neutral-50",children:[a.jsx(cr,{className:"w-4 h-4"}),"Open Workspace"]}),a.jsxs("button",{className:"w-full flex items-center gap-2 px-3 py-2 text-body text-neutral-700 hover:bg-neutral-50",children:[a.jsx(Os,{className:"w-4 h-4"}),"Edit"]}),a.jsxs("button",{className:"w-full flex items-center gap-2 px-3 py-2 text-body text-error-600 hover:bg-error-50",children:[a.jsx(Ii,{className:"w-4 h-4"}),"Delete"]})]})})]})]}),a.jsx("div",{className:"flex items-center gap-2 mb-3",children:a.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-fluent-sm text-caption font-medium bg-${F.color}-50 text-${F.color}-700`,children:[a.jsx(Y,{className:"w-3.5 h-3.5"}),F.label]})}),N.engagement_type==="SOC2"&&N.tsc_categories&&a.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:N.tsc_categories.map(Q=>a.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs bg-neutral-100 text-neutral-600",children:Q.charAt(0)+Q.slice(1).toLowerCase().replace("_"," ")},Q))}),a.jsxs("div",{className:"space-y-2 text-caption text-neutral-600",children:[N.review_period_start&&N.review_period_end&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Jr,{className:"w-3.5 h-3.5"}),a.jsxs("span",{children:[new Date(N.review_period_start).toLocaleDateString()," -"," ",new Date(N.review_period_end).toLocaleDateString()]})]}),N.point_in_time_date&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(nt,{className:"w-3.5 h-3.5"}),a.jsxs("span",{children:["As of: ",new Date(N.point_in_time_date).toLocaleDateString()]})]})]})]},N.id)})}),v.length===0&&a.jsxs("div",{className:"fluent-card text-center py-16",children:[a.jsx(We,{className:"w-16 h-16 text-neutral-300 mx-auto mb-4"}),a.jsx("h3",{className:"text-title text-neutral-900 mb-2",children:"No SOC engagements found"}),a.jsx("p",{className:"text-body text-neutral-600 mb-6",children:"Get started by creating your first SOC 1 or SOC 2 engagement"}),a.jsxs("button",{onClick:()=>m(!0),className:"fluent-btn-primary",children:[a.jsx($t,{className:"w-4 h-4"}),"Create SOC Engagement"]})]}),a.jsx(Xe,{children:x&&a.jsx(z.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:()=>m(!1),children:a.jsxs(z.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:N=>N.stopPropagation(),className:"bg-white rounded-fluent-lg p-6 max-w-2xl w-full shadow-fluent-16 max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(We,{className:"w-6 h-6 text-primary-500"}),a.jsx("h2",{className:"text-title-large text-neutral-900",children:"Create SOC Engagement"})]}),a.jsx("button",{onClick:()=>m(!1),className:"p-2 hover:bg-neutral-100 rounded-fluent-sm",children:a.jsx(ur,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"space-y-5",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Engagement Type *"}),a.jsx("div",{className:"grid grid-cols-2 gap-3",children:["SOC1","SOC2"].map(N=>a.jsxs("button",{onClick:()=>g({...b,engagement_type:N}),className:`p-4 rounded-fluent border-2 transition-all ${b.engagement_type===N?"border-primary-500 bg-primary-50":"border-neutral-200 hover:border-neutral-300"}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(We,{className:`w-5 h-5 ${b.engagement_type===N?"text-primary-500":"text-neutral-500"}`}),a.jsx("span",{className:"font-semibold",children:N})]}),a.jsx("p",{className:"text-caption text-neutral-600 text-left",children:N==="SOC1"?"Controls relevant to user entities financial reporting (ICFR)":"Trust Services Criteria - Security, Availability, etc."})]},N))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Report Type *"}),a.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{id:"TYPE1",label:"Type I",desc:"Design & implementation at a point in time"},{id:"TYPE2",label:"Type II",desc:"Design, implementation & operating effectiveness"}].map(N=>a.jsxs("button",{onClick:()=>g({...b,report_type:N.id}),className:`p-4 rounded-fluent border-2 transition-all text-left ${b.report_type===N.id?"border-primary-500 bg-primary-50":"border-neutral-200 hover:border-neutral-300"}`,children:[a.jsx("span",{className:"font-semibold",children:N.label}),a.jsx("p",{className:"text-caption text-neutral-600",children:N.desc})]},N.id))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Service Organization *"}),s.length>0?a.jsxs("select",{value:b.client_name,onChange:N=>g({...b,client_name:N.target.value}),className:"fluent-input",children:[a.jsx("option",{value:"",children:"Select a client"}),s.map(N=>a.jsx("option",{value:N.name,children:N.name},N.id))]}):a.jsx("input",{type:"text",value:b.client_name,onChange:N=>g({...b,client_name:N.target.value}),className:"fluent-input",placeholder:"Enter service organization name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Service Description *"}),a.jsx("textarea",{value:b.service_description,onChange:N=>g({...b,service_description:N.target.value}),className:"fluent-input min-h-[80px]",placeholder:"Describe the services provided by the service organization..."})]}),b.engagement_type==="SOC2"&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Trust Services Categories *"}),a.jsx("div",{className:"space-y-2",children:y.map(N=>{var Q;const D=N.icon,F=(Q=b.tsc_categories)==null?void 0:Q.includes(N.id),Y=N.id==="SECURITY";return a.jsxs("button",{onClick:()=>S(N.id),disabled:Y,className:`w-full flex items-center gap-3 p-3 rounded-fluent border transition-all text-left ${F?"border-primary-500 bg-primary-50":"border-neutral-200 hover:border-neutral-300"} ${Y?"opacity-90":""}`,children:[a.jsx(D,{className:`w-5 h-5 ${F?"text-primary-500":"text-neutral-500"}`}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium",children:N.label}),Y&&a.jsx("span",{className:"text-xs bg-primary-100 text-primary-700 px-1.5 py-0.5 rounded",children:"Required"})]}),a.jsx("p",{className:"text-caption text-neutral-600",children:N.description})]}),a.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center ${F?"border-primary-500 bg-primary-500":"border-neutral-300"}`,children:F&&a.jsx(Re,{className:"w-3 h-3 text-white"})})]},N.id)})})]}),b.report_type==="TYPE2"?a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Review Period Start *"}),a.jsx("input",{type:"date",value:b.review_period_start,onChange:N=>g({...b,review_period_start:N.target.value}),className:"fluent-input"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Review Period End *"}),a.jsx("input",{type:"date",value:b.review_period_end,onChange:N=>g({...b,review_period_end:N.target.value}),className:"fluent-input"})]})]}):a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Point-in-Time Date *"}),a.jsx("input",{type:"date",value:b.point_in_time_date,onChange:N=>g({...b,point_in_time_date:N.target.value}),className:"fluent-input"})]})]}),a.jsxs("div",{className:"flex gap-3 mt-6 pt-6 border-t border-neutral-200",children:[a.jsx("button",{onClick:()=>m(!1),className:"fluent-btn-secondary flex-1",children:"Cancel"}),a.jsxs("button",{onClick:k,className:"fluent-btn-primary flex-1",children:[a.jsx(We,{className:"w-4 h-4"}),"Create SOC Engagement"]})]})]})})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var HN=1252,VP=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],xx={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},gx=function(e){VP.indexOf(e)!=-1&&(HN=xx[0]=e)};function zP(){gx(1252)}var Rs=function(e){gx(e)};function WN(){Rs(1200),zP()}function Zy(e){for(var t=[],r=0,s=e.length;r<s;++r)t[r]=e.charCodeAt(r);return t}function HP(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function GN(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var vo=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?HP(e.slice(2)):t==254&&r==255?GN(e.slice(2)):t==65279?e.slice(1):e},Uu=function(t){return String.fromCharCode(t)},ev=function(t){return String.fromCharCode(t)},wc,mn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function tv(e){for(var t="",r=0,s=0,n=0,i=0,l=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),i=r>>2,s=e.charCodeAt(u++),l=(r&3)<<4|s>>4,n=e.charCodeAt(u++),o=(s&15)<<2|n>>6,c=n&63,isNaN(s)?o=c=64:isNaN(n)&&(c=64),t+=mn.charAt(i)+mn.charAt(l)+mn.charAt(o)+mn.charAt(c);return t}function Zr(e){var t="",r=0,s=0,n=0,i=0,l=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=mn.indexOf(e.charAt(u++)),l=mn.indexOf(e.charAt(u++)),r=i<<2|l>>4,t+=String.fromCharCode(r),o=mn.indexOf(e.charAt(u++)),s=(l&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(s)),c=mn.indexOf(e.charAt(u++)),n=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(n));return t}var Oe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Oi=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function An(e){return Oe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function rv(e){return Oe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Fs=function(t){return Oe?Oi(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Mi(e){if(Array.isArray(e))return e.map(function(s){return String.fromCharCode(s)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function yx(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return yx(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var rn=Oe?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Oi(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var s=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)s.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";s.set(new Uint8Array(e[t]),r)}return s}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function WP(e){for(var t=[],r=0,s=e.length+250,n=An(e.length+255),i=0;i<e.length;++i){var l=e.charCodeAt(i);if(l<128)n[r++]=l;else if(l<2048)n[r++]=192|l>>6&31,n[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var o=e.charCodeAt(++i)&1023;n[r++]=240|l>>8&7,n[r++]=128|l>>2&63,n[r++]=128|o>>6&15|(l&3)<<4,n[r++]=128|o&63}else n[r++]=224|l>>12&15,n[r++]=128|l>>6&63,n[r++]=128|l&63;r>s&&(t.push(n.slice(0,r)),r=0,n=An(65535),s=65530)}return t.push(n.slice(0,r)),rn(t)}var _r=/\u0000/g,wo=/[\u0001-\u0006]/g;function gl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ps(e,t){var r=""+e;return r.length>=t?r:gt("0",t-r.length)+r}function vx(e,t){var r=""+e;return r.length>=t?r:gt(" ",t-r.length)+r}function Zd(e,t){var r=""+e;return r.length>=t?r:r+gt(" ",t-r.length)}function GP(e,t){var r=""+Math.round(e);return r.length>=t?r:gt("0",t-r.length)+r}function qP(e,t){var r=""+e;return r.length>=t?r:gt("0",t-r.length)+r}var sv=Math.pow(2,32);function Hi(e,t){if(e>sv||e<-sv)return GP(e,t);var r=Math.round(e);return qP(r,t)}function e0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var av=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Qf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function YP(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Te={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},nv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},KP={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function t0(e,t,r){for(var s=e<0?-1:1,n=e*s,i=0,l=1,o=0,c=1,u=0,d=0,f=Math.floor(n);u<t&&(f=Math.floor(n),o=f*l+i,d=f*u+c,!(n-f<5e-8));)n=1/(n-f),i=l,l=o,c=u,u=d;if(d>t&&(u>t?(d=c,o=i):(d=u,o=l)),!r)return[0,s*o,d];var h=Math.floor(s*o/d);return[h,s*o-h*d,d]}function ai(e,t,r){if(e>2958465||e<0)return null;var s=e|0,n=Math.floor(86400*(e-s)),i=0,l=[],o={D:s,T:n,u:86400*(e-s)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(s+=1462),o.u>.9999&&(o.u=0,++n==86400&&(o.T=n=0,++s,++o.D)),s===60)l=r?[1317,10,29]:[1900,2,29],i=3;else if(s===0)l=r?[1317,8,29]:[1900,1,0],i=6;else{s>60&&--s;var c=new Date(1900,0,1);c.setDate(c.getDate()+s-1),l=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),s<60&&(i=(i+6)%7),r&&(i=t8(c,l))}return o.y=l[0],o.m=l[1],o.d=l[2],o.S=n%60,n=Math.floor(n/60),o.M=n%60,n=Math.floor(n/60),o.H=n,o.q=i,o}var qN=new Date(1899,11,31,0,0,0),XP=qN.getTime(),QP=new Date(1900,2,1,0,0,0);function YN(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=QP&&(r+=24*60*60*1e3),(r-(XP+(e.getTimezoneOffset()-qN.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function wx(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function JP(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function ZP(e){var t=e<0?12:11,r=wx(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function e8(e){var t=wx(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function bc(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=ZP(e):t===10?r=e.toFixed(10).substr(0,12):r=e8(e),wx(JP(r.toUpperCase()))}function Si(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):bc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return gs(14,YN(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function t8(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function r8(e,t,r,s){var n="",i=0,l=0,o=r.y,c,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return Qf[r.m-1][1];case 5:return Qf[r.m-1][0];default:return Qf[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return av[r.q][0];default:return av[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Ps(r.S,t.length):(s>=2?l=s===3?1e3:100:l=s===1?10:1,i=Math.round(l*(r.S+r.u)),i>=60*l&&(i=0),t==="s"?i===0?"0":""+i/l:(n=Ps(i,2+s),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var d=u>0?Ps(c,u):"";return d}function pn(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,s=e.substr(0,r);r!=e.length;r+=t)s+=(s.length>0?",":"")+e.substr(r,t);return s}var KN=/%/g;function s8(e,t,r){var s=t.replace(KN,""),n=t.length-s.length;return Fa(e,s,r*Math.pow(10,2*n))+gt("%",n)}function a8(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return Fa(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function XN(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+XN(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(s+1+(n+i)%n),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(n+i)%n)+"."+d.substr(i)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var QN=/# (\?+)( ?)\/( ?)(\d+)/;function n8(e,t,r){var s=parseInt(e[4],10),n=Math.round(t*s),i=Math.floor(n/s),l=n-i*s,o=s;return r+(i===0?"":""+i)+" "+(l===0?gt(" ",e[1].length+1+e[4].length):vx(l,e[1].length)+e[2]+"/"+e[3]+Ps(o,e[4].length))}function i8(e,t,r){return r+(t===0?"":""+t)+gt(" ",e[1].length+2+e[4].length)}var JN=/^#*0*\.([0#]+)/,ZN=/\).*[0#]/,e_=/\(###\) ###\\?-####/;function vr(e){for(var t="",r,s=0;s!=e.length;++s)switch(r=e.charCodeAt(s)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function iv(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function lv(e,t){var r=e-Math.floor(e),s=Math.pow(10,t);return t<(""+Math.round(r*s)).length?0:Math.round(r*s)}function l8(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function o8(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ns(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ZN)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ns("n",s,r):"("+ns("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return a8(e,t,r);if(t.indexOf("%")!==-1)return s8(e,t,r);if(t.indexOf("E")!==-1)return XN(t,r);if(t.charCodeAt(0)===36)return"$"+ns(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,l,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Hi(c,t.length);if(t.match(/^[#?]+$/))return n=Hi(r,0),n==="0"&&(n=""),n.length>t.length?n:vr(t.substr(0,t.length-n.length))+n;if(i=t.match(QN))return n8(i,c,u);if(t.match(/^#+0+$/))return u+Hi(c,t.length-t.indexOf("0"));if(i=t.match(JN))return n=iv(r,i[1].length).replace(/^([^\.]+)$/,"$1."+vr(i[1])).replace(/\.$/,"."+vr(i[1])).replace(/\.(\d*)$/,function(m,p){return"."+p+gt("0",vr(i[1]).length-p.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+iv(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+pn(Hi(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ns(e,t,-r):pn(""+(Math.floor(r)+l8(r,i[1].length)))+"."+Ps(lv(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return ns(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=gl(ns(e,t.replace(/[\\-]/g,""),r)),l=0,gl(gl(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return l<n.length?n.charAt(l++):m==="0"?"0":""}));if(t.match(e_))return n=ns(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),o=t0(c,Math.pow(10,l)-1,!1),n=""+u,d=Fa("n",i[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+i[2]+"/"+i[3],d=Zd(o[2],l),d.length<i[4].length&&(d=vr(i[4].substr(i[4].length-d.length))+d),n+=d,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),o=t0(c,Math.pow(10,l)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?vx(o[1],l)+i[2]+"/"+i[3]+Zd(o[2],l):gt(" ",2*l+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=Hi(r,0),t.length<=n.length?n:vr(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var f=t.indexOf(".")-l,h=t.length-n.length-f;return vr(t.substr(0,f)+n+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return l=lv(r,i[1].length),r<0?"-"+ns(e,t,-r):pn(o8(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Ps(0,3-m.length):"")+m})+"."+Ps(l,i[1].length);switch(t){case"###,##0.00":return ns(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var x=pn(Hi(c,0));return x!=="0"?u+x:"";case"###,###.00":return ns(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ns(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function c8(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return Fa(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function u8(e,t,r){var s=t.replace(KN,""),n=t.length-s.length;return Fa(e,s,r*Math.pow(10,2*n))+gt("%",n)}function t_(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+t_(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(s+1+(n+i)%n),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(n+i)%n)+"."+d.substr(i)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Js(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ZN)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Js("n",s,r):"("+Js("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return c8(e,t,r);if(t.indexOf("%")!==-1)return u8(e,t,r);if(t.indexOf("E")!==-1)return t_(t,r);if(t.charCodeAt(0)===36)return"$"+Js(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,l,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Ps(c,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:vr(t.substr(0,t.length-n.length))+n;if(i=t.match(QN))return i8(i,c,u);if(t.match(/^#+0+$/))return u+Ps(c,t.length-t.indexOf("0"));if(i=t.match(JN))return n=(""+r).replace(/^([^\.]+)$/,"$1."+vr(i[1])).replace(/\.$/,"."+vr(i[1])),n=n.replace(/\.(\d*)$/,function(m,p){return"."+p+gt("0",vr(i[1]).length-p.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+pn(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Js(e,t,-r):pn(""+r)+"."+gt("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Js(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=gl(Js(e,t.replace(/[\\-]/g,""),r)),l=0,gl(gl(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return l<n.length?n.charAt(l++):m==="0"?"0":""}));if(t.match(e_))return n=Js(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),o=t0(c,Math.pow(10,l)-1,!1),n=""+u,d=Fa("n",i[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+i[2]+"/"+i[3],d=Zd(o[2],l),d.length<i[4].length&&(d=vr(i[4].substr(i[4].length-d.length))+d),n+=d,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),o=t0(c,Math.pow(10,l)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?vx(o[1],l)+i[2]+"/"+i[3]+Zd(o[2],l):gt(" ",2*l+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:vr(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var f=t.indexOf(".")-l,h=t.length-n.length-f;return vr(t.substr(0,f)+n+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Js(e,t,-r):pn(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Ps(0,3-m.length):"")+m})+"."+Ps(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var x=pn(""+c);return x!=="0"?u+x:"";default:if(t.match(/\.[0#?]*$/))return Js(e,t.slice(0,t.lastIndexOf(".")),r)+vr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Fa(e,t,r){return(r|0)===r?Js(e,t,r):ns(e,t,r)}function d8(e){for(var t=[],r=!1,s=0,n=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:r=!r;break;case 95:case 42:case 92:++s;break;case 59:t[t.length]=e.substr(n,s-n),n=s+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var r_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Yl(e){for(var t=0,r="",s="";t<e.length;)switch(r=e.charAt(t)){case"G":e0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(s=r;e.charAt(t++)!=="]"&&t<e.length;)s+=e.charAt(t);if(s.match(r_))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function f8(e,t,r,s){for(var n=[],i="",l=0,o="",c="t",u,d,f,h="H";l<e.length;)switch(o=e.charAt(l)){case"G":if(!e0(e,l))throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"G",v:"General"},l+=7;break;case'"':for(i="";(f=e.charCodeAt(++l))!==34&&l<e.length;)i+=String.fromCharCode(f);n[n.length]={t:"t",v:i},++l;break;case"\\":var x=e.charAt(++l),m=x==="("||x===")"?x:"t";n[n.length]={t:m,v:x},++l;break;case"_":n[n.length]={t:"t",v:" "},l+=2;break;case"@":n[n.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(u==null&&(u=ai(t,r,e.charAt(l+1)==="2"),u==null))return"";n[n.length]={t:"X",v:e.substr(l,2)},c=o,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=ai(t,r),u==null))return"";for(i=o;++l<e.length&&e.charAt(l).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),n[n.length]={t:o,v:i},c=o;break;case"A":case"a":case"":var p={t:o,v:o};if(u==null&&(u=ai(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(u!=null&&(p.v=u.H>=12?"P":"A"),p.t="T",h="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(u!=null&&(p.v=u.H>=12?"PM":"AM"),p.t="T",l+=5,h="h"):e.substr(l,5).toUpperCase()==="/"?(u!=null&&(p.v=u.H>=12?"":""),p.t="T",l+=5,h="h"):(p.t="t",++l),u==null&&p.t==="T")return"";n[n.length]=p,c=o;break;case"[":for(i=o;e.charAt(l++)!=="]"&&l<e.length;)i+=e.charAt(l);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(r_)){if(u==null&&(u=ai(t,r),u==null))return"";n[n.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Yl(e)||(n[n.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=o;++l<e.length&&(o=e.charAt(l))==="0";)i+=o;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++l<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(l))>-1;)i+=o;n[n.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++l)===o;)i+=o;n[n.length]={t:o,v:i},c=o;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":n[n.length]={t:s===1?"t":o,v:o},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)i+=e.charAt(l);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:o,v:o},++l;break;case"$":n[n.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);n[n.length]={t:"t",v:o},++l;break}var w=0,b=0,g;for(l=n.length-1,c="t";l>=0;--l)switch(n[l].t){case"h":case"H":n[l].t=h,c="h",w<1&&(w=1);break;case"s":(g=n[l].v.match(/\.0+$/))&&(b=Math.max(b,g[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":c=n[l].t;break;case"m":c==="s"&&(n[l].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&n[l].v.match(/[Hh]/)&&(w=1),w<2&&n[l].v.match(/[Mm]/)&&(w=2),w<3&&n[l].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var y="",j;for(l=0;l<n.length;++l)switch(n[l].t){case"t":case"T":case" ":case"D":break;case"X":n[l].v="",n[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[l].v=r8(n[l].t.charCodeAt(0),n[l].v,u,b),n[l].t="t";break;case"n":case"?":for(j=l+1;n[j]!=null&&((o=n[j].t)==="?"||o==="D"||(o===" "||o==="t")&&n[j+1]!=null&&(n[j+1].t==="?"||n[j+1].t==="t"&&n[j+1].v==="/")||n[l].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(n[j].v==="/"||n[j].v===" "&&n[j+1]!=null&&n[j+1].t=="?"));)n[l].v+=n[j].v,n[j]={v:"",t:";"},++j;y+=n[l].v,l=j-1;break;case"G":n[l].t="t",n[l].v=Si(t,r);break}var A="",k,v;if(y.length>0){y.charCodeAt(0)==40?(k=t<0&&y.charCodeAt(0)===45?-t:t,v=Fa("n",y,k)):(k=t<0&&s>1?-t:t,v=Fa("n",y,k),k<0&&n[0]&&n[0].t=="t"&&(v=v.substr(1),n[0].v="-"+n[0].v)),j=v.length-1;var E=n.length;for(l=0;l<n.length;++l)if(n[l]!=null&&n[l].t!="t"&&n[l].v.indexOf(".")>-1){E=l;break}var S=n.length;if(E===n.length&&v.indexOf("E")===-1){for(l=n.length-1;l>=0;--l)n[l]==null||"n?".indexOf(n[l].t)===-1||(j>=n[l].v.length-1?(j-=n[l].v.length,n[l].v=v.substr(j+1,n[l].v.length)):j<0?n[l].v="":(n[l].v=v.substr(0,j+1),j=-1),n[l].t="t",S=l);j>=0&&S<n.length&&(n[S].v=v.substr(0,j+1)+n[S].v)}else if(E!==n.length&&v.indexOf("E")===-1){for(j=v.indexOf(".")-1,l=E;l>=0;--l)if(!(n[l]==null||"n?".indexOf(n[l].t)===-1)){for(d=n[l].v.indexOf(".")>-1&&l===E?n[l].v.indexOf(".")-1:n[l].v.length-1,A=n[l].v.substr(d+1);d>=0;--d)j>=0&&(n[l].v.charAt(d)==="0"||n[l].v.charAt(d)==="#")&&(A=v.charAt(j--)+A);n[l].v=A,n[l].t="t",S=l}for(j>=0&&S<n.length&&(n[S].v=v.substr(0,j+1)+n[S].v),j=v.indexOf(".")+1,l=E;l<n.length;++l)if(!(n[l]==null||"n?(".indexOf(n[l].t)===-1&&l!==E)){for(d=n[l].v.indexOf(".")>-1&&l===E?n[l].v.indexOf(".")+1:0,A=n[l].v.substr(0,d);d<n[l].v.length;++d)j<v.length&&(A+=v.charAt(j++));n[l].v=A,n[l].t="t",S=l}}}for(l=0;l<n.length;++l)n[l]!=null&&"n?".indexOf(n[l].t)>-1&&(k=s>1&&t<0&&l>0&&n[l-1].v==="-"?-t:t,n[l].v=Fa(n[l].t,n[l].v,k),n[l].t="t");var N="";for(l=0;l!==n.length;++l)n[l]!=null&&(N+=n[l].v);return N}var ov=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function cv(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function h8(e,t){var r=d8(e),s=r.length,n=r[s-1].indexOf("@");if(s<4&&n>-1&&--s,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[s,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(ov),o=r[1].match(ov);return cv(t,l)?[s,r[0]]:cv(t,o)?[s,r[1]]:[s,r[l!=null&&o!=null?2:1]]}return[s,i]}function gs(e,t,r){r==null&&(r={});var s="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?s=r.dateNF:s=e;break;case"number":e==14&&r.dateNF?s=r.dateNF:s=(r.table!=null?r.table:Te)[e],s==null&&(s=r.table&&r.table[nv[e]]||Te[nv[e]]),s==null&&(s=KP[e]||"General");break}if(e0(s,0))return Si(t,r);t instanceof Date&&(t=YN(t,r.date1904));var n=h8(s,t);if(e0(n[1]))return Si(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return f8(n[1],t,r,n[0])}function gi(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Te[r]==null){t<0&&(t=r);continue}if(Te[r]==e){t=r;break}}t<0&&(t=391)}return Te[t]=e,t}function s_(){Te=YP()}var m8={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},a_=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function p8(e){var t=typeof e=="number"?Te[e]:e;return t=t.replace(a_,"(\\d+)"),new RegExp("^"+t+"$")}function x8(e,t,r){var s=-1,n=-1,i=-1,l=-1,o=-1,c=-1;(t.match(a_)||[]).forEach(function(f,h){var x=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":s=x;break;case"d":i=x;break;case"h":l=x;break;case"s":c=x;break;case"m":l>=0?o=x:n=x;break}}),c>=0&&o==-1&&n>=0&&(o=n,n=-1);var u=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return l==-1&&o==-1&&c==-1?u:s==-1&&n==-1&&i==-1?d:u+"T"+d}var g8=function(){var e={};e.version="1.2.0";function t(){for(var v=0,E=new Array(256),S=0;S!=256;++S)v=S,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,E[S]=v;return typeof Int32Array<"u"?new Int32Array(E):E}var r=t();function s(v){var E=0,S=0,N=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(N=0;N!=256;++N)D[N]=v[N];for(N=0;N!=256;++N)for(S=v[N],E=256+N;E<4096;E+=256)S=D[E]=S>>>8^v[S&255];var F=[];for(N=1;N!=16;++N)F[N-1]=typeof Int32Array<"u"?D.subarray(N*256,N*256+256):D.slice(N*256,N*256+256);return F}var n=s(r),i=n[0],l=n[1],o=n[2],c=n[3],u=n[4],d=n[5],f=n[6],h=n[7],x=n[8],m=n[9],p=n[10],w=n[11],b=n[12],g=n[13],y=n[14];function j(v,E){for(var S=E^-1,N=0,D=v.length;N<D;)S=S>>>8^r[(S^v.charCodeAt(N++))&255];return~S}function A(v,E){for(var S=E^-1,N=v.length-15,D=0;D<N;)S=y[v[D++]^S&255]^g[v[D++]^S>>8&255]^b[v[D++]^S>>16&255]^w[v[D++]^S>>>24]^p[v[D++]]^m[v[D++]]^x[v[D++]]^h[v[D++]]^f[v[D++]]^d[v[D++]]^u[v[D++]]^c[v[D++]]^o[v[D++]]^l[v[D++]]^i[v[D++]]^r[v[D++]];for(N+=15;D<N;)S=S>>>8^r[(S^v[D++])&255];return~S}function k(v,E){for(var S=E^-1,N=0,D=v.length,F=0,Y=0;N<D;)F=v.charCodeAt(N++),F<128?S=S>>>8^r[(S^F)&255]:F<2048?(S=S>>>8^r[(S^(192|F>>6&31))&255],S=S>>>8^r[(S^(128|F&63))&255]):F>=55296&&F<57344?(F=(F&1023)+64,Y=v.charCodeAt(N++)&1023,S=S>>>8^r[(S^(240|F>>8&7))&255],S=S>>>8^r[(S^(128|F>>2&63))&255],S=S>>>8^r[(S^(128|Y>>6&15|(F&3)<<4))&255],S=S>>>8^r[(S^(128|Y&63))&255]):(S=S>>>8^r[(S^(224|F>>12&15))&255],S=S>>>8^r[(S^(128|F>>6&63))&255],S=S>>>8^r[(S^(128|F&63))&255]);return~S}return e.table=r,e.bstr=j,e.buf=A,e.str=k,e}(),Le=function(){var t={};t.version="1.2.1";function r(R,M){for(var _=R.split("/"),P=M.split("/"),I=0,O=0,G=Math.min(_.length,P.length);I<G;++I){if(O=_[I].length-P[I].length)return O;if(_[I]!=P[I])return _[I]<P[I]?-1:1}return _.length-P.length}function s(R){if(R.charAt(R.length-1)=="/")return R.slice(0,-1).indexOf("/")===-1?R:s(R.slice(0,-1));var M=R.lastIndexOf("/");return M===-1?R:R.slice(0,M+1)}function n(R){if(R.charAt(R.length-1)=="/")return n(R.slice(0,-1));var M=R.lastIndexOf("/");return M===-1?R:R.slice(M+1)}function i(R,M){typeof M=="string"&&(M=new Date(M));var _=M.getHours();_=_<<6|M.getMinutes(),_=_<<5|M.getSeconds()>>>1,R.write_shift(2,_);var P=M.getFullYear()-1980;P=P<<4|M.getMonth()+1,P=P<<5|M.getDate(),R.write_shift(2,P)}function l(R){var M=R.read_shift(2)&65535,_=R.read_shift(2)&65535,P=new Date,I=_&31;_>>>=5;var O=_&15;_>>>=4,P.setMilliseconds(0),P.setFullYear(_+1980),P.setMonth(O-1),P.setDate(I);var G=M&31;M>>>=5;var Z=M&63;return M>>>=6,P.setHours(M),P.setMinutes(Z),P.setSeconds(G<<1),P}function o(R){qt(R,0);for(var M={},_=0;R.l<=R.length-4;){var P=R.read_shift(2),I=R.read_shift(2),O=R.l+I,G={};switch(P){case 21589:_=R.read_shift(1),_&1&&(G.mtime=R.read_shift(4)),I>5&&(_&2&&(G.atime=R.read_shift(4)),_&4&&(G.ctime=R.read_shift(4))),G.mtime&&(G.mt=new Date(G.mtime*1e3));break}R.l=O,M[P]=G}return M}var c;function u(){return c||(c={})}function d(R,M){if(R[0]==80&&R[1]==75)return Ql(R,M);if((R[0]|32)==109&&(R[1]|32)==105)return iu(R,M);if(R.length<512)throw new Error("CFB file size "+R.length+" < 512");var _=3,P=512,I=0,O=0,G=0,Z=0,q=0,K=[],X=R.slice(0,512);qt(X,0);var ie=f(X);switch(_=ie[0],_){case 3:P=512;break;case 4:P=4096;break;case 0:if(ie[1]==0)return Ql(R,M);default:throw new Error("Major Version: Expected 3 or 4 saw "+_)}P!==512&&(X=R.slice(0,P),qt(X,28));var he=R.slice(0,P);h(X,_);var ge=X.read_shift(4,"i");if(_===3&&ge!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ge);X.l+=4,G=X.read_shift(4,"i"),X.l+=4,X.chk("00100000","Mini Stream Cutoff Size: "),Z=X.read_shift(4,"i"),I=X.read_shift(4,"i"),q=X.read_shift(4,"i"),O=X.read_shift(4,"i");for(var me=-1,we=0;we<109&&(me=X.read_shift(4,"i"),!(me<0));++we)K[we]=me;var Ce=x(R,P);w(q,O,Ce,P,K);var ot=g(Ce,G,K,P);ot[G].name="!Directory",I>0&&Z!==Y&&(ot[Z].name="!MiniFAT"),ot[K[0]].name="!FAT",ot.fat_addrs=K,ot.ssz=P;var ct={},Jt=[],Jl=[],Zl=[];y(G,ot,Ce,Jt,I,ct,Jl,Z),m(Jl,Zl,Jt),Jt.shift();var eo={FileIndex:Jl,FullPaths:Zl};return M&&M.raw&&(eo.raw={header:he,sectors:Ce}),eo}function f(R){if(R[R.l]==80&&R[R.l+1]==75)return[0,0];R.chk(Q,"Header Signature: "),R.l+=16;var M=R.read_shift(2,"u");return[R.read_shift(2,"u"),M]}function h(R,M){var _=9;switch(R.l+=2,_=R.read_shift(2)){case 9:if(M!=3)throw new Error("Sector Shift: Expected 9 saw "+_);break;case 12:if(M!=4)throw new Error("Sector Shift: Expected 12 saw "+_);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+_)}R.chk("0600","Mini Sector Shift: "),R.chk("000000000000","Reserved: ")}function x(R,M){for(var _=Math.ceil(R.length/M)-1,P=[],I=1;I<_;++I)P[I-1]=R.slice(I*M,(I+1)*M);return P[_-1]=R.slice(_*M),P}function m(R,M,_){for(var P=0,I=0,O=0,G=0,Z=0,q=_.length,K=[],X=[];P<q;++P)K[P]=X[P]=P,M[P]=_[P];for(;Z<X.length;++Z)P=X[Z],I=R[P].L,O=R[P].R,G=R[P].C,K[P]===P&&(I!==-1&&K[I]!==I&&(K[P]=K[I]),O!==-1&&K[O]!==O&&(K[P]=K[O])),G!==-1&&(K[G]=P),I!==-1&&P!=K[P]&&(K[I]=K[P],X.lastIndexOf(I)<Z&&X.push(I)),O!==-1&&P!=K[P]&&(K[O]=K[P],X.lastIndexOf(O)<Z&&X.push(O));for(P=1;P<q;++P)K[P]===P&&(O!==-1&&K[O]!==O?K[P]=K[O]:I!==-1&&K[I]!==I&&(K[P]=K[I]));for(P=1;P<q;++P)if(R[P].type!==0){if(Z=P,Z!=K[Z])do Z=K[Z],M[P]=M[Z]+"/"+M[P];while(Z!==0&&K[Z]!==-1&&Z!=K[Z]);K[P]=-1}for(M[0]+="/",P=1;P<q;++P)R[P].type!==2&&(M[P]+="/")}function p(R,M,_){for(var P=R.start,I=R.size,O=[],G=P;_&&I>0&&G>=0;)O.push(M.slice(G*F,G*F+F)),I-=F,G=Xn(_,G*4);return O.length===0?Et(0):rn(O).slice(0,R.size)}function w(R,M,_,P,I){var O=Y;if(R===Y){if(M!==0)throw new Error("DIFAT chain shorter than expected")}else if(R!==-1){var G=_[R],Z=(P>>>2)-1;if(!G)return;for(var q=0;q<Z&&(O=Xn(G,q*4))!==Y;++q)I.push(O);w(Xn(G,P-4),M-1,_,P,I)}}function b(R,M,_,P,I){var O=[],G=[];I||(I=[]);var Z=P-1,q=0,K=0;for(q=M;q>=0;){I[q]=!0,O[O.length]=q,G.push(R[q]);var X=_[Math.floor(q*4/P)];if(K=q*4&Z,P<4+K)throw new Error("FAT boundary crossed: "+q+" 4 "+P);if(!R[X])break;q=Xn(R[X],K)}return{nodes:O,data:vv([G])}}function g(R,M,_,P){var I=R.length,O=[],G=[],Z=[],q=[],K=P-1,X=0,ie=0,he=0,ge=0;for(X=0;X<I;++X)if(Z=[],he=X+M,he>=I&&(he-=I),!G[he]){q=[];var me=[];for(ie=he;ie>=0;){me[ie]=!0,G[ie]=!0,Z[Z.length]=ie,q.push(R[ie]);var we=_[Math.floor(ie*4/P)];if(ge=ie*4&K,P<4+ge)throw new Error("FAT boundary crossed: "+ie+" 4 "+P);if(!R[we]||(ie=Xn(R[we],ge),me[ie]))break}O[he]={nodes:Z,data:vv([q])}}return O}function y(R,M,_,P,I,O,G,Z){for(var q=0,K=P.length?2:0,X=M[R].data,ie=0,he=0,ge;ie<X.length;ie+=128){var me=X.slice(ie,ie+128);qt(me,64),he=me.read_shift(2),ge=kx(me,0,he-K),P.push(ge);var we={name:ge,type:me.read_shift(1),color:me.read_shift(1),L:me.read_shift(4,"i"),R:me.read_shift(4,"i"),C:me.read_shift(4,"i"),clsid:me.read_shift(16),state:me.read_shift(4,"i"),start:0,size:0},Ce=me.read_shift(2)+me.read_shift(2)+me.read_shift(2)+me.read_shift(2);Ce!==0&&(we.ct=j(me,me.l-8));var ot=me.read_shift(2)+me.read_shift(2)+me.read_shift(2)+me.read_shift(2);ot!==0&&(we.mt=j(me,me.l-8)),we.start=me.read_shift(4,"i"),we.size=me.read_shift(4,"i"),we.size<0&&we.start<0&&(we.size=we.type=0,we.start=Y,we.name=""),we.type===5?(q=we.start,I>0&&q!==Y&&(M[q].name="!StreamData")):we.size>=4096?(we.storage="fat",M[we.start]===void 0&&(M[we.start]=b(_,we.start,M.fat_addrs,M.ssz)),M[we.start].name=we.name,we.content=M[we.start].data.slice(0,we.size)):(we.storage="minifat",we.size<0?we.size=0:q!==Y&&we.start!==Y&&M[q]&&(we.content=p(we,M[q].data,(M[Z]||{}).data))),we.content&&qt(we.content,0),O[ge]=we,G.push(we)}}function j(R,M){return new Date((Wr(R,M+4)/1e7*Math.pow(2,32)+Wr(R,M)/1e7-11644473600)*1e3)}function A(R,M){return u(),d(c.readFileSync(R),M)}function k(R,M){var _=M&&M.type;switch(_||Oe&&Buffer.isBuffer(R)&&(_="buffer"),_||"base64"){case"file":return A(R,M);case"base64":return d(Fs(Zr(R)),M);case"binary":return d(Fs(R),M)}return d(R,M)}function v(R,M){var _=M||{},P=_.root||"Root Entry";if(R.FullPaths||(R.FullPaths=[]),R.FileIndex||(R.FileIndex=[]),R.FullPaths.length!==R.FileIndex.length)throw new Error("inconsistent CFB structure");R.FullPaths.length===0&&(R.FullPaths[0]=P+"/",R.FileIndex[0]={name:P,type:5}),_.CLSID&&(R.FileIndex[0].clsid=_.CLSID),E(R)}function E(R){var M="Sh33tJ5";if(!Le.find(R,"/"+M)){var _=Et(4);_[0]=55,_[1]=_[3]=50,_[2]=54,R.FileIndex.push({name:M,type:2,content:_,size:4,L:69,R:69,C:69}),R.FullPaths.push(R.FullPaths[0]+M),S(R)}}function S(R,M){v(R);for(var _=!1,P=!1,I=R.FullPaths.length-1;I>=0;--I){var O=R.FileIndex[I];switch(O.type){case 0:P?_=!0:(R.FileIndex.pop(),R.FullPaths.pop());break;case 1:case 2:case 5:P=!0,isNaN(O.R*O.L*O.C)&&(_=!0),O.R>-1&&O.L>-1&&O.R==O.L&&(_=!0);break;default:_=!0;break}}if(!(!_&&!M)){var G=new Date(1987,1,19),Z=0,q=Object.create?Object.create(null):{},K=[];for(I=0;I<R.FullPaths.length;++I)q[R.FullPaths[I]]=!0,R.FileIndex[I].type!==0&&K.push([R.FullPaths[I],R.FileIndex[I]]);for(I=0;I<K.length;++I){var X=s(K[I][0]);P=q[X],P||(K.push([X,{name:n(X).replace("/",""),type:1,clsid:ee,ct:G,mt:G,content:null}]),q[X]=!0)}for(K.sort(function(ge,me){return r(ge[0],me[0])}),R.FullPaths=[],R.FileIndex=[],I=0;I<K.length;++I)R.FullPaths[I]=K[I][0],R.FileIndex[I]=K[I][1];for(I=0;I<K.length;++I){var ie=R.FileIndex[I],he=R.FullPaths[I];if(ie.name=n(he).replace("/",""),ie.L=ie.R=ie.C=-(ie.color=1),ie.size=ie.content?ie.content.length:0,ie.start=0,ie.clsid=ie.clsid||ee,I===0)ie.C=K.length>1?1:-1,ie.size=0,ie.type=5;else if(he.slice(-1)=="/"){for(Z=I+1;Z<K.length&&s(R.FullPaths[Z])!=he;++Z);for(ie.C=Z>=K.length?-1:Z,Z=I+1;Z<K.length&&s(R.FullPaths[Z])!=s(he);++Z);ie.R=Z>=K.length?-1:Z,ie.type=1}else s(R.FullPaths[I+1]||"")==s(he)&&(ie.R=I+1),ie.type=2}}}function N(R,M){var _=M||{};if(_.fileType=="mad")return lu(R,_);switch(S(R),_.fileType){case"zip":return eu(R,_)}var P=function(ge){for(var me=0,we=0,Ce=0;Ce<ge.FileIndex.length;++Ce){var ot=ge.FileIndex[Ce];if(ot.content){var ct=ot.content.length;ct>0&&(ct<4096?me+=ct+63>>6:we+=ct+511>>9)}}for(var Jt=ge.FullPaths.length+3>>2,Jl=me+7>>3,Zl=me+127>>7,eo=Jl+we+Jt+Zl,Vn=eo+127>>7,sf=Vn<=109?0:Math.ceil((Vn-109)/127);eo+Vn+sf+127>>7>Vn;)sf=++Vn<=109?0:Math.ceil((Vn-109)/127);var ga=[1,sf,Vn,Zl,Jt,we,me,0];return ge.FileIndex[0].size=me<<6,ga[7]=(ge.FileIndex[0].start=ga[0]+ga[1]+ga[2]+ga[3]+ga[4]+ga[5])+(ga[6]+7>>3),ga}(R),I=Et(P[7]<<9),O=0,G=0;{for(O=0;O<8;++O)I.write_shift(1,ae[O]);for(O=0;O<8;++O)I.write_shift(2,0);for(I.write_shift(2,62),I.write_shift(2,3),I.write_shift(2,65534),I.write_shift(2,9),I.write_shift(2,6),O=0;O<3;++O)I.write_shift(2,0);for(I.write_shift(4,0),I.write_shift(4,P[2]),I.write_shift(4,P[0]+P[1]+P[2]+P[3]-1),I.write_shift(4,0),I.write_shift(4,4096),I.write_shift(4,P[3]?P[0]+P[1]+P[2]-1:Y),I.write_shift(4,P[3]),I.write_shift(-4,P[1]?P[0]-1:Y),I.write_shift(4,P[1]),O=0;O<109;++O)I.write_shift(-4,O<P[2]?P[1]+O:-1)}if(P[1])for(G=0;G<P[1];++G){for(;O<236+G*127;++O)I.write_shift(-4,O<P[2]?P[1]+O:-1);I.write_shift(-4,G===P[1]-1?Y:G+1)}var Z=function(ge){for(G+=ge;O<G-1;++O)I.write_shift(-4,O+1);ge&&(++O,I.write_shift(-4,Y))};for(G=O=0,G+=P[1];O<G;++O)I.write_shift(-4,fe.DIFSECT);for(G+=P[2];O<G;++O)I.write_shift(-4,fe.FATSECT);Z(P[3]),Z(P[4]);for(var q=0,K=0,X=R.FileIndex[0];q<R.FileIndex.length;++q)X=R.FileIndex[q],X.content&&(K=X.content.length,!(K<4096)&&(X.start=G,Z(K+511>>9)));for(Z(P[6]+7>>3);I.l&511;)I.write_shift(-4,fe.ENDOFCHAIN);for(G=O=0,q=0;q<R.FileIndex.length;++q)X=R.FileIndex[q],X.content&&(K=X.content.length,!(!K||K>=4096)&&(X.start=G,Z(K+63>>6)));for(;I.l&511;)I.write_shift(-4,fe.ENDOFCHAIN);for(O=0;O<P[4]<<2;++O){var ie=R.FullPaths[O];if(!ie||ie.length===0){for(q=0;q<17;++q)I.write_shift(4,0);for(q=0;q<3;++q)I.write_shift(4,-1);for(q=0;q<12;++q)I.write_shift(4,0);continue}X=R.FileIndex[O],O===0&&(X.start=X.size?X.start-1:Y);var he=O===0&&_.root||X.name;if(K=2*(he.length+1),I.write_shift(64,he,"utf16le"),I.write_shift(2,K),I.write_shift(1,X.type),I.write_shift(1,X.color),I.write_shift(-4,X.L),I.write_shift(-4,X.R),I.write_shift(-4,X.C),X.clsid)I.write_shift(16,X.clsid,"hex");else for(q=0;q<4;++q)I.write_shift(4,0);I.write_shift(4,X.state||0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,X.start),I.write_shift(4,X.size),I.write_shift(4,0)}for(O=1;O<R.FileIndex.length;++O)if(X=R.FileIndex[O],X.size>=4096)if(I.l=X.start+1<<9,Oe&&Buffer.isBuffer(X.content))X.content.copy(I,I.l,0,X.size),I.l+=X.size+511&-512;else{for(q=0;q<X.size;++q)I.write_shift(1,X.content[q]);for(;q&511;++q)I.write_shift(1,0)}for(O=1;O<R.FileIndex.length;++O)if(X=R.FileIndex[O],X.size>0&&X.size<4096)if(Oe&&Buffer.isBuffer(X.content))X.content.copy(I,I.l,0,X.size),I.l+=X.size+63&-64;else{for(q=0;q<X.size;++q)I.write_shift(1,X.content[q]);for(;q&63;++q)I.write_shift(1,0)}if(Oe)I.l=I.length;else for(;I.l<I.length;)I.write_shift(1,0);return I}function D(R,M){var _=R.FullPaths.map(function(q){return q.toUpperCase()}),P=_.map(function(q){var K=q.split("/");return K[K.length-(q.slice(-1)=="/"?2:1)]}),I=!1;M.charCodeAt(0)===47?(I=!0,M=_[0].slice(0,-1)+M):I=M.indexOf("/")!==-1;var O=M.toUpperCase(),G=I===!0?_.indexOf(O):P.indexOf(O);if(G!==-1)return R.FileIndex[G];var Z=!O.match(wo);for(O=O.replace(_r,""),Z&&(O=O.replace(wo,"!")),G=0;G<_.length;++G)if((Z?_[G].replace(wo,"!"):_[G]).replace(_r,"")==O||(Z?P[G].replace(wo,"!"):P[G]).replace(_r,"")==O)return R.FileIndex[G];return null}var F=64,Y=-2,Q="d0cf11e0a1b11ae1",ae=[208,207,17,224,161,177,26,225],ee="00000000000000000000000000000000",fe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Y,FREESECT:-1,HEADER_SIGNATURE:Q,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function se(R,M,_){u();var P=N(R,_);c.writeFileSync(M,P)}function H(R){for(var M=new Array(R.length),_=0;_<R.length;++_)M[_]=String.fromCharCode(R[_]);return M.join("")}function ne(R,M){var _=N(R,M);switch(M&&M.type||"buffer"){case"file":return u(),c.writeFileSync(M.filename,_),_;case"binary":return typeof _=="string"?_:H(_);case"base64":return tv(typeof _=="string"?_:H(_));case"buffer":if(Oe)return Buffer.isBuffer(_)?_:Oi(_);case"array":return typeof _=="string"?Fs(_):_}return _}var W;function T(R){try{var M=R.InflateRaw,_=new M;if(_._processChunk(new Uint8Array([3,0]),_._finishFlushFlag),_.bytesRead)W=R;else throw new Error("zlib does not expose bytesRead")}catch(P){console.error("cannot use native zlib: "+(P.message||P))}}function L(R,M){if(!W)return rs(R,M);var _=W.InflateRaw,P=new _,I=P._processChunk(R.slice(R.l),P._finishFlushFlag);return R.l+=P.bytesRead,I}function B(R){return W?W.deflateRawSync(R):Ae(R)}var V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ue=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ve(R){var M=(R<<1|R<<11)&139536|(R<<5|R<<15)&558144;return(M>>16|M>>8|M)&255}for(var pe=typeof Uint8Array<"u",le=pe?new Uint8Array(256):[],ke=0;ke<256;++ke)le[ke]=ve(ke);function U(R,M){var _=le[R&255];return M<=8?_>>>8-M:(_=_<<8|le[R>>8&255],M<=16?_>>>16-M:(_=_<<8|le[R>>16&255],_>>>24-M))}function rt(R,M){var _=M&7,P=M>>>3;return(R[P]|(_<=6?0:R[P+1]<<8))>>>_&3}function Me(R,M){var _=M&7,P=M>>>3;return(R[P]|(_<=5?0:R[P+1]<<8))>>>_&7}function He(R,M){var _=M&7,P=M>>>3;return(R[P]|(_<=4?0:R[P+1]<<8))>>>_&15}function Fe(R,M){var _=M&7,P=M>>>3;return(R[P]|(_<=3?0:R[P+1]<<8))>>>_&31}function xe(R,M){var _=M&7,P=M>>>3;return(R[P]|(_<=1?0:R[P+1]<<8))>>>_&127}function it(R,M,_){var P=M&7,I=M>>>3,O=(1<<_)-1,G=R[I]>>>P;return _<8-P||(G|=R[I+1]<<8-P,_<16-P)||(G|=R[I+2]<<16-P,_<24-P)||(G|=R[I+3]<<24-P),G&O}function Tr(R,M,_){var P=M&7,I=M>>>3;return P<=5?R[I]|=(_&7)<<P:(R[I]|=_<<P&255,R[I+1]=(_&7)>>8-P),M+3}function Ur(R,M,_){var P=M&7,I=M>>>3;return _=(_&1)<<P,R[I]|=_,M+1}function vs(R,M,_){var P=M&7,I=M>>>3;return _<<=P,R[I]|=_&255,_>>>=8,R[I+1]=_,M+8}function Ln(R,M,_){var P=M&7,I=M>>>3;return _<<=P,R[I]|=_&255,_>>>=8,R[I+1]=_&255,R[I+2]=_>>>8,M+16}function Gs(R,M){var _=R.length,P=2*_>M?2*_:M+5,I=0;if(_>=M)return R;if(Oe){var O=rv(P);if(R.copy)R.copy(O);else for(;I<R.length;++I)O[I]=R[I];return O}else if(pe){var G=new Uint8Array(P);if(G.set)G.set(R);else for(;I<_;++I)G[I]=R[I];return G}return R.length=P,R}function pr(R){for(var M=new Array(R),_=0;_<R;++_)M[_]=0;return M}function ws(R,M,_){var P=1,I=0,O=0,G=0,Z=0,q=R.length,K=pe?new Uint16Array(32):pr(32);for(O=0;O<32;++O)K[O]=0;for(O=q;O<_;++O)R[O]=0;q=R.length;var X=pe?new Uint16Array(q):pr(q);for(O=0;O<q;++O)K[I=R[O]]++,P<I&&(P=I),X[O]=0;for(K[0]=0,O=1;O<=P;++O)K[O+16]=Z=Z+K[O-1]<<1;for(O=0;O<q;++O)Z=R[O],Z!=0&&(X[O]=K[Z+16]++);var ie=0;for(O=0;O<q;++O)if(ie=R[O],ie!=0)for(Z=U(X[O],P)>>P-ie,G=(1<<P+4-ie)-1;G>=0;--G)M[Z|G<<ie]=ie&15|O<<4;return P}var qs=pe?new Uint16Array(512):pr(512),Bn=pe?new Uint16Array(32):pr(32);if(!pe){for(var zt=0;zt<512;++zt)qs[zt]=0;for(zt=0;zt<32;++zt)Bn[zt]=0}(function(){for(var R=[],M=0;M<32;M++)R.push(5);ws(R,Bn,32);var _=[];for(M=0;M<=143;M++)_.push(8);for(;M<=255;M++)_.push(9);for(;M<=279;M++)_.push(7);for(;M<=287;M++)_.push(8);ws(_,qs,288)})();var $r=function(){for(var M=pe?new Uint8Array(32768):[],_=0,P=0;_<ue.length-1;++_)for(;P<ue[_+1];++P)M[P]=_;for(;P<32768;++P)M[P]=29;var I=pe?new Uint8Array(259):[];for(_=0,P=0;_<te.length-1;++_)for(;P<te[_+1];++P)I[P]=_;function O(Z,q){for(var K=0;K<Z.length;){var X=Math.min(65535,Z.length-K),ie=K+X==Z.length;for(q.write_shift(1,+ie),q.write_shift(2,X),q.write_shift(2,~X&65535);X-- >0;)q[q.l++]=Z[K++]}return q.l}function G(Z,q){for(var K=0,X=0,ie=pe?new Uint16Array(32768):[];X<Z.length;){var he=Math.min(65535,Z.length-X);if(he<10){for(K=Tr(q,K,+(X+he==Z.length)),K&7&&(K+=8-(K&7)),q.l=K/8|0,q.write_shift(2,he),q.write_shift(2,~he&65535);he-- >0;)q[q.l++]=Z[X++];K=q.l*8;continue}K=Tr(q,K,+(X+he==Z.length)+2);for(var ge=0;he-- >0;){var me=Z[X];ge=(ge<<5^me)&32767;var we=-1,Ce=0;if((we=ie[ge])&&(we|=X&-32768,we>X&&(we-=32768),we<X))for(;Z[we+Ce]==Z[X+Ce]&&Ce<250;)++Ce;if(Ce>2){me=I[Ce],me<=22?K=vs(q,K,le[me+1]>>1)-1:(vs(q,K,3),K+=5,vs(q,K,le[me-23]>>5),K+=3);var ot=me<8?0:me-4>>2;ot>0&&(Ln(q,K,Ce-te[me]),K+=ot),me=M[X-we],K=vs(q,K,le[me]>>3),K-=3;var ct=me<4?0:me-2>>1;ct>0&&(Ln(q,K,X-we-ue[me]),K+=ct);for(var Jt=0;Jt<Ce;++Jt)ie[ge]=X&32767,ge=(ge<<5^Z[X])&32767,++X;he-=Ce-1}else me<=143?me=me+48:K=Ur(q,K,1),K=vs(q,K,le[me]),ie[ge]=X&32767,++X}K=vs(q,K,0)-1}return q.l=(K+7)/8|0,q.l}return function(q,K){return q.length<8?O(q,K):G(q,K)}}();function Ae(R){var M=Et(50+Math.floor(R.length*1.1)),_=$r(R,M);return M.slice(0,_)}var lt=pe?new Uint16Array(32768):pr(32768),Er=pe?new Uint16Array(32768):pr(32768),vt=pe?new Uint16Array(128):pr(128),xa=1,Un=1;function tf(R,M){var _=Fe(R,M)+257;M+=5;var P=Fe(R,M)+1;M+=5;var I=He(R,M)+4;M+=4;for(var O=0,G=pe?new Uint8Array(19):pr(19),Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],q=1,K=pe?new Uint8Array(8):pr(8),X=pe?new Uint8Array(8):pr(8),ie=G.length,he=0;he<I;++he)G[V[he]]=O=Me(R,M),q<O&&(q=O),K[O]++,M+=3;var ge=0;for(K[0]=0,he=1;he<=q;++he)X[he]=ge=ge+K[he-1]<<1;for(he=0;he<ie;++he)(ge=G[he])!=0&&(Z[he]=X[ge]++);var me=0;for(he=0;he<ie;++he)if(me=G[he],me!=0){ge=le[Z[he]]>>8-me;for(var we=(1<<7-me)-1;we>=0;--we)vt[ge|we<<me]=me&7|he<<3}var Ce=[];for(q=1;Ce.length<_+P;)switch(ge=vt[xe(R,M)],M+=ge&7,ge>>>=3){case 16:for(O=3+rt(R,M),M+=2,ge=Ce[Ce.length-1];O-- >0;)Ce.push(ge);break;case 17:for(O=3+Me(R,M),M+=3;O-- >0;)Ce.push(0);break;case 18:for(O=11+xe(R,M),M+=7;O-- >0;)Ce.push(0);break;default:Ce.push(ge),q<ge&&(q=ge);break}var ot=Ce.slice(0,_),ct=Ce.slice(_);for(he=_;he<286;++he)ot[he]=0;for(he=P;he<30;++he)ct[he]=0;return xa=ws(ot,lt,286),Un=ws(ct,Er,30),M}function rf(R,M){if(R[0]==3&&!(R[1]&3))return[An(M),2];for(var _=0,P=0,I=rv(M||1<<18),O=0,G=I.length>>>0,Z=0,q=0;!(P&1);){if(P=Me(R,_),_+=3,P>>>1)P>>1==1?(Z=9,q=5):(_=tf(R,_),Z=xa,q=Un);else{_&7&&(_+=8-(_&7));var K=R[_>>>3]|R[(_>>>3)+1]<<8;if(_+=32,K>0)for(!M&&G<O+K&&(I=Gs(I,O+K),G=I.length);K-- >0;)I[O++]=R[_>>>3],_+=8;continue}for(;;){!M&&G<O+32767&&(I=Gs(I,O+32767),G=I.length);var X=it(R,_,Z),ie=P>>>1==1?qs[X]:lt[X];if(_+=ie&15,ie>>>=4,!(ie>>>8&255))I[O++]=ie;else{if(ie==256)break;ie-=257;var he=ie<8?0:ie-4>>2;he>5&&(he=0);var ge=O+te[ie];he>0&&(ge+=it(R,_,he),_+=he),X=it(R,_,q),ie=P>>>1==1?Bn[X]:Er[X],_+=ie&15,ie>>>=4;var me=ie<4?0:ie-2>>1,we=ue[ie];for(me>0&&(we+=it(R,_,me),_+=me),!M&&G<ge&&(I=Gs(I,ge+100),G=I.length);O<ge;)I[O]=I[O-we],++O}}}return M?[I,_+7>>>3]:[I.slice(0,O),_+7>>>3]}function rs(R,M){var _=R.slice(R.l||0),P=rf(_,M);return R.l+=P[1],P[0]}function Ht(R,M){if(R)typeof console<"u"&&console.error(M);else throw new Error(M)}function Ql(R,M){var _=R;qt(_,0);var P=[],I=[],O={FileIndex:P,FullPaths:I};v(O,{root:M.root});for(var G=_.length-4;(_[G]!=80||_[G+1]!=75||_[G+2]!=5||_[G+3]!=6)&&G>=0;)--G;_.l=G+4,_.l+=4;var Z=_.read_shift(2);_.l+=6;var q=_.read_shift(4);for(_.l=q,G=0;G<Z;++G){_.l+=20;var K=_.read_shift(4),X=_.read_shift(4),ie=_.read_shift(2),he=_.read_shift(2),ge=_.read_shift(2);_.l+=8;var me=_.read_shift(4),we=o(_.slice(_.l+ie,_.l+ie+he));_.l+=ie+he+ge;var Ce=_.l;_.l=me+4,Zc(_,K,X,O,we),_.l=Ce}return O}function Zc(R,M,_,P,I){R.l+=2;var O=R.read_shift(2),G=R.read_shift(2),Z=l(R);if(O&8257)throw new Error("Unsupported ZIP encryption");for(var q=R.read_shift(4),K=R.read_shift(4),X=R.read_shift(4),ie=R.read_shift(2),he=R.read_shift(2),ge="",me=0;me<ie;++me)ge+=String.fromCharCode(R[R.l++]);if(he){var we=o(R.slice(R.l,R.l+he));(we[21589]||{}).mt&&(Z=we[21589].mt),((I||{})[21589]||{}).mt&&(Z=I[21589].mt)}R.l+=he;var Ce=R.slice(R.l,R.l+K);switch(G){case 8:Ce=L(R,X);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+G)}var ot=!1;O&8&&(q=R.read_shift(4),q==134695760&&(q=R.read_shift(4),ot=!0),K=R.read_shift(4),X=R.read_shift(4)),K!=M&&Ht(ot,"Bad compressed size: "+M+" != "+K),X!=_&&Ht(ot,"Bad uncompressed size: "+_+" != "+X),Vi(P,ge,Ce,{unsafe:!0,mt:Z})}function eu(R,M){var _=M||{},P=[],I=[],O=Et(1),G=_.compression?8:0,Z=0,q=0,K=0,X=0,ie=0,he=R.FullPaths[0],ge=he,me=R.FileIndex[0],we=[],Ce=0;for(q=1;q<R.FullPaths.length;++q)if(ge=R.FullPaths[q].slice(he.length),me=R.FileIndex[q],!(!me.size||!me.content||ge=="Sh33tJ5")){var ot=X,ct=Et(ge.length);for(K=0;K<ge.length;++K)ct.write_shift(1,ge.charCodeAt(K)&127);ct=ct.slice(0,ct.l),we[ie]=g8.buf(me.content,0);var Jt=me.content;G==8&&(Jt=B(Jt)),O=Et(30),O.write_shift(4,67324752),O.write_shift(2,20),O.write_shift(2,Z),O.write_shift(2,G),me.mt?i(O,me.mt):O.write_shift(4,0),O.write_shift(-4,we[ie]),O.write_shift(4,Jt.length),O.write_shift(4,me.content.length),O.write_shift(2,ct.length),O.write_shift(2,0),X+=O.length,P.push(O),X+=ct.length,P.push(ct),X+=Jt.length,P.push(Jt),O=Et(46),O.write_shift(4,33639248),O.write_shift(2,0),O.write_shift(2,20),O.write_shift(2,Z),O.write_shift(2,G),O.write_shift(4,0),O.write_shift(-4,we[ie]),O.write_shift(4,Jt.length),O.write_shift(4,me.content.length),O.write_shift(2,ct.length),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(4,0),O.write_shift(4,ot),Ce+=O.l,I.push(O),Ce+=ct.length,I.push(ct),++ie}return O=Et(22),O.write_shift(4,101010256),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,ie),O.write_shift(2,ie),O.write_shift(4,Ce),O.write_shift(4,X),O.write_shift(2,0),rn([rn(P),rn(I),O])}var $n={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function tu(R,M){if(R.ctype)return R.ctype;var _=R.name||"",P=_.match(/\.([^\.]+)$/);return P&&$n[P[1]]||M&&(P=(_=M).match(/[\.\\]([^\.\\])+$/),P&&$n[P[1]])?$n[P[1]]:"application/octet-stream"}function ru(R){for(var M=tv(R),_=[],P=0;P<M.length;P+=76)_.push(M.slice(P,P+76));return _.join(`\r
`)+`\r
`}function su(R){var M=R.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(K){var X=K.charCodeAt(0).toString(16).toUpperCase();return"="+(X.length==1?"0"+X:X)});M=M.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),M.charAt(0)==`
`&&(M="=0D"+M.slice(1)),M=M.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var _=[],P=M.split(`\r
`),I=0;I<P.length;++I){var O=P[I];if(O.length==0){_.push("");continue}for(var G=0;G<O.length;){var Z=76,q=O.slice(G,G+Z);q.charAt(Z-1)=="="?Z--:q.charAt(Z-2)=="="?Z-=2:q.charAt(Z-3)=="="&&(Z-=3),q=O.slice(G,G+Z),G+=Z,G<O.length&&(q+="="),_.push(q)}}return _.join(`\r
`)}function au(R){for(var M=[],_=0;_<R.length;++_){for(var P=R[_];_<=R.length&&P.charAt(P.length-1)=="=";)P=P.slice(0,P.length-1)+R[++_];M.push(P)}for(var I=0;I<M.length;++I)M[I]=M[I].replace(/[=][0-9A-Fa-f]{2}/g,function(O){return String.fromCharCode(parseInt(O.slice(1),16))});return Fs(M.join(`\r
`))}function nu(R,M,_){for(var P="",I="",O="",G,Z=0;Z<10;++Z){var q=M[Z];if(!q||q.match(/^\s*$/))break;var K=q.match(/^(.*?):\s*([^\s].*)$/);if(K)switch(K[1].toLowerCase()){case"content-location":P=K[2].trim();break;case"content-type":O=K[2].trim();break;case"content-transfer-encoding":I=K[2].trim();break}}switch(++Z,I.toLowerCase()){case"base64":G=Fs(Zr(M.slice(Z).join("")));break;case"quoted-printable":G=au(M.slice(Z));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+I)}var X=Vi(R,P.slice(_.length),G,{unsafe:!0});O&&(X.ctype=O)}function iu(R,M){if(H(R.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var _=M&&M.root||"",P=(Oe&&Buffer.isBuffer(R)?R.toString("binary"):H(R)).split(`\r
`),I=0,O="";for(I=0;I<P.length;++I)if(O=P[I],!!/^Content-Location:/i.test(O)&&(O=O.slice(O.indexOf("file")),_||(_=O.slice(0,O.lastIndexOf("/")+1)),O.slice(0,_.length)!=_))for(;_.length>0&&(_=_.slice(0,_.length-1),_=_.slice(0,_.lastIndexOf("/")+1),O.slice(0,_.length)!=_););var G=(P[1]||"").match(/boundary="(.*?)"/);if(!G)throw new Error("MAD cannot find boundary");var Z="--"+(G[1]||""),q=[],K=[],X={FileIndex:q,FullPaths:K};v(X);var ie,he=0;for(I=0;I<P.length;++I){var ge=P[I];ge!==Z&&ge!==Z+"--"||(he++&&nu(X,P.slice(ie,I),_),ie=I)}return X}function lu(R,M){var _=M||{},P=_.boundary||"SheetJS";P="------="+P;for(var I=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+P.slice(2)+'"',"","",""],O=R.FullPaths[0],G=O,Z=R.FileIndex[0],q=1;q<R.FullPaths.length;++q)if(G=R.FullPaths[q].slice(O.length),Z=R.FileIndex[q],!(!Z.size||!Z.content||G=="Sh33tJ5")){G=G.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ce){return"_x"+Ce.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ce){return"_u"+Ce.charCodeAt(0).toString(16)+"_"});for(var K=Z.content,X=Oe&&Buffer.isBuffer(K)?K.toString("binary"):H(K),ie=0,he=Math.min(1024,X.length),ge=0,me=0;me<=he;++me)(ge=X.charCodeAt(me))>=32&&ge<128&&++ie;var we=ie>=he*4/5;I.push(P),I.push("Content-Location: "+(_.root||"file:///C:/SheetJS/")+G),I.push("Content-Transfer-Encoding: "+(we?"quoted-printable":"base64")),I.push("Content-Type: "+tu(Z,G)),I.push(""),I.push(we?su(X):ru(X))}return I.push(P+`--\r
`),I.join(`\r
`)}function ou(R){var M={};return v(M,R),M}function Vi(R,M,_,P){var I=P&&P.unsafe;I||v(R);var O=!I&&Le.find(R,M);if(!O){var G=R.FullPaths[0];M.slice(0,G.length)==G?G=M:(G.slice(-1)!="/"&&(G+="/"),G=(G+M).replace("//","/")),O={name:n(M),type:2},R.FileIndex.push(O),R.FullPaths.push(G),I||Le.utils.cfb_gc(R)}return O.content=_,O.size=_?_.length:0,P&&(P.CLSID&&(O.clsid=P.CLSID),P.mt&&(O.mt=P.mt),P.ct&&(O.ct=P.ct)),O}function cu(R,M){v(R);var _=Le.find(R,M);if(_){for(var P=0;P<R.FileIndex.length;++P)if(R.FileIndex[P]==_)return R.FileIndex.splice(P,1),R.FullPaths.splice(P,1),!0}return!1}function uu(R,M,_){v(R);var P=Le.find(R,M);if(P){for(var I=0;I<R.FileIndex.length;++I)if(R.FileIndex[I]==P)return R.FileIndex[I].name=n(_),R.FullPaths[I]=_,!0}return!1}function du(R){S(R,!0)}return t.find=D,t.read=k,t.parse=d,t.write=ne,t.writeFile=se,t.utils={cfb_new:ou,cfb_add:Vi,cfb_del:cu,cfb_mov:uu,cfb_gc:du,ReadShift:Oo,CheckField:S_,prep_blob:qt,bconcat:rn,use_zlib:T,_deflateRaw:Ae,_inflateRaw:rs,consts:fe},t}();function y8(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(s){if(!s.message||!s.message.match(/onstruct/))throw s}throw new Error("Cannot access file "+e)}function da(e){for(var t=Object.keys(e),r=[],s=0;s<t.length;++s)Object.prototype.hasOwnProperty.call(e,t[s])&&r.push(t[s]);return r}function bx(e){for(var t=[],r=da(e),s=0;s!==r.length;++s)t[e[r[s]]]=r[s];return t}var r0=new Date(1899,11,30,0,0,0);function kr(e,t){var r=e.getTime(),s=r0.getTime()+(e.getTimezoneOffset()-r0.getTimezoneOffset())*6e4;return(r-s)/(24*60*60*1e3)}var n_=new Date,v8=r0.getTime()+(n_.getTimezoneOffset()-r0.getTimezoneOffset())*6e4,uv=n_.getTimezoneOffset();function Q0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+v8),t.getTimezoneOffset()!==uv&&t.setTime(t.getTime()+(t.getTimezoneOffset()-uv)*6e4),t}function w8(e){var t=0,r=0,s=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=n.length;++i)if(n[i]){switch(r=1,i>3&&(s=!0),n[i].slice(n[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[i].slice(n[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(s)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[i],10)}return t}var dv=new Date("2017-02-19T19:06:09.000Z"),i_=isNaN(dv.getFullYear())?new Date("2/19/17"):dv,b8=i_.getFullYear()==2017;function Vt(e,t){var r=new Date(e);if(b8)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(i_.getFullYear()==1917&&!isNaN(r.getFullYear())){var s=r.getFullYear();return e.indexOf(""+s)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Ci(e,t){if(Oe&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return jo(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return jo(GN(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return jo(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return jo(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var s=[],n=0;n!=e.length;++n)s.push(String.fromCharCode(e[n]));return s.join("")}function Kt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Kt(e[r]));return t}function gt(e,t){for(var r="";r.length<t;)r+=e;return r}function Ms(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(s))||(s=s.replace(/[(](.*)[)]/,function(n,i){return r=-r,i}),!isNaN(t=Number(s)))?t/r:t}var j8=["january","february","march","april","may","june","july","august","september","october","november","december"];function Bl(e){var t=new Date(e),r=new Date(NaN),s=t.getYear(),n=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&j8.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return s<0||s>8099?r:(n>0||i>1)&&s!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var N8=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,s,n){if(e||typeof s=="string")return r.split(s);for(var i=r.split(s),l=[i[0]],o=1;o<i.length;++o)l.push(n),l.push(i[o]);return l}}();function l_(e){return e?e.content&&e.type?Ci(e.content,!0):e.data?vo(e.data):e.asNodeBuffer&&Oe?vo(e.asNodeBuffer().toString("binary")):e.asBinary?vo(e.asBinary()):e._data&&e._data.getContent?vo(Ci(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function o_(e){if(!e)return null;if(e.data)return Zy(e.data);if(e.asNodeBuffer&&Oe)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Zy(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function _8(e){return e&&e.name.slice(-4)===".bin"?o_(e):l_(e)}function ls(e,t){for(var r=e.FullPaths||da(e.files),s=t.toLowerCase().replace(/[\/]/g,"\\"),n=s.replace(/\\/g,"/"),i=0;i<r.length;++i){var l=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(s==l||n==l)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function jx(e,t){var r=ls(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function St(e,t,r){if(!r)return _8(jx(e,t));if(!t)return null;try{return St(e,t)}catch{return null}}function Gr(e,t,r){if(!r)return l_(jx(e,t));if(!t)return null;try{return Gr(e,t)}catch{return null}}function k8(e,t,r){return o_(jx(e,t))}function fv(e){for(var t=e.FullPaths||da(e.files),r=[],s=0;s<t.length;++s)t[s].slice(-1)!="/"&&r.push(t[s].replace(/^Root Entry[\/]/,""));return r.sort()}function S8(e,t,r){if(e.FullPaths){if(typeof r=="string"){var s;return Oe?s=Oi(r):s=WP(r),Le.utils.cfb_add(e,t,s)}Le.utils.cfb_add(e,t,r)}else e.file(t,r)}function c_(e,t){switch(t.type){case"base64":return Le.read(e,{type:"base64"});case"binary":return Le.read(e,{type:"binary"});case"buffer":case"array":return Le.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function bo(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var s=e.split("/");s.length!==0;){var n=s.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var u_=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,C8=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,hv=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,T8=/<[^>]*>/g,mr=u_.match(hv)?hv:T8,E8=/<\w*:/,A8=/<(\/?)\w+:/;function Ne(e,t,r){for(var s={},n=0,i=0;n!==e.length&&!((i=e.charCodeAt(n))===32||i===10||i===13);++n);if(t||(s[0]=e.slice(0,n)),n===e.length)return s;var l=e.match(C8),o=0,c="",u=0,d="",f="",h=1;if(l)for(u=0;u!=l.length;++u){for(f=l[u],i=0;i!=f.length&&f.charCodeAt(i)!==61;++i);for(d=f.slice(0,i).trim();f.charCodeAt(i+1)==32;)++i;for(h=(n=f.charCodeAt(i+1))==34||n==39?1:0,c=f.slice(i+1+h,f.length-h),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),s[d]=c,s[d.toLowerCase()]=c;else{var x=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(s[x]&&d.slice(o-3,o)=="ext")continue;s[x]=c,s[x.toLowerCase()]=c}}return s}function ma(e){return e.replace(A8,"<$1")}var d_={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},F8=bx(d_),Ve=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(s){var n=s+"",i=n.indexOf("<![CDATA[");if(i==-1)return n.replace(e,function(o,c){return d_[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var l=n.indexOf("]]>");return r(n.slice(0,i))+n.slice(i+9,l)+r(n.slice(l+3))}}(),R8=/[&<>'"]/g,P8=/[\u0000-\u001f]/g;function Nx(e){var t=e+"";return t.replace(R8,function(r){return F8[r]}).replace(/\n/g,"<br/>").replace(P8,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var mv=function(){var e=/&#(\d+);/g;function t(r,s){return String.fromCharCode(parseInt(s,10))}return function(s){return s.replace(e,t)}}();function st(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Jf(e){for(var t="",r=0,s=0,n=0,i=0,l=0,o=0;r<e.length;){if(s=e.charCodeAt(r++),s<128){t+=String.fromCharCode(s);continue}if(n=e.charCodeAt(r++),s>191&&s<224){l=(s&31)<<6,l|=n&63,t+=String.fromCharCode(l);continue}if(i=e.charCodeAt(r++),s<240){t+=String.fromCharCode((s&15)<<12|(n&63)<<6|i&63);continue}l=e.charCodeAt(r++),o=((s&7)<<18|(n&63)<<12|(i&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function pv(e){var t=An(2*e.length),r,s,n=1,i=0,l=0,o;for(s=0;s<e.length;s+=n)n=1,(o=e.charCodeAt(s))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(s+1)&63),n=2):o<240?(r=(o&15)*4096+(e.charCodeAt(s+1)&63)*64+(e.charCodeAt(s+2)&63),n=3):(n=4,r=(o&7)*262144+(e.charCodeAt(s+1)&63)*4096+(e.charCodeAt(s+2)&63)*64+(e.charCodeAt(s+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[i++]=l&255,t[i++]=l>>>8,l=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function xv(e){return Oi(e,"binary").toString("utf8")}var $u="foo bar baz",Ze=Oe&&(xv($u)==Jf($u)&&xv||pv($u)==Jf($u)&&pv)||Jf,jo=Oe?function(e){return Oi(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,s=0,n=0;r<e.length;)switch(s=e.charCodeAt(r++),!0){case s<128:t.push(String.fromCharCode(s));break;case s<2048:t.push(String.fromCharCode(192+(s>>6))),t.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,n=e.charCodeAt(r++)-56320+(s<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(s>>12))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)))}return t.join("")},jc=function(){var e={};return function(r,s){var n=r+"|"+(s||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",s||"")}}(),f_=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var s=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)s=s.replace(e[n][0],e[n][1]);return s}}(),D8=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),I8=/<\/?(?:vt:)?variant>/g,O8=/<(?:vt:)([^>]*)>([\s\S]*)</;function gv(e,t){var r=Ne(e),s=e.match(D8(r.baseType))||[],n=[];if(s.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+s.length+" != "+r.size);return n}return s.forEach(function(i){var l=i.replace(I8,"").match(O8);l&&n.push({v:Ze(l[2]),t:l[1]})}),n}var M8=/(^\s|\s$|\n)/;function L8(e){return da(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function B8(e,t,r){return"<"+e+(r!=null?L8(r):"")+(t!=null?(t.match(M8)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function _x(e){if(Oe&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Ze(Mi(yx(e)));throw new Error("Bad input format: expected Buffer or string")}var Nc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,U8={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},$8=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function V8(e,t){for(var r=1-2*(e[t+7]>>>7),s=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,i=5;i>=0;--i)n=n*256+e[t+i];return s==2047?n==0?r*(1/0):NaN:(s==0?s=-1022:(s-=1023,n+=Math.pow(2,52)),r*Math.pow(2,s-52)*n)}function z8(e,t,r){var s=(t<0||1/t==-1/0?1:0)<<7,n=0,i=0,l=s?-t:t;isFinite(l)?l==0?n=i=0:(n=Math.floor(Math.log(l)/Math.LN2),i=l*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(n&15)<<4|i&15,e[r+7]=n>>4|s}var yv=function(e){for(var t=[],r=10240,s=0;s<e[0].length;++s)if(e[0][s])for(var n=0,i=e[0][s].length;n<i;n+=r)t.push.apply(t,e[0][s].slice(n,n+r));return t},vv=Oe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Oi(t)})):yv(e)}:yv,wv=function(e,t,r){for(var s=[],n=t;n<r;n+=2)s.push(String.fromCharCode(Sa(e,n)));return s.join("").replace(_r,"")},kx=Oe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(_r,""):wv(e,t,r)}:wv,bv=function(e,t,r){for(var s=[],n=t;n<t+r;++n)s.push(("0"+e[n].toString(16)).slice(-2));return s.join("")},h_=Oe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):bv(e,t,r)}:bv,jv=function(e,t,r){for(var s=[],n=t;n<r;n++)s.push(String.fromCharCode(qi(e,n)));return s.join("")},qc=Oe?function(t,r,s){return Buffer.isBuffer(t)?t.toString("utf8",r,s):jv(t,r,s)}:jv,m_=function(e,t){var r=Wr(e,t);return r>0?qc(e,t+4,t+4+r-1):""},p_=m_,x_=function(e,t){var r=Wr(e,t);return r>0?qc(e,t+4,t+4+r-1):""},g_=x_,y_=function(e,t){var r=2*Wr(e,t);return r>0?qc(e,t+4,t+4+r-1):""},v_=y_,w_=function(t,r){var s=Wr(t,r);return s>0?kx(t,r+4,r+4+s):""},b_=w_,j_=function(e,t){var r=Wr(e,t);return r>0?qc(e,t+4,t+4+r):""},N_=j_,__=function(e,t){return V8(e,t)},s0=__,k_=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Oe&&(p_=function(t,r){if(!Buffer.isBuffer(t))return m_(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},g_=function(t,r){if(!Buffer.isBuffer(t))return x_(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},v_=function(t,r){if(!Buffer.isBuffer(t))return y_(t,r);var s=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s-1)},b_=function(t,r){if(!Buffer.isBuffer(t))return w_(t,r);var s=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s)},N_=function(t,r){if(!Buffer.isBuffer(t))return j_(t,r);var s=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+s)},s0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):__(t,r)},k_=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var qi=function(e,t){return e[t]},Sa=function(e,t){return e[t+1]*256+e[t]},H8=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Wr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Xn=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},W8=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Oo(e,t){var r="",s,n,i=[],l,o,c,u;switch(t){case"dbcs":if(u=this.l,Oe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Sa(this,u)),u+=2;e*=2;break;case"utf8":r=qc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=kx(this,this.l,this.l+e);break;case"wstr":return Oo.call(this,e,"dbcs");case"lpstr-ansi":r=p_(this,this.l),e=4+Wr(this,this.l);break;case"lpstr-cp":r=g_(this,this.l),e=4+Wr(this,this.l);break;case"lpwstr":r=v_(this,this.l),e=4+2*Wr(this,this.l);break;case"lpp4":e=4+Wr(this,this.l),r=b_(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Wr(this,this.l),r=N_(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=qi(this,this.l+e++))!==0;)i.push(Uu(l));r=i.join("");break;case"_wstr":for(e=0,r="";(l=Sa(this,this.l+e))!==0;)i.push(Uu(l)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return l=qi(this,u),this.l=u+1,o=Oo.call(this,e-c,l?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Uu(Sa(this,u))),u+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return l=qi(this,u),this.l=u+1,o=Oo.call(this,e-c,l?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Uu(qi(this,u))),u+=1}r=i.join("");break;default:switch(e){case 1:return s=qi(this,this.l),this.l++,s;case 2:return s=(t==="i"?H8:Sa)(this,this.l),this.l+=2,s;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(s=(e>0?Xn:W8)(this,this.l),this.l+=4,s):(n=Wr(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=s0(this,this.l):n=s0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=h_(this,this.l,e);break}}return this.l+=e,r}var G8=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},q8=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Y8=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function K8(e,t,r){var s=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)Y8(this,t.charCodeAt(n),this.l+2*n);s=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;s=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var l=t.charCodeAt(n);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:s=1,this[this.l]=t&255;break;case 2:s=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:s=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:s=4,G8(this,t,this.l);break;case 8:if(s=8,r==="f"){z8(this,t,this.l);break}case 16:break;case-4:s=4,q8(this,t,this.l);break}return this.l+=s,this}function S_(e,t){var r=h_(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function qt(e,t){e.l=t,e.read_shift=Oo,e.chk=S_,e.write_shift=K8}function hr(e,t){e.l+=t}function Et(e){var t=An(e);return qt(t,0),t}function za(e,t,r){if(e){var s,n,i;qt(e,e.l||0);for(var l=e.length,o=0,c=0;e.l<l;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=c0[o]||c0[65535];for(s=e.read_shift(1),i=s&127,n=1;n<4&&s&128;++n)i+=((s=e.read_shift(1))&127)<<7*n;c=e.l+i;var d=u.f&&u.f(e,i,r);if(e.l=c,t(d,u,o))return}}}function Tm(){var e=[],t=Oe?256:2048,r=function(u){var d=Et(u);return qt(d,0),d},s=r(t),n=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&e.push(s),s=null)},i=function(u){return s&&u<s.length-s.l?s:(n(),s=r(Math.max(u+1,t)))},l=function(){return n(),rn(e)},o=function(u){n(),s=u,s.l==null&&(s.l=s.length),i(t)};return{next:i,push:o,end:l,_bufs:e}}function Mo(e,t,r){var s=Kt(e);if(t.s?(s.cRel&&(s.c+=t.s.c),s.rRel&&(s.r+=t.s.r)):(s.cRel&&(s.c+=t.c),s.rRel&&(s.r+=t.r)),!r||r.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function Nv(e,t,r){var s=Kt(e);return s.s=Mo(s.s,t.s,r),s.e=Mo(s.e,t.s,r),s}function Lo(e,t){if(e.cRel&&e.c<0)for(e=Kt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Kt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Se(e);return!e.cRel&&e.cRel!=null&&(r=J8(r)),!e.rRel&&e.rRel!=null&&(r=X8(r)),r}function Zf(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Pt(e.s.c)+":"+(e.e.cRel?"":"$")+Pt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Xt(e.s.r)+":"+(e.e.rRel?"":"$")+Xt(e.e.r):Lo(e.s,t.biff)+":"+Lo(e.e,t.biff)}function Sx(e){return parseInt(Q8(e),10)-1}function Xt(e){return""+(e+1)}function X8(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Q8(e){return e.replace(/\$(\d+)$/,"$1")}function Cx(e){for(var t=Z8(e),r=0,s=0;s!==t.length;++s)r=26*r+t.charCodeAt(s)-64;return r-1}function Pt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function J8(e){return e.replace(/^([A-Z])/,"$$$1")}function Z8(e){return e.replace(/^\$([A-Z])/,"$1")}function eD(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function jr(e){for(var t=0,r=0,s=0;s<e.length;++s){var n=e.charCodeAt(s);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function Se(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Kl(e){var t=e.indexOf(":");return t==-1?{s:jr(e),e:jr(e)}:{s:jr(e.slice(0,t)),e:jr(e.slice(t+1))}}function Be(e,t){return typeof t>"u"||typeof t=="number"?Be(e.s,e.e):(typeof e!="string"&&(e=Se(e)),typeof t!="string"&&(t=Se(t)),e==t?e:e+":"+t)}function yt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,s=0,n=0,i=e.length;for(r=0;s<i&&!((n=e.charCodeAt(s)-64)<1||n>26);++s)r=26*r+n;for(t.s.c=--r,r=0;s<i&&!((n=e.charCodeAt(s)-48)<0||n>9);++s)r=10*r+n;if(t.s.r=--r,s===i||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++s,r=0;s!=i&&!((n=e.charCodeAt(s)-64)<1||n>26);++s)r=26*r+n;for(t.e.c=--r,r=0;s!=i&&!((n=e.charCodeAt(s)-48)<0||n>9);++s)r=10*r+n;return t.e.r=--r,t}function _v(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=gs(e.z,r?kr(t):t)}catch{}try{return e.w=gs((e.XF||{}).numFmtId||(r?14:0),r?kr(t):t)}catch{return""+t}}function $a(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Ui[e.v]||e.v:t==null?_v(e,e.v):_v(e,t))}function Mn(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",s={};return s[r]=e,{SheetNames:[r],Sheets:s}}function C_(e,t,r){var s=r||{},n=e?Array.isArray(e):s.dense,i=e||(n?[]:{}),l=0,o=0;if(i&&s.origin!=null){if(typeof s.origin=="number")l=s.origin;else{var c=typeof s.origin=="string"?jr(s.origin):s.origin;l=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=yt(i["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),l==-1&&(u.e.r=l=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var x={v:t[f][h]},m=l+f,p=o+h;if(u.s.r>m&&(u.s.r=m),u.s.c>p&&(u.s.c=p),u.e.r<m&&(u.e.r=m),u.e.c<p&&(u.e.c=p),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))x=t[f][h];else if(Array.isArray(x.v)&&(x.f=t[f][h][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(s.nullError)x.t="e",x.v=0;else if(s.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=s.dateNF||Te[14],s.cellDates?(x.t="d",x.w=gs(x.z,kr(x.v))):(x.t="n",x.v=kr(x.v),x.w=gs(x.z,x.v))):x.t="s";if(n)i[m]||(i[m]=[]),i[m][p]&&i[m][p].z&&(x.z=i[m][p].z),i[m][p]=x;else{var w=Se({c:p,r:m});i[w]&&i[w].z&&(x.z=i[w].z),i[w]=x}}}return u.s.c<1e7&&(i["!ref"]=Be(u)),i}function Xl(e,t){return C_(null,e,t)}function tD(e){return e.read_shift(4,"i")}function dr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function rD(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Tx(e,t){var r=e.l,s=e.read_shift(1),n=dr(e),i=[],l={t:n,h:n};if(s&1){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push(rD(e));l.r=i}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}var sD=Tx;function ys(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Li(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var aD=dr;function Ex(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var nD=dr,Em=Ex;function Ax(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,s=t[0]&2;e.l+=4;var n=s===0?s0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Xn(t,0)>>2;return r?n/100:n}function T_(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Bi=T_;function lr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function iD(e){var t={},r=e.read_shift(1),s=r>>>1,n=e.read_shift(1),i=e.read_shift(2,"i"),l=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,s){case 0:t.auto=1;break;case 1:t.index=n;var u=yi[n];u&&(t.rgb=kc(u));break;case 2:t.rgb=kc([l,o,c]);break;case 3:t.theme=n;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function lD(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function E_(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},s=e.read_shift(4);switch(s){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(s>400)throw new Error("Unsupported Clipboard: "+s.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function oD(e){return E_(e,1)}function cD(e){return E_(e,2)}var Fx=2,Ar=3,Vu=11,kv=12,a0=19,zu=64,uD=65,dD=71,fD=4108,hD=4126,Mt=80,A_=81,mD=[Mt,A_],pD={1:{n:"CodePage",t:Fx},2:{n:"Category",t:Mt},3:{n:"PresentationFormat",t:Mt},4:{n:"ByteCount",t:Ar},5:{n:"LineCount",t:Ar},6:{n:"ParagraphCount",t:Ar},7:{n:"SlideCount",t:Ar},8:{n:"NoteCount",t:Ar},9:{n:"HiddenCount",t:Ar},10:{n:"MultimediaClipCount",t:Ar},11:{n:"ScaleCrop",t:Vu},12:{n:"HeadingPairs",t:fD},13:{n:"TitlesOfParts",t:hD},14:{n:"Manager",t:Mt},15:{n:"Company",t:Mt},16:{n:"LinksUpToDate",t:Vu},17:{n:"CharacterCount",t:Ar},19:{n:"SharedDoc",t:Vu},22:{n:"HyperlinksChanged",t:Vu},23:{n:"AppVersion",t:Ar,p:"version"},24:{n:"DigSig",t:uD},26:{n:"ContentType",t:Mt},27:{n:"ContentStatus",t:Mt},28:{n:"Language",t:Mt},29:{n:"Version",t:Mt},255:{},2147483648:{n:"Locale",t:a0},2147483651:{n:"Behavior",t:a0},1919054434:{}},xD={1:{n:"CodePage",t:Fx},2:{n:"Title",t:Mt},3:{n:"Subject",t:Mt},4:{n:"Author",t:Mt},5:{n:"Keywords",t:Mt},6:{n:"Comments",t:Mt},7:{n:"Template",t:Mt},8:{n:"LastAuthor",t:Mt},9:{n:"RevNumber",t:Mt},10:{n:"EditTime",t:zu},11:{n:"LastPrinted",t:zu},12:{n:"CreatedDate",t:zu},13:{n:"ModifiedDate",t:zu},14:{n:"PageCount",t:Ar},15:{n:"WordCount",t:Ar},16:{n:"CharCount",t:Ar},17:{n:"Thumbnail",t:dD},18:{n:"Application",t:Mt},19:{n:"DocSecurity",t:Ar},255:{},2147483648:{n:"Locale",t:a0},2147483651:{n:"Behavior",t:a0},1919054434:{}},Sv={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},gD=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function yD(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var vD=yD([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),yi=Kt(vD),Ui={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},F_={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Cv={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function wD(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function bD(e){var t=wD();if(!e||!e.match)return t;var r={};if((e.match(mr)||[]).forEach(function(s){var n=Ne(s);switch(n[0].replace(E8,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[Cv[n.ContentType]]!==void 0&&t[Cv[n.ContentType]].push(n.PartName);break}}),t.xmlns!==U8.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var ul={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Am(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Bo(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var s={};return(e.match(mr)||[]).forEach(function(n){var i=Ne(n);if(i[0]==="<Relationship"){var l={};l.Type=i.Type,l.Target=i.Target,l.Id=i.Id,i.TargetMode&&(l.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:bo(i.Target,t);r[o]=l,s[i.Id]=l}}),r["!id"]=s,r}var jD="application/vnd.oasis.opendocument.spreadsheet";function ND(e,t){for(var r=_x(e),s,n;s=Nc.exec(r);)switch(s[3]){case"manifest":break;case"file-entry":if(n=Ne(s[0],!1),n.path=="/"&&n.type!==jD)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw s}}var Uo=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],_D=function(){for(var e=new Array(Uo.length),t=0;t<Uo.length;++t){var r=Uo[t],s="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+s+"[^>]*>([\\s\\S]*?)</"+s+">")}return e}();function R_(e){var t={};e=Ze(e);for(var r=0;r<Uo.length;++r){var s=Uo[r],n=e.match(_D[r]);n!=null&&n.length>0&&(t[s[1]]=Ve(n[1])),s[2]==="date"&&t[s[1]]&&(t[s[1]]=Vt(t[s[1]]))}return t}var kD=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function P_(e,t,r,s){var n=[];if(typeof e=="string")n=gv(e,s);else for(var i=0;i<e.length;++i)n=n.concat(e[i].map(function(d){return{v:d}}));var l=typeof t=="string"?gv(t,s).map(function(d){return d.v}):t,o=0,c=0;if(l.length>0)for(var u=0;u!==n.length;u+=2){switch(c=+n[u+1].v,n[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=l.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=l.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=l.slice(o,o+c);break}o+=c}}function SD(e,t,r){var s={};return t||(t={}),e=Ze(e),kD.forEach(function(n){var i=(e.match(jc(n[0]))||[])[1];switch(n[2]){case"string":i&&(t[n[1]]=Ve(i));break;case"bool":t[n[1]]=i==="true";break;case"raw":var l=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));l&&l.length>0&&(s[n[1]]=l[1]);break}}),s.HeadingPairs&&s.TitlesOfParts&&P_(s.HeadingPairs,s.TitlesOfParts,t,r),t}var CD=/<[^>]+>[^<]*/g;function TD(e,t){var r={},s="",n=e.match(CD);if(n)for(var i=0;i!=n.length;++i){var l=n[i],o=Ne(l);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":s=Ve(o.name);break;case"</property>":s=null;break;default:if(l.indexOf("<vt:")===0){var c=l.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[s]=Ve(d);break;case"bool":r[s]=st(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[s]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[s]=parseFloat(d);break;case"filetime":case"date":r[s]=Vt(d);break;case"cy":case"error":r[s]=Ve(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,u,c)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return r}var ED={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},eh;function AD(e,t,r){eh||(eh=bx(ED)),t=eh[t]||t,e[t]=r}function Rx(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function D_(e,t,r){var s=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-s&3;)++e.l;return n}function I_(e,t,r){var s=e.read_shift(0,"lpwstr");return s}function O_(e,t,r){return t===31?I_(e):D_(e,t,r)}function Fm(e,t,r){return O_(e,t,r===!1?0:4)}function FD(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return O_(e,t,0)}function RD(e){for(var t=e.read_shift(4),r=[],s=0;s!=t;++s){var n=e.l;r[s]=e.read_shift(0,"lpwstr").replace(_r,""),e.l-n&2&&(e.l+=2)}return r}function PD(e){for(var t=e.read_shift(4),r=[],s=0;s!=t;++s)r[s]=e.read_shift(0,"lpstr-cp").replace(_r,"");return r}function DD(e){var t=e.l,r=n0(e,A_);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var s=n0(e,Ar);return[r,s]}function ID(e){for(var t=e.read_shift(4),r=[],s=0;s<t/2;++s)r.push(DD(e));return r}function Tv(e,t){for(var r=e.read_shift(4),s={},n=0;n!=r;++n){var i=e.read_shift(4),l=e.read_shift(4);s[i]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(_r,"").replace(wo,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),s}function M_(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function OD(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function n0(e,t,r){var s=e.read_shift(2),n,i=r||{};if(e.l+=2,t!==kv&&s!==t&&mD.indexOf(t)===-1&&!((t&65534)==4126&&(s&65534)==4126))throw new Error("Expected type "+t+" saw "+s);switch(t===kv?s:t){case 2:return n=e.read_shift(2,"i"),i.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return D_(e,s,4).replace(_r,"");case 31:return I_(e);case 64:return Rx(e);case 65:return M_(e);case 71:return OD(e);case 80:return Fm(e,s,!i.raw).replace(_r,"");case 81:return FD(e,s).replace(_r,"");case 4108:return ID(e);case 4126:case 4127:return s==4127?RD(e):PD(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+s)}}function Ev(e,t){var r=e.l,s=e.read_shift(4),n=e.read_shift(4),i=[],l=0,o=0,c=-1,u={};for(l=0;l!=n;++l){var d=e.read_shift(4),f=e.read_shift(4);i[l]=[d,f+r]}i.sort(function(g,y){return g[1]-y[1]});var h={};for(l=0;l!=n;++l){if(e.l!==i[l][1]){var x=!0;if(l>0&&t)switch(t[i[l-1][0]].t){case 2:e.l+2===i[l][1]&&(e.l+=2,x=!1);break;case 80:e.l<=i[l][1]&&(e.l=i[l][1],x=!1);break;case 4108:e.l<=i[l][1]&&(e.l=i[l][1],x=!1);break}if((!t||l==0)&&e.l<=i[l][1]&&(x=!1,e.l=i[l][1]),x)throw new Error("Read Error: Expected address "+i[l][1]+" at "+e.l+" :"+l)}if(t){var m=t[i[l][0]];if(h[m.n]=n0(e,m.t,{raw:!0}),m.p==="version"&&(h[m.n]=String(h[m.n]>>16)+"."+("0000"+String(h[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(h[m.n]){case 0:h[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Rs(o=h[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[m.n])}}else if(i[l][0]===1){if(o=h.CodePage=n0(e,Fx),Rs(o),c!==-1){var p=e.l;e.l=i[c][1],u=Tv(e,o),e.l=p}}else if(i[l][0]===0){if(o===0){c=l,e.l=i[l+1][1];continue}u=Tv(e,o)}else{var w=u[i[l][0]],b;switch(e[e.l]){case 65:e.l+=4,b=M_(e);break;case 30:e.l+=4,b=Fm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,b=Fm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,b=e.read_shift(4,"i");break;case 19:e.l+=4,b=e.read_shift(4);break;case 5:e.l+=4,b=e.read_shift(8,"f");break;case 11:e.l+=4,b=wt(e,4);break;case 64:e.l+=4,b=Vt(Rx(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[w]=b}}return e.l=r+s,h}function Av(e,t,r){var s=e.content;if(!s)return{};qt(s,0);var n,i,l,o,c=0;s.chk("feff","Byte Order: "),s.read_shift(2);var u=s.read_shift(4),d=s.read_shift(16);if(d!==Le.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(n=s.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(i=s.read_shift(16),o=s.read_shift(4),n===1&&o!==s.l)throw new Error("Length mismatch: "+o+" !== "+s.l);n===2&&(l=s.read_shift(16),c=s.read_shift(4));var f=Ev(s,t),h={SystemIdentifier:u};for(var x in f)h[x]=f[x];if(h.FMTID=i,n===1)return h;if(c-s.l==2&&(s.l+=2),s.l!==c)throw new Error("Length mismatch 2: "+s.l+" !== "+c);var m;try{m=Ev(s,null)}catch{}for(x in m)h[x]=m[x];return h.FMTID=[i,l],h}function Wa(e,t){return e.read_shift(t),null}function MD(e,t,r){for(var s=[],n=e.l+t;e.l<n;)s.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return s}function wt(e,t){return e.read_shift(t)===1}function Ct(e){return e.read_shift(2,"u")}function L_(e,t){return MD(e,t,Ct)}function LD(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Yc(e,t,r){var s=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var l=s?e.read_shift(s,n):"";return l}function BD(e){var t=e.read_shift(2),r=e.read_shift(1),s=r&4,n=r&8,i=1+(r&1),l=0,o,c={};n&&(l=e.read_shift(2)),s&&(o=e.read_shift(4));var u=i==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return n&&(e.l+=4*l),s&&(e.l+=o),c.t=d,n||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function Ti(e,t,r){var s;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?s=e.read_shift(t,"sbcs-cont"):s=e.read_shift(t,"dbcs-cont"),s}function Kc(e,t,r){var s=e.read_shift(r&&r.biff==2?1:2);return s===0?(e.l++,""):Ti(e,s,r)}function $i(e,t,r){if(r.biff>5)return Kc(e,t,r);var s=e.read_shift(1);return s===0?(e.l++,""):e.read_shift(s,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function UD(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function $D(e){var t=e.read_shift(4),r=e.l,s=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(s=!0),e.l=r);var n=e.read_shift((s?t-24:t)>>1,"utf16le").replace(_r,"");return s&&(e.l+=24),n}function VD(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var s=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+s.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(i>>1,"utf16le").replace(_r,"");return r+l}function zD(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return $D(e);case"0303000000000000c000000000000046":return VD(e);default:throw new Error("Unsupported Moniker "+r)}}function Hu(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(_r,""):"";return r}function HD(e,t){var r=e.l+t,s=e.read_shift(4);if(s!==2)throw new Error("Unrecognized streamVersion: "+s);var n=e.read_shift(2);e.l+=2;var i,l,o,c,u="",d,f;n&16&&(i=Hu(e,r-e.l)),n&128&&(l=Hu(e,r-e.l)),(n&257)===257&&(o=Hu(e,r-e.l)),(n&257)===1&&(c=zD(e,r-e.l)),n&8&&(u=Hu(e,r-e.l)),n&32&&(d=e.read_shift(16)),n&64&&(f=Rx(e)),e.l=r;var h=l||o||c||"";h&&u&&(h+="#"+u),h||(h="#"+u),n&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var x={Target:h};return d&&(x.guid=d),f&&(x.time=f),i&&(x.Tooltip=i),x}function B_(e){var t=e.read_shift(1),r=e.read_shift(1),s=e.read_shift(1),n=e.read_shift(1);return[t,r,s,n]}function U_(e,t){var r=B_(e);return r[3]=0,r}function pa(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return{r:t,c:r,ixfe:s}}function WD(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function GD(e,t,r){return t===0?"":$i(e,t,r)}function qD(e,t,r){var s=r.biff>8?4:2,n=e.read_shift(s),i=e.read_shift(s,"i"),l=e.read_shift(s,"i");return[n,i,l]}function $_(e){var t=e.read_shift(2),r=Ax(e);return[t,r]}function YD(e,t,r){e.l+=4,t-=4;var s=e.l+t,n=Yc(e,t,r),i=e.read_shift(2);if(s-=e.l,i!==s)throw new Error("Malformed AddinUdf: padding = "+s+" != "+i);return e.l+=i,n}function J0(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2);return{s:{c:s,r:t},e:{c:n,r}}}function V_(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(1),n=e.read_shift(1);return{s:{c:s,r:t},e:{c:n,r}}}var KD=V_;function z_(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return e.l+=12,[r,t,s]}function XD(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function QD(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function rr(e){e.l+=2,e.l+=e.read_shift(2)}var JD={0:rr,4:rr,5:rr,6:rr,7:QD,8:rr,9:rr,10:rr,11:rr,12:rr,13:XD,14:rr,15:rr,16:rr,17:rr,18:rr,19:rr,20:rr,21:z_};function ZD(e,t){for(var r=e.l+t,s=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{s.push(JD[n](e,r-e.l))}catch{return e.l=r,s}}return e.l!=r&&(e.l=r),s}function Wu(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function eI(e,t){return t===0||e.read_shift(2),1200}function tI(e,t,r){if(r.enc)return e.l+=t,"";var s=e.l,n=$i(e,0,r);return e.read_shift(t+s-e.l),n}function rI(e,t,r){var s=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:s&16,fBelow:s&64,fRight:s&128}}function sI(e,t,r){var s=e.read_shift(4),n=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var l=Yc(e,0,r);return l.length===0&&(l="Sheet1"),{pos:s,hs:n,dt:i,name:l}}function aI(e,t){for(var r=e.l+t,s=e.read_shift(4),n=e.read_shift(4),i=[],l=0;l!=n&&e.l<r;++l)i.push(BD(e));return i.Count=s,i.Unique=n,i}function nI(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function iI(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var s=e.read_shift(1);return e.l+=3,s&7&&(t.level=s&7),s&32&&(t.hidden=!0),s&64&&(t.hpt=r/20),t}function lI(e){var t=WD(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function oI(e){return e.read_shift(2),e.read_shift(4)}function Fv(e,t,r){var s=0;r&&r.biff==2||(s=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(s=1-(n>>15),n&=32767);var i={Unsynced:s&1,DyZero:(s&2)>>1,ExAsc:(s&4)>>2,ExDsc:(s&8)>>3};return[i,n]}function cI(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[s,n],Flags:i,CurTab:l,FirstTab:o,Selected:c,TabRatio:u}}function uI(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var s=e.read_shift(2);return{RTL:s&64}}function dI(){}function fI(e,t,r){var s={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return s.name=Yc(e,0,r),s}function hI(e){var t=pa(e);return t.isst=e.read_shift(4),t}function mI(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=e.l+t,n=pa(e);r.biff==2&&e.l++;var i=Kc(e,s-e.l,r);return n.val=i,n}function pI(e,t,r){var s=e.read_shift(2),n=$i(e,0,r);return[s,n]}var xI=$i;function Rv(e,t,r){var s=e.l+t,n=r.biff==8||!r.biff?4:2,i=e.read_shift(n),l=e.read_shift(n),o=e.read_shift(2),c=e.read_shift(2);return e.l=s,{s:{r:i,c:o},e:{r:l,c}}}function gI(e){var t=e.read_shift(2),r=e.read_shift(2),s=$_(e);return{r:t,c:r,ixfe:s[0],rknum:s[1]}}function yI(e,t){for(var r=e.l+t-2,s=e.read_shift(2),n=e.read_shift(2),i=[];e.l<r;)i.push($_(e));if(e.l!==r)throw new Error("MulRK read error");var l=e.read_shift(2);if(i.length!=l-n+1)throw new Error("MulRK length mismatch");return{r:s,c:n,C:l,rkrec:i}}function vI(e,t){for(var r=e.l+t-2,s=e.read_shift(2),n=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var l=e.read_shift(2);if(i.length!=l-n+1)throw new Error("MulBlank length mismatch");return{r:s,c:n,C:l,ixfe:i}}function wI(e,t,r,s){var n={},i=e.read_shift(4),l=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return n.patternType=gD[o>>26],s.cellStyles&&(n.alc=i&7,n.fWrap=i>>3&1,n.alcV=i>>4&7,n.fJustLast=i>>7&1,n.trot=i>>8&255,n.cIndent=i>>16&15,n.fShrinkToFit=i>>20&1,n.iReadOrder=i>>22&2,n.fAtrNum=i>>26&1,n.fAtrFnt=i>>27&1,n.fAtrAlc=i>>28&1,n.fAtrBdr=i>>29&1,n.fAtrPat=i>>30&1,n.fAtrProt=i>>31&1,n.dgLeft=l&15,n.dgRight=l>>4&15,n.dgTop=l>>8&15,n.dgBottom=l>>12&15,n.icvLeft=l>>16&127,n.icvRight=l>>23&127,n.grbitDiag=l>>30&3,n.icvTop=o&127,n.icvBottom=o>>7&127,n.icvDiag=o>>14&127,n.dgDiag=o>>21&15,n.icvFore=c&127,n.icvBack=c>>7&127,n.fsxButton=c>>14&1),n}function bI(e,t,r){var s={};return s.ifnt=e.read_shift(2),s.numFmtId=e.read_shift(2),s.flags=e.read_shift(2),s.fStyle=s.flags>>2&1,t-=6,s.data=wI(e,t,s.fStyle,r),s}function jI(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Pv(e,t,r){var s=pa(e);(r.biff==2||t==9)&&++e.l;var n=LD(e);return s.val=n,s.t=n===!0||n===!1?"b":"e",s}function NI(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=pa(e),n=lr(e);return s.val=n,s}var Dv=GD;function _I(e,t,r){var s=e.l+t,n=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,n];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var l=Ti(e,i),o=[];s>e.l;)o.push(Kc(e));return[i,n,l,o]}function Iv(e,t,r){var s=e.read_shift(2),n,i={fBuiltIn:s&1,fWantAdvise:s>>>1&1,fWantPict:s>>>2&1,fOle:s>>>3&1,fOleLink:s>>>4&1,cf:s>>>5&1023,fIcon:s>>>15&1};return r.sbcch===14849&&(n=YD(e,t-2,r)),i.body=n||e.read_shift(t-2),typeof n=="string"&&(i.Name=n),i}var kI=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Ov(e,t,r){var s=e.l+t,n=e.read_shift(2),i=e.read_shift(1),l=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=Ti(e,l,r);n&32&&(u=kI[u.charCodeAt(0)]);var d=s-e.l;r&&r.biff==2&&--d;var f=s==e.l||o===0||!(d>0)?[]:iL(e,d,r,o);return{chKey:i,Name:u,itab:c,rgce:f}}function H_(e,t,r){if(r.biff<8)return SI(e,t,r);for(var s=[],n=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)s.push(qD(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return s}function SI(e,t,r){e[e.l+1]==3&&e[e.l]++;var s=Yc(e,t,r);return s.charCodeAt(0)==3?s.slice(1):s}function CI(e,t,r){if(r.biff<8){e.l+=t;return}var s=e.read_shift(2),n=e.read_shift(2),i=Ti(e,s,r),l=Ti(e,n,r);return[i,l]}function TI(e,t,r){var s=V_(e);e.l++;var n=e.read_shift(1);return t-=8,[lL(e,t,r),n,s]}function Mv(e,t,r){var s=KD(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[s,aL(e,t,r)]}function EI(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,s=e.read_shift(4);return[t,r,s]}function AI(e,t,r){if(!(r.biff<8)){var s=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),o=$i(e,0,r);return r.biff<8&&e.read_shift(1),[{r:s,c:n},o,l,i]}}function FI(e,t,r){return AI(e,t,r)}function RI(e,t){for(var r=[],s=e.read_shift(2);s--;)r.push(J0(e));return r}function PI(e,t,r){if(r&&r.biff<8)return II(e,t,r);var s=z_(e),n=ZD(e,t-22,s[1]);return{cmo:s,ft:n}}var DI={8:function(e,t){var r=e.l+t;e.l+=10;var s=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:s}}};function II(e,t,r){e.l+=4;var s=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((DI[s]||hr)(e,t,r)),{cmo:[n,s,i],ft:l}}function OI(e,t,r){var s=e.l,n="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:l=UD(e,6,r);var o=e.read_shift(2);e.read_shift(2),Ct(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-s!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=Ti(e,e.lens[u+1]-e.lens[u]-1);if(n+=f,n.length>=(d?o:2*o))break}if(n.length!==o&&n.length!==o*2)throw new Error("cchText: "+o+" != "+n.length);return e.l=s+t,{t:n}}catch{return e.l=s+t,{t:n}}}function MI(e,t){var r=J0(e);e.l+=16;var s=HD(e,t-24);return[r,s]}function LI(e,t){e.read_shift(2);var r=J0(e),s=e.read_shift((t-10)/2,"dbcs-cont");return s=s.replace(_r,""),[r,s]}function BI(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Sv[r]||r,r=e.read_shift(2),t[1]=Sv[r]||r,t}function UI(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(U_(e));return r}function $I(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(U_(e));return r}function VI(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function W_(e,t,r){if(!r.cellStyles)return hr(e,t);var s=r&&r.biff>=12?4:2,n=e.read_shift(s),i=e.read_shift(s),l=e.read_shift(s),o=e.read_shift(s),c=e.read_shift(2);s==2&&(e.l+=2);var u={s:n,e:i,w:l,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function zI(e,t){var r={};return t<32||(e.l+=16,r.header=lr(e),r.footer=lr(e),e.l+=2),r}function HI(e,t,r){var s={area:!1};if(r.biff!=5)return e.l+=t,s;var n=e.read_shift(1);return e.l+=3,n&16&&(s.area=!0),s}var WI=pa,GI=L_,qI=Kc;function YI(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),n={fmt:t,env:r,len:s,data:e.slice(e.l,e.l+s)};return e.l+=s,n}function KI(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var s=pa(e);++e.l;var n=$i(e,t-7,r);return s.t="str",s.val=n,s}function XI(e){var t=pa(e);++e.l;var r=lr(e);return t.t="n",t.val=r,t}function QI(e){var t=pa(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function JI(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function ZI(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function eO(e,t,r){var s=e.l+t,n=pa(e),i=e.read_shift(2),l=Ti(e,i,r);return e.l=s,n.t="str",n.val=l,n}var tO=[2,3,48,49,131,139,140,245],Lv=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=bx({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],d=An(1);switch(c.type){case"base64":d=Fs(Zr(o));break;case"binary":d=Fs(o);break;case"buffer":case"array":d=o;break}qt(d,0);var f=d.read_shift(1),h=!!(f&136),x=!1,m=!1;switch(f){case 2:break;case 3:break;case 48:x=!0,h=!0;break;case 49:x=!0,h=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,w=521;f==2&&(p=d.read_shift(2)),d.l+=3,f!=2&&(p=d.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(w=d.read_shift(2));var b=d.read_shift(2),g=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(g=e[d[d.l]]),d.l+=1,d.l+=2),m&&(d.l+=36);for(var y=[],j={},A=Math.min(d.length,f==2?521:w-10-(x?264:0)),k=m?32:11;d.l<A&&d[d.l]!=13;)switch(j={},j.name=wc.utils.decode(g,d.slice(d.l,d.l+k)).replace(/[\u0000\r\n].*$/g,""),d.l+=k,j.type=String.fromCharCode(d.read_shift(1)),f!=2&&!m&&(j.offset=d.read_shift(4)),j.len=d.read_shift(1),f==2&&(j.offset=d.read_shift(2)),j.dec=d.read_shift(1),j.name.length&&y.push(j),f!=2&&(d.l+=m?13:14),j.type){case"B":(!x||j.len!=8)&&c.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+j.type)}if(d[d.l]!==13&&(d.l=w-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=w;var v=0,E=0;for(u[0]=[],E=0;E!=y.length;++E)u[0][E]=y[E].name;for(;p-- >0;){if(d[d.l]===42){d.l+=b;continue}for(++d.l,u[++v]=[],E=0,E=0;E!=y.length;++E){var S=d.slice(d.l,d.l+y[E].len);d.l+=y[E].len,qt(S,0);var N=wc.utils.decode(g,S);switch(y[E].type){case"C":N.trim().length&&(u[v][E]=N.replace(/\s+$/,""));break;case"D":N.length===8?u[v][E]=new Date(+N.slice(0,4),+N.slice(4,6)-1,+N.slice(6,8)):u[v][E]=N;break;case"F":u[v][E]=parseFloat(N.trim());break;case"+":case"I":u[v][E]=m?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(N.trim().toUpperCase()){case"Y":case"T":u[v][E]=!0;break;case"N":case"F":u[v][E]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+N+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[v][E]="##MEMO##"+(m?parseInt(N.trim(),10):S.read_shift(4));break;case"N":N=N.replace(/\u0000/g,"").trim(),N&&N!="."&&(u[v][E]=+N||0);break;case"@":u[v][E]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":u[v][E]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":u[v][E]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[v][E]=-S.read_shift(-8,"f");break;case"B":if(x&&y[E].len==8){u[v][E]=S.read_shift(8,"f");break}case"G":case"P":S.l+=y[E].len;break;case"0":if(y[E].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[E].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=y,u}function s(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=Xl(r(o,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function n(o,c){try{return Mn(s(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function l(o,c){var u=c||{};if(+u.codepage>=0&&Rs(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Tm(),f=Lm(o,{header:1,raw:!0,cellDates:!0}),h=f[0],x=f.slice(1),m=o["!cols"]||[],p=0,w=0,b=0,g=1;for(p=0;p<h.length;++p){if(((m[p]||{}).DBF||{}).name){h[p]=m[p].DBF.name,++b;continue}if(h[p]!=null){if(++b,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(w=0;w<1024;++w)if(h.indexOf(h[p]+"_"+w)==-1){h[p]+="_"+w;break}}}}var y=yt(o["!ref"]),j=[],A=[],k=[];for(p=0;p<=y.e.c-y.s.c;++p){var v="",E="",S=0,N=[];for(w=0;w<x.length;++w)x[w][p]!=null&&N.push(x[w][p]);if(N.length==0||h[p]==null){j[p]="?";continue}for(w=0;w<N.length;++w){switch(typeof N[w]){case"number":E="B";break;case"string":E="C";break;case"boolean":E="L";break;case"object":E=N[w]instanceof Date?"D":"C";break;default:E="C"}S=Math.max(S,String(N[w]).length),v=v&&v!=E?"C":E}S>250&&(S=250),E=((m[p]||{}).DBF||{}).type,E=="C"&&m[p].DBF.len>S&&(S=m[p].DBF.len),v=="B"&&E=="N"&&(v="N",k[p]=m[p].DBF.dec,S=m[p].DBF.len),A[p]=v=="C"||E=="N"?S:i[v]||0,g+=A[p],j[p]=v}var D=d.next(32);for(D.write_shift(4,318902576),D.write_shift(4,x.length),D.write_shift(2,296+32*b),D.write_shift(2,g),p=0;p<4;++p)D.write_shift(4,0);for(D.write_shift(4,0|(+t[HN]||3)<<8),p=0,w=0;p<h.length;++p)if(h[p]!=null){var F=d.next(32),Y=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);F.write_shift(1,Y,"sbcs"),F.write_shift(1,j[p]=="?"?"C":j[p],"sbcs"),F.write_shift(4,w),F.write_shift(1,A[p]||i[j[p]]||0),F.write_shift(1,k[p]||0),F.write_shift(1,2),F.write_shift(4,0),F.write_shift(1,0),F.write_shift(4,0),F.write_shift(4,0),w+=A[p]||i[j[p]]||0}var Q=d.next(264);for(Q.write_shift(4,13),p=0;p<65;++p)Q.write_shift(4,0);for(p=0;p<x.length;++p){var ae=d.next(g);for(ae.write_shift(1,0),w=0;w<h.length;++w)if(h[w]!=null)switch(j[w]){case"L":ae.write_shift(1,x[p][w]==null?63:x[p][w]?84:70);break;case"B":ae.write_shift(8,x[p][w]||0,"f");break;case"N":var ee="0";for(typeof x[p][w]=="number"&&(ee=x[p][w].toFixed(k[w]||0)),b=0;b<A[w]-ee.length;++b)ae.write_shift(1,32);ae.write_shift(1,ee,"sbcs");break;case"D":x[p][w]?(ae.write_shift(4,("0000"+x[p][w].getFullYear()).slice(-4),"sbcs"),ae.write_shift(2,("00"+(x[p][w].getMonth()+1)).slice(-2),"sbcs"),ae.write_shift(2,("00"+x[p][w].getDate()).slice(-2),"sbcs")):ae.write_shift(8,"00000000","sbcs");break;case"C":var fe=String(x[p][w]!=null?x[p][w]:"").slice(0,A[w]);for(ae.write_shift(1,fe,"sbcs"),b=0;b<A[w]-fe.length;++b)ae.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:n,to_sheet:s,from_sheet:l}}(),rO=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+da(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,x){var m=e[x];return typeof m=="number"?ev(m):m},s=function(h,x,m){var p=x.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return p==59?h:ev(p)};e["|"]=254;function n(h,x){switch(x.type){case"base64":return i(Zr(h),x);case"binary":return i(h,x);case"buffer":return i(Oe&&Buffer.isBuffer(h)?h.toString("binary"):Mi(h),x);case"array":return i(Ci(h),x)}throw new Error("Unrecognized type "+x.type)}function i(h,x){var m=h.split(/[\n\r]+/),p=-1,w=-1,b=0,g=0,y=[],j=[],A=null,k={},v=[],E=[],S=[],N=0,D;for(+x.codepage>=0&&Rs(+x.codepage);b!==m.length;++b){N=0;var F=m[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(t,r),Y=F.replace(/;;/g,"\0").split(";").map(function(V){return V.replace(/\u0000/g,";")}),Q=Y[0],ae;if(F.length>0)switch(Q){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Y[1].charAt(0)=="P"&&j.push(F.slice(3).replace(/;;/g,";"));break;case"C":var ee=!1,fe=!1,se=!1,H=!1,ne=-1,W=-1;for(g=1;g<Y.length;++g)switch(Y[g].charAt(0)){case"A":break;case"X":w=parseInt(Y[g].slice(1))-1,fe=!0;break;case"Y":for(p=parseInt(Y[g].slice(1))-1,fe||(w=0),D=y.length;D<=p;++D)y[D]=[];break;case"K":ae=Y[g].slice(1),ae.charAt(0)==='"'?ae=ae.slice(1,ae.length-1):ae==="TRUE"?ae=!0:ae==="FALSE"?ae=!1:isNaN(Ms(ae))?isNaN(Bl(ae).getDate())||(ae=Vt(ae)):(ae=Ms(ae),A!==null&&Yl(A)&&(ae=Q0(ae))),ee=!0;break;case"E":H=!0;var T=yl(Y[g].slice(1),{r:p,c:w});y[p][w]=[y[p][w],T];break;case"S":se=!0,y[p][w]=[y[p][w],"S5S"];break;case"G":break;case"R":ne=parseInt(Y[g].slice(1))-1;break;case"C":W=parseInt(Y[g].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+F)}if(ee&&(y[p][w]&&y[p][w].length==2?y[p][w][0]=ae:y[p][w]=ae,A=null),se){if(H)throw new Error("SYLK shared formula cannot have own formula");var L=ne>-1&&y[ne][W];if(!L||!L[1])throw new Error("SYLK shared formula cannot find base");y[p][w][1]=t4(L[1],{r:p-ne,c:w-W})}break;case"F":var B=0;for(g=1;g<Y.length;++g)switch(Y[g].charAt(0)){case"X":w=parseInt(Y[g].slice(1))-1,++B;break;case"Y":for(p=parseInt(Y[g].slice(1))-1,D=y.length;D<=p;++D)y[D]=[];break;case"M":N=parseInt(Y[g].slice(1))/20;break;case"F":break;case"G":break;case"P":A=j[parseInt(Y[g].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=Y[g].slice(1).split(" "),D=parseInt(S[0],10);D<=parseInt(S[1],10);++D)N=parseInt(S[2],10),E[D-1]=N===0?{hidden:!0}:{wch:N},Ul(E[D-1]);break;case"C":w=parseInt(Y[g].slice(1))-1,E[w]||(E[w]={});break;case"R":p=parseInt(Y[g].slice(1))-1,v[p]||(v[p]={}),N>0?(v[p].hpt=N,v[p].hpx=Sc(N)):N===0&&(v[p].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+F)}B<1&&(A=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+F)}}return v.length>0&&(k["!rows"]=v),E.length>0&&(k["!cols"]=E),x&&x.sheetRows&&(y=y.slice(0,x.sheetRows)),[y,k]}function l(h,x){var m=n(h,x),p=m[0],w=m[1],b=Xl(p,x);return da(w).forEach(function(g){b[g]=w[g]}),b}function o(h,x){return Mn(l(h,x),x)}function c(h,x,m,p){var w="C;Y"+(m+1)+";X"+(p+1)+";K";switch(h.t){case"n":w+=h.v||0,h.f&&!h.F&&(w+=";E"+V9(h.f,{r:m,c:p}));break;case"b":w+=h.v?"TRUE":"FALSE";break;case"e":w+=h.w||h.v;break;case"d":w+='"'+(h.w||h.v)+'"';break;case"s":w+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function u(h,x){x.forEach(function(m,p){var w="F;W"+(p+1)+" "+(p+1)+" ";m.hidden?w+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=l0(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=o0(m.wpx)),typeof m.wch=="number"&&(w+=Math.round(m.wch))),w.charAt(w.length-1)!=" "&&h.push(w)})}function d(h,x){x.forEach(function(m,p){var w="F;";m.hidden?w+="M0;":m.hpt?w+="M"+20*m.hpt+";":m.hpx&&(w+="M"+20*J_(m.hpx)+";"),w.length>2&&h.push(w+"R"+(p+1))})}function f(h,x){var m=["ID;PWXL;N;E"],p=[],w=yt(h["!ref"]),b,g=Array.isArray(h),y=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),h["!cols"]&&u(m,h["!cols"]),h["!rows"]&&d(m,h["!rows"]),m.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var j=w.s.r;j<=w.e.r;++j)for(var A=w.s.c;A<=w.e.c;++A){var k=Se({r:j,c:A});b=g?(h[j]||[])[A]:h[k],!(!b||b.v==null&&(!b.f||b.F))&&p.push(c(b,h,j,A))}return m.join(y)+y+p.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:l,from_sheet:f}}(),sO=function(){function e(i,l){switch(l.type){case"base64":return t(Zr(i),l);case"binary":return t(i,l);case"buffer":return t(Oe&&Buffer.isBuffer(i)?i.toString("binary"):Mi(i),l);case"array":return t(Ci(i),l)}throw new Error("Unrecognized type "+l.type)}function t(i,l){for(var o=i.split(`
`),c=-1,u=-1,d=0,f=[];d!==o.length;++d){if(o[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var h=o[d].trim().split(","),x=h[0],m=h[1];++d;for(var p=o[d]||"";(p.match(/["]/g)||[]).length&1&&d<o.length-1;)p+=`
`+o[++d];switch(p=p.trim(),+x){case-1:if(p==="BOT"){f[++c]=[],u=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[c][u]=!0:p==="FALSE"?f[c][u]=!1:isNaN(Ms(m))?isNaN(Bl(m).getDate())?f[c][u]=m:f[c][u]=Vt(m):f[c][u]=Ms(m),++u;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[c][u++]=p!==""?p:null;break}if(p==="EOD")break}}return l&&l.sheetRows&&(f=f.slice(0,l.sheetRows)),f}function r(i,l){return Xl(e(i,l),l)}function s(i,l){return Mn(r(i,l),l)}var n=function(){var i=function(c,u,d,f,h){c.push(u),c.push(d+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},l=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=yt(c["!ref"]),f,h=Array.isArray(c);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,d.e.r-d.s.r+1,""),i(u,"TUPLES",0,d.e.c-d.s.c+1,""),i(u,"DATA",0,0,"");for(var x=d.s.r;x<=d.e.r;++x){l(u,-1,0,"BOT");for(var m=d.s.c;m<=d.e.c;++m){var p=Se({r:x,c:m});if(f=h?(c[x]||[])[m]:c[p],!f){l(u,1,0,"");continue}switch(f.t){case"n":var w=f.w;!w&&f.v!=null&&(w=f.v),w==null?f.f&&!f.F?l(u,1,0,"="+f.f):l(u,1,0,""):l(u,0,w,"V");break;case"b":l(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":l(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=gs(f.z||Te[14],kr(Vt(f.v)))),l(u,0,f.w,"V");break;default:l(u,1,0,"")}}}l(u,-1,0,"EOD");var b=`\r
`,g=u.join(b);return g}}();return{to_workbook:s,to_sheet:r,from_sheet:n}}(),aO=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var x=f.split(`
`),m=-1,p=-1,w=0,b=[];w!==x.length;++w){var g=x[w].trim().split(":");if(g[0]==="cell"){var y=jr(g[1]);if(b.length<=y.r)for(m=b.length;m<=y.r;++m)b[m]||(b[m]=[]);switch(m=y.r,p=y.c,g[2]){case"t":b[m][p]=e(g[3]);break;case"v":b[m][p]=+g[3];break;case"vtf":var j=g[g.length-1];case"vtc":switch(g[3]){case"nl":b[m][p]=!!+g[4];break;default:b[m][p]=+g[4];break}g[2]=="vtf"&&(b[m][p]=[b[m][p],j])}}}return h&&h.sheetRows&&(b=b.slice(0,h.sheetRows)),b}function s(f,h){return Xl(r(f,h),h)}function n(f,h){return Mn(s(f,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var h=[],x=[],m,p="",w=Kl(f["!ref"]),b=Array.isArray(f),g=w.s.r;g<=w.e.r;++g)for(var y=w.s.c;y<=w.e.c;++y)if(p=Se({r:g,c:y}),m=b?(f[g]||[])[y]:f[p],!(!m||m.v==null||m.t==="z")){switch(x=["cell",p,"t"],m.t){case"s":case"str":x.push(t(m.v));break;case"n":m.f?(x[2]="vtf",x[3]="n",x[4]=m.v,x[5]=t(m.f)):(x[2]="v",x[3]=m.v);break;case"b":x[2]="vt"+(m.f?"f":"c"),x[3]="nl",x[4]=m.v?"1":"0",x[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var j=kr(Vt(m.v));x[2]="vtc",x[3]="nd",x[4]=""+j,x[5]=m.w||gs(m.z||Te[14],j);break;case"e":continue}h.push(x.join(":"))}return h.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[i,l,o,l,u(f),c].join(`
`)}return{to_workbook:n,to_sheet:s,from_sheet:d}}(),_c=function(){function e(d,f,h,x,m){m.raw?f[h][x]=d:d===""||(d==="TRUE"?f[h][x]=!0:d==="FALSE"?f[h][x]=!1:isNaN(Ms(d))?isNaN(Bl(d).getDate())?f[h][x]=d:f[h][x]=Vt(d):f[h][x]=Ms(d))}function t(d,f){var h=f||{},x=[];if(!d||d.length===0)return x;for(var m=d.split(/[\r\n]/),p=m.length-1;p>=0&&m[p].length===0;)--p;for(var w=10,b=0,g=0;g<=p;++g)b=m[g].indexOf(" "),b==-1?b=m[g].length:b++,w=Math.max(w,b);for(g=0;g<=p;++g){x[g]=[];var y=0;for(e(m[g].slice(0,w).trim(),x,g,y,h),y=1;y<=(m[g].length-w)/10+1;++y)e(m[g].slice(w+(y-1)*10,w+y*10).trim(),x,g,y,h)}return h.sheetRows&&(x=x.slice(0,h.sheetRows)),x}var r={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function n(d){for(var f={},h=!1,x=0,m=0;x<d.length;++x)(m=d.charCodeAt(x))==34?h=!h:!h&&m in r&&(f[m]=(f[m]||0)+1);m=[];for(x in f)Object.prototype.hasOwnProperty.call(f,x)&&m.push([f[x],x]);if(!m.length){f=s;for(x in f)Object.prototype.hasOwnProperty.call(f,x)&&m.push([f[x],x])}return m.sort(function(p,w){return p[0]-w[0]||s[p[1]]-s[w[1]]}),r[m.pop()[1]]||44}function i(d,f){var h=f||{},x="",m=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(x=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(x=d.charAt(4),d=d.slice(6)):x=n(d.slice(0,1024)):h&&h.FS?x=h.FS:x=n(d.slice(0,1024));var w=0,b=0,g=0,y=0,j=0,A=x.charCodeAt(0),k=!1,v=0,E=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var S=h.dateNF!=null?p8(h.dateNF):null;function N(){var D=d.slice(y,j),F={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),D.length===0)F.t="z";else if(h.raw)F.t="s",F.v=D;else if(D.trim().length===0)F.t="s",F.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(F.t="s",F.v=D.slice(2,-1).replace(/""/g,'"')):H9(D)?(F.t="n",F.f=D.slice(1)):(F.t="s",F.v=D);else if(D=="TRUE")F.t="b",F.v=!0;else if(D=="FALSE")F.t="b",F.v=!1;else if(!isNaN(g=Ms(D)))F.t="n",h.cellText!==!1&&(F.w=D),F.v=g;else if(!isNaN(Bl(D).getDate())||S&&D.match(S)){F.z=h.dateNF||Te[14];var Y=0;S&&D.match(S)&&(D=x8(D,h.dateNF,D.match(S)||[]),Y=1),h.cellDates?(F.t="d",F.v=Vt(D,Y)):(F.t="n",F.v=kr(Vt(D,Y))),h.cellText!==!1&&(F.w=gs(F.z,F.v instanceof Date?kr(F.v):F.v)),h.cellNF||delete F.z}else F.t="s",F.v=D;if(F.t=="z"||(h.dense?(m[w]||(m[w]=[]),m[w][b]=F):m[Se({c:b,r:w})]=F),y=j+1,E=d.charCodeAt(y),p.e.c<b&&(p.e.c=b),p.e.r<w&&(p.e.r=w),v==A)++b;else if(b=0,++w,h.sheetRows&&h.sheetRows<=w)return!0}e:for(;j<d.length;++j)switch(v=d.charCodeAt(j)){case 34:E===34&&(k=!k);break;case A:case 10:case 13:if(!k&&N())break e;break}return j-y>0&&N(),m["!ref"]=Be(p),m}function l(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,f):Xl(t(d,f),f)}function o(d,f){var h="",x=f.type=="string"?[0,0,0,0]:Ux(d,f);switch(f.type){case"base64":h=Zr(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof wc<"u"||(h=Oe&&Buffer.isBuffer(d)?d.toString("binary"):Mi(d));break;case"array":h=Ci(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return x[0]==239&&x[1]==187&&x[2]==191?h=Ze(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=Ze(h):f.type=="binary"&&typeof wc<"u",h.slice(0,19)=="socialcalc:version:"?aO.to_sheet(f.type=="string"?h:Ze(h),f):l(h,f)}function c(d,f){return Mn(o(d,f),f)}function u(d){for(var f=[],h=yt(d["!ref"]),x,m=Array.isArray(d),p=h.s.r;p<=h.e.r;++p){for(var w=[],b=h.s.c;b<=h.e.c;++b){var g=Se({r:p,c:b});if(x=m?(d[p]||[])[b]:d[g],!x||x.v==null){w.push("          ");continue}for(var y=(x.w||($a(x),x.w)||"").slice(0,10);y.length<10;)y+=" ";w.push(y+(b===0?" ":""))}f.push(w.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}}();function nO(e,t){var r=t||{},s=!!r.WTF;r.WTF=!0;try{var n=rO.to_workbook(e,r);return r.WTF=s,n}catch(i){if(r.WTF=s,!i.message.match(/SYLK bad record ID/)&&s)throw i;return _c.to_workbook(e,t)}}var $o=function(){function e(T,L,B){if(T){qt(T,T.l||0);for(var V=B.Enum||ne;T.l<T.length;){var te=T.read_shift(2),ue=V[te]||V[65535],ve=T.read_shift(2),pe=T.l+ve,le=ue.f&&ue.f(T,ve,B);if(T.l=pe,L(le,ue,te))return}}}function t(T,L){switch(L.type){case"base64":return r(Fs(Zr(T)),L);case"binary":return r(Fs(T),L);case"buffer":case"array":return r(T,L)}throw"Unsupported type "+L.type}function r(T,L){if(!T)return T;var B=L||{},V=B.dense?[]:{},te="Sheet1",ue="",ve=0,pe={},le=[],ke=[],U={s:{r:0,c:0},e:{r:0,c:0}},rt=B.sheetRows||0;if(T[2]==0&&(T[3]==8||T[3]==9)&&T.length>=16&&T[14]==5&&T[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(T[2]==2)B.Enum=ne,e(T,function(xe,it,Tr){switch(Tr){case 0:B.vers=xe,xe>=4096&&(B.qpro=!0);break;case 6:U=xe;break;case 204:xe&&(ue=xe);break;case 222:ue=xe;break;case 15:case 51:B.qpro||(xe[1].v=xe[1].v.slice(1));case 13:case 14:case 16:Tr==14&&(xe[2]&112)==112&&(xe[2]&15)>1&&(xe[2]&15)<15&&(xe[1].z=B.dateNF||Te[14],B.cellDates&&(xe[1].t="d",xe[1].v=Q0(xe[1].v))),B.qpro&&xe[3]>ve&&(V["!ref"]=Be(U),pe[te]=V,le.push(te),V=B.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},ve=xe[3],te=ue||"Sheet"+(ve+1),ue="");var Ur=B.dense?(V[xe[0].r]||[])[xe[0].c]:V[Se(xe[0])];if(Ur){Ur.t=xe[1].t,Ur.v=xe[1].v,xe[1].z!=null&&(Ur.z=xe[1].z),xe[1].f!=null&&(Ur.f=xe[1].f);break}B.dense?(V[xe[0].r]||(V[xe[0].r]=[]),V[xe[0].r][xe[0].c]=xe[1]):V[Se(xe[0])]=xe[1];break}},B);else if(T[2]==26||T[2]==14)B.Enum=W,T[2]==14&&(B.qpro=!0,T.l=0),e(T,function(xe,it,Tr){switch(Tr){case 204:te=xe;break;case 22:xe[1].v=xe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(xe[3]>ve&&(V["!ref"]=Be(U),pe[te]=V,le.push(te),V=B.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},ve=xe[3],te="Sheet"+(ve+1)),rt>0&&xe[0].r>=rt)break;B.dense?(V[xe[0].r]||(V[xe[0].r]=[]),V[xe[0].r][xe[0].c]=xe[1]):V[Se(xe[0])]=xe[1],U.e.c<xe[0].c&&(U.e.c=xe[0].c),U.e.r<xe[0].r&&(U.e.r=xe[0].r);break;case 27:xe[14e3]&&(ke[xe[14e3][0]]=xe[14e3][1]);break;case 1537:ke[xe[0]]=xe[1],xe[0]==ve&&(te=xe[1]);break}},B);else throw new Error("Unrecognized LOTUS BOF "+T[2]);if(V["!ref"]=Be(U),pe[ue||te]=V,le.push(ue||te),!ke.length)return{SheetNames:le,Sheets:pe};for(var Me={},He=[],Fe=0;Fe<ke.length;++Fe)pe[le[Fe]]?(He.push(ke[Fe]||le[Fe]),Me[ke[Fe]]=pe[ke[Fe]]||pe[le[Fe]]):(He.push(ke[Fe]),Me[ke[Fe]]={"!ref":"A1"});return{SheetNames:He,Sheets:Me}}function s(T,L){var B=L||{};if(+B.codepage>=0&&Rs(+B.codepage),B.type=="string")throw new Error("Cannot write WK1 to JS string");var V=Tm(),te=yt(T["!ref"]),ue=Array.isArray(T),ve=[];_s(V,0,i(1030)),_s(V,6,c(te));for(var pe=Math.min(te.e.r,8191),le=te.s.r;le<=pe;++le)for(var ke=Xt(le),U=te.s.c;U<=te.e.c;++U){le===te.s.r&&(ve[U]=Pt(U));var rt=ve[U]+ke,Me=ue?(T[le]||[])[U]:T[rt];if(!(!Me||Me.t=="z"))if(Me.t=="n")(Me.v|0)==Me.v&&Me.v>=-32768&&Me.v<=32767?_s(V,13,x(le,U,Me.v)):_s(V,14,p(le,U,Me.v));else{var He=$a(Me);_s(V,15,f(le,U,He.slice(0,239)))}}return _s(V,1),V.end()}function n(T,L){var B=L||{};if(+B.codepage>=0&&Rs(+B.codepage),B.type=="string")throw new Error("Cannot write WK3 to JS string");var V=Tm();_s(V,0,l(T));for(var te=0,ue=0;te<T.SheetNames.length;++te)(T.Sheets[T.SheetNames[te]]||{})["!ref"]&&_s(V,27,H(T.SheetNames[te],ue++));var ve=0;for(te=0;te<T.SheetNames.length;++te){var pe=T.Sheets[T.SheetNames[te]];if(!(!pe||!pe["!ref"])){for(var le=yt(pe["!ref"]),ke=Array.isArray(pe),U=[],rt=Math.min(le.e.r,8191),Me=le.s.r;Me<=rt;++Me)for(var He=Xt(Me),Fe=le.s.c;Fe<=le.e.c;++Fe){Me===le.s.r&&(U[Fe]=Pt(Fe));var xe=U[Fe]+He,it=ke?(pe[Me]||[])[Fe]:pe[xe];if(!(!it||it.t=="z"))if(it.t=="n")_s(V,23,N(Me,Fe,ve,it.v));else{var Tr=$a(it);_s(V,22,v(Me,Fe,ve,Tr.slice(0,239)))}}++ve}}return _s(V,1),V.end()}function i(T){var L=Et(2);return L.write_shift(2,T),L}function l(T){var L=Et(26);L.write_shift(2,4096),L.write_shift(2,4),L.write_shift(4,0);for(var B=0,V=0,te=0,ue=0;ue<T.SheetNames.length;++ue){var ve=T.SheetNames[ue],pe=T.Sheets[ve];if(!(!pe||!pe["!ref"])){++te;var le=Kl(pe["!ref"]);B<le.e.r&&(B=le.e.r),V<le.e.c&&(V=le.e.c)}}return B>8191&&(B=8191),L.write_shift(2,B),L.write_shift(1,te),L.write_shift(1,V),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(1,1),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(4,0),L}function o(T,L,B){var V={s:{c:0,r:0},e:{c:0,r:0}};return L==8&&B.qpro?(V.s.c=T.read_shift(1),T.l++,V.s.r=T.read_shift(2),V.e.c=T.read_shift(1),T.l++,V.e.r=T.read_shift(2),V):(V.s.c=T.read_shift(2),V.s.r=T.read_shift(2),L==12&&B.qpro&&(T.l+=2),V.e.c=T.read_shift(2),V.e.r=T.read_shift(2),L==12&&B.qpro&&(T.l+=2),V.s.c==65535&&(V.s.c=V.e.c=V.s.r=V.e.r=0),V)}function c(T){var L=Et(8);return L.write_shift(2,T.s.c),L.write_shift(2,T.s.r),L.write_shift(2,T.e.c),L.write_shift(2,T.e.r),L}function u(T,L,B){var V=[{c:0,r:0},{t:"n",v:0},0,0];return B.qpro&&B.vers!=20768?(V[0].c=T.read_shift(1),V[3]=T.read_shift(1),V[0].r=T.read_shift(2),T.l+=2):(V[2]=T.read_shift(1),V[0].c=T.read_shift(2),V[0].r=T.read_shift(2)),V}function d(T,L,B){var V=T.l+L,te=u(T,L,B);if(te[1].t="s",B.vers==20768){T.l++;var ue=T.read_shift(1);return te[1].v=T.read_shift(ue,"utf8"),te}return B.qpro&&T.l++,te[1].v=T.read_shift(V-T.l,"cstr"),te}function f(T,L,B){var V=Et(7+B.length);V.write_shift(1,255),V.write_shift(2,L),V.write_shift(2,T),V.write_shift(1,39);for(var te=0;te<V.length;++te){var ue=B.charCodeAt(te);V.write_shift(1,ue>=128?95:ue)}return V.write_shift(1,0),V}function h(T,L,B){var V=u(T,L,B);return V[1].v=T.read_shift(2,"i"),V}function x(T,L,B){var V=Et(7);return V.write_shift(1,255),V.write_shift(2,L),V.write_shift(2,T),V.write_shift(2,B,"i"),V}function m(T,L,B){var V=u(T,L,B);return V[1].v=T.read_shift(8,"f"),V}function p(T,L,B){var V=Et(13);return V.write_shift(1,255),V.write_shift(2,L),V.write_shift(2,T),V.write_shift(8,B,"f"),V}function w(T,L,B){var V=T.l+L,te=u(T,L,B);if(te[1].v=T.read_shift(8,"f"),B.qpro)T.l=V;else{var ue=T.read_shift(2);j(T.slice(T.l,T.l+ue),te),T.l+=ue}return te}function b(T,L,B){var V=L&32768;return L&=-32769,L=(V?T:0)+(L>=8192?L-16384:L),(V?"":"$")+(B?Pt(L):Xt(L))}var g={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function j(T,L){qt(T,0);for(var B=[],V=0,te="",ue="",ve="",pe="";T.l<T.length;){var le=T[T.l++];switch(le){case 0:B.push(T.read_shift(8,"f"));break;case 1:ue=b(L[0].c,T.read_shift(2),!0),te=b(L[0].r,T.read_shift(2),!1),B.push(ue+te);break;case 2:{var ke=b(L[0].c,T.read_shift(2),!0),U=b(L[0].r,T.read_shift(2),!1);ue=b(L[0].c,T.read_shift(2),!0),te=b(L[0].r,T.read_shift(2),!1),B.push(ke+U+":"+ue+te)}break;case 3:if(T.l<T.length){console.error("WK1 premature formula end");return}break;case 4:B.push("("+B.pop()+")");break;case 5:B.push(T.read_shift(2));break;case 6:{for(var rt="";le=T[T.l++];)rt+=String.fromCharCode(le);B.push('"'+rt.replace(/"/g,'""')+'"')}break;case 8:B.push("-"+B.pop());break;case 23:B.push("+"+B.pop());break;case 22:B.push("NOT("+B.pop()+")");break;case 20:case 21:pe=B.pop(),ve=B.pop(),B.push(["AND","OR"][le-20]+"("+ve+","+pe+")");break;default:if(le<32&&y[le])pe=B.pop(),ve=B.pop(),B.push(ve+y[le]+pe);else if(g[le]){if(V=g[le][1],V==69&&(V=T[T.l++]),V>B.length){console.error("WK1 bad formula parse 0x"+le.toString(16)+":|"+B.join("|")+"|");return}var Me=B.slice(-V);B.length-=V,B.push(g[le][0]+"("+Me.join(",")+")")}else return le<=7?console.error("WK1 invalid opcode "+le.toString(16)):le<=24?console.error("WK1 unsupported op "+le.toString(16)):le<=30?console.error("WK1 invalid opcode "+le.toString(16)):le<=115?console.error("WK1 unsupported function opcode "+le.toString(16)):console.error("WK1 unrecognized opcode "+le.toString(16))}}B.length==1?L[1].f=""+B[0]:console.error("WK1 bad formula parse |"+B.join("|")+"|")}function A(T){var L=[{c:0,r:0},{t:"n",v:0},0];return L[0].r=T.read_shift(2),L[3]=T[T.l++],L[0].c=T[T.l++],L}function k(T,L){var B=A(T);return B[1].t="s",B[1].v=T.read_shift(L-4,"cstr"),B}function v(T,L,B,V){var te=Et(6+V.length);te.write_shift(2,T),te.write_shift(1,B),te.write_shift(1,L),te.write_shift(1,39);for(var ue=0;ue<V.length;++ue){var ve=V.charCodeAt(ue);te.write_shift(1,ve>=128?95:ve)}return te.write_shift(1,0),te}function E(T,L){var B=A(T);B[1].v=T.read_shift(2);var V=B[1].v>>1;if(B[1].v&1)switch(V&7){case 0:V=(V>>3)*5e3;break;case 1:V=(V>>3)*500;break;case 2:V=(V>>3)/20;break;case 3:V=(V>>3)/200;break;case 4:V=(V>>3)/2e3;break;case 5:V=(V>>3)/2e4;break;case 6:V=(V>>3)/16;break;case 7:V=(V>>3)/64;break}return B[1].v=V,B}function S(T,L){var B=A(T),V=T.read_shift(4),te=T.read_shift(4),ue=T.read_shift(2);if(ue==65535)return V===0&&te===3221225472?(B[1].t="e",B[1].v=15):V===0&&te===3489660928?(B[1].t="e",B[1].v=42):B[1].v=0,B;var ve=ue&32768;return ue=(ue&32767)-16446,B[1].v=(1-ve*2)*(te*Math.pow(2,ue+32)+V*Math.pow(2,ue)),B}function N(T,L,B,V){var te=Et(14);if(te.write_shift(2,T),te.write_shift(1,B),te.write_shift(1,L),V==0)return te.write_shift(4,0),te.write_shift(4,0),te.write_shift(2,65535),te;var ue=0,ve=0,pe=0,le=0;return V<0&&(ue=1,V=-V),ve=Math.log2(V)|0,V/=Math.pow(2,ve-31),le=V>>>0,le&2147483648||(V/=2,++ve,le=V>>>0),V-=le,le|=2147483648,le>>>=0,V*=Math.pow(2,32),pe=V>>>0,te.write_shift(4,pe),te.write_shift(4,le),ve+=16383+(ue?32768:0),te.write_shift(2,ve),te}function D(T,L){var B=S(T);return T.l+=L-14,B}function F(T,L){var B=A(T),V=T.read_shift(4);return B[1].v=V>>6,B}function Y(T,L){var B=A(T),V=T.read_shift(8,"f");return B[1].v=V,B}function Q(T,L){var B=Y(T);return T.l+=L-10,B}function ae(T,L){return T[T.l+L-1]==0?T.read_shift(L,"cstr"):""}function ee(T,L){var B=T[T.l++];B>L-1&&(B=L-1);for(var V="";V.length<B;)V+=String.fromCharCode(T[T.l++]);return V}function fe(T,L,B){if(!(!B.qpro||L<21)){var V=T.read_shift(1);T.l+=17,T.l+=1,T.l+=2;var te=T.read_shift(L-21,"cstr");return[V,te]}}function se(T,L){for(var B={},V=T.l+L;T.l<V;){var te=T.read_shift(2);if(te==14e3){for(B[te]=[0,""],B[te][0]=T.read_shift(2);T[T.l];)B[te][1]+=String.fromCharCode(T[T.l]),T.l++;T.l++}}return B}function H(T,L){var B=Et(5+T.length);B.write_shift(2,14e3),B.write_shift(2,L);for(var V=0;V<T.length;++V){var te=T.charCodeAt(V);B[B.l++]=te>127?95:te}return B[B.l++]=0,B}var ne={0:{n:"BOF",f:Ct},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ae},222:{n:"SHEETNAMELP",f:ee},65535:{n:""}},W={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:E},25:{n:"FORMULA19",f:D},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:se},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:F},38:{n:"??"},39:{n:"NUMBER27",f:Y},40:{n:"FORMULA28",f:Q},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ae},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:fe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:n,to_workbook:t}}();function iO(e){var t={},r=e.match(mr),s=0,n=!1;if(r)for(;s!=r.length;++s){var i=Ne(r[s]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=xx[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(i[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+i[0])}}return t}var lO=function(){var e=jc("t"),t=jc("rPr");function r(i){var l=i.match(e);if(!l)return{t:"s",v:""};var o={t:"s",v:Ve(l[1])},c=i.match(t);return c&&(o.s=iO(c[1])),o}var s=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(l){return l.replace(s,"").split(n).map(r).filter(function(o){return o.v})}}(),oO=function(){var t=/(\r\n|\n)/g;function r(n,i,l){var o=[];n.u&&o.push("text-decoration: underline;"),n.uval&&o.push("text-underline-style:"+n.uval+";"),n.sz&&o.push("font-size:"+n.sz+"pt;"),n.outline&&o.push("text-effect: outline;"),n.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),n.b&&(i.push("<b>"),l.push("</b>")),n.i&&(i.push("<i>"),l.push("</i>")),n.strike&&(i.push("<s>"),l.push("</s>"));var c=n.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),l.push("</"+c+">")),l.push("</span>"),n}function s(n){var i=[[],n.v,[]];return n.v?(n.s&&r(n.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(s).join("")}}(),cO=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,uO=/<(?:\w+:)?r>/,dO=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Px(e,t){var r=t?t.cellHTML:!0,s={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(s.t=Ve(Ze(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),s.r=Ze(e),r&&(s.h=Nx(s.t))):e.match(uO)&&(s.r=Ze(e),s.t=Ve(Ze((e.replace(dO,"").match(cO)||[]).join("").replace(mr,""))),r&&(s.h=oO(lO(s.r)))),s):{t:""}}var fO=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,hO=/<(?:\w+:)?(?:si|sstItem)>/g,mO=/<\/(?:\w+:)?(?:si|sstItem)>/;function pO(e,t){var r=[],s="";if(!e)return r;var n=e.match(fO);if(n){s=n[2].replace(hO,"").split(mO);for(var i=0;i!=s.length;++i){var l=Px(s[i].trim(),t);l!=null&&(r[r.length]=l)}n=Ne(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}function xO(e){return[e.read_shift(4),e.read_shift(4)]}function gO(e,t){var r=[],s=!1;return za(e,function(i,l,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:s=!0;break;case 36:s=!1;break;default:if(l.T,!s||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function G_(e){for(var t=[],r=e.split(""),s=0;s<r.length;++s)t[s]=r[s].charCodeAt(0);return t}function Ra(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function yO(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Ra(e,4),t.U=Ra(e,4),t.W=Ra(e,4),t}function vO(e){for(var t=e.read_shift(4),r=e.l+t-4,s={},n=e.read_shift(4),i=[];n-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(s.name=e.read_shift(0,"lpp4"),s.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return s}function wO(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(vO(e));return t}function bO(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function jO(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Ra(e,4),t.U=Ra(e,4),t.W=Ra(e,4),t}function NO(e){var t=jO(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function q_(e,t){var r=e.l+t,s={};s.Flags=e.read_shift(4)&63,e.l+=4,s.AlgID=e.read_shift(4);var n=!1;switch(s.AlgID){case 26126:case 26127:case 26128:n=s.Flags==36;break;case 26625:n=s.Flags==4;break;case 0:n=s.Flags==16||s.Flags==4||s.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+s.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return s.AlgIDHash=e.read_shift(4),s.KeySize=e.read_shift(4),s.ProviderType=e.read_shift(4),e.l+=8,s.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,s}function Y_(e,t){var r={},s=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,s),e.l=s,r}function _O(e){var t=Ra(e);switch(t.Minor){case 2:return[t.Minor,kO(e)];case 3:return[t.Minor,SO()];case 4:return[t.Minor,CO(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function kO(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),s=q_(e,r),n=Y_(e,e.length-e.l);return{t:"Std",h:s,v:n}}function SO(){throw new Error("File is password-protected: ECMA-376 Extensible")}function CO(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),s={};return r.replace(mr,function(i){var l=Ne(i);switch(ma(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){s[o]=l[o]});break;case"<dataIntegrity":s.encryptedHmacKey=l.encryptedHmacKey,s.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":s.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":s.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":s.encs.push(l);break;default:throw l[0]}}),s}function TO(e,t){var r={},s=r.EncryptionVersionInfo=Ra(e,4);if(t-=4,s.Minor!=2)throw new Error("unrecognized minor version code: "+s.Minor);if(s.Major>4||s.Major<2)throw new Error("unrecognized major version code: "+s.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=q_(e,n),t-=n,r.EncryptionVerifier=Y_(e,t),r}function EO(e){var t={},r=t.EncryptionVersionInfo=Ra(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function AO(e){var t=0,r,s=G_(e),n=s.length+1,i,l,o,c,u;for(r=An(n),r[0]=s.length,i=1;i!=n;++i)r[i]=s[i-1];for(i=n-1;i>=0;--i)l=r[i],o=t&16384?1:0,c=t<<1&32767,u=o|c,t=u^l;return t^52811}var K_=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],s=function(l){return(l/2|l*128)&255},n=function(l,o){return s(l^o)},i=function(l){for(var o=t[l.length-1],c=104,u=l.length-1;u>=0;--u)for(var d=l[u],f=0;f!=7;++f)d&64&&(o^=r[c]),d*=2,--c;return o};return function(l){for(var o=G_(l),c=i(o),u=o.length,d=An(16),f=0;f!=16;++f)d[f]=0;var h,x,m;for((u&1)===1&&(h=c>>8,d[u]=n(e[0],h),--u,h=c&255,x=o[o.length-1],d[u]=n(x,h));u>0;)--u,h=c>>8,d[u]=n(o[u],h),--u,h=c&255,d[u]=n(o[u],h);for(u=15,m=15-o.length;m>0;)h=c>>8,d[u]=n(e[m],h),--u,--m,h=c&255,d[u]=n(o[u],h),--u,--m;return d}}(),FO=function(e,t,r,s,n){n||(n=t),s||(s=K_(e));var i,l;for(i=0;i!=t.length;++i)l=t[i],l^=s[r],l=(l>>5|l<<3)&255,n[i]=l,++r;return[n,r,s]},RO=function(e){var t=0,r=K_(e);return function(s){var n=FO("",s,t,r);return t=n[1],n[0]}};function PO(e,t,r,s){var n={key:Ct(e),verificationBytes:Ct(e)};return r.password&&(n.verifier=AO(r.password)),s.valid=n.verificationBytes===n.verifier,s.valid&&(s.insitu=RO(r.password)),n}function DO(e,t,r){var s=r||{};return s.Info=e.read_shift(2),e.l-=2,s.Info===1?s.Data=EO(e):s.Data=TO(e,t),s}function IO(e,t,r){var s={Type:r.biff>=8?e.read_shift(2):0};return s.Type?DO(e,t-2,s):PO(e,r.biff>=8?t:t-2,r,s),s}var OO=function(){function e(n,i){switch(i.type){case"base64":return t(Zr(n),i);case"binary":return t(n,i);case"buffer":return t(Oe&&Buffer.isBuffer(n)?n.toString("binary"):Mi(n),i);case"array":return t(Ci(n),i)}throw new Error("Unrecognized type "+i.type)}function t(n,i){var l=i||{},o=l.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,x=0,m,p=-1;m=h.exec(d);){switch(m[0]){case"\\cell":var w=d.slice(x,h.lastIndex-m[0].length);if(w[0]==" "&&(w=w.slice(1)),++p,w.length){var b={v:w,t:"s"};Array.isArray(o)?o[f][p]=b:o[Se({r:f,c:p})]=b}break}x=h.lastIndex}p>u.e.c&&(u.e.c=p)}),o["!ref"]=Be(u),o}function r(n,i){return Mn(e(n,i),i)}function s(n){for(var i=["{\\rtf1\\ansi"],l=yt(n["!ref"]),o,c=Array.isArray(n),u=l.s.r;u<=l.e.r;++u){i.push("\\trowd\\trautofit1");for(var d=l.s.c;d<=l.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=l.s.c;d<=l.e.c;++d){var f=Se({r:u,c:d});o=c?(n[u]||[])[d]:n[f],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||($a(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:s}}();function MO(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function kc(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function LO(e){var t=e[0]/255,r=e[1]/255,s=e[2]/255,n=Math.max(t,r,s),i=Math.min(t,r,s),l=n-i;if(l===0)return[0,0,t];var o=0,c=0,u=n+i;switch(c=l/(u>1?2-u:u),n){case t:o=((r-s)/l+6)%6;break;case r:o=(s-t)/l+2;break;case s:o=(t-r)/l+4;break}return[o/6,c,u/2]}function BO(e){var t=e[0],r=e[1],s=e[2],n=r*2*(s<.5?s:1-s),i=s-n/2,l=[i,i,i],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=n*o,l[0]+=n,l[1]+=c;break;case 1:c=n*(2-o),l[0]+=c,l[1]+=n;break;case 2:c=n*(o-2),l[1]+=n,l[2]+=c;break;case 3:c=n*(4-o),l[1]+=c,l[2]+=n;break;case 4:c=n*(o-4),l[2]+=n,l[0]+=c;break;case 5:c=n*(6-o),l[2]+=c,l[0]+=n;break}for(var u=0;u!=3;++u)l[u]=Math.round(l[u]*255);return l}function i0(e,t){if(t===0)return e;var r=LO(MO(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),kc(BO(r))}var X_=6,UO=15,$O=1,br=X_;function l0(e){return Math.floor((e+Math.round(128/br)/256)*br)}function o0(e){return Math.floor((e-5)/br*100+.5)/100}function Rm(e){return Math.round((e*br+5)/br*256)/256}function th(e){return Rm(o0(l0(e)))}function Dx(e){var t=Math.abs(e-th(e)),r=br;if(t>.005)for(br=$O;br<UO;++br)Math.abs(e-th(e))<=t&&(t=Math.abs(e-th(e)),r=br);br=r}function Ul(e){e.width?(e.wpx=l0(e.width),e.wch=o0(e.wpx),e.MDW=br):e.wpx?(e.wch=o0(e.wpx),e.width=Rm(e.wch),e.MDW=br):typeof e.wch=="number"&&(e.width=Rm(e.wch),e.wpx=l0(e.width),e.MDW=br),e.customWidth&&delete e.customWidth}var VO=96,Q_=VO;function J_(e){return e*96/Q_}function Sc(e){return e*Q_/96}var zO={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function HO(e,t,r,s){t.Borders=[];var n={},i=!1;(e[0].match(mr)||[]).forEach(function(l){var o=Ne(l);switch(ma(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},o.diagonalUp&&(n.diagonalUp=st(o.diagonalUp)),o.diagonalDown&&(n.diagonalDown=st(o.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function WO(e,t,r,s){t.Fills=[];var n={},i=!1;(e[0].match(mr)||[]).forEach(function(l){var o=Ne(l);switch(ma(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":o.patternType&&(n.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),o.indexed&&(n.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(n.bgColor.theme=parseInt(o.theme,10)),o.tint&&(n.bgColor.tint=parseFloat(o.tint)),o.rgb&&(n.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),o.theme&&(n.fgColor.theme=parseInt(o.theme,10)),o.tint&&(n.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(n.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function GO(e,t,r,s){t.Fonts=[];var n={},i=!1;(e[0].match(mr)||[]).forEach(function(l){var o=Ne(l);switch(ma(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":o.val&&(n.name=Ze(o.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=o.val?st(o.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=o.val?st(o.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(o.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=o.val?st(o.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=o.val?st(o.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=o.val?st(o.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=o.val?st(o.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=o.val?st(o.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":o.val&&(n.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(n.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(n.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(n.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=xx[parseInt(o.val,10)];break;case"<color":if(n.color||(n.color={}),o.auto&&(n.color.auto=st(o.auto)),o.rgb)n.color.rgb=o.rgb.slice(-6);else if(o.indexed){n.color.index=parseInt(o.indexed,10);var c=yi[n.color.index];n.color.index==81&&(c=yi[1]),c||(c=yi[1]),n.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(n.color.theme=parseInt(o.theme,10),o.tint&&(n.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=i0(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function qO(e,t,r){t.NumberFmt=[];for(var s=da(Te),n=0;n<s.length;++n)t.NumberFmt[s[n]]=Te[s[n]];var i=e[0].match(mr);if(i)for(n=0;n<i.length;++n){var l=Ne(i[n]);switch(ma(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Ve(Ze(l.formatCode)),c=parseInt(l.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}gi(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}var Gu=["numFmtId","fillId","fontId","borderId","xfId"],qu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function YO(e,t,r){t.CellXf=[];var s,n=!1;(e[0].match(mr)||[]).forEach(function(i){var l=Ne(i),o=0;switch(ma(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(s=l,delete s[0],o=0;o<Gu.length;++o)s[Gu[o]]&&(s[Gu[o]]=parseInt(s[Gu[o]],10));for(o=0;o<qu.length;++o)s[qu[o]]&&(s[qu[o]]=st(s[qu[o]]));if(t.NumberFmt&&s.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[s.numFmtId]==t.NumberFmt[o]){s.numFmtId=o;break}}t.CellXf.push(s);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};l.vertical&&(c.vertical=l.vertical),l.horizontal&&(c.horizontal=l.horizontal),l.textRotation!=null&&(c.textRotation=l.textRotation),l.indent&&(c.indent=l.indent),l.wrapText&&(c.wrapText=st(l.wrapText)),s.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}var KO=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,s=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,u){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&qO(f,d,u),(f=o.match(n))&&GO(f,d,c,u),(f=o.match(s))&&WO(f,d,c,u),(f=o.match(i))&&HO(f,d,c,u),(f=o.match(r))&&YO(f,d,u),d}}();function XO(e,t){var r=e.read_shift(2),s=dr(e);return[r,s]}function QO(e,t,r){var s={};s.sz=e.read_shift(2)/20;var n=lD(e);n.fItalic&&(s.italic=1),n.fCondense&&(s.condense=1),n.fExtend&&(s.extend=1),n.fShadow&&(s.shadow=1),n.fOutline&&(s.outline=1),n.fStrikeout&&(s.strike=1);var i=e.read_shift(2);switch(i===700&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(s.underline=l);var o=e.read_shift(1);o>0&&(s.family=o);var c=e.read_shift(1);switch(c>0&&(s.charset=c),e.l++,s.color=iD(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=dr(e),s}var JO=hr;function ZO(e,t){var r=e.l+t,s=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:s,numFmtId:n}}var e9=hr;function t9(e,t,r){var s={};s.NumberFmt=[];for(var n in Te)s.NumberFmt[n]=Te[n];s.CellXf=[],s.Fonts=[];var i=[],l=!1;return za(e,function(c,u,d){switch(d){case 44:s.NumberFmt[c[0]]=c[1],gi(c[1],c[0]);break;case 43:s.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=i0(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&s.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:i.push(d),l=!0;break;case 38:i.pop(),l=!1;break;default:if(u.T>0)i.push(d);else if(u.T<0)i.pop();else if(!l||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),s}var r9=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function s9(e,t,r){t.themeElements.clrScheme=[];var s={};(e[0].match(mr)||[]).forEach(function(n){var i=Ne(n);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":s.rgb=i.val;break;case"<a:sysClr":s.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[r9.indexOf(i[0])]=s,s={}):s.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function a9(){}function n9(){}var i9=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,l9=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,o9=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function c9(e,t,r){t.themeElements={};var s;[["clrScheme",i9,s9],["fontScheme",l9,a9],["fmtScheme",o9,n9]].forEach(function(n){if(!(s=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](s,t,r)})}var u9=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Z_(e,t){(!e||e.length===0)&&(e=d9());var r,s={};if(!(r=e.match(u9)))throw new Error("themeElements not found in theme");return c9(r[0],s,t),s.raw=e,s}function d9(e,t){var r=[u_];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function f9(e,t,r){var s=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=s;return}var i=e.slice(e.l);e.l=s;var l;try{l=c_(i,{type:"array"})}catch{return}var o=Gr(l,"theme/theme/theme1.xml",!0);if(o)return Z_(o,r)}}function h9(e){return e.read_shift(4)}function m9(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=p9(e,4);break;case 2:t.xclrValue=B_(e);break;case 3:t.xclrValue=h9(e);break;case 4:e.l+=4;break}return e.l+=8,t}function p9(e,t){return hr(e,t)}function x9(e,t){return hr(e,t)}function g9(e){var t=e.read_shift(2),r=e.read_shift(2)-4,s=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:s[1]=m9(e);break;case 6:s[1]=x9(e,r);break;case 14:case 15:s[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return s}function y9(e,t){var r=e.l+t;e.l+=2;var s=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),i=[];n-- >0;)i.push(g9(e,r-e.l));return{ixfe:s,ext:i}}function v9(e,t){t.forEach(function(r){switch(r[0]){}})}function w9(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:dr(e)}}function b9(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function j9(e){return e.l+=4,e.read_shift(4)!=0}function N9(e,t,r){var s={Types:[],Cell:[],Value:[]},n=r||{},i=[],l=!1,o=2;return za(e,function(c,u,d){switch(d){case 335:s.Types.push({name:c.name});break;case 51:c.forEach(function(f){o==1?s.Cell.push({type:s.Types[f[0]-1].name,index:f[1]}):o==0&&s.Value.push({type:s.Types[f[0]-1].name,index:f[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:i.push(d),l=!0;break;case 36:i.pop(),l=!1;break;default:if(!u.T){if(!l||n.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),s}function _9(e,t,r){var s={Types:[],Cell:[],Value:[]};if(!e)return s;var n=!1,i=2,l;return e.replace(mr,function(o){var c=Ne(o);switch(ma(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":s.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<s.Types.length;++u)s.Types[u].name==c.name&&(l=s.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?s.Cell.push({type:s.Types[c.t-1].name,index:+c.v}):i==0&&s.Value.push({type:s.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+c.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),s}function k9(e){var t=[];if(!e)return t;var r=1;return(e.match(mr)||[]).forEach(function(s){var n=Ne(s);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function S9(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Se(r);var s=e.read_shift(1);return s&2&&(t.l="1"),s&8&&(t.a="1"),t}function C9(e,t,r){var s=[];return za(e,function(i,l,o){switch(o){case 63:s.push(i);break;default:if(!l.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),s}function T9(e,t,r,s){if(!e)return e;var n=s||{},i=!1;za(e,function(o,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||n.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},n)}function E9(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function Bv(e,t,r,s){var n=Array.isArray(e),i;t.forEach(function(l){var o=jr(l.ref);if(n?(e[o.r]||(e[o.r]=[]),i=e[o.r][o.c]):i=e[l.ref],!i){i={t:"z"},n?e[o.r][o.c]=i:e[l.ref]=i;var c=yt(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var u=Be(c);u!==e["!ref"]&&(e["!ref"]=u)}i.c||(i.c=[]);var d={a:l.author,t:l.t,r:l.r,T:r};l.h&&(d.h=l.h);for(var f=i.c.length-1;f>=0;--f){if(!r&&i.c[f].T)return;r&&!i.c[f].T&&i.c.splice(f,1)}if(r&&s){for(f=0;f<s.length;++f)if(d.a==s[f].id){d.a=s[f].name||d.a;break}}i.c.push(d)})}function A9(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],s=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=Ne(o[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=jr(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&Px(f[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),s.push(u)}}}}),s}function F9(e,t){var r=[],s=!1,n={},i=0;return e.replace(mr,function(o,c){var u=Ne(o);switch(ma(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":i=c+o.length;break;case"</text>":n.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":s=!0;break;case"</mentions>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function R9(e,t){var r=[],s=!1;return e.replace(mr,function(i){var l=Ne(i);switch(ma(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),r}function P9(e){var t={};t.iauthor=e.read_shift(4);var r=Bi(e);return t.rfx=r.s,t.ref=Se(r.s),e.l+=16,t}var D9=dr;function I9(e,t){var r=[],s=[],n={},i=!1;return za(e,function(o,c,u){switch(u){case 632:s.push(o);break;case 635:n=o;break;case 637:n.t=o.t,n.h=o.h,n.r=o.r;break;case 636:if(n.author=s[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}var O9="application/vnd.ms-office.vbaProject";function M9(e){var t=Le.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,s){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Le.utils.cfb_add(t,n,e.FileIndex[s].content)}}),Le.write(t)}function L9(){return{"!type":"dialog"}}function B9(){return{"!type":"dialog"}}function U9(){return{"!type":"macro"}}function $9(){return{"!type":"macro"}}var yl=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(s,n,i,l){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),l.length==0?o=!0:l.charAt(0)=="["&&(o=!0,l=l.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,d=l.length>0?parseInt(l,10)|0:0;return o?d+=t.c:--d,c?u+=t.r:--u,n+(o?"":"$")+Pt(d)+(c?"":"$")+Xt(u)}return function(n,i){return t=i,n.replace(e,r)}}(),e4=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,V9=function(){return function(t,r){return t.replace(e4,function(s,n,i,l,o,c){var u=Cx(l)-(i?0:r.c),d=Sx(c)-(o?0:r.r),f=d==0?"":o?d+1:"["+d+"]",h=u==0?"":i?u+1:"["+u+"]";return n+"R"+f+"C"+h})}}();function t4(e,t){return e.replace(e4,function(r,s,n,i,l,o){return s+(n=="$"?n+i:Pt(Cx(i)+t.c))+(l=="$"?l+o:Xt(Sx(o)+t.r))})}function z9(e,t,r){var s=Kl(t),n=s.s,i=jr(r),l={r:i.r-n.r,c:i.c-n.c};return t4(e,l)}function H9(e){return e.length!=1}function Uv(e){return e.replace(/_xlfn\./g,"")}function _t(e){e.l+=1}function Fn(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function r4(e,t,r){var s=2;if(r){if(r.biff>=2&&r.biff<=5)return s4(e);r.biff==12&&(s=4)}var n=e.read_shift(s),i=e.read_shift(s),l=Fn(e),o=Fn(e);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function s4(e){var t=Fn(e),r=Fn(e),s=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:s,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function W9(e,t,r){if(r.biff<8)return s4(e);var s=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),i=Fn(e),l=Fn(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:l[0],cRel:l[1],rRel:l[2]}}}function a4(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return G9(e);var s=e.read_shift(r&&r.biff==12?4:2),n=Fn(e);return{r:s,c:n[0],cRel:n[1],rRel:n[2]}}function G9(e){var t=Fn(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function q9(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Y9(e,t,r){var s=r&&r.biff?r.biff:8;if(s>=2&&s<=5)return K9(e);var n=e.read_shift(s>=12?4:2),i=e.read_shift(2),l=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;n>524287;)n-=1048576;if(l==1)for(;i>8191;)i=i-16384;return{r:n,c:i,cRel:l,rRel:o}}function K9(e){var t=e.read_shift(2),r=e.read_shift(1),s=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,s==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:s}}function X9(e,t,r){var s=(e[e.l++]&96)>>5,n=r4(e,r.biff>=2&&r.biff<=5?6:8,r);return[s,n]}function Q9(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var l=r4(e,i,r);return[s,n,l]}function J9(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[s]}function Z9(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[s,n]}function eM(e,t,r){var s=(e[e.l++]&96)>>5,n=W9(e,t-1,r);return[s,n]}function tM(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[s]}function $v(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function rM(e,t,r){e.l+=2;for(var s=e.read_shift(r&&r.biff==2?1:2),n=[],i=0;i<=s;++i)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function sM(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function aM(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function nM(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function iM(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[s]}function n4(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function lM(e){return e.read_shift(2),n4(e)}function oM(e){return e.read_shift(2),n4(e)}function cM(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=a4(e,0,r);return[s,n]}function uM(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=Y9(e,0,r);return[s,n]}function dM(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=a4(e,0,r);return[s,n,i]}function fM(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[hL[n],o4[n],s]}function hM(e,t,r){var s=e[e.l++],n=e.read_shift(1),i=r&&r.biff<=3?[s==88?-1:0,e.read_shift(1)]:mM(e);return[n,(i[0]===0?o4:fL)[i[1]]]}function mM(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function pM(e,t,r){e.l+=r&&r.biff==2?3:4}function xM(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var s=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function gM(e){return e.l++,Ui[e.read_shift(1)]}function yM(e){return e.l++,e.read_shift(2)}function vM(e){return e.l++,e.read_shift(1)!==0}function wM(e){return e.l++,lr(e)}function bM(e,t,r){return e.l++,Yc(e,t-1,r)}function jM(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=wt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Ui[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=lr(e);break;case 2:r[1]=$i(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function NM(e,t,r){for(var s=e.read_shift(r.biff==12?4:2),n=[],i=0;i!=s;++i)n.push((r.biff==12?Bi:J0)(e));return n}function _M(e,t,r){var s=0,n=0;r.biff==12?(s=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),s=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--s,--n==0&&(n=256));for(var i=0,l=[];i!=s&&(l[i]=[]);++i)for(var o=0;o!=n;++o)l[i][o]=jM(e,r.biff);return l}function kM(e,t,r){var s=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,i=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[s,0,i]}function SM(e,t,r){if(r.biff==5)return CM(e);var s=e.read_shift(1)>>>5&3,n=e.read_shift(2),i=e.read_shift(4);return[s,n,i]}function CM(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[t,r,s]}function TM(e,t,r){var s=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function EM(e,t,r){var s=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function AM(e,t,r){var s=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[s]}function FM(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[s,n]}var RM=hr,PM=hr,DM=hr;function Xc(e,t,r){return e.l+=2,[q9(e)]}function Ix(e){return e.l+=6,[]}var IM=Xc,OM=Ix,MM=Ix,LM=Xc;function i4(e){return e.l+=2,[Ct(e),e.read_shift(2)&1]}var BM=Xc,UM=i4,$M=Ix,VM=Xc,zM=Xc,HM=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function WM(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),n=e.read_shift(2),i=e.read_shift(2),l=HM[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:s,c:n,C:i}}function GM(e){return e.l+=2,[e.read_shift(4)]}function qM(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function YM(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function KM(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function XM(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function QM(e){return e.l+=4,[0,0]}var Vv={1:{n:"PtgExp",f:xM},2:{n:"PtgTbl",f:DM},3:{n:"PtgAdd",f:_t},4:{n:"PtgSub",f:_t},5:{n:"PtgMul",f:_t},6:{n:"PtgDiv",f:_t},7:{n:"PtgPower",f:_t},8:{n:"PtgConcat",f:_t},9:{n:"PtgLt",f:_t},10:{n:"PtgLe",f:_t},11:{n:"PtgEq",f:_t},12:{n:"PtgGe",f:_t},13:{n:"PtgGt",f:_t},14:{n:"PtgNe",f:_t},15:{n:"PtgIsect",f:_t},16:{n:"PtgUnion",f:_t},17:{n:"PtgRange",f:_t},18:{n:"PtgUplus",f:_t},19:{n:"PtgUminus",f:_t},20:{n:"PtgPercent",f:_t},21:{n:"PtgParen",f:_t},22:{n:"PtgMissArg",f:_t},23:{n:"PtgStr",f:bM},26:{n:"PtgSheet",f:qM},27:{n:"PtgEndSheet",f:YM},28:{n:"PtgErr",f:gM},29:{n:"PtgBool",f:vM},30:{n:"PtgInt",f:yM},31:{n:"PtgNum",f:wM},32:{n:"PtgArray",f:tM},33:{n:"PtgFunc",f:fM},34:{n:"PtgFuncVar",f:hM},35:{n:"PtgName",f:kM},36:{n:"PtgRef",f:cM},37:{n:"PtgArea",f:X9},38:{n:"PtgMemArea",f:TM},39:{n:"PtgMemErr",f:RM},40:{n:"PtgMemNoMem",f:PM},41:{n:"PtgMemFunc",f:EM},42:{n:"PtgRefErr",f:AM},43:{n:"PtgAreaErr",f:J9},44:{n:"PtgRefN",f:uM},45:{n:"PtgAreaN",f:eM},46:{n:"PtgMemAreaN",f:KM},47:{n:"PtgMemNoMemN",f:XM},57:{n:"PtgNameX",f:SM},58:{n:"PtgRef3d",f:dM},59:{n:"PtgArea3d",f:Q9},60:{n:"PtgRefErr3d",f:FM},61:{n:"PtgAreaErr3d",f:Z9},255:{}},JM={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},ZM={1:{n:"PtgElfLel",f:i4},2:{n:"PtgElfRw",f:VM},3:{n:"PtgElfCol",f:IM},6:{n:"PtgElfRwV",f:zM},7:{n:"PtgElfColV",f:LM},10:{n:"PtgElfRadical",f:BM},11:{n:"PtgElfRadicalS",f:$M},13:{n:"PtgElfColS",f:OM},15:{n:"PtgElfColSV",f:MM},16:{n:"PtgElfRadicalLel",f:UM},25:{n:"PtgList",f:WM},29:{n:"PtgSxName",f:GM},255:{}},eL={0:{n:"PtgAttrNoop",f:QM},1:{n:"PtgAttrSemi",f:iM},2:{n:"PtgAttrIf",f:aM},4:{n:"PtgAttrChoose",f:rM},8:{n:"PtgAttrGoto",f:sM},16:{n:"PtgAttrSum",f:pM},32:{n:"PtgAttrBaxcel",f:$v},33:{n:"PtgAttrBaxcel",f:$v},64:{n:"PtgAttrSpace",f:lM},65:{n:"PtgAttrSpaceSemi",f:oM},128:{n:"PtgAttrIfError",f:nM},255:{}};function Qc(e,t,r,s){if(s.biff<8)return hr(e,t);for(var n=e.l+t,i=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=_M(e,0,s),i.push(r[l][1]);break;case"PtgMemArea":r[l][2]=NM(e,r[l][1],s),i.push(r[l][2]);break;case"PtgExp":s&&s.biff==12&&(r[l][1][1]=e.read_shift(4),i.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=n-e.l,t!==0&&i.push(hr(e,t)),i}function Jc(e,t,r){for(var s=e.l+t,n,i,l=[];s!=e.l;)t=s-e.l,i=e[e.l],n=Vv[i]||Vv[JM[i]],(i===24||i===25)&&(n=(i===24?ZM:eL)[e[e.l+1]]),!n||!n.f?hr(e,t):l.push([n.n,n.f(e,t,r)]);return l}function tL(e){for(var t=[],r=0;r<e.length;++r){for(var s=e[r],n=[],i=0;i<s.length;++i){var l=s[i];if(l)switch(l[0]){case 2:n.push('"'+l[1].replace(/"/g,'""')+'"');break;default:n.push(l[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var rL={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function sL(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function l4(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!s)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[s[0]][0]){case 357:return n=s[1]==-1?"#REF":e.SheetNames[s[1]],s[1]==s[2]?n:n+":"+e.SheetNames[s[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[s[0]][0];case 355:default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return n=s[1]==-1?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?n:n+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[s[0]][0][3]?(n=s[1]==-1?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?n:n+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function zv(e,t,r){var s=l4(e,t,r);return s=="#REF"?s:sL(s,r)}function ar(e,t,r,s,n){var i=n&&n.biff||8,l={s:{c:0,r:0}},o=[],c,u,d,f=0,h=0,x,m="";if(!e[0]||!e[0][0])return"";for(var p=-1,w="",b=0,g=e[0].length;b<g;++b){var y=e[0][b];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:w=gt(" ",e[0][p][1][1]);break;case 1:w=gt("\r",e[0][p][1][1]);break;default:if(w="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}u=u+w,p=-1}o.push(u+rL[y[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Mo(y[1][1],l,n),o.push(Lo(d,i));break;case"PtgRefN":d=r?Mo(y[1][1],r,n):y[1][1],o.push(Lo(d,i));break;case"PtgRef3d":f=y[1][1],d=Mo(y[1][2],l,n),m=zv(s,f,n),o.push(m+"!"+Lo(d,i));break;case"PtgFunc":case"PtgFuncVar":var j=y[1][0],A=y[1][1];j||(j=0),j&=127;var k=j==0?[]:o.slice(-j);o.length-=j,A==="User"&&(A=k.shift()),o.push(A+"("+k.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":x=Nv(y[1][1],r?{s:r}:l,n),o.push(Zf(x,n));break;case"PtgArea":x=Nv(y[1][1],l,n),o.push(Zf(x,n));break;case"PtgArea3d":f=y[1][1],x=y[1][2],m=zv(s,f,n),o.push(m+"!"+Zf(x,n));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=y[1][2];var v=(s.names||[])[h-1]||(s[0]||[])[h],E=v?v.Name:"SH33TJSNAME"+String(h);E&&E.slice(0,6)=="_xlfn."&&!n.xlfn&&(E=E.slice(6)),o.push(E);break;case"PtgNameX":var S=y[1][1];h=y[1][2];var N;if(n.biff<=5)S<0&&(S=-S),s[S]&&(N=s[S][h]);else{var D="";if(((s[S]||[])[0]||[])[0]==14849||(((s[S]||[])[0]||[])[0]==1025?s[S][h]&&s[S][h].itab>0&&(D=s.SheetNames[s[S][h].itab-1]+"!"):D=s.SheetNames[h-1]+"!"),s[S]&&s[S][h])D+=s[S][h].Name;else if(s[0]&&s[0][h])D+=s[0][h].Name;else{var F=(l4(s,S,n)||"").split(";;");F[h-1]?D=F[h-1]:D+="SH33TJSERRX"}o.push(D);break}N||(N={Name:"SH33TJSERRY"}),o.push(N.Name);break;case"PtgParen":var Y="(",Q=")";if(p>=0){switch(w="",e[0][p][1][0]){case 2:Y=gt(" ",e[0][p][1][1])+Y;break;case 3:Y=gt("\r",e[0][p][1][1])+Y;break;case 4:Q=gt(" ",e[0][p][1][1])+Q;break;case 5:Q=gt("\r",e[0][p][1][1])+Q;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(Y+o.pop()+Q);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:y[1][1],r:y[1][0]};var ae={c:r.c,r:r.r};if(s.sharedf[Se(d)]){var ee=s.sharedf[Se(d)];o.push(ar(ee,l,ae,s,n))}else{var fe=!1;for(c=0;c!=s.arrayf.length;++c)if(u=s.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(ar(u[1],l,ae,s,n)),fe=!0;break}fe||o.push(y[1])}break;case"PtgArray":o.push("{"+tL(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var se=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&p>=0&&se.indexOf(e[0][b][0])==-1){y=e[0][p];var H=!0;switch(y[1][0]){case 4:H=!1;case 0:w=gt(" ",y[1][1]);break;case 5:H=!1;case 1:w=gt("\r",y[1][1]);break;default:if(w="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((H?w:"")+o.pop()+(H?"":w)),p=-1}}if(o.length>1&&n.WTF)throw new Error("bad formula stack");return o[0]}function aL(e,t,r){var s=e.l+t,n=r.biff==2?1:2,i,l=e.read_shift(n);if(l==65535)return[[],hr(e,t-2)];var o=Jc(e,l,r);return t!==l+n&&(i=Qc(e,t-l-n,o,r)),e.l=s,[o,i]}function nL(e,t,r){var s=e.l+t,n=r.biff==2?1:2,i,l=e.read_shift(n);if(l==65535)return[[],hr(e,t-2)];var o=Jc(e,l,r);return t!==l+n&&(i=Qc(e,t-l-n,o,r)),e.l=s,[o,i]}function iL(e,t,r,s){var n=e.l+t,i=Jc(e,s,r),l;return n!==e.l&&(l=Qc(e,n-e.l,i,r)),[i,l]}function lL(e,t,r){var s=e.l+t,n,i=e.read_shift(2),l=Jc(e,i,r);return i==65535?[[],hr(e,t-2)]:(t!==i+2&&(n=Qc(e,s-i-2,l,r)),[l,n])}function oL(e){var t;if(Sa(e,e.l+6)!==65535)return[lr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function rh(e,t,r){var s=e.l+t,n=pa(e);r.biff==2&&++e.l;var i=oL(e),l=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=nL(e,s-e.l,r);return{cell:n,val:i[0],formula:o,shared:l>>3&1,tt:i[1]}}function Z0(e,t,r){var s=e.read_shift(4),n=Jc(e,s,r),i=e.read_shift(4),l=i>0?Qc(e,i,n,r):null;return[n,l]}var cL=Z0,ef=Z0,uL=Z0,dL=Z0,fL={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},o4={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},hL={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Hv(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function sh(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Vo={},vl={};function zo(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function c4(e,t,r,s,n,i){try{s.cellNF&&(e.z=Te[t])}catch(o){if(s.WTF)throw o}if(!(e.t==="z"&&!s.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Vt(e.v)),(!s||s.cellText!==!1)&&e.t!=="z")try{if(Te[t]==null&&gi(m8[t]||"General",t),e.t==="e")e.w=e.w||Ui[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=bc(e.v);else if(e.t==="d"){var l=kr(e.v);(l|0)===l?e.w=l.toString(10):e.w=bc(l)}else{if(e.v===void 0)return"";e.w=Si(e.v,vl)}else e.t==="d"?e.w=gs(t,kr(e.v),vl):e.w=gs(t,e.v,vl)}catch(o){if(s.WTF)throw o}if(s.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=i0(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),s.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=i0(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),s.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(s.WTF&&i.Fills)throw o}}}function mL(e,t){var r=yt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Be(r))}var pL=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,xL=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,gL=/<(?:\w:)?hyperlink [^>]*>/mg,yL=/"(\w*:\w*)"/,vL=/<(?:\w:)?col\b[^>]*[\/]?>/g,wL=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,bL=/<(?:\w:)?pageMargins[^>]*\/>/g,u4=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,jL=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,NL=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function _L(e,t,r,s,n,i,l){if(!e)return e;s||(s={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(xL);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var h=u.match(u4);h?Ox(h[0],o,n,r):(h=u.match(jL))&&kL(h[0],h[1]||"",o,n,r);var x=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(x>0){var m=u.slice(x,x+50).match(yL);m&&mL(o,m[1])}var p=u.match(NL);p&&p[1]&&FL(p[1],n);var w=[];if(t.cellStyles){var b=u.match(vL);b&&TL(w,b)}f&&RL(f[1],o,t,c,i,l);var g=d.match(wL);g&&(o["!autofilter"]=EL(g[0]));var y=[],j=d.match(pL);if(j)for(x=0;x!=j.length;++x)y[x]=yt(j[x].slice(j[x].indexOf('"')+1));var A=d.match(gL);A&&SL(o,A,s);var k=d.match(bL);if(k&&(o["!margins"]=CL(Ne(k[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Be(c)),t.sheetRows>0&&o["!ref"]){var v=yt(o["!ref"]);t.sheetRows<=+v.e.r&&(v.e.r=t.sheetRows-1,v.e.r>c.e.r&&(v.e.r=c.e.r),v.e.r<v.s.r&&(v.s.r=v.e.r),v.e.c>c.e.c&&(v.e.c=c.e.c),v.e.c<v.s.c&&(v.s.c=v.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Be(v))}return w.length>0&&(o["!cols"]=w),y.length>0&&(o["!merges"]=y),o}function Ox(e,t,r,s){var n=Ne(e);r.Sheets[s]||(r.Sheets[s]={}),n.codeName&&(r.Sheets[s].CodeName=Ve(Ze(n.codeName)))}function kL(e,t,r,s,n){Ox(e.slice(0,e.indexOf(">")),r,s,n)}function SL(e,t,r){for(var s=Array.isArray(e),n=0;n!=t.length;++n){var i=Ne(Ze(t[n]),!0);if(!i.ref)return;var l=((r||{})["!id"]||[])[i.id];l?(i.Target=l.Target,i.location&&(i.Target+="#"+Ve(i.location))):(i.Target="#"+Ve(i.location),l={Target:i.Target,TargetMode:"Internal"}),i.Rel=l,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=yt(i.ref),c=o.s.r;c<=o.e.r;++c)for(var u=o.s.c;u<=o.e.c;++u){var d=Se({c:u,r:c});s?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=i):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=i)}}}function CL(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function TL(e,t){for(var r=!1,s=0;s!=t.length;++s){var n=Ne(t[s],!0);n.hidden&&(n.hidden=st(n.hidden));var i=parseInt(n.min,10)-1,l=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,Dx(n.width)),Ul(n);i<=l;)e[i++]=Kt(n)}}function EL(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var AL=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function FL(e,t){t.Views||(t.Views=[{}]),(e.match(AL)||[]).forEach(function(r,s){var n=Ne(r);t.Views[s]||(t.Views[s]={}),+n.zoomScale&&(t.Views[s].zoom=+n.zoomScale),st(n.rightToLeft)&&(t.Views[s].RTL=!0)})}var RL=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,s=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,i=jc("v"),l=jc("f");return function(c,u,d,f,h,x){for(var m=0,p="",w=[],b=[],g=0,y=0,j=0,A="",k,v,E=0,S=0,N,D,F=0,Y=0,Q=Array.isArray(x.CellXf),ae,ee=[],fe=[],se=Array.isArray(u),H=[],ne={},W=!1,T=!!d.sheetStubs,L=c.split(t),B=0,V=L.length;B!=V;++B){p=L[B].trim();var te=p.length;if(te!==0){var ue=0;e:for(m=0;m<te;++m)switch(p[m]){case">":if(p[m-1]!="/"){++m;break e}if(d&&d.cellStyles){if(v=Ne(p.slice(ue,m),!0),E=v.r!=null?parseInt(v.r,10):E+1,S=-1,d.sheetRows&&d.sheetRows<E)continue;ne={},W=!1,v.ht&&(W=!0,ne.hpt=parseFloat(v.ht),ne.hpx=Sc(ne.hpt)),v.hidden=="1"&&(W=!0,ne.hidden=!0),v.outlineLevel!=null&&(W=!0,ne.level=+v.outlineLevel),W&&(H[E-1]=ne)}break;case"<":ue=m;break}if(ue>=m)break;if(v=Ne(p.slice(ue,m),!0),E=v.r!=null?parseInt(v.r,10):E+1,S=-1,!(d.sheetRows&&d.sheetRows<E)){f.s.r>E-1&&(f.s.r=E-1),f.e.r<E-1&&(f.e.r=E-1),d&&d.cellStyles&&(ne={},W=!1,v.ht&&(W=!0,ne.hpt=parseFloat(v.ht),ne.hpx=Sc(ne.hpt)),v.hidden=="1"&&(W=!0,ne.hidden=!0),v.outlineLevel!=null&&(W=!0,ne.level=+v.outlineLevel),W&&(H[E-1]=ne)),w=p.slice(m).split(e);for(var ve=0;ve!=w.length&&w[ve].trim().charAt(0)=="<";++ve);for(w=w.slice(ve),m=0;m!=w.length;++m)if(p=w[m].trim(),p.length!==0){if(b=p.match(r),g=m,y=0,j=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,b!=null&&b.length===2){for(g=0,A=b[1],y=0;y!=A.length&&!((j=A.charCodeAt(y)-64)<1||j>26);++y)g=26*g+j;--g,S=g}else++S;for(y=0;y!=p.length&&p.charCodeAt(y)!==62;++y);if(++y,v=Ne(p.slice(0,y),!0),v.r||(v.r=Se({r:E-1,c:S})),A=p.slice(y),k={t:""},(b=A.match(i))!=null&&b[1]!==""&&(k.v=Ve(b[1])),d.cellFormula){if((b=A.match(l))!=null&&b[1]!==""){if(k.f=Ve(Ze(b[1])).replace(/\r\n/g,`
`),d.xlfn||(k.f=Uv(k.f)),b[0].indexOf('t="array"')>-1)k.F=(A.match(n)||[])[1],k.F.indexOf(":")>-1&&ee.push([yt(k.F),k.F]);else if(b[0].indexOf('t="shared"')>-1){D=Ne(b[0]);var pe=Ve(Ze(b[1]));d.xlfn||(pe=Uv(pe)),fe[parseInt(D.si,10)]=[D,pe,v.r]}}else(b=A.match(/<f[^>]*\/>/))&&(D=Ne(b[0]),fe[D.si]&&(k.f=z9(fe[D.si][1],fe[D.si][2],v.r)));var le=jr(v.r);for(y=0;y<ee.length;++y)le.r>=ee[y][0].s.r&&le.r<=ee[y][0].e.r&&le.c>=ee[y][0].s.c&&le.c<=ee[y][0].e.c&&(k.F=ee[y][1])}if(v.t==null&&k.v===void 0)if(k.f||k.F)k.v=0,k.t="n";else if(T)k.t="z";else continue;else k.t=v.t||"n";switch(f.s.c>S&&(f.s.c=S),f.e.c<S&&(f.e.c=S),k.t){case"n":if(k.v==""||k.v==null){if(!T)continue;k.t="z"}else k.v=parseFloat(k.v);break;case"s":if(typeof k.v>"u"){if(!T)continue;k.t="z"}else N=Vo[parseInt(k.v,10)],k.v=N.t,k.r=N.r,d.cellHTML&&(k.h=N.h);break;case"str":k.t="s",k.v=k.v!=null?Ze(k.v):"",d.cellHTML&&(k.h=Nx(k.v));break;case"inlineStr":b=A.match(s),k.t="s",b!=null&&(N=Px(b[1]))?(k.v=N.t,d.cellHTML&&(k.h=N.h)):k.v="";break;case"b":k.v=st(k.v);break;case"d":d.cellDates?k.v=Vt(k.v,1):(k.v=kr(Vt(k.v,1)),k.t="n");break;case"e":(!d||d.cellText!==!1)&&(k.w=k.v),k.v=F_[k.v];break}if(F=Y=0,ae=null,Q&&v.s!==void 0&&(ae=x.CellXf[v.s],ae!=null&&(ae.numFmtId!=null&&(F=ae.numFmtId),d.cellStyles&&ae.fillId!=null&&(Y=ae.fillId))),c4(k,F,Y,d,h,x),d.cellDates&&Q&&k.t=="n"&&Yl(Te[F])&&(k.t="d",k.v=Q0(k.v)),v.cm&&d.xlmeta){var ke=(d.xlmeta.Cell||[])[+v.cm-1];ke&&ke.type=="XLDAPR"&&(k.D=!0)}if(se){var U=jr(v.r);u[U.r]||(u[U.r]=[]),u[U.r][U.c]=k}else u[v.r]=k}}}}H.length>0&&(u["!rows"]=H)}}();function PL(e,t){var r={},s=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=s,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=n/20),r}var DL=Bi;function IL(){}function OL(e,t){var r={},s=e[e.l];return++e.l,r.above=!(s&64),r.left=!(s&128),e.l+=18,r.name=aD(e),r}function ML(e){var t=ys(e);return[t]}function LL(e){var t=Li(e);return[t]}function BL(e){var t=ys(e),r=e.read_shift(1);return[t,r,"b"]}function UL(e){var t=Li(e),r=e.read_shift(1);return[t,r,"b"]}function $L(e){var t=ys(e),r=e.read_shift(1);return[t,r,"e"]}function VL(e){var t=Li(e),r=e.read_shift(1);return[t,r,"e"]}function zL(e){var t=ys(e),r=e.read_shift(4);return[t,r,"s"]}function HL(e){var t=Li(e),r=e.read_shift(4);return[t,r,"s"]}function WL(e){var t=ys(e),r=lr(e);return[t,r,"n"]}function d4(e){var t=Li(e),r=lr(e);return[t,r,"n"]}function GL(e){var t=ys(e),r=Ax(e);return[t,r,"n"]}function qL(e){var t=Li(e),r=Ax(e);return[t,r,"n"]}function YL(e){var t=ys(e),r=Tx(e);return[t,r,"is"]}function KL(e){var t=ys(e),r=dr(e);return[t,r,"str"]}function XL(e){var t=Li(e),r=dr(e);return[t,r,"str"]}function QL(e,t,r){var s=e.l+t,n=ys(e);n.r=r["!row"];var i=e.read_shift(1),l=[n,i,"b"];if(r.cellFormula){e.l+=2;var o=ef(e,s-e.l,r);l[3]=ar(o,null,n,r.supbooks,r)}else e.l=s;return l}function JL(e,t,r){var s=e.l+t,n=ys(e);n.r=r["!row"];var i=e.read_shift(1),l=[n,i,"e"];if(r.cellFormula){e.l+=2;var o=ef(e,s-e.l,r);l[3]=ar(o,null,n,r.supbooks,r)}else e.l=s;return l}function ZL(e,t,r){var s=e.l+t,n=ys(e);n.r=r["!row"];var i=lr(e),l=[n,i,"n"];if(r.cellFormula){e.l+=2;var o=ef(e,s-e.l,r);l[3]=ar(o,null,n,r.supbooks,r)}else e.l=s;return l}function e7(e,t,r){var s=e.l+t,n=ys(e);n.r=r["!row"];var i=dr(e),l=[n,i,"str"];if(r.cellFormula){e.l+=2;var o=ef(e,s-e.l,r);l[3]=ar(o,null,n,r.supbooks,r)}else e.l=s;return l}var t7=Bi;function r7(e,t){var r=e.l+t,s=Bi(e),n=Ex(e),i=dr(e),l=dr(e),o=dr(e);e.l=r;var c={rfx:s,relId:n,loc:i,display:o};return l&&(c.Tooltip=l),c}function s7(){}function a7(e,t,r){var s=e.l+t,n=T_(e),i=e.read_shift(1),l=[n];if(l[2]=i,r.cellFormula){var o=cL(e,s-e.l,r);l[1]=o}else e.l=s;return l}function n7(e,t,r){var s=e.l+t,n=Bi(e),i=[n];if(r.cellFormula){var l=dL(e,s-e.l,r);i[1]=l,e.l=s}else e.l=s;return i}var i7=["left","right","top","bottom","header","footer"];function l7(e){var t={};return i7.forEach(function(r){t[r]=lr(e)}),t}function o7(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function c7(){}function u7(){}function d7(e,t,r,s,n,i,l){if(!e)return e;var o=t||{};s||(s={"!id":{}});var c=o.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,x,m,p,w,b,g,y,j,A,k=[];o.biff=12,o["!row"]=0;var v=0,E=!1,S=[],N={},D=o.supbooks||n.supbooks||[[]];if(D.sharedf=N,D.arrayf=S,D.SheetNames=n.SheetNames||n.Sheets.map(function(se){return se.name}),!o.supbooks&&(o.supbooks=D,n.Names))for(var F=0;F<n.Names.length;++F)D[0][F+1]=n.Names[F];var Y=[],Q=[],ae=!1;c0[16]={n:"BrtShortReal",f:d4};var ee;if(za(e,function(H,ne,W){if(!h)switch(W){case 148:u=H;break;case 0:x=H,o.sheetRows&&o.sheetRows<=x.r&&(h=!0),j=Xt(w=x.r),o["!row"]=x.r,(H.hidden||H.hpt||H.level!=null)&&(H.hpt&&(H.hpx=Sc(H.hpt)),Q[H.r]=H);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:H[2]},H[2]){case"n":m.v=H[1];break;case"s":y=Vo[H[1]],m.v=y.t,m.r=y.r;break;case"b":m.v=!!H[1];break;case"e":m.v=H[1],o.cellText!==!1&&(m.w=Ui[m.v]);break;case"str":m.t="s",m.v=H[1];break;case"is":m.t="s",m.v=H[1].t;break}if((p=l.CellXf[H[0].iStyleRef])&&c4(m,p.numFmtId,null,o,i,l),b=H[0].c==-1?b+1:H[0].c,o.dense?(c[w]||(c[w]=[]),c[w][b]=m):c[Pt(b)+j]=m,o.cellFormula){for(E=!1,v=0;v<S.length;++v){var T=S[v];x.r>=T[0].s.r&&x.r<=T[0].e.r&&b>=T[0].s.c&&b<=T[0].e.c&&(m.F=Be(T[0]),E=!0)}!E&&H.length>3&&(m.f=H[3])}if(d.s.r>x.r&&(d.s.r=x.r),d.s.c>b&&(d.s.c=b),d.e.r<x.r&&(d.e.r=x.r),d.e.c<b&&(d.e.c=b),o.cellDates&&p&&m.t=="n"&&Yl(Te[p.numFmtId])){var L=ai(m.v);L&&(m.t="d",m.v=new Date(L.y,L.m-1,L.d,L.H,L.M,L.S,L.u))}ee&&(ee.type=="XLDAPR"&&(m.D=!0),ee=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;m={t:"z",v:void 0},b=H[0].c==-1?b+1:H[0].c,o.dense?(c[w]||(c[w]=[]),c[w][b]=m):c[Pt(b)+j]=m,d.s.r>x.r&&(d.s.r=x.r),d.s.c>b&&(d.s.c=b),d.e.r<x.r&&(d.e.r=x.r),d.e.c<b&&(d.e.c=b),ee&&(ee.type=="XLDAPR"&&(m.D=!0),ee=void 0);break;case 176:k.push(H);break;case 49:ee=((o.xlmeta||{}).Cell||[])[H-1];break;case 494:var B=s["!id"][H.relId];for(B?(H.Target=B.Target,H.loc&&(H.Target+="#"+H.loc),H.Rel=B):H.relId==""&&(H.Target="#"+H.loc),w=H.rfx.s.r;w<=H.rfx.e.r;++w)for(b=H.rfx.s.c;b<=H.rfx.e.c;++b)o.dense?(c[w]||(c[w]=[]),c[w][b]||(c[w][b]={t:"z",v:void 0}),c[w][b].l=H):(g=Se({c:b,r:w}),c[g]||(c[g]={t:"z",v:void 0}),c[g].l=H);break;case 426:if(!o.cellFormula)break;S.push(H),A=o.dense?c[w][b]:c[Pt(b)+j],A.f=ar(H[1],d,{r:x.r,c:b},D,o),A.F=Be(H[0]);break;case 427:if(!o.cellFormula)break;N[Se(H[0].s)]=H[1],A=o.dense?c[w][b]:c[Pt(b)+j],A.f=ar(H[1],d,{r:x.r,c:b},D,o);break;case 60:if(!o.cellStyles)break;for(;H.e>=H.s;)Y[H.e--]={width:H.w/256,hidden:!!(H.flags&1),level:H.level},ae||(ae=!0,Dx(H.w/256)),Ul(Y[H.e+1]);break;case 161:c["!autofilter"]={ref:Be(H)};break;case 476:c["!margins"]=H;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),H.name&&(n.Sheets[r].CodeName=H.name),(H.above||H.left)&&(c["!outline"]={above:H.above,left:H.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),H.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!ne.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+W.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=Be(u||d)),o.sheetRows&&c["!ref"]){var fe=yt(c["!ref"]);o.sheetRows<=+fe.e.r&&(fe.e.r=o.sheetRows-1,fe.e.r>d.e.r&&(fe.e.r=d.e.r),fe.e.r<fe.s.r&&(fe.s.r=fe.e.r),fe.e.c>d.e.c&&(fe.e.c=d.e.c),fe.e.c<fe.s.c&&(fe.s.c=fe.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Be(fe))}return k.length>0&&(c["!merges"]=k),Y.length>0&&(c["!cols"]=Y),Q.length>0&&(c["!rows"]=Q),c}function f7(e){var t=[],r=e.match(/^<c:numCache>/),s;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var l=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=r?+l[2]:l[2])});var n=Ve((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){s=i.replace(/<.*?>/g,"")}),[t,n,s]}function h7(e,t,r,s,n,i){var l=i||{"!type":"chart"};if(!e)return i;var o=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=f7(f);d.s.r=d.s.c=0,d.e.c=o,u=Pt(o),h[0].forEach(function(x,m){l[u+Xt(m)]={t:"n",v:x,z:h[1]},c=m}),d.e.r<c&&(d.e.r=c),++o}),o>0&&(l["!ref"]=Be(d)),l}function m7(e,t,r,s,n){if(!e)return e;s||(s={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l,o=e.match(u4);return o&&Ox(o[0],i,n,r),(l=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=l[1]),s["!id"][i["!rel"]]&&(i["!drawel"]=s["!id"][i["!rel"]]),i}function p7(e,t){e.l+=10;var r=dr(e);return{name:r}}function x7(e,t,r,s,n){if(!e)return e;s||(s={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l=!1;return za(e,function(c,u,d){switch(d){case 550:i["!rel"]=c;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),c.name&&(n.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),s["!id"][i["!rel"]]&&(i["!drawel"]=s["!id"][i["!rel"]]),i}var f4=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],g7=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],y7=[],v7=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Wv(e,t){for(var r=0;r!=e.length;++r)for(var s=e[r],n=0;n!=t.length;++n){var i=t[n];if(s[i[0]]==null)s[i[0]]=i[1];else switch(i[2]){case"bool":typeof s[i[0]]=="string"&&(s[i[0]]=st(s[i[0]]));break;case"int":typeof s[i[0]]=="string"&&(s[i[0]]=parseInt(s[i[0]],10));break}}}function Gv(e,t){for(var r=0;r!=t.length;++r){var s=t[r];if(e[s[0]]==null)e[s[0]]=s[1];else switch(s[2]){case"bool":typeof e[s[0]]=="string"&&(e[s[0]]=st(e[s[0]]));break;case"int":typeof e[s[0]]=="string"&&(e[s[0]]=parseInt(e[s[0]],10));break}}}function h4(e){Gv(e.WBProps,f4),Gv(e.CalcPr,v7),Wv(e.WBView,g7),Wv(e.Sheets,y7),vl.date1904=st(e.WBProps.date1904)}var w7="][*?/\\".split("");function b7(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return w7.forEach(function(s){if(e.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var j7=/<\w+:workbook/;function N7(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},s=!1,n="xmlns",i={},l=0;if(e.replace(mr,function(c,u){var d=Ne(c);switch(ma(d[0])){case"<?xml":break;case"<workbook":c.match(j7)&&(n="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[n];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":f4.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=st(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=Ze(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Ve(Ze(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":s=!0;break;case"</definedNames>":s=!1;break;case"<definedName":i={},i.Name=Ze(d.name),d.comment&&(i.Comment=d.comment),d.localSheetId&&(i.Sheet=+d.localSheetId),st(d.hidden||"0")&&(i.Hidden=!0),l=u+c.length;break;case"</definedName>":i.Ref=Ve(Ze(e.slice(l,u))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":s=!0;break;case"</AlternateContent>":s=!1;break;case"<revisionPtr":break;default:if(!s&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),$8.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return h4(r),r}function _7(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Em(e),r.name=dr(e),r}function k7(e,t){var r={},s=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?dr(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(s&65536),r.backupFile=!!(s&64),r.checkCompatibility=!!(s&4096),r.date1904=!!(s&1),r.filterPrivacy=!!(s&8),r.hidePivotFieldList=!!(s&1024),r.promptedSolutions=!!(s&16),r.publishItems=!!(s&2048),r.refreshAllConnections=!!(s&262144),r.saveExternalLinkValues=!!(s&128),r.showBorderUnselectedTables=!!(s&4),r.showInkAnnotation=!!(s&32),r.showObjects=["all","placeholders","none"][s>>13&3],r.showPivotChartFilter=!!(s&32768),r.updateLinks=["userSet","never","always"][s>>8&3],r}function S7(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function C7(e,t,r){var s=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),i=nD(e),l=uL(e,0,r),o=Ex(e);e.l=s;var c={Name:i,Ptg:l};return n<268435455&&(c.Sheet=n),o&&(c.Comment=o),c}function T7(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},s=[],n=!1;t||(t={}),t.biff=12;var i=[],l=[[]];return l.SheetNames=[],l.XTI=[],c0[16]={n:"BrtFRTArchID$",f:S7},za(e,function(c,u,d){switch(d){case 156:l.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=ar(c.Ptg,null,null,l,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([d,c]):l[0]=[d,c],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(c),l.XTI=l.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:s.push(d),n=!0;break;case 36:s.pop(),n=!1;break;case 37:s.push(d),n=!0;break;case 38:s.pop(),n=!1;break;case 16:break;default:if(!u.T){if(!n||t.WTF&&s[s.length-1]!=37&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),h4(r),r.Names=i,r.supbooks=l,r}function E7(e,t,r){return t.slice(-4)===".bin"?T7(e,r):N7(e,r)}function A7(e,t,r,s,n,i,l,o){return t.slice(-4)===".bin"?d7(e,s,r,n,i,l,o):_L(e,s,r,n,i,l,o)}function F7(e,t,r,s,n,i,l,o){return t.slice(-4)===".bin"?x7(e,s,r,n,i):m7(e,s,r,n,i)}function R7(e,t,r,s,n,i,l,o){return t.slice(-4)===".bin"?U9():$9()}function P7(e,t,r,s,n,i,l,o){return t.slice(-4)===".bin"?L9():B9()}function D7(e,t,r,s){return t.slice(-4)===".bin"?t9(e,r,s):KO(e,r,s)}function I7(e,t,r){return Z_(e,r)}function O7(e,t,r){return t.slice(-4)===".bin"?gO(e,r):pO(e,r)}function M7(e,t,r){return t.slice(-4)===".bin"?I9(e,r):A9(e,r)}function L7(e,t,r){return t.slice(-4)===".bin"?C9(e):k9(e)}function B7(e,t,r,s){return r.slice(-4)===".bin"?T9(e,t,r,s):void 0}function U7(e,t,r){return t.slice(-4)===".bin"?N9(e,t,r):_9(e,t,r)}var m4=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,p4=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ns(e,t){var r=e.split(/\s+/),s=[];if(s[0]=r[0],r.length===1)return s;var n=e.match(m4),i,l,o,c;if(n)for(c=0;c!=n.length;++c)i=n[c].match(p4),(l=i[1].indexOf(":"))===-1?s[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(l+1),s[o]=i[2].slice(1,i[2].length-1));return s}function $7(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var s=e.match(m4),n,i,l,o;if(s)for(o=0;o!=s.length;++o)n=s[o].match(p4),(i=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?l="xmlns"+n[1].slice(6):l=n[1].slice(i+1),r[l]=n[2].slice(1,n[2].length-1));return r}var Ho;function V7(e,t){var r=Ho[e]||Ve(e);return r==="General"?Si(t):gs(r,t)}function z7(e,t,r,s){var n=s;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=st(s);break;case"i2":case"int":n=parseInt(s,10);break;case"r4":case"float":n=parseFloat(s);break;case"date":case"dateTime.tz":n=Vt(s);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ve(t)]=n}function H7(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Ui[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=bc(e.v):e.w=Si(e.v):e.w=V7(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var s=Ho[t]||t||"General";if(r.cellNF&&(e.z=s),r.cellDates&&e.t=="n"&&Yl(s)){var n=ai(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(i){if(r.WTF)throw i}}}function W7(e,t,r){if(r.cellStyles&&t.Interior){var s=t.Interior;s.Pattern&&(s.patternType=zO[s.Pattern]||s.Pattern)}e[t.ID]=t}function G7(e,t,r,s,n,i,l,o,c,u){var d="General",f=s.StyleID,h={};u=u||{};var x=[],m=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&l&&(f=l.StyleID);i[f]!==void 0&&(i[f].nf&&(d=i[f].nf),i[f].Interior&&x.push(i[f].Interior),!!i[f].Parent);)f=i[f].Parent;switch(r.Type){case"Boolean":s.t="b",s.v=st(e);break;case"String":s.t="s",s.r=mv(Ve(e)),s.v=e.indexOf("<")>-1?Ve(t||e).replace(/<.*?>/g,""):s.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),s.v=(Vt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),s.v!==s.v?s.v=Ve(e):s.v<60&&(s.v=s.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":s.v===void 0&&(s.v=+e),s.t||(s.t="n");break;case"Error":s.t="e",s.v=F_[e],u.cellText!==!1&&(s.w=e);break;default:e==""&&t==""?s.t="z":(s.t="s",s.v=mv(t||e));break}if(H7(s,d,u),u.cellFormula!==!1)if(s.Formula){var p=Ve(s.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),s.f=yl(p,n),delete s.Formula,s.ArrayRange=="RC"?s.F=yl("RC:RC",n):s.ArrayRange&&(s.F=yl(s.ArrayRange,n),c.push([yt(s.F),s.F]))}else for(m=0;m<c.length;++m)n.r>=c[m][0].s.r&&n.r<=c[m][0].e.r&&n.c>=c[m][0].s.c&&n.c<=c[m][0].e.c&&(s.F=c[m][1]);u.cellStyles&&(x.forEach(function(w){!h.patternType&&w.patternType&&(h.patternType=w.patternType)}),s.s=h),s.StyleID!==void 0&&(s.ixfe=s.StyleID)}function q7(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function ah(e,t){var r=t||{};s_();var s=vo(_x(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(s=Ze(s));var n=s.slice(0,1024).toLowerCase(),i=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var l=Kt(r);return l.type="string",_c.to_workbook(s,l)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(it){n.indexOf("<"+it)>=0&&(i=!0)}),i)return rB(s,r);Ho={"General Number":"General","General Date":Te[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Te[15],"Short Date":Te[14],"Long Time":Te[19],"Medium Time":Te[18],"Short Time":Te[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Te[2],Standard:Te[4],Percent:Te[10],Scientific:Te[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],u,d={},f=[],h=r.dense?[]:{},x="",m={},p={},w=Ns('<Data ss:Type="String">'),b=0,g=0,y=0,j={s:{r:2e6,c:2e6},e:{r:0,c:0}},A={},k={},v="",E=0,S=[],N={},D={},F=0,Y=[],Q=[],ae={},ee=[],fe,se=!1,H=[],ne=[],W={},T=0,L=0,B={Sheets:[],WBProps:{date1904:!1}},V={};Nc.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"");for(var te="";o=Nc.exec(s);)switch(o[3]=(te=o[3]).toLowerCase()){case"data":if(te=="data"){if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?G7(s.slice(b,o.index),v,w,c[c.length-1][0]=="comment"?ae:m,{c:g,r:y},A,ee[g],p,H,r):(v="",w=Ns(o[0]),b=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(Q.length>0&&(m.c=Q),(!r.sheetRows||r.sheetRows>y)&&m.v!==void 0&&(r.dense?(h[y]||(h[y]=[]),h[y][g]=m):h[Pt(g)+Xt(y)]=m),m.HRef&&(m.l={Target:Ve(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(T=g+(parseInt(m.MergeAcross,10)|0),L=y+(parseInt(m.MergeDown,10)|0),S.push({s:{c:g,r:y},e:{c:T,r:L}})),!r.sheetStubs)m.MergeAcross?g=T+1:++g;else if(m.MergeAcross||m.MergeDown){for(var ue=g;ue<=T;++ue)for(var ve=y;ve<=L;++ve)(ue>g||ve>y)&&(r.dense?(h[ve]||(h[ve]=[]),h[ve][ue]={t:"z"}):h[Pt(ue)+Xt(ve)]={t:"z"});g=T+1}else++g;else m=$7(o[0]),m.Index&&(g=+m.Index-1),g<j.s.c&&(j.s.c=g),g>j.e.c&&(j.e.c=g),o[0].slice(-2)==="/>"&&++g,Q=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<j.s.r&&(j.s.r=y),y>j.e.r&&(j.e.r=y),o[0].slice(-2)==="/>"&&(p=Ns(o[0]),p.Index&&(y=+p.Index-1)),g=0,++y):(p=Ns(o[0]),p.Index&&(y=+p.Index-1),W={},(p.AutoFitHeight=="0"||p.Height)&&(W.hpx=parseInt(p.Height,10),W.hpt=J_(W.hpx),ne[y]=W),p.Hidden=="1"&&(W.hidden=!0,ne[y]=W));break;case"worksheet":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));f.push(x),j.s.r<=j.e.r&&j.s.c<=j.e.c&&(h["!ref"]=Be(j),r.sheetRows&&r.sheetRows<=j.e.r&&(h["!fullref"]=h["!ref"],j.e.r=r.sheetRows-1,h["!ref"]=Be(j))),S.length&&(h["!merges"]=S),ee.length>0&&(h["!cols"]=ee),ne.length>0&&(h["!rows"]=ne),d[x]=h}else j={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=g=0,c.push([o[3],!1]),u=Ns(o[0]),x=Ve(u.Name),h=r.dense?[]:{},S=[],H=[],ne=[],V={name:x,Hidden:0},B.Sheets.push(V);break;case"table":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),ee=[],se=!1}break;case"style":o[1]==="/"?W7(A,k,r):k=Ns(o[0]);break;case"numberformat":k.nf=Ve(Ns(o[0]).Format||"General"),Ho[k.nf]&&(k.nf=Ho[k.nf]);for(var pe=0;pe!=392&&Te[pe]!=k.nf;++pe);if(pe==392){for(pe=57;pe!=392;++pe)if(Te[pe]==null){gi(k.nf,pe);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(fe=Ns(o[0]),fe.Hidden&&(fe.hidden=!0,delete fe.Hidden),fe.Width&&(fe.wpx=parseInt(fe.Width,10)),!se&&fe.wpx>10){se=!0,br=X_;for(var le=0;le<ee.length;++le)ee[le]&&Ul(ee[le])}se&&Ul(fe),ee[fe.Index-1||ee.length]=fe;for(var ke=0;ke<+fe.Span;++ke)ee[ee.length]=Kt(fe);break;case"namedrange":if(o[1]==="/")break;B.Names||(B.Names=[]);var U=Ne(o[0]),rt={Name:U.Name,Ref:yl(U.RefersTo.slice(1),{r:0,c:0})};B.Sheets.length>0&&(rt.Sheet=B.Sheets.length-1),B.Names.push(rt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?v+=s.slice(E,o.index):E=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;k.Interior=Ns(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?AD(N,te,s.slice(F,o.index)):F=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));q7(ae),Q.push(ae)}else c.push([o[3],!1]),u=Ns(o[0]),ae={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Me=Ns(o[0]);h["!autofilter"]={ref:yl(Me.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return Jv(s,r);var He=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:He=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:He=!1}break;case"excelworkbook":switch(o[3]){case"date1904":B.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:He=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:He=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(s.slice(F,o.index)){case"SheetHidden":V.Hidden=1;break;case"SheetVeryHidden":V.Hidden=2;break}else F=o.index+o[0].length;break;case"header":h["!margins"]||zo(h["!margins"]={},"xlml"),isNaN(+Ne(o[0]).Margin)||(h["!margins"].header=+Ne(o[0]).Margin);break;case"footer":h["!margins"]||zo(h["!margins"]={},"xlml"),isNaN(+Ne(o[0]).Margin)||(h["!margins"].footer=+Ne(o[0]).Margin);break;case"pagemargins":var Fe=Ne(o[0]);h["!margins"]||zo(h["!margins"]={},"xlml"),isNaN(+Fe.Top)||(h["!margins"].top=+Fe.Top),isNaN(+Fe.Left)||(h["!margins"].left=+Fe.Left),isNaN(+Fe.Right)||(h["!margins"].right=+Fe.Right),isNaN(+Fe.Bottom)||(h["!margins"].bottom=+Fe.Bottom);break;case"displayrighttoleft":B.Views||(B.Views=[]),B.Views[0]||(B.Views[0]={}),B.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:He=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:He=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:He=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:He=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:He=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:He=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:He=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:He=!1}break;case"smarttags":break;default:He=!1;break}if(He||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?z7(D,te,Y,s.slice(F,o.index)):(Y=o,F=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var xe={};return!r.bookSheets&&!r.bookProps&&(xe.Sheets=d),xe.SheetNames=f,xe.Workbook=B,xe.SSF=Kt(Te),xe.Props=N,xe.Custprops=D,xe}function Pm(e,t){switch(Bx(t=t||{}),t.type||"base64"){case"base64":return ah(Zr(e),t);case"binary":case"buffer":case"file":return ah(e,t);case"array":return ah(Mi(e),t)}}function Y7(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=oD(r),r.length-r.l<=4)return t;var s=r.read_shift(4);if(s==0||s>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(s=r.read_shift(4),s!==1907505652)||(t.UnicodeClipboardFormat=cD(r),s=r.read_shift(4),s==0||s>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var K7=[60,1084,2066,2165,2175];function X7(e,t,r,s,n){var i=s,l=[],o=r.slice(r.l,r.l+i);if(n&&n.enc&&n.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(o)}l.push(o),r.l+=i;for(var c=Sa(r,r.l),u=Dm[c],d=0;u!=null&&K7.indexOf(c)>-1;)i=Sa(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),o=r.slice(d,r.l+4+i),l.push(o),r.l+=4+i,u=Dm[c=Sa(r,r.l)];var f=rn(l);qt(f,0);var h=0;f.lens=[];for(var x=0;x<l.length;++x)f.lens.push(h),h+=l[x].length;if(f.length<s)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+s;return t.f(f,f.length,n)}function Qs(e,t,r){if(e.t!=="z"&&e.XF){var s=0;try{s=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Te[s])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ui[e.v]:s===0||s=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=bc(e.v):e.w=Si(e.v):e.w=gs(s,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&s&&e.t=="n"&&Yl(Te[s]||String(s))){var n=ai(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function Yu(e,t,r){return{v:e,ixfe:t,t:r}}function Q7(e,t){var r={opts:{}},s={},n=t.dense?[]:{},i={},l={},o=null,c=[],u="",d={},f,h="",x,m,p,w,b={},g=[],y,j,A=[],k=[],v={Sheets:[],WBProps:{date1904:!1},Views:[{}]},E={},S=function(Ae){return Ae<8?yi[Ae]:Ae<64&&k[Ae-8]||yi[Ae]},N=function(Ae,lt,Er){var vt=lt.XF.data;if(!(!vt||!vt.patternType||!Er||!Er.cellStyles)){lt.s={},lt.s.patternType=vt.patternType;var xa;(xa=kc(S(vt.icvFore)))&&(lt.s.fgColor={rgb:xa}),(xa=kc(S(vt.icvBack)))&&(lt.s.bgColor={rgb:xa})}},D=function(Ae,lt,Er){if(!(W>1)&&!(Er.sheetRows&&Ae.r>=Er.sheetRows)){if(Er.cellStyles&&lt.XF&&lt.XF.data&&N(Ae,lt,Er),delete lt.ixfe,delete lt.XF,f=Ae,h=Se(Ae),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),Ae.r<l.s.r&&(l.s.r=Ae.r),Ae.c<l.s.c&&(l.s.c=Ae.c),Ae.r+1>l.e.r&&(l.e.r=Ae.r+1),Ae.c+1>l.e.c&&(l.e.c=Ae.c+1),Er.cellFormula&&lt.f){for(var vt=0;vt<g.length;++vt)if(!(g[vt][0].s.c>Ae.c||g[vt][0].s.r>Ae.r)&&!(g[vt][0].e.c<Ae.c||g[vt][0].e.r<Ae.r)){lt.F=Be(g[vt][0]),(g[vt][0].s.c!=Ae.c||g[vt][0].s.r!=Ae.r)&&delete lt.f,lt.f&&(lt.f=""+ar(g[vt][1],l,Ae,H,F));break}}Er.dense?(n[Ae.r]||(n[Ae.r]=[]),n[Ae.r][Ae.c]=lt):n[h]=lt}},F={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:g,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(F.password=t.password);var Y,Q=[],ae=[],ee=[],fe=[],se=!1,H=[];H.SheetNames=F.snames,H.sharedf=F.sharedf,H.arrayf=F.arrayf,H.names=[],H.XTI=[];var ne=0,W=0,T=0,L=[],B=[],V;F.codepage=1200,Rs(1200);for(var te=!1;e.l<e.length-1;){var ue=e.l,ve=e.read_shift(2);if(ve===0&&ne===10)break;var pe=e.l===e.length?0:e.read_shift(2),le=Dm[ve];if(le&&le.f){if(t.bookSheets&&ne===133&&ve!==133)break;if(ne=ve,le.r===2||le.r==12){var ke=e.read_shift(2);if(pe-=2,!F.enc&&ke!==ve&&((ke&255)<<8|ke>>8)!==ve)throw new Error("rt mismatch: "+ke+"!="+ve);le.r==12&&(e.l+=10,pe-=10)}var U={};if(ve===10?U=le.f(e,pe,F):U=X7(ve,le,e,pe,F),W==0&&[9,521,1033,2057].indexOf(ne)===-1)continue;switch(ve){case 34:r.opts.Date1904=v.WBProps.date1904=U;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(F.enc||(e.l=0),F.enc=U,!t.password)throw new Error("File is password-protected");if(U.valid==null)throw new Error("Encryption scheme unsupported");if(!U.valid)throw new Error("Password is incorrect");break;case 92:F.lastuser=U;break;case 66:var rt=Number(U);switch(rt){case 21010:rt=1200;break;case 32768:rt=1e4;break;case 32769:rt=1252;break}Rs(F.codepage=rt),te=!0;break;case 317:F.rrtabid=U;break;case 25:F.winlocked=U;break;case 439:r.opts.RefreshAll=U;break;case 12:r.opts.CalcCount=U;break;case 16:r.opts.CalcDelta=U;break;case 17:r.opts.CalcIter=U;break;case 13:r.opts.CalcMode=U;break;case 14:r.opts.CalcPrecision=U;break;case 95:r.opts.CalcSaveRecalc=U;break;case 15:F.CalcRefMode=U;break;case 2211:r.opts.FullCalc=U;break;case 129:U.fDialog&&(n["!type"]="dialog"),U.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),U.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:A.push(U);break;case 430:H.push([U]),H[H.length-1].XTI=[];break;case 35:case 547:H[H.length-1].push(U);break;case 24:case 536:V={Name:U.Name,Ref:ar(U.rgce,l,null,H,F)},U.itab>0&&(V.Sheet=U.itab-1),H.names.push(V),H[0]||(H[0]=[],H[0].XTI=[]),H[H.length-1].push(U),U.Name=="_xlnm._FilterDatabase"&&U.itab>0&&U.rgce&&U.rgce[0]&&U.rgce[0][0]&&U.rgce[0][0][0]=="PtgArea3d"&&(B[U.itab-1]={ref:Be(U.rgce[0][0][1][2])});break;case 22:F.ExternCount=U;break;case 23:H.length==0&&(H[0]=[],H[0].XTI=[]),H[H.length-1].XTI=H[H.length-1].XTI.concat(U),H.XTI=H.XTI.concat(U);break;case 2196:if(F.biff<8)break;V!=null&&(V.Comment=U[1]);break;case 18:n["!protect"]=U;break;case 19:U!==0&&F.WTF&&console.error("Password verifier: "+U);break;case 133:i[U.pos]=U,F.snames.push(U.name);break;case 10:{if(--W)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,n["!ref"]=Be(l),t.sheetRows&&t.sheetRows<=l.e.r){var Me=l.e.r;l.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=Be(l),l.e.r=Me}l.e.r++,l.e.c++}Q.length>0&&(n["!merges"]=Q),ae.length>0&&(n["!objects"]=ae),ee.length>0&&(n["!cols"]=ee),fe.length>0&&(n["!rows"]=fe),v.Sheets.push(E)}u===""?d=n:s[u]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(F.biff===8&&(F.biff={9:2,521:3,1033:4}[ve]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[U.BIFFVer]||8),F.biffguess=U.BIFFVer==0,U.BIFFVer==0&&U.dt==4096&&(F.biff=5,te=!0,Rs(F.codepage=28591)),F.biff==8&&U.BIFFVer==0&&U.dt==16&&(F.biff=2),W++)break;if(n=t.dense?[]:{},F.biff<8&&!te&&(te=!0,Rs(F.codepage=t.codepage||1252)),F.biff<5||U.BIFFVer==0&&U.dt==4096){u===""&&(u="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var He={pos:e.l-pe,name:u};i[He.pos]=He,F.snames.push(u)}else u=(i[ue]||{name:""}).name;U.dt==32&&(n["!type"]="chart"),U.dt==64&&(n["!type"]="macro"),Q=[],ae=[],F.arrayf=g=[],ee=[],fe=[],se=!1,E={Hidden:(i[ue]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[U.r]||[])[U.c]:n[Se({c:U.c,r:U.r})])&&++U.c,y={ixfe:U.ixfe,XF:A[U.ixfe]||{},v:U.val,t:"n"},T>0&&(y.z=L[y.ixfe>>8&63]),Qs(y,t,r.opts.Date1904),D({c:U.c,r:U.r},y,t);break;case 5:case 517:y={ixfe:U.ixfe,XF:A[U.ixfe],v:U.val,t:U.t},T>0&&(y.z=L[y.ixfe>>8&63]),Qs(y,t,r.opts.Date1904),D({c:U.c,r:U.r},y,t);break;case 638:y={ixfe:U.ixfe,XF:A[U.ixfe],v:U.rknum,t:"n"},T>0&&(y.z=L[y.ixfe>>8&63]),Qs(y,t,r.opts.Date1904),D({c:U.c,r:U.r},y,t);break;case 189:for(var Fe=U.c;Fe<=U.C;++Fe){var xe=U.rkrec[Fe-U.c][0];y={ixfe:xe,XF:A[xe],v:U.rkrec[Fe-U.c][1],t:"n"},T>0&&(y.z=L[y.ixfe>>8&63]),Qs(y,t,r.opts.Date1904),D({c:Fe,r:U.r},y,t)}break;case 6:case 518:case 1030:{if(U.val=="String"){o=U;break}if(y=Yu(U.val,U.cell.ixfe,U.tt),y.XF=A[y.ixfe],t.cellFormula){var it=U.formula;if(it&&it[0]&&it[0][0]&&it[0][0][0]=="PtgExp"){var Tr=it[0][0][1][0],Ur=it[0][0][1][1],vs=Se({r:Tr,c:Ur});b[vs]?y.f=""+ar(U.formula,l,U.cell,H,F):y.F=((t.dense?(n[Tr]||[])[Ur]:n[vs])||{}).F}else y.f=""+ar(U.formula,l,U.cell,H,F)}T>0&&(y.z=L[y.ixfe>>8&63]),Qs(y,t,r.opts.Date1904),D(U.cell,y,t),o=U}break;case 7:case 519:if(o)o.val=U,y=Yu(U,o.cell.ixfe,"s"),y.XF=A[y.ixfe],t.cellFormula&&(y.f=""+ar(o.formula,l,o.cell,H,F)),T>0&&(y.z=L[y.ixfe>>8&63]),Qs(y,t,r.opts.Date1904),D(o.cell,y,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{g.push(U);var Ln=Se(U[0].s);if(x=t.dense?(n[U[0].s.r]||[])[U[0].s.c]:n[Ln],t.cellFormula&&x){if(!o||!Ln||!x)break;x.f=""+ar(U[1],l,U[0],H,F),x.F=Be(U[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;b[Se(o.cell)]=U[0],x=t.dense?(n[o.cell.r]||[])[o.cell.c]:n[Se(o.cell)],(x||{}).f=""+ar(U[0],l,f,H,F)}}break;case 253:y=Yu(c[U.isst].t,U.ixfe,"s"),c[U.isst].h&&(y.h=c[U.isst].h),y.XF=A[y.ixfe],T>0&&(y.z=L[y.ixfe>>8&63]),Qs(y,t,r.opts.Date1904),D({c:U.c,r:U.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:U.ixfe,XF:A[U.ixfe],t:"z"},T>0&&(y.z=L[y.ixfe>>8&63]),Qs(y,t,r.opts.Date1904),D({c:U.c,r:U.r},y,t));break;case 190:if(t.sheetStubs)for(var Gs=U.c;Gs<=U.C;++Gs){var pr=U.ixfe[Gs-U.c];y={ixfe:pr,XF:A[pr],t:"z"},T>0&&(y.z=L[y.ixfe>>8&63]),Qs(y,t,r.opts.Date1904),D({c:Gs,r:U.r},y,t)}break;case 214:case 516:case 4:y=Yu(U.val,U.ixfe,"s"),y.XF=A[y.ixfe],T>0&&(y.z=L[y.ixfe>>8&63]),Qs(y,t,r.opts.Date1904),D({c:U.c,r:U.r},y,t);break;case 0:case 512:W===1&&(l=U);break;case 252:c=U;break;case 1054:if(F.biff==4){L[T++]=U[1];for(var ws=0;ws<T+163&&Te[ws]!=U[1];++ws);ws>=163&&gi(U[1],T+163)}else gi(U[1],U[0]);break;case 30:{L[T++]=U;for(var qs=0;qs<T+163&&Te[qs]!=U;++qs);qs>=163&&gi(U,T+163)}break;case 229:Q=Q.concat(U);break;case 93:ae[U.cmo[0]]=F.lastobj=U;break;case 438:F.lastobj.TxO=U;break;case 127:F.lastobj.ImData=U;break;case 440:for(w=U[0].s.r;w<=U[0].e.r;++w)for(p=U[0].s.c;p<=U[0].e.c;++p)x=t.dense?(n[w]||[])[p]:n[Se({c:p,r:w})],x&&(x.l=U[1]);break;case 2048:for(w=U[0].s.r;w<=U[0].e.r;++w)for(p=U[0].s.c;p<=U[0].e.c;++p)x=t.dense?(n[w]||[])[p]:n[Se({c:p,r:w})],x&&x.l&&(x.l.Tooltip=U[1]);break;case 28:{if(F.biff<=5&&F.biff>=2)break;x=t.dense?(n[U[0].r]||[])[U[0].c]:n[Se(U[0])];var Bn=ae[U[2]];x||(t.dense?(n[U[0].r]||(n[U[0].r]=[]),x=n[U[0].r][U[0].c]={t:"z"}):x=n[Se(U[0])]={t:"z"},l.e.r=Math.max(l.e.r,U[0].r),l.s.r=Math.min(l.s.r,U[0].r),l.e.c=Math.max(l.e.c,U[0].c),l.s.c=Math.min(l.s.c,U[0].c)),x.c||(x.c=[]),m={a:U[1],t:Bn.TxO.t},x.c.push(m)}break;case 2173:v9(A[U.ixfe],U.ext);break;case 125:{if(!F.cellStyles)break;for(;U.e>=U.s;)ee[U.e--]={width:U.w/256,level:U.level||0,hidden:!!(U.flags&1)},se||(se=!0,Dx(U.w/256)),Ul(ee[U.e+1])}break;case 520:{var zt={};U.level!=null&&(fe[U.r]=zt,zt.level=U.level),U.hidden&&(fe[U.r]=zt,zt.hidden=!0),U.hpt&&(fe[U.r]=zt,zt.hpt=U.hpt,zt.hpx=Sc(U.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||zo(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ve]]=U;break;case 161:n["!margins"]||zo(n["!margins"]={}),n["!margins"].header=U.header,n["!margins"].footer=U.footer;break;case 574:U.RTL&&(v.Views[0].RTL=!0);break;case 146:k=U;break;case 2198:Y=U;break;case 140:j=U;break;case 442:u?E.CodeName=U||E.name:v.WBProps.CodeName=U||"ThisWorkbook";break}}else le||console.error("Missing Info for XLS Record 0x"+ve.toString(16)),e.l+=pe}return r.SheetNames=da(i).sort(function($r,Ae){return Number($r)-Number(Ae)}).map(function($r){return i[$r].name}),t.bookSheets||(r.Sheets=s),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&B.forEach(function($r,Ae){r.Sheets[r.SheetNames[Ae]]["!autofilter"]=$r}),r.Strings=c,r.SSF=Kt(Te),F.enc&&(r.Encryption=F.enc),Y&&(r.Themes=Y),r.Metadata={},j!==void 0&&(r.Metadata.Country=j),H.names.length>0&&(v.Names=H.names),r.Workbook=v,r}var qv={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function J7(e,t,r){var s=Le.find(e,"/!DocumentSummaryInformation");if(s&&s.size>0)try{var n=Av(s,pD,qv.DSI);for(var i in n)t[i]=n[i]}catch(u){if(r.WTF)throw u}var l=Le.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var o=Av(l,xD,qv.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(P_(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function x4(e,t){t||(t={}),Bx(t),WN(),t.codepage&&gx(t.codepage);var r,s;if(e.FullPaths){if(Le.find(e,"/encryption"))throw new Error("File is password-protected");r=Le.find(e,"!CompObj"),s=Le.find(e,"/Workbook")||Le.find(e,"/Book")}else{switch(t.type){case"base64":e=Fs(Zr(e));break;case"binary":e=Fs(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}qt(e,0),s={content:e}}var n,i;if(r&&Y7(r),t.bookProps&&!t.bookSheets)n={};else{var l=Oe?"buffer":"array";if(s&&s.content)n=Q7(s.content,t);else if((i=Le.find(e,"PerfectOffice_MAIN"))&&i.content)n=$o.to_workbook(i.content,(t.type=l,t));else if((i=Le.find(e,"NativeContent_MAIN"))&&i.content)n=$o.to_workbook(i.content,(t.type=l,t));else throw(i=Le.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Le.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=M9(e))}var o={};return e.FullPaths&&J7(e,o,t),n.Props=n.Custprops=o,t.bookFiles&&(n.cfb=e),n}var c0={0:{f:PL},1:{f:ML},2:{f:GL},3:{f:$L},4:{f:BL},5:{f:WL},6:{f:KL},7:{f:zL},8:{f:e7},9:{f:ZL},10:{f:QL},11:{f:JL},12:{f:LL},13:{f:qL},14:{f:VL},15:{f:UL},16:{f:d4},17:{f:XL},18:{f:HL},19:{f:Tx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:C7},40:{},42:{},43:{f:QO},44:{f:XO},45:{f:JO},46:{f:e9},47:{f:ZO},48:{},49:{f:tD},50:{},51:{f:b9},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:W_},62:{f:YL},63:{f:S9},64:{f:c7},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:hr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:o7},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:OL},148:{f:DL,p:16},151:{f:s7},152:{},153:{f:k7},154:{},155:{},156:{f:_7},157:{},158:{},159:{T:1,f:xO},160:{T:-1},161:{T:1,f:Bi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:t7},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:w9},336:{T:-1},337:{f:j9,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Em},357:{},358:{},359:{},360:{T:1},361:{},362:{f:H_},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:a7},427:{f:n7},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:l7},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:IL},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:r7},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Em},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:D9},633:{T:1},634:{T:-1},635:{T:1,f:P9},636:{T:-1},637:{f:sD},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:p7},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:u7},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Dm={6:{f:rh},10:{f:Wa},12:{f:Ct},13:{f:Ct},14:{f:wt},15:{f:wt},16:{f:lr},17:{f:wt},18:{f:wt},19:{f:Ct},20:{f:Dv},21:{f:Dv},23:{f:H_},24:{f:Ov},25:{f:wt},26:{},27:{},28:{f:FI},29:{},34:{f:wt},35:{f:Iv},38:{f:lr},39:{f:lr},40:{f:lr},41:{f:lr},42:{f:wt},43:{f:wt},47:{f:IO},49:{f:fI},51:{f:Ct},60:{},61:{f:cI},64:{f:wt},65:{f:dI},66:{f:Ct},77:{},80:{},81:{},82:{},85:{f:Ct},89:{},90:{},91:{},92:{f:tI},93:{f:PI},94:{},95:{f:wt},96:{},97:{},99:{f:wt},125:{f:W_},128:{f:jI},129:{f:rI},130:{f:Ct},131:{f:wt},132:{f:wt},133:{f:sI},134:{},140:{f:BI},141:{f:Ct},144:{},146:{f:$I},151:{},152:{},153:{},154:{},155:{},156:{f:Ct},157:{},158:{},160:{f:GI},161:{f:zI},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:yI},190:{f:vI},193:{f:Wa},197:{},198:{},199:{},200:{},201:{},202:{f:wt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ct},220:{},221:{f:wt},222:{},224:{f:bI},225:{f:eI},226:{f:Wa},227:{},229:{f:RI},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:aI},253:{f:hI},255:{f:nI},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:L_},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:wt},353:{f:Wa},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:_I},431:{f:wt},432:{},433:{},434:{},437:{},438:{f:OI},439:{f:wt},440:{f:MI},441:{},442:{f:Kc},443:{},444:{f:Ct},445:{},446:{},448:{f:Wa},449:{f:oI,r:2},450:{f:Wa},512:{f:Rv},513:{f:WI},515:{f:NI},516:{f:mI},517:{f:Pv},519:{f:qI},520:{f:iI},523:{},545:{f:Mv},549:{f:Fv},566:{},574:{f:uI},638:{f:gI},659:{},1048:{},1054:{f:pI},1084:{},1212:{f:TI},2048:{f:LI},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Wu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Wa},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:VI,r:12},2173:{f:y9,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:wt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:CI,r:12},2197:{},2198:{f:f9,r:12},2199:{},2200:{},2201:{},2202:{f:EI,r:12},2203:{f:Wa},2204:{},2205:{},2206:{},2207:{},2211:{f:lI},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ct},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:HI},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:UI},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Rv},1:{},2:{f:QI},3:{f:XI},4:{f:KI},5:{f:Pv},7:{f:JI},8:{},9:{f:Wu},11:{},22:{f:Ct},30:{f:xI},31:{},32:{},33:{f:Mv},36:{},37:{f:Fv},50:{f:ZI},62:{},52:{},67:{},68:{f:Ct},69:{},86:{},126:{},127:{f:YI},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:eO},223:{},234:{},354:{},421:{},518:{f:rh},521:{f:Wu},536:{f:Ov},547:{f:Iv},561:{},579:{},1030:{f:rh},1033:{f:Wu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function _s(e,t,r,s){var n=t;if(!isNaN(n)){var i=(r||[]).length||0,l=e.next(4);l.write_shift(2,n),l.write_shift(2,i),i>0&&k_(r)&&e.push(r)}}function Yv(e,t){var r=t||{},s=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),l=n.index,o=i&&i.index||e.length,c=N8(e.slice(l,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,h=0,x={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(l=0;l<c.length;++l){var p=c[l].trim(),w=p.slice(0,3).toLowerCase();if(w=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(w!="<td"&&w!="<th")){var b=p.split(/<\/t[dh]>/i);for(o=0;o<b.length;++o){var g=b[o].trim();if(g.match(/<t[dh]/i)){for(var y=g,j=0;y.charAt(0)=="<"&&(j=y.indexOf(">"))>-1;)y=y.slice(j+1);for(var A=0;A<m.length;++A){var k=m[A];k.s.c==d&&k.s.r<u&&u<=k.e.r&&(d=k.e.c+1,A=-1)}var v=Ne(g.slice(0,g.indexOf(">")));h=v.colspan?+v.colspan:1,((f=+v.rowspan)>1||h>1)&&m.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+h-1}});var E=v.t||v["data-t"]||"";if(!y.length){d+=h;continue}if(y=f_(y),x.s.r>u&&(x.s.r=u),x.e.r<u&&(x.e.r=u),x.s.c>d&&(x.s.c=d),x.e.c<d&&(x.e.c=d),!y.length){d+=h;continue}var S={t:"s",v:y};r.raw||!y.trim().length||E=="s"||(y==="TRUE"?S={t:"b",v:!0}:y==="FALSE"?S={t:"b",v:!1}:isNaN(Ms(y))?isNaN(Bl(y).getDate())||(S={t:"d",v:Vt(y)},r.cellDates||(S={t:"n",v:kr(S.v)}),S.z=r.dateNF||Te[14]):S={t:"n",v:Ms(y)}),r.dense?(s[u]||(s[u]=[]),s[u][d]=S):s[Se({r:u,c:d})]=S,d+=h}}}}return s["!ref"]=Be(x),m.length&&(s["!merges"]=m),s}function Z7(e,t,r,s){for(var n=e["!merges"]||[],i=[],l=t.s.c;l<=t.e.c;++l){for(var o=0,c=0,u=0;u<n.length;++u)if(!(n[u].s.r>r||n[u].s.c>l)&&!(n[u].e.r<r||n[u].e.c<l)){if(n[u].s.r<r||n[u].s.c<l){o=-1;break}o=n[u].e.r-n[u].s.r+1,c=n[u].e.c-n[u].s.c+1;break}if(!(o<0)){var d=Se({r,c:l}),f=s.dense?(e[r]||[])[l]:e[d],h=f&&f.v!=null&&(f.h||Nx(f.w||($a(f),f.w)||""))||"",x={};o>1&&(x.rowspan=o),c>1&&(x.colspan=c),s.editable?h='<span contenteditable="true">'+h+"</span>":f&&(x["data-t"]=f&&f.t||"z",f.v!=null&&(x["data-v"]=f.v),f.z!=null&&(x["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),x.id=(s.id||"sjs")+"-"+d,i.push(B8("td",h,x))}}var m="<tr>";return m+i.join("")+"</tr>"}var eB='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',tB="</body></html>";function rB(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Mn(Yv(r[0],t),t);var s=$x();return r.forEach(function(n,i){Vx(s,Yv(n,t),"Sheet"+(i+1))}),s}function sB(e,t,r){var s=[];return s.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function aB(e,t){var r=t||{},s=r.header!=null?r.header:eB,n=r.footer!=null?r.footer:tB,i=[s],l=Kl(e["!ref"]);r.dense=Array.isArray(e),i.push(sB(e,l,r));for(var o=l.s.r;o<=l.e.r;++o)i.push(Z7(e,l,o,r));return i.push("</table>"+n),i.join("")}function g4(e,t,r){var s=r||{},n=0,i=0;if(s.origin!=null)if(typeof s.origin=="number")n=s.origin;else{var l=typeof s.origin=="string"?jr(s.origin):s.origin;n=l.r,i=l.c}var o=t.getElementsByTagName("tr"),c=Math.min(s.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:n,c:i}};if(e["!ref"]){var d=Kl(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),n==-1&&(u.e.r=n=d.e.r+1)}var f=[],h=0,x=e["!rows"]||(e["!rows"]=[]),m=0,p=0,w=0,b=0,g=0,y=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&p<c;++m){var j=o[m];if(Kv(j)){if(s.display)continue;x[p]={hidden:!0}}var A=j.children;for(w=b=0;w<A.length;++w){var k=A[w];if(!(s.display&&Kv(k))){var v=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):f_(k.innerHTML),E=k.getAttribute("data-z")||k.getAttribute("z");for(h=0;h<f.length;++h){var S=f[h];S.s.c==b+i&&S.s.r<p+n&&p+n<=S.e.r&&(b=S.e.c+1-i,h=-1)}y=+k.getAttribute("colspan")||1,((g=+k.getAttribute("rowspan")||1)>1||y>1)&&f.push({s:{r:p+n,c:b+i},e:{r:p+n+(g||1)-1,c:b+i+(y||1)-1}});var N={t:"s",v},D=k.getAttribute("data-t")||k.getAttribute("t")||"";v!=null&&(v.length==0?N.t=D||"z":s.raw||v.trim().length==0||D=="s"||(v==="TRUE"?N={t:"b",v:!0}:v==="FALSE"?N={t:"b",v:!1}:isNaN(Ms(v))?isNaN(Bl(v).getDate())||(N={t:"d",v:Vt(v)},s.cellDates||(N={t:"n",v:kr(N.v)}),N.z=s.dateNF||Te[14]):N={t:"n",v:Ms(v)})),N.z===void 0&&E!=null&&(N.z=E);var F="",Y=k.getElementsByTagName("A");if(Y&&Y.length)for(var Q=0;Q<Y.length&&!(Y[Q].hasAttribute("href")&&(F=Y[Q].getAttribute("href"),F.charAt(0)!="#"));++Q);F&&F.charAt(0)!="#"&&(N.l={Target:F}),s.dense?(e[p+n]||(e[p+n]=[]),e[p+n][b+i]=N):e[Se({c:b+i,r:p+n})]=N,u.e.c<b+i&&(u.e.c=b+i),b+=y}}++p}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,p-1+n),e["!ref"]=Be(u),p>=c&&(e["!fullref"]=Be((u.e.r=o.length-m+p-1+n,u))),e}function y4(e,t){var r=t||{},s=r.dense?[]:{};return g4(s,e,t)}function nB(e,t){return Mn(y4(e,t),t)}function Kv(e){var t="",r=iB(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function iB(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function lB(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(s,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ve(t.replace(/<[^>]*>/g,""));return[r]}var Xv={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function v4(e,t){var r=t||{},s=_x(e),n=[],i,l,o={name:""},c="",u=0,d,f,h={},x=[],m=r.dense?[]:{},p,w,b={value:""},g="",y=0,j=[],A=-1,k=-1,v={s:{r:1e6,c:1e7},e:{r:0,c:0}},E=0,S={},N=[],D={},F=0,Y=0,Q=[],ae=1,ee=1,fe=[],se={Names:[]},H={},ne=["",""],W=[],T={},L="",B=0,V=!1,te=!1,ue=0;for(Nc.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Nc.exec(s);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(v.e.c>=v.s.c&&v.e.r>=v.s.r?m["!ref"]=Be(v):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=v.e.r&&(m["!fullref"]=m["!ref"],v.e.r=r.sheetRows-1,m["!ref"]=Be(v)),N.length&&(m["!merges"]=N),Q.length&&(m["!rows"]=Q),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),x.push(d.name),h[d.name]=m,te=!1):p[0].charAt(p[0].length-2)!=="/"&&(d=Ne(p[0],!1),A=k=-1,v.s.r=v.s.c=1e7,v.e.r=v.e.c=0,m=r.dense?[]:{},N=[],Q=[],te=!0);break;case"table-row-group":p[1]==="/"?--E:++E;break;case"table-row":case"":if(p[1]==="/"){A+=ae,ae=1;break}if(f=Ne(p[0],!1),f.?A=f.-1:A==-1&&(A=0),ae=+f["number-rows-repeated"]||1,ae<10)for(ue=0;ue<ae;++ue)E>0&&(Q[A+ue]={level:E});k=-1;break;case"covered-table-cell":p[1]!=="/"&&++k,r.sheetStubs&&(r.dense?(m[A]||(m[A]=[]),m[A][k]={t:"z"}):m[Se({r:A,c:k})]={t:"z"}),g="",j=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++k,b=Ne(p[0],!1),ee=parseInt(b["number-columns-repeated"]||"1",10),w={t:"z",v:null},b.formula&&r.cellFormula!=!1&&(w.f=Hv(Ve(b.formula))),(b.||b["value-type"])=="string"&&(w.t="s",w.v=Ve(b["string-value"]||""),r.dense?(m[A]||(m[A]=[]),m[A][k]=w):m[Se({r:A,c:k})]=w),k+=ee-1;else if(p[1]!=="/"){++k,g="",y=0,j=[],ee=1;var ve=ae?A+ae-1:A;if(k>v.e.c&&(v.e.c=k),k<v.s.c&&(v.s.c=k),A<v.s.r&&(v.s.r=A),ve>v.e.r&&(v.e.r=ve),b=Ne(p[0],!1),W=[],T={},w={t:b.||b["value-type"],v:null},r.cellFormula)if(b.formula&&(b.formula=Ve(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(F=parseInt(b["number-matrix-rows-spanned"],10)||0,Y=parseInt(b["number-matrix-columns-spanned"],10)||0,D={s:{r:A,c:k},e:{r:A+F-1,c:k+Y-1}},w.F=Be(D),fe.push([D,w.F])),b.formula)w.f=Hv(b.formula);else for(ue=0;ue<fe.length;++ue)A>=fe[ue][0].s.r&&A<=fe[ue][0].e.r&&k>=fe[ue][0].s.c&&k<=fe[ue][0].e.c&&(w.F=fe[ue][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(F=parseInt(b["number-rows-spanned"],10)||0,Y=parseInt(b["number-columns-spanned"],10)||0,D={s:{r:A,c:k},e:{r:A+F-1,c:k+Y-1}},N.push(D)),b["number-columns-repeated"]&&(ee=parseInt(b["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=st(b["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(b.value);break;case"percentage":w.t="n",w.v=parseFloat(b.value);break;case"currency":w.t="n",w.v=parseFloat(b.value);break;case"date":w.t="d",w.v=Vt(b["date-value"]),r.cellDates||(w.t="n",w.v=kr(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=w8(b["time-value"])/86400,r.cellDates&&(w.t="d",w.v=Q0(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(b.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",b["string-value"]!=null&&(g=Ve(b["string-value"]),j=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(V=!1,w.t==="s"&&(w.v=g||"",j.length&&(w.R=j),V=y==0),H.Target&&(w.l=H),W.length>0&&(w.c=W,W=[]),g&&r.cellText!==!1&&(w.w=g),V&&(w.t="z",delete w.v),(!V||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=A))for(var pe=0;pe<ae;++pe){if(ee=parseInt(b["number-columns-repeated"]||"1",10),r.dense)for(m[A+pe]||(m[A+pe]=[]),m[A+pe][k]=pe==0?w:Kt(w);--ee>0;)m[A+pe][k+ee]=Kt(w);else for(m[Se({r:A+pe,c:k})]=w;--ee>0;)m[Se({r:A+pe,c:k+ee})]=Kt(w);v.e.c<=k&&(v.e.c=k)}ee=parseInt(b["number-columns-repeated"]||"1",10),k+=ee-1,ee=0,w={},g="",j=[]}H={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((i=n.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((i=n.pop())[0]!==p[3])throw"Bad state: "+i;T.t=g,j.length&&(T.R=j),T.a=L,W.push(T)}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!1]);L="",B=0,g="",y=0,j=[];break;case"creator":p[1]==="/"?L=s.slice(B,p.index):B=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((i=n.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!1]);g="",y=0,j=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(S[o.name]=c,(i=n.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&(c="",o=Ne(p[0],!1),n.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":l=Ne(p[0],!1),c+=Xv[p[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":l=Ne(p[0],!1),c+=Xv[p[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":c+=s.slice(u,p.index);break}else u=p.index+p[0].length;break;case"named-range":l=Ne(p[0],!1),ne=sh(l["cell-range-address"]);var le={Name:l.name,Ref:ne[0]+"!"+ne[1]};te&&(le.Sheet=x.length),se.Names.push(le);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(p[1]==="/"&&(!b||!b["string-value"])){var ke=lB(s.slice(y,p.index));g=(g.length>0?g+`
`:"")+ke[0]}else Ne(p[0],!1),y=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{ne=sh(Ne(p[0])["target-range-address"]),h[ne[0]]["!autofilter"]={ref:ne[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(H=Ne(p[0],!1),!H.href)break;H.Target=Ve(H.href),delete H.href,H.Target.charAt(0)=="#"&&H.Target.indexOf(".")>-1?(ne=sh(H.Target.slice(1)),H.Target="#"+ne[0]+"!"+ne[1]):H.Target.match(/^\.\.[\\\/]/)&&(H.Target=H.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(p)}}var U={Sheets:h,SheetNames:x,Workbook:se};return r.bookSheets&&delete U.Sheets,U}function Qv(e,t){t=t||{},ls(e,"META-INF/manifest.xml")&&ND(St(e,"META-INF/manifest.xml"),t);var r=Gr(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var s=v4(Ze(r),t);return ls(e,"meta.xml")&&(s.Props=R_(St(e,"meta.xml"))),s}function Jv(e,t){return v4(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Mx(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Im(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Ze(Mi(e))}function Om(e){var t=e.reduce(function(n,i){return n+i.length},0),r=new Uint8Array(t),s=0;return e.forEach(function(n){r.set(n,s),s+=n.length}),r}function Zv(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function oB(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,s=e[t+14]&1,n=t+13;n>=t;--n)s=s*256+e[n];return(e[t+15]&128?-s:s)*Math.pow(10,r-6176)}function Cc(e,t){var r=t?t[0]:0,s=e[r]&127;e:if(e[r++]>=128&&(s|=(e[r]&127)<<7,e[r++]<128||(s|=(e[r]&127)<<14,e[r++]<128)||(s|=(e[r]&127)<<21,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),s}function It(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function or(e){for(var t=[],r=[0];r[0]<e.length;){var s=r[0],n=Cc(e,r),i=n&7;n=Math.floor(n/8);var l=0,o;if(n==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:l=4,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=Cc(e,r),o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(s))}var u={data:o,type:i};t[n]==null?t[n]=[u]:t[n].push(u)}return t}function Lx(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function cB(e){for(var t,r=[],s=[0];s[0]<e.length;){var n=Cc(e,s),i=or(e.slice(s[0],s[0]+n));s[0]+=n;var l={id:It(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=or(o.data),u=It(c[3][0].data);l.messages.push({meta:c,data:e.slice(s[0],s[0]+u)}),s[0]+=u}),(t=i[3])!=null&&t[0]&&(l.merge=It(i[3][0].data)>>>0>0),r.push(l)}return r}function uB(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],s=Cc(t,r),n=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var o=l-59;l=t[r[0]],o>1&&(l|=t[r[0]+1]<<8),o>2&&(l|=t[r[0]+2]<<16),o>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=o}n.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var c=0,u=0;if(i==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[Om(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(n.push(n[0].slice(-c)),u-=c;u>=n[n.length-1].length;)n.push(n[n.length-1]),u-=n[n.length-1].length;n.push(n[0].slice(-c,-c+u))}}var d=Om(n);if(d.length!=s)throw new Error("Unexpected length: ".concat(d.length," != ").concat(s));return d}function dB(e){for(var t=[],r=0;r<e.length;){var s=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(uB(s,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Om(t)}function fB(e,t,r,s){var n=Mx(e),i=n.getUint32(4,!0),l=(s>1?12:8)+Zv(i&(s>1?3470:398))*4,o=-1,c=-1,u=NaN,d=new Date(2001,0,1);i&512&&(o=n.getUint32(l,!0),l+=4),l+=Zv(i&(s>1?12288:4096))*4,i&16&&(c=n.getUint32(l,!0),l+=4),i&32&&(u=n.getFloat64(l,!0),l+=8),i&64&&(d.setTime(d.getTime()+n.getFloat64(l,!0)*1e3),l+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function hB(e,t,r){var s=Mx(e),n=s.getUint32(8,!0),i=12,l=-1,o=-1,c=NaN,u=NaN,d=new Date(2001,0,1);n&1&&(c=oB(e,i),i+=16),n&2&&(u=s.getFloat64(i,!0),i+=8),n&4&&(d.setTime(d.getTime()+s.getFloat64(i,!0)*1e3),i+=8),n&8&&(o=s.getUint32(i,!0),i+=4),n&16&&(l=s.getUint32(i,!0),i+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return f}function mB(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return fB(e,t,r,e[0]);case 5:return hB(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function kn(e){var t=or(e);return Cc(t[1][0].data)}function e2(e,t){var r=or(t.data),s=It(r[1][0].data),n=r[3],i=[];return(n||[]).forEach(function(l){var o=or(l.data),c=It(o[1][0].data)>>>0;switch(s){case 1:i[c]=Im(o[3][0].data);break;case 8:{var u=e[kn(o[9][0].data)][0],d=or(u.data),f=e[kn(d[1][0].data)][0],h=It(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var x=or(f.data);i[c]=x[3].map(function(m){return Im(m.data)}).join("")}break}}),i}function pB(e,t){var r,s,n,i,l,o,c,u,d,f,h,x,m,p,w=or(e),b=It(w[1][0].data)>>>0,g=It(w[2][0].data)>>>0,y=((s=(r=w[8])==null?void 0:r[0])==null?void 0:s.data)&&It(w[8][0].data)>0||!1,j,A;if((i=(n=w[7])==null?void 0:n[0])!=null&&i.data&&t!=0)j=(o=(l=w[7])==null?void 0:l[0])==null?void 0:o.data,A=(u=(c=w[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=w[4])==null?void 0:d[0])!=null&&f.data&&t!=1)j=(x=(h=w[4])==null?void 0:h[0])==null?void 0:x.data,A=(p=(m=w[3])==null?void 0:m[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var k=y?4:1,v=Mx(j),E=[],S=0;S<j.length/2;++S){var N=v.getUint16(S*2,!0);N<65535&&E.push([S,N])}if(E.length!=g)throw"Expected ".concat(g," cells, found ").concat(E.length);var D=[];for(S=0;S<E.length-1;++S)D[E[S][0]]=A.subarray(E[S][1]*k,E[S+1][1]*k);return E.length>=1&&(D[E[E.length-1][0]]=A.subarray(E[E.length-1][1]*k)),{R:b,cells:D}}function xB(e,t){var r,s=or(t.data),n=(r=s==null?void 0:s[7])!=null&&r[0]?It(s[7][0].data)>>>0>0?1:0:-1,i=Lx(s[5],function(l){return pB(l,n)});return{nrows:It(s[4][0].data)>>>0,data:i.reduce(function(l,o){return l[o.R]||(l[o.R]=[]),o.cells.forEach(function(c,u){if(l[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));l[o.R][u]=c}),l},[])}}function gB(e,t,r){var s,n=or(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(It(n[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(i.e.c=(It(n[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=Be(i);var l=or(n[4][0].data),o=e2(e,e[kn(l[4][0].data)][0]),c=(s=l[17])!=null&&s[0]?e2(e,e[kn(l[17][0].data)][0]):[],u=or(l[3][0].data),d=0;u[1].forEach(function(f){var h=or(f.data),x=e[kn(h[2][0].data)][0],m=It(x.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var p=xB(e,x);p.data.forEach(function(w,b){w.forEach(function(g,y){var j=Se({r:d+b,c:y}),A=mB(g,o,c);A&&(r[j]=A)})}),d+=p.nrows})}function yB(e,t){var r=or(t.data),s={"!ref":"A1"},n=e[kn(r[2][0].data)],i=It(n[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return gB(e,n[0],s),s}function vB(e,t){var r,s=or(t.data),n={name:(r=s[1])!=null&&r[0]?Im(s[1][0].data):"",sheets:[]},i=Lx(s[2],kn);return i.forEach(function(l){e[l].forEach(function(o){var c=It(o.meta[1][0].data);c==6e3&&n.sheets.push(yB(e,o))})}),n}function wB(e,t){var r=$x(),s=or(t.data),n=Lx(s[1],kn);if(n.forEach(function(i){e[i].forEach(function(l){var o=It(l.meta[1][0].data);if(o==2){var c=vB(e,l);c.sheets.forEach(function(u,d){Vx(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function nh(e){var t,r,s,n,i={},l=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=dB(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=cB(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){i[f.id]=f.messages,l.push(f.id)})}}),!l.length)throw new Error("File has no messages");var o=((n=(s=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:s[1])==null?void 0:n[0].data)&&It(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||l.forEach(function(c){i[c].forEach(function(u){var d=It(u.meta[1][0].data)>>>0;if(d==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return wB(i,o)}function bB(e){return function(r){for(var s=0;s!=e.length;++s){var n=e[s];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function Bx(e){bB([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function jB(e){return ul.WS.indexOf(e)>-1?"sheet":e==ul.CS?"chart":e==ul.DS?"dialog":e==ul.MS?"macro":e&&e.length?e:"sheet"}function NB(e,t){if(!e)return 0;try{e=t.map(function(s){return s.id||(s.id=s.strRelID),[s.name,e["!id"][s.id].Target,jB(e["!id"][s.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function _B(e,t,r,s,n,i,l,o,c,u,d,f){try{i[s]=Bo(Gr(e,r,!0),t);var h=St(e,t),x;switch(o){case"sheet":x=A7(h,t,n,c,i[s],u,d,f);break;case"chart":if(x=F7(h,t,n,c,i[s],u,d,f),!x||!x["!drawel"])break;var m=bo(x["!drawel"].Target,t),p=Am(m),w=E9(Gr(e,m,!0),Bo(Gr(e,p,!0),m)),b=bo(w,m),g=Am(b);x=h7(Gr(e,b,!0),b,c,Bo(Gr(e,g,!0),b),u,x);break;case"macro":x=R7(h,t,n,c,i[s],u,d,f);break;case"dialog":x=P7(h,t,n,c,i[s],u,d,f);break;default:throw new Error("Unrecognized sheet type "+o)}l[s]=x;var y=[];i&&i[s]&&da(i[s]).forEach(function(j){var A="";if(i[s][j].Type==ul.CMNT){A=bo(i[s][j].Target,t);var k=M7(St(e,A,!0),A,c);if(!k||!k.length)return;Bv(x,k,!1)}i[s][j].Type==ul.TCMNT&&(A=bo(i[s][j].Target,t),y=y.concat(F9(St(e,A,!0),c)))}),y&&y.length&&Bv(x,y,!0,c.people||[])}catch(j){if(c.WTF)throw j}}function as(e){return e.charAt(0)=="/"?e.slice(1):e}function kB(e,t){if(s_(),t=t||{},Bx(t),ls(e,"META-INF/manifest.xml")||ls(e,"objectdata.xml"))return Qv(e,t);if(ls(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof nh<"u"){if(e.FileIndex)return nh(e);var r=Le.utils.cfb_new();return fv(e).forEach(function(Q){S8(r,Q,k8(e,Q))}),nh(r)}throw new Error("Unsupported NUMBERS file")}if(!ls(e,"[Content_Types].xml"))throw ls(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ls(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var s=fv(e),n=bD(Gr(e,"[Content_Types].xml")),i=!1,l,o;if(n.workbooks.length===0&&(o="xl/workbook.xml",St(e,o,!0)&&n.workbooks.push(o)),n.workbooks.length===0){if(o="xl/workbook.bin",!St(e,o,!0))throw new Error("Could not find workbook");n.workbooks.push(o),i=!0}n.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(Vo=[],n.sst)try{Vo=O7(St(e,as(n.sst)),n.sst,t)}catch(Q){if(t.WTF)throw Q}t.cellStyles&&n.themes.length&&(c=I7(Gr(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(u=D7(St(e,as(n.style)),n.style,c,t))}n.links.map(function(Q){try{var ae=Bo(Gr(e,Am(as(Q))),Q);return B7(St(e,as(Q)),ae,Q,t)}catch{}});var d=E7(St(e,as(n.workbooks[0])),n.workbooks[0],t),f={},h="";n.coreprops.length&&(h=St(e,as(n.coreprops[0]),!0),h&&(f=R_(h)),n.extprops.length!==0&&(h=St(e,as(n.extprops[0]),!0),h&&SD(h,f,t)));var x={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(h=Gr(e,as(n.custprops[0]),!0),h&&(x=TD(h,t)));var m={};if((t.bookSheets||t.bookProps)&&(d.Sheets?l=d.Sheets.map(function(ae){return ae.name}):f.Worksheets&&f.SheetNames.length>0&&(l=f.SheetNames),t.bookProps&&(m.Props=f,m.Custprops=x),t.bookSheets&&typeof l<"u"&&(m.SheetNames=l),t.bookSheets?m.SheetNames:t.bookProps))return m;l={};var p={};t.bookDeps&&n.calcchain&&(p=L7(St(e,as(n.calcchain)),n.calcchain));var w=0,b={},g,y;{var j=d.Sheets;f.Worksheets=j.length,f.SheetNames=[];for(var A=0;A!=j.length;++A)f.SheetNames[A]=j[A].name}var k=i?"bin":"xml",v=n.workbooks[0].lastIndexOf("/"),E=(n.workbooks[0].slice(0,v+1)+"_rels/"+n.workbooks[0].slice(v+1)+".rels").replace(/^\//,"");ls(e,E)||(E="xl/_rels/workbook."+k+".rels");var S=Bo(Gr(e,E,!0),E.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=U7(St(e,as(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=R9(St(e,as(n.people[0])),t)),S&&(S=NB(S,d.Sheets));var N=St(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=f.Worksheets;++w){var D="sheet";if(S&&S[w]?(g="xl/"+S[w][1].replace(/[\/]?xl\//,""),ls(e,g)||(g=S[w][1]),ls(e,g)||(g=E.replace(/_rels\/.*$/,"")+S[w][1]),D=S[w][2]):(g="xl/worksheets/sheet"+(w+1-N)+"."+k,g=g.replace(/sheet0\./,"sheet.")),y=g.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(w!=t.sheets)continue e;break;case"string":if(f.SheetNames[w].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var F=!1,Y=0;Y!=t.sheets.length;++Y)typeof t.sheets[Y]=="number"&&t.sheets[Y]==w&&(F=1),typeof t.sheets[Y]=="string"&&t.sheets[Y].toLowerCase()==f.SheetNames[w].toLowerCase()&&(F=1);if(!F)continue e}}_B(e,g,y,f.SheetNames[w],w,b,l,D,t,d,c,u)}return m={Directory:n,Workbook:d,Props:f,Custprops:x,Deps:p,Sheets:l,SheetNames:f.SheetNames,Strings:Vo,Styles:u,Themes:c,SSF:Kt(Te)},t&&t.bookFiles&&(e.files?(m.keys=s,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(Q,ae){Q=Q.replace(/^Root Entry[\/]/,""),m.keys.push(Q),m.files[Q]=e.FileIndex[ae]}))),t&&t.bookVBA&&(n.vba.length>0?m.vbaraw=St(e,as(n.vba[0]),!0):n.defaults&&n.defaults.bin===O9&&(m.vbaraw=St(e,"xl/vbaProject.bin",!0))),m}function SB(e,t){var r=t||{},s="Workbook",n=Le.find(e,s);try{if(s="/!DataSpaces/Version",n=Le.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(yO(n.content),s="/!DataSpaces/DataSpaceMap",n=Le.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var i=wO(n.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=Le.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var l=bO(n.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=Le.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);NO(n.content)}catch{}if(s="/EncryptionInfo",n=Le.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var o=_O(n.content);if(s="/EncryptedPackage",n=Le.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],n.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function Ux(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Zr(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function CB(e,t){return Le.find(e,"EncryptedPackage")?SB(e,t):x4(e,t)}function TB(e,t){var r,s=e,n=t||{};return n.type||(n.type=Oe&&Buffer.isBuffer(e)?"buffer":"base64"),r=c_(s,n),kB(r,n)}function w4(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Pm(e.slice(r),t);default:break e}return _c.to_workbook(e,t)}function EB(e,t){var r="",s=Ux(e,t);switch(t.type){case"base64":r=Zr(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Ci(e);break;default:throw new Error("Unrecognized type "+t.type)}return s[0]==239&&s[1]==187&&s[2]==191&&(r=Ze(r)),t.type="binary",w4(r,t)}function AB(e,t){var r=e;return t.type=="base64"&&(r=Zr(r)),r=wc.utils.decode(1200,r.slice(2),"str"),t.type="binary",w4(r,t)}function FB(e){return e.match(/[^\x00-\x7F]/)?jo(e):e}function ih(e,t,r,s){return s?(r.type="string",_c.to_workbook(e,r)):_c.to_workbook(t,r)}function Mm(e,t){WN();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Mm(new Uint8Array(e),(r=Kt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var s=e,n=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),vl={},r.dateNF&&(vl.dateNF=r.dateNF),r.type||(r.type=Oe&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Oe?"buffer":"binary",s=y8(e),typeof Uint8Array<"u"&&!Oe&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,s=FB(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),o=new Uint8Array(l);if(o.foo="bar",!o.foo)return r=Kt(r),r.type="array",Mm(yx(s),r)}switch((n=Ux(s,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return CB(Le.read(s,r),r);break;case 9:if(n[1]<=8)return x4(s,r);break;case 60:return Pm(s,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return nO(s,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return sO.to_workbook(s,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?TB(s,r):ih(e,s,r,i);case 239:return n[3]===60?Pm(s,r):ih(e,s,r,i);case 255:if(n[1]===254)return AB(s,r);if(n[1]===0&&n[2]===2&&n[3]===0)return $o.to_workbook(s,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return $o.to_workbook(s,r);break;case 3:case 131:case 139:case 140:return Lv.to_workbook(s,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return OO.to_workbook(s,r);break;case 10:case 13:case 32:return EB(s,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return tO.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?Lv.to_workbook(s,r):ih(e,s,r,i)}function RB(e,t,r,s,n,i,l,o){var c=Xt(r),u=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!l||e[r])for(var x=t.s.c;x<=t.e.c;++x){var m=l?e[r][x]:e[s[x]+c];if(m===void 0||m.t===void 0){if(u===void 0)continue;i[x]!=null&&(h[i[x]]=u);continue}var p=m.v;switch(m.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(i[x]!=null){if(p==null)if(m.t=="e"&&p===null)h[i[x]]=null;else if(u!==void 0)h[i[x]]=u;else if(d&&p===null)h[i[x]]=null;else continue;else h[i[x]]=d&&(m.t!=="n"||m.t==="n"&&o.rawNumbers!==!1)?p:$a(m,p,o);p!=null&&(f=!1)}}return{row:h,isempty:f}}function Lm(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},s=0,n=1,i=[],l=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?s=1:u.header==="A"?s=2:Array.isArray(u.header)?s=3:u.header==null&&(s=0),typeof d){case"string":c=yt(d);break;case"number":c=yt(e["!ref"]),c.s.r=d;break;default:c=d}s>0&&(n=0);var f=Xt(c.s.r),h=[],x=[],m=0,p=0,w=Array.isArray(e),b=c.s.r,g=0,y={};w&&!e[b]&&(e[b]=[]);var j=u.skipHidden&&e["!cols"]||[],A=u.skipHidden&&e["!rows"]||[];for(g=c.s.c;g<=c.e.c;++g)if(!(j[g]||{}).hidden)switch(h[g]=Pt(g),r=w?e[b][g]:e[h[g]+f],s){case 1:i[g]=g-c.s.c;break;case 2:i[g]=h[g];break;case 3:i[g]=u.header[g-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=l=$a(r,null,u),p=y[l]||0,!p)y[l]=1;else{do o=l+"_"+p++;while(y[o]);y[l]=p,y[o]=1}i[g]=o}for(b=c.s.r+n;b<=c.e.r;++b)if(!(A[b]||{}).hidden){var k=RB(e,c,b,h,s,i,w,u);(k.isempty===!1||(s===1?u.blankrows!==!1:u.blankrows))&&(x[m++]=k.row)}return x.length=m,x}var t2=/"/g;function PB(e,t,r,s,n,i,l,o){for(var c=!0,u=[],d="",f=Xt(r),h=t.s.c;h<=t.e.c;++h)if(s[h]){var x=o.dense?(e[r]||[])[h]:e[s[h]+f];if(x==null)d="";else if(x.v!=null){c=!1,d=""+(o.rawNumbers&&x.t=="n"?x.v:$a(x,null,o));for(var m=0,p=0;m!==d.length;++m)if((p=d.charCodeAt(m))===n||p===i||p===34||o.forceQuotes){d='"'+d.replace(t2,'""')+'"';break}d=="ID"&&(d='"ID"')}else x.f!=null&&!x.F?(c=!1,d="="+x.f,d.indexOf(",")>=0&&(d='"'+d.replace(t2,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&c?null:u.join(l)}function b4(e,t){var r=[],s=t??{};if(e==null||e["!ref"]==null)return"";var n=yt(e["!ref"]),i=s.FS!==void 0?s.FS:",",l=i.charCodeAt(0),o=s.RS!==void 0?s.RS:`
`,c=o.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),d="",f=[];s.dense=Array.isArray(e);for(var h=s.skipHidden&&e["!cols"]||[],x=s.skipHidden&&e["!rows"]||[],m=n.s.c;m<=n.e.c;++m)(h[m]||{}).hidden||(f[m]=Pt(m));for(var p=0,w=n.s.r;w<=n.e.r;++w)(x[w]||{}).hidden||(d=PB(e,n,w,f,l,c,i,s),d!=null&&(s.strip&&(d=d.replace(u,"")),(d||s.blankrows!==!1)&&r.push((p++?o:"")+d)));return delete s.dense,r.join("")}function DB(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=b4(e,t);return r}function IB(e){var t="",r,s="";if(e==null||e["!ref"]==null)return[];var n=yt(e["!ref"]),i="",l=[],o,c=[],u=Array.isArray(e);for(o=n.s.c;o<=n.e.c;++o)l[o]=Pt(o);for(var d=n.s.r;d<=n.e.r;++d)for(i=Xt(d),o=n.s.c;o<=n.e.c;++o)if(t=l[o]+i,r=u?(e[d]||[])[o]:e[t],s="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;s=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)s=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)s=""+r.v;else if(r.t=="b")s=r.v?"TRUE":"FALSE";else if(r.w!==void 0)s="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?s="'"+r.v:s=""+r.v}}c[c.length]=t+"="+s}return c}function j4(e,t,r){var s=r||{},n=+!s.skipHeader,i=e||{},l=0,o=0;if(i&&s.origin!=null)if(typeof s.origin=="number")l=s.origin;else{var c=typeof s.origin=="string"?jr(s.origin):s.origin;l=c.r,o=c.c}var u,d={s:{c:0,r:0},e:{c:o,r:l+t.length-1+n}};if(i["!ref"]){var f=yt(i["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),l==-1&&(l=f.e.r+1,d.e.r=l+t.length-1+n)}else l==-1&&(l=0,d.e.r=t.length-1+n);var h=s.header||[],x=0;t.forEach(function(p,w){da(p).forEach(function(b){(x=h.indexOf(b))==-1&&(h[x=h.length]=b);var g=p[b],y="z",j="",A=Se({c:o+x,r:l+w+n});u=Tc(i,A),g&&typeof g=="object"&&!(g instanceof Date)?i[A]=g:(typeof g=="number"?y="n":typeof g=="boolean"?y="b":typeof g=="string"?y="s":g instanceof Date?(y="d",s.cellDates||(y="n",g=kr(g)),j=s.dateNF||Te[14]):g===null&&s.nullError&&(y="e",g=0),u?(u.t=y,u.v=g,delete u.w,delete u.R,j&&(u.z=j)):i[A]=u={t:y,v:g},j&&(u.z=j))})}),d.e.c=Math.max(d.e.c,o+h.length-1);var m=Xt(l);if(n)for(x=0;x<h.length;++x)i[Pt(x+o)+m]={t:"s",v:h[x]};return i["!ref"]=Be(d),i}function OB(e,t){return j4(null,e,t)}function Tc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var s=jr(t);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Tc(e,Se(t)):Tc(e,Se({r:t,c:r||0}))}function MB(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function $x(){return{SheetNames:[],Sheets:{}}}function Vx(e,t,r,s){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var l=i&&i[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=l+n)!=-1;++n);}if(b7(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function LB(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=MB(e,t);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[s].Hidden=r}function BB(e,t){return e.z=t,e}function N4(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function UB(e,t,r){return N4(e,"#"+t,r)}function $B(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function VB(e,t,r,s){for(var n=typeof t!="string"?t:yt(t),i=typeof t=="string"?t:Be(t),l=n.s.r;l<=n.e.r;++l)for(var o=n.s.c;o<=n.e.c;++o){var c=Tc(e,l,o);c.t="n",c.F=i,delete c.v,l==n.s.r&&o==n.s.c&&(c.f=r,s&&(c.D=!0))}return e}var zB={encode_col:Pt,encode_row:Xt,encode_cell:Se,encode_range:Be,decode_col:Cx,decode_row:Sx,split_cell:eD,decode_cell:jr,decode_range:Kl,format_cell:$a,sheet_add_aoa:C_,sheet_add_json:j4,sheet_add_dom:g4,aoa_to_sheet:Xl,json_to_sheet:OB,table_to_sheet:y4,table_to_book:nB,sheet_to_csv:b4,sheet_to_txt:DB,sheet_to_json:Lm,sheet_to_html:aB,sheet_to_formulae:IB,sheet_to_row_object_array:Lm,sheet_get_cell:Tc,book_new:$x,book_append_sheet:Vx,book_set_sheet_visibility:LB,cell_set_number_format:BB,cell_set_hyperlink:N4,cell_set_internal_link:UB,cell_add_comment:$B,sheet_set_array_formula:VB,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const HB="https://portal.auraai.toroniandcompany.com/api";class WB{constructor(){Wt(this,"api");this.api=ye.create({baseURL:`${HB}/audit-planning`,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(t=>{const r=localStorage.getItem("access_token");return r&&(t.headers.Authorization=`Bearer ${r}`),t}),this.api.interceptors.response.use(t=>t,t=>{var r;return((r=t.response)==null?void 0:r.status)===401&&(localStorage.removeItem("access_token"),window.location.href="/login"),Promise.reject(t)})}async calculateMateriality(t){return(await this.api.post("/materiality/calculate",t)).data}async assessRisk(t){return(await this.api.post("/risk/assess",t)).data}async createAuditPlan(t){return(await this.api.post("/plans",t)).data}async getAuditPlan(t){return(await this.api.get(`/plans/${t}`)).data}async generateAuditProgram(t,r,s="moderate"){return(await this.api.post(`/programs/generate/${t}`,null,{params:{area:r,risk_level:s}})).data}async analyzeRiskWithAI(t){return(await this.api.post("/ai/analyze-risk",t)).data}async generateAuditProgramWithAI(t){return(await this.api.post("/ai/generate-program",t)).data}async calculateMaterialityWithAI(t){return(await this.api.post("/ai/materiality",t)).data}async detectFraudWithAI(t){return(await this.api.post("/ai/detect-fraud",t)).data}async generatePlanningMemoWithAI(t){return(await this.api.post("/ai/planning-memo",t)).data}async getAICapabilities(){return(await this.api.get("/ai/capabilities")).data}}const ho=new WB,Wi={total_assets:0,total_liabilities:0,current_assets:0,current_liabilities:0,total_revenue:0,net_income:0,pretax_income:0,total_equity:0,inventory:0,accounts_receivable:0,cost_of_goods_sold:0,operating_expenses:0,allowance_doubtful:0},GB=[{id:"manual",name:"Manual Entry",icon:Z6,description:"Enter financial data manually"},{id:"upload",name:"Upload File",icon:oa,description:"Upload Excel, CSV, or PDF trial balance"},{id:"quickbooks",name:"QuickBooks",icon:ud,description:"Connect to QuickBooks Online"},{id:"xero",name:"Xero",icon:ud,description:"Connect to Xero accounting"},{id:"sage",name:"Sage",icon:ud,description:"Connect to Sage Intacct"}],qB={total_assets:"Total Assets",total_liabilities:"Total Liabilities",current_assets:"Current Assets",current_liabilities:"Current Liabilities",total_revenue:"Total Revenue",net_income:"Net Income",pretax_income:"Pre-Tax Income",total_equity:"Total Equity",inventory:"Inventory",accounts_receivable:"Accounts Receivable",cost_of_goods_sold:"Cost of Goods Sold",operating_expenses:"Operating Expenses",allowance_doubtful:"Allowance for Doubtful Accounts"},YB=()=>{var Zc,eu,$n,tu,ru,su,au,nu,iu,lu,ou,Vi,cu,uu,du,R,M;const{id:e}=Hs(),t=ze(),[r,s]=C.useState(null),[n,i]=C.useState(""),[l,o]=C.useState("manufacturing"),[c,u]=C.useState(!0),[d,f]=C.useState("risk"),[h,x]=C.useState(Wi),[m,p]=C.useState(!0),[w,b]=C.useState("manual"),[g,y]=C.useState(null),[j,A]=C.useState(!1),[k,v]=C.useState(0),[E,S]=C.useState(!1),[N,D]=C.useState(!1),[F,Y]=C.useState(null),[Q,ae]=C.useState(null),[ee,fe]=C.useState(null),[se,H]=C.useState([]),[ne,W]=C.useState(null),[T,L]=C.useState(!1),[B,V]=C.useState(!1),[te,ue]=C.useState(!1),[ve,pe]=C.useState(!1),[le,ke]=C.useState(!1),[U,rt]=C.useState(!1),Me=[{value:"manufacturing",label:"Manufacturing"},{value:"technology",label:"Technology"},{value:"healthcare",label:"Healthcare"},{value:"retail",label:"Retail"},{value:"financial_services",label:"Financial Services"},{value:"default",label:"Other"}];C.useEffect(()=>{e&&He(e)},[e]);const He=async _=>{try{u(!0);const P=await ca.getEngagement(_);if(s(P),P.client_id)try{const I=await si.getClient(P.client_id);i(I.name||P.client_id)}catch{i(P.client_id)}}catch(P){console.error("Failed to load engagement:",P),de.error("Failed to load engagement"),t("/firm/audits")}finally{u(!1)}},Fe=_=>{_.preventDefault(),A(!0)},xe=_=>{_.preventDefault(),A(!1)},it=_=>{_.preventDefault(),A(!1);const P=_.dataTransfer.files;P.length>0&&Ur(P[0])},Tr=_=>{const P=_.target.files;P&&P.length>0&&Ur(P[0])},Ur=async _=>{if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv","application/pdf"].includes(_.type)&&!_.name.endsWith(".csv")&&!_.name.endsWith(".xlsx")){de.error("Please upload an Excel, CSV, or PDF file");return}y(_),S(!0),v(0);try{for(let O=0;O<=100;O+=10)await new Promise(G=>setTimeout(G,100)),v(O);const I=await vs(_);x(I),D(!0),de.success(`Financial data extracted from ${_.name}`)}catch(I){console.error("File processing error:",I),de.error("Failed to process file. Please check the format.")}finally{S(!1)}},vs=async _=>{if(_.name.endsWith(".csv")){const P=await _.text();return Gs(P)}return _.name.endsWith(".xlsx")||_.name.endsWith(".xls")?new Promise((P,I)=>{const O=new FileReader;O.onload=G=>{var Z;try{const q=(Z=G.target)==null?void 0:Z.result,K=Mm(q,{type:"binary"}),X=K.SheetNames[0],ie=K.Sheets[X],he=zB.sheet_to_json(ie,{header:1}),ge=Ln(he);P(ge)}catch(q){console.error("Excel parsing error:",q),I(q)}},O.onerror=()=>I(new Error("Failed to read file")),O.readAsBinaryString(_)}):(_.name.endsWith(".pdf")&&de.error("PDF parsing requires backend processing. Please use Excel or CSV format."),Wi)},Ln=_=>{const P={...Wi},I={"total assets":"total_assets","assets total":"total_assets","total asset":"total_assets",assets:"total_assets","sum of assets":"total_assets","total liabilities":"total_liabilities","liabilities total":"total_liabilities","total liability":"total_liabilities",liabilities:"total_liabilities","sum of liabilities":"total_liabilities","current assets":"current_assets","total current assets":"current_assets","current assets total":"current_assets","current liabilities":"current_liabilities","total current liabilities":"current_liabilities","current liabilities total":"current_liabilities",revenue:"total_revenue","total revenue":"total_revenue",revenues:"total_revenue","net revenue":"total_revenue","net revenues":"total_revenue",sales:"total_revenue","net sales":"total_revenue","total sales":"total_revenue","gross sales":"total_revenue","service revenue":"total_revenue","operating revenue":"total_revenue","net income":"net_income","net profit":"net_income","net earnings":"net_income","net income (loss)":"net_income","profit (loss)":"net_income",profit:"net_income",earnings:"net_income","bottom line":"net_income","pretax income":"pretax_income","pre-tax income":"pretax_income","income before tax":"pretax_income","income before taxes":"pretax_income","earnings before tax":"pretax_income",ebt:"pretax_income","income before income tax":"pretax_income","profit before tax":"pretax_income",equity:"total_equity","total equity":"total_equity","stockholders equity":"total_equity","stockholders' equity":"total_equity","shareholders equity":"total_equity","shareholders' equity":"total_equity","owners equity":"total_equity","owner's equity":"total_equity","net worth":"total_equity","total stockholders equity":"total_equity","total shareholders equity":"total_equity",capital:"total_equity",inventory:"inventory",inventories:"inventory","merchandise inventory":"inventory","finished goods":"inventory","raw materials":"inventory","work in progress":"inventory",stock:"inventory","accounts receivable":"accounts_receivable",receivables:"accounts_receivable","trade receivables":"accounts_receivable","a/r":"accounts_receivable",ar:"accounts_receivable","net receivables":"accounts_receivable","accounts receivable net":"accounts_receivable","trade accounts receivable":"accounts_receivable","customer receivables":"accounts_receivable","cost of goods sold":"cost_of_goods_sold",cogs:"cost_of_goods_sold","cost of sales":"cost_of_goods_sold","cost of revenue":"cost_of_goods_sold","cost of products sold":"cost_of_goods_sold","cost of services":"cost_of_goods_sold","direct costs":"cost_of_goods_sold","operating expenses":"operating_expenses",opex:"operating_expenses","total operating expenses":"operating_expenses","operating costs":"operating_expenses","sg&a":"operating_expenses",sga:"operating_expenses","selling general administrative":"operating_expenses","general and administrative":"operating_expenses","allowance for doubtful accounts":"allowance_doubtful","allowance for bad debts":"allowance_doubtful","allowance doubtful":"allowance_doubtful","bad debt reserve":"allowance_doubtful","provision for bad debts":"allowance_doubtful"},O=G=>{if(G==null||G==="")return 0;if(typeof G=="number")return Math.abs(G);const Z=String(G).replace(/[$,\s]/g,"").replace(/\(([^)]+)\)/g,"-$1").trim(),q=parseFloat(Z);return isNaN(q)?0:Math.abs(q)};for(const G of _)if(!(!G||G.length<2))for(let Z=0;Z<G.length-1;Z++){const q=G[Z];if(typeof q!="string")continue;const K=q.toLowerCase().trim();if(K){for(const[X,ie]of Object.entries(I))if(K===X||K.includes(X)){for(let he=Z+1;he<G.length;he++){const ge=O(G[he]);if(ge>0){(P[ie]===0||K===X)&&(P[ie]=ge);break}}break}}}return P},Gs=_=>{const P=_.trim().split(`
`),I={...Wi},O={"total assets":"total_assets","assets total":"total_assets","total asset":"total_assets","sum of assets":"total_assets","total liabilities":"total_liabilities","liabilities total":"total_liabilities","total liability":"total_liabilities","sum of liabilities":"total_liabilities","current assets":"current_assets","total current assets":"current_assets","current assets total":"current_assets","current liabilities":"current_liabilities","total current liabilities":"current_liabilities","current liabilities total":"current_liabilities",revenue:"total_revenue","total revenue":"total_revenue",revenues:"total_revenue","net revenue":"total_revenue","net revenues":"total_revenue",sales:"total_revenue","net sales":"total_revenue","total sales":"total_revenue","gross sales":"total_revenue","service revenue":"total_revenue","operating revenue":"total_revenue","net income":"net_income","net profit":"net_income","net earnings":"net_income","net income (loss)":"net_income","profit (loss)":"net_income",profit:"net_income",earnings:"net_income","pretax income":"pretax_income","pre-tax income":"pretax_income","income before tax":"pretax_income","income before taxes":"pretax_income","earnings before tax":"pretax_income",ebt:"pretax_income","income before income tax":"pretax_income","profit before tax":"pretax_income",equity:"total_equity","total equity":"total_equity","stockholders equity":"total_equity","stockholders' equity":"total_equity","shareholders equity":"total_equity","shareholders' equity":"total_equity","owners equity":"total_equity","owner's equity":"total_equity","net worth":"total_equity","total stockholders equity":"total_equity","total shareholders equity":"total_equity",capital:"total_equity",inventory:"inventory",inventories:"inventory","merchandise inventory":"inventory","finished goods":"inventory","raw materials":"inventory","work in progress":"inventory",stock:"inventory","accounts receivable":"accounts_receivable",receivables:"accounts_receivable","trade receivables":"accounts_receivable","a/r":"accounts_receivable",ar:"accounts_receivable","net receivables":"accounts_receivable","accounts receivable net":"accounts_receivable","trade accounts receivable":"accounts_receivable","customer receivables":"accounts_receivable","cost of goods sold":"cost_of_goods_sold",cogs:"cost_of_goods_sold","cost of sales":"cost_of_goods_sold","cost of revenue":"cost_of_goods_sold","cost of products sold":"cost_of_goods_sold","cost of services":"cost_of_goods_sold","direct costs":"cost_of_goods_sold","operating expenses":"operating_expenses",opex:"operating_expenses","total operating expenses":"operating_expenses","operating costs":"operating_expenses","sg&a":"operating_expenses",sga:"operating_expenses","selling general administrative":"operating_expenses","general and administrative":"operating_expenses","allowance for doubtful accounts":"allowance_doubtful","allowance for bad debts":"allowance_doubtful","allowance doubtful":"allowance_doubtful","bad debt reserve":"allowance_doubtful","provision for bad debts":"allowance_doubtful"},G=Z=>{if(!Z)return 0;const q=Z.replace(/[$,\s]/g,"").replace(/\(([^)]+)\)/g,"-$1").trim(),K=parseFloat(q);return isNaN(K)?0:Math.abs(K)};return P.forEach(Z=>{const q=Z.split(/[,\t;]/).map(K=>K.replace(/^["']|["']$/g,"").trim());if(q.length>=2){const K=q[0].toLowerCase();for(const[X,ie]of Object.entries(O))if(K===X||K.includes(X)){for(let he=1;he<q.length;he++){const ge=G(q[he]);if(ge>0){(I[ie]===0||K===X)&&(I[ie]=ge);break}}break}}}),I},pr=_=>{de.error(`${_.charAt(0).toUpperCase()+_.slice(1)} integration coming soon! Please use manual entry or file upload for now.`)},ws=_=>_===0?"":_.toLocaleString("en-US"),qs=_=>parseFloat(_.replace(/,/g,""))||0,Bn=(_,P)=>{const I=qs(P);x(O=>({...O,[_]:I})),D(!0)},zt=()=>{y(null),v(0),x(Wi),D(!1)},$r=()=>h.total_assets>0&&h.total_revenue>0,Ae=async()=>{var _,P;if(!(!e||!r)){L(!0);try{const I=await ho.analyzeRiskWithAI({engagement_id:e,client_name:n||r.name,industry:l,financial_data:h,prior_year_data:void 0,known_issues:[]});Y(I),de.success("AI Risk Analysis Complete"),p(!1)}catch(I){console.error("Risk analysis failed:",I),de.error(((P=(_=I.response)==null?void 0:_.data)==null?void 0:P.detail)||"Risk analysis failed")}finally{L(!1)}}},lt=async()=>{var _,P,I;V(!0);try{const O=await ho.calculateMaterialityWithAI({financial_data:h,industry:l,entity_type:"private",risk_factors:((_=F==null?void 0:F.recommended_focus_areas)==null?void 0:_.map(G=>G.area))||[],user_count:0});ae(O),de.success("AI Materiality Calculation Complete")}catch(O){console.error("Materiality calculation failed:",O),de.error(((I=(P=O.response)==null?void 0:P.data)==null?void 0:I.detail)||"Materiality calculation failed")}finally{V(!1)}},Er=async()=>{var _,P;if(e){ue(!0);try{const I=await ho.detectFraudWithAI({engagement_id:e,financial_data:h});fe(I),de.success("AI Fraud Detection Complete")}catch(I){console.error("Fraud detection failed:",I),de.error(((P=(_=I.response)==null?void 0:_.data)==null?void 0:P.detail)||"Fraud detection failed")}finally{ue(!1)}}},vt=async()=>{var _,P;if(!e||!F||!Q){de.error("Please complete risk analysis and materiality calculation first");return}pe(!0);try{const I=["revenue","receivables","inventory","payables"],O=[];for(const G of I){const Z=await ho.generateAuditProgramWithAI({engagement_id:e,risk_assessment:F,audit_area:G,account_balance:rf(G),materiality:Q.overall_materiality,prior_year_findings:[]});O.push(Z)}H(O),de.success(`Generated ${O.length} AI-powered audit programs`)}catch(I){console.error("Program generation failed:",I),de.error(((P=(_=I.response)==null?void 0:_.data)==null?void 0:P.detail)||"Program generation failed")}finally{pe(!1)}},xa=async()=>{var _,P;if(!e||!r||!F||!Q||!ee){de.error("Please complete all analyses first");return}ke(!0);try{const I=await ho.generatePlanningMemoWithAI({engagement_id:e,client_name:n||r.name,risk_assessment:F,materiality:Q,fraud_assessment:ee,audit_programs:se});W(I),de.success("Planning Memo Generated")}catch(I){console.error("Memo generation failed:",I),de.error(((P=(_=I.response)==null?void 0:_.data)==null?void 0:P.detail)||"Memo generation failed")}finally{ke(!1)}},Un=()=>!!F&&!!Q,tf=async()=>{var _,P;if(!(!e||!r)){if(!Un()){de.error("Please complete at least Risk Analysis and Materiality before advancing");return}rt(!0);try{r.status==="draft"&&await ca.transitionStatus(e,"planning","AI-powered planning initiated"),await ca.transitionStatus(e,"fieldwork","Planning phase completed with AI assistance"),de.success("Planning complete! Engagement advanced to Fieldwork phase."),t(`/firm/engagements/${e}`)}catch(I){console.error("Failed to advance engagement:",I),de.error(((P=(_=I.response)==null?void 0:_.data)==null?void 0:P.detail)||"Failed to advance engagement phase")}finally{rt(!1)}}},rf=_=>{switch(_){case"revenue":return h.total_revenue;case"receivables":return h.accounts_receivable;case"inventory":return h.inventory;case"payables":return h.total_liabilities*.3;default:return 1e6}},rs=_=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(_),Ht=_=>{switch(_==null?void 0:_.toLowerCase()){case"significant":return"error";case"high":return"error";case"moderate":return"warning";case"low":return"success";default:return"neutral"}};if(c)return a.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:a.jsxs("div",{className:"flex flex-col items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 border-4 border-primary-500 border-t-transparent rounded-full animate-spin"}),a.jsx("p",{className:"text-body text-neutral-600",children:"Loading AI Planning..."})]})});if(!r)return null;const Ql=[{id:"risk",label:"Risk Analysis",icon:We,completed:!!F},{id:"materiality",label:"Materiality",icon:Us,completed:!!Q},{id:"fraud",label:"Fraud Detection",icon:Qe,completed:!!ee},{id:"programs",label:"Audit Programs",icon:$e,completed:se.length>0},{id:"memo",label:"Planning Memo",icon:$e,completed:!!ne}];return a.jsxs("div",{className:"space-y-6 max-w-[1800px]",children:[a.jsxs(z.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center gap-4",children:[a.jsx("button",{onClick:()=>t(`/firm/engagements/${e}`),className:"p-2 hover:bg-neutral-100 rounded-fluent-sm transition-colors",children:a.jsx(Qr,{className:"w-5 h-5 text-neutral-700"})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[a.jsx(Rt,{className:"w-6 h-6 text-primary-600"}),a.jsx("h1",{className:"text-display text-neutral-900",children:"AI-Powered Audit Planning"}),a.jsx("span",{className:"px-2 py-0.5 bg-primary-100 text-primary-700 text-caption font-medium rounded-full",children:"Superior to Human CPA"})]}),a.jsxs("p",{className:"text-body text-neutral-600",children:[r.name," - ",n]})]})]}),a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"fluent-card p-4",children:a.jsx("div",{className:"flex items-center justify-between gap-2 overflow-x-auto",children:Ql.map((_,P)=>{const I=_.icon,O=d===_.id,G=_.completed;return a.jsxs(Ei.Fragment,{children:[a.jsxs("button",{onClick:()=>f(_.id),className:`flex items-center gap-3 px-4 py-3 rounded-fluent transition-all min-w-fit ${O?"bg-primary-500 text-white":G?"bg-success-100 text-success-700 hover:bg-success-200":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}`,children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${O?"bg-white/20":G?"bg-success-500 text-white":"bg-neutral-200"}`,children:G&&!O?a.jsx(Xd,{className:"w-4 h-4"}):a.jsx(I,{className:"w-4 h-4"})}),a.jsx("span",{className:"text-body-strong whitespace-nowrap",children:_.label})]}),P<Ql.length-1&&a.jsx(fa,{className:"w-5 h-5 text-neutral-400 flex-shrink-0"})]},_.id)})})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[a.jsx(Xe,{mode:"wait",children:m&&d==="risk"&&a.jsxs(z.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"fluent-card p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-title text-neutral-900",children:"Financial Data Input"}),a.jsx("p",{className:"text-caption text-neutral-600",children:"Import financial data to power AI analysis"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[N&&a.jsxs("span",{className:"flex items-center gap-1 px-2 py-1 bg-success-100 text-success-700 text-caption rounded",children:[a.jsx(Re,{className:"w-3 h-3"}),"Data Loaded"]}),a.jsx("button",{onClick:()=>p(!1),className:"text-caption text-neutral-500 hover:text-neutral-700",children:"Collapse"})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-3",children:"Choose Data Source"}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:GB.map(_=>{const P=_.icon,I=w===_.id;return a.jsxs("button",{onClick:()=>{b(_.id),_.id!=="manual"&&_.id!=="upload"&&pr(_.id)},className:`flex flex-col items-center gap-2 p-4 rounded-fluent border-2 transition-all ${I?"border-primary-500 bg-primary-50":"border-neutral-200 hover:border-neutral-300 hover:bg-neutral-50"}`,children:[a.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${I?"bg-primary-500 text-white":"bg-neutral-100 text-neutral-600"}`,children:a.jsx(P,{className:"w-5 h-5"})}),a.jsx("span",{className:`text-caption font-medium ${I?"text-primary-700":"text-neutral-700"}`,children:_.name})]},_.id)})})]}),w==="upload"&&a.jsxs("div",{className:"mb-6",children:[a.jsx("div",{onDragOver:Fe,onDragLeave:xe,onDrop:it,className:`border-2 border-dashed rounded-fluent p-8 text-center transition-all ${j?"border-primary-500 bg-primary-50":g?"border-success-500 bg-success-50":"border-neutral-300 hover:border-primary-400 hover:bg-neutral-50"}`,children:E?a.jsxs("div",{className:"space-y-3",children:[a.jsx(zr,{className:"w-8 h-8 text-primary-500 mx-auto animate-spin"}),a.jsxs("p",{className:"text-body text-neutral-700",children:["Processing ",g==null?void 0:g.name,"..."]}),a.jsx("div",{className:"w-48 h-2 bg-neutral-200 rounded-full mx-auto overflow-hidden",children:a.jsx("div",{className:"h-full bg-primary-500 transition-all duration-300",style:{width:`${k}%`}})}),a.jsxs("p",{className:"text-caption text-neutral-500",children:[k,"% complete"]})]}):g?a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-success-100 flex items-center justify-center mx-auto",children:a.jsx(pc,{className:"w-6 h-6 text-success-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-body-strong text-neutral-900",children:g.name}),a.jsxs("p",{className:"text-caption text-neutral-500",children:[(g.size/1024).toFixed(1)," KB - Financial data extracted"]})]}),a.jsxs("button",{onClick:zt,className:"inline-flex items-center gap-1 text-caption text-error-600 hover:text-error-700",children:[a.jsx(ur,{className:"w-3 h-3"}),"Remove file"]})]}):a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-neutral-100 flex items-center justify-center mx-auto",children:a.jsx(oa,{className:"w-6 h-6 text-neutral-500"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-body-strong text-neutral-900",children:"Drag & drop your trial balance"}),a.jsx("p",{className:"text-caption text-neutral-500",children:"or click to browse - Excel, CSV, or PDF"})]}),a.jsx("input",{type:"file",accept:".xlsx,.xls,.csv,.pdf",onChange:Tr,className:"hidden",id:"file-upload"}),a.jsxs("label",{htmlFor:"file-upload",className:"inline-flex items-center gap-2 px-4 py-2 bg-primary-500 text-white rounded-fluent cursor-pointer hover:bg-primary-600 transition-colors",children:[a.jsx(pc,{className:"w-4 h-4"}),"Select File"]})]})}),a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-caption text-neutral-500",children:[a.jsx(z0,{className:"w-3 h-3"}),"Supports QuickBooks export, Excel trial balance, or any CSV with financial data"]})]}),a.jsxs("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Industry Classification"}),a.jsx("select",{value:l,onChange:_=>o(_.target.value),className:"fluent-input w-full",children:Me.map(_=>a.jsx("option",{value:_.value,children:_.label},_.value))}),a.jsx("p",{className:"text-caption text-neutral-500 mt-1",children:"Used for industry-specific benchmarks and risk factors"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-body-strong text-neutral-700 mb-2",children:"Client Name"}),a.jsx("input",{type:"text",value:n,onChange:_=>i(_.target.value),placeholder:"Enter client name",className:"fluent-input w-full"})]})]}),(w==="manual"||N)&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-body-strong text-neutral-900",children:w==="upload"?"Extracted Financial Data":"Enter Financial Data"}),w==="upload"&&a.jsx("span",{className:"text-caption text-neutral-500",children:"Edit values if needed"})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(h).map(([_,P])=>a.jsxs("div",{className:"relative",children:[a.jsx("label",{className:"block text-caption text-neutral-600 mb-1",children:qB[_]}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-400",children:a.jsx(Or,{className:"w-4 h-4"})}),a.jsx("input",{type:"text",value:ws(P),onChange:I=>Bn(_,I.target.value),placeholder:"0",className:"fluent-input w-full pl-9 text-right font-mono"})]})]},_))}),N&&a.jsxs("div",{className:"mt-4 p-4 bg-neutral-50 rounded-fluent",children:[a.jsx("h4",{className:"text-caption font-medium text-neutral-700 mb-2",children:"Quick Summary"}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-neutral-500",children:"Total Assets:"}),a.jsx("span",{className:"ml-2 font-medium",children:rs(h.total_assets)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-neutral-500",children:"Revenue:"}),a.jsx("span",{className:"ml-2 font-medium",children:rs(h.total_revenue)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-neutral-500",children:"Net Income:"}),a.jsx("span",{className:"ml-2 font-medium",children:rs(h.net_income)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-neutral-500",children:"Equity:"}),a.jsx("span",{className:"ml-2 font-medium",children:rs(h.total_equity)})]})]})]})]}),!$r()&&w==="manual"&&a.jsxs("div",{className:"mt-4 p-3 bg-warning-50 border border-warning-200 rounded-fluent flex items-start gap-2",children:[a.jsx(Qe,{className:"w-4 h-4 text-warning-600 mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-caption font-medium text-warning-800",children:"Missing Required Data"}),a.jsx("p",{className:"text-caption text-warning-700",children:"Please enter Total Assets and Total Revenue at minimum to run AI analysis."})]})]})]})}),d==="risk"&&a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:a.jsxs("div",{className:"fluent-card p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-title text-neutral-900",children:"AI Risk Analysis"}),a.jsx("p",{className:"text-body text-neutral-600",children:"Pattern recognition across industry benchmarks with fraud indicator detection"})]}),a.jsx("button",{onClick:Ae,disabled:T||!$r(),className:"fluent-btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:T?a.jsxs(a.Fragment,{children:[a.jsx(zr,{className:"w-4 h-4 animate-spin"}),"Analyzing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Rt,{className:"w-4 h-4"}),F?"Re-analyze":"Analyze Risk"]})})]}),F&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"p-4 bg-neutral-50 rounded-fluent",children:[a.jsx("p",{className:"text-caption text-neutral-600 mb-1",children:"Overall Risk Score"}),a.jsxs("p",{className:"text-2xl font-bold text-neutral-900",children:[F.overall_risk_score,"/100"]})]}),a.jsxs("div",{className:"p-4 bg-neutral-50 rounded-fluent",children:[a.jsx("p",{className:"text-caption text-neutral-600 mb-1",children:"Risk Level"}),a.jsx("span",{className:`inline-flex px-3 py-1 rounded-full text-body-strong bg-${Ht(F.risk_level)}-100 text-${Ht(F.risk_level)}-700`,children:(Zc=F.risk_level)==null?void 0:Zc.toUpperCase()})]}),a.jsxs("div",{className:"p-4 bg-neutral-50 rounded-fluent",children:[a.jsx("p",{className:"text-caption text-neutral-600 mb-1",children:"Fraud Risk"}),a.jsx("span",{className:`inline-flex px-3 py-1 rounded-full text-body-strong bg-${Ht((eu=F.fraud_risk_assessment)==null?void 0:eu.fraud_risk_level)}-100 text-${Ht(($n=F.fraud_risk_assessment)==null?void 0:$n.fraud_risk_level)}-700`,children:(ru=(tu=F.fraud_risk_assessment)==null?void 0:tu.fraud_risk_level)==null?void 0:ru.toUpperCase()})]})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-body-strong text-neutral-900 mb-3 flex items-center gap-2",children:[a.jsx(vc,{className:"w-4 h-4 text-primary-500"}),"AI-Generated Insights"]}),a.jsx("div",{className:"space-y-2",children:(su=F.ai_insights)==null?void 0:su.map((_,P)=>a.jsxs("div",{className:`p-3 rounded-fluent border-l-4 border-${Ht(_.severity)}-500 bg-${Ht(_.severity)}-50`,children:[a.jsx("p",{className:"text-body-strong text-neutral-900",children:_.insight}),a.jsx("p",{className:"text-caption text-neutral-600 mt-1",children:_.action}),a.jsxs("p",{className:"text-caption text-neutral-500 mt-1",children:["Ref: ",_.pcaob_reference]})]},P))})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-body-strong text-neutral-900 mb-3",children:"Significant Accounts"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-neutral-100",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left p-3",children:"Account"}),a.jsx("th",{className:"text-right p-3",children:"Balance"}),a.jsx("th",{className:"text-center p-3",children:"x Materiality"}),a.jsx("th",{className:"text-center p-3",children:"Testing Required"})]})}),a.jsx("tbody",{children:(au=F.significant_accounts)==null?void 0:au.map((_,P)=>a.jsxs("tr",{className:"border-b",children:[a.jsx("td",{className:"p-3",children:_.account}),a.jsx("td",{className:"p-3 text-right",children:rs(_.balance)}),a.jsxs("td",{className:"p-3 text-center",children:[_.times_materiality,"x"]}),a.jsx("td",{className:"p-3 text-center",children:_.requires_testing?a.jsx(Re,{className:"w-5 h-5 text-success-500 mx-auto"}):a.jsx(tn,{className:"w-5 h-5 text-neutral-300 mx-auto"})})]},P))})]})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-body-strong text-neutral-900 mb-3",children:"Recommended Focus Areas"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:(nu=F.recommended_focus_areas)==null?void 0:nu.map((_,P)=>a.jsxs("div",{className:"p-3 bg-neutral-50 rounded-fluent",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("p",{className:"text-body-strong text-neutral-900",children:_.area}),a.jsx("span",{className:`text-caption px-2 py-0.5 rounded bg-${Ht(_.priority)}-100 text-${Ht(_.priority)}-700`,children:_.priority})]}),a.jsx("p",{className:"text-caption text-neutral-600",children:_.reason})]},P))})]})]})]})}),d==="materiality"&&a.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"fluent-card p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-title text-neutral-900",children:"AI Materiality Calculation"}),a.jsx("p",{className:"text-body text-neutral-600",children:"Intelligent benchmark selection with risk factor adjustments"})]}),a.jsx("button",{onClick:lt,disabled:B,className:"fluent-btn-primary",children:B?a.jsxs(a.Fragment,{children:[a.jsx(zr,{className:"w-4 h-4 animate-spin"}),"Calculating..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Us,{className:"w-4 h-4"}),Q?"Recalculate":"Calculate Materiality"]})})]}),Q&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"p-4 bg-primary-50 rounded-fluent border border-primary-200",children:[a.jsx("p",{className:"text-caption text-primary-600 mb-1",children:"Overall Materiality"}),a.jsx("p",{className:"text-2xl font-bold text-primary-900",children:rs(Q.overall_materiality)})]}),a.jsxs("div",{className:"p-4 bg-neutral-50 rounded-fluent",children:[a.jsx("p",{className:"text-caption text-neutral-600 mb-1",children:"Performance Materiality"}),a.jsx("p",{className:"text-xl font-bold text-neutral-900",children:rs(Q.performance_materiality)})]}),a.jsxs("div",{className:"p-4 bg-neutral-50 rounded-fluent",children:[a.jsx("p",{className:"text-caption text-neutral-600 mb-1",children:"Trivial Threshold"}),a.jsx("p",{className:"text-xl font-bold text-neutral-900",children:rs(Q.trivial_threshold)})]})]}),a.jsxs("div",{className:"p-4 bg-primary-50 rounded-fluent border border-primary-200",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Rt,{className:"w-5 h-5 text-primary-600"}),a.jsx("h3",{className:"text-body-strong text-primary-900",children:"AI Reasoning"})]}),a.jsx("p",{className:"text-body text-primary-800",children:Q.ai_reasoning}),a.jsxs("p",{className:"text-caption text-primary-600 mt-2",children:["Benchmark: ",Q.selected_benchmark," | Risk Adjustment: ",(Q.risk_adjustment_factor*100).toFixed(0),"%"]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-body-strong text-neutral-900 mb-3",children:"All Benchmarks Analyzed"}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:Object.entries(Q.all_benchmarks||{}).map(([_,P])=>a.jsxs("div",{className:`p-3 rounded-fluent ${_===Q.selected_benchmark?"bg-primary-100 border-2 border-primary-500":"bg-neutral-50"}`,children:[a.jsx("p",{className:"text-caption text-neutral-600",children:_.replace(/_/g," ")}),a.jsx("p",{className:"text-body-strong text-neutral-900",children:rs(P)})]},_))})]}),a.jsxs("div",{className:"p-3 bg-success-50 rounded-fluent border border-success-200",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Re,{className:"w-5 h-5 text-success-600"}),a.jsx("h3",{className:"text-body-strong text-success-900",children:"PCAOB AS 2105 Compliance"})]}),a.jsx("ul",{className:"text-caption text-success-800 space-y-1",children:(iu=Q.pcaob_compliance_notes)==null?void 0:iu.map((_,P)=>a.jsxs("li",{children:["- ",_]},P))})]})]})]}),d==="fraud"&&a.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"fluent-card p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-title text-neutral-900",children:"AI Fraud Detection"}),a.jsx("p",{className:"text-body text-neutral-600",children:"Benford's Law analysis, pattern recognition, and anomaly detection"})]}),a.jsx("button",{onClick:Er,disabled:te,className:"fluent-btn-primary",children:te?a.jsxs(a.Fragment,{children:[a.jsx(zr,{className:"w-4 h-4 animate-spin"}),"Detecting..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Qe,{className:"w-4 h-4"}),ee?"Re-analyze":"Detect Fraud Patterns"]})})]}),ee&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"p-4 bg-neutral-50 rounded-fluent",children:[a.jsx("p",{className:"text-caption text-neutral-600 mb-1",children:"Fraud Risk Score"}),a.jsxs("p",{className:"text-2xl font-bold text-neutral-900",children:[ee.fraud_risk_score,"/100"]})]}),a.jsxs("div",{className:"p-4 bg-neutral-50 rounded-fluent",children:[a.jsx("p",{className:"text-caption text-neutral-600 mb-1",children:"Risk Level"}),a.jsx("span",{className:`inline-flex px-3 py-1 rounded-full text-body-strong bg-${Ht(ee.fraud_risk_level)}-100 text-${Ht(ee.fraud_risk_level)}-700`,children:(lu=ee.fraud_risk_level)==null?void 0:lu.toUpperCase()})]}),a.jsxs("div",{className:"p-4 bg-neutral-50 rounded-fluent",children:[a.jsx("p",{className:"text-caption text-neutral-600 mb-1",children:"Indicators Found"}),a.jsx("p",{className:"text-2xl font-bold text-neutral-900",children:ee.indicators_found})]})]}),((ou=ee.fraud_indicators)==null?void 0:ou.length)>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-body-strong text-neutral-900 mb-3",children:"Fraud Indicators Detected"}),a.jsx("div",{className:"space-y-2",children:ee.fraud_indicators.map((_,P)=>a.jsxs("div",{className:`p-3 rounded-fluent border-l-4 border-${Ht(_.severity)}-500 bg-${Ht(_.severity)}-50`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("p",{className:"text-body-strong text-neutral-900",children:_.type.replace(/_/g," ").toUpperCase()}),a.jsx("span",{className:`text-caption px-2 py-0.5 rounded bg-${Ht(_.severity)}-200 text-${Ht(_.severity)}-800`,children:_.severity})]}),a.jsx("p",{className:"text-body text-neutral-700",children:_.description}),_.audit_implication&&a.jsxs("p",{className:"text-caption text-neutral-600 mt-1",children:["Implication: ",_.audit_implication]})]},P))})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-body-strong text-neutral-900 mb-3",children:"Required Fraud Procedures (AS 2401)"}),a.jsx("ul",{className:"space-y-2",children:(Vi=ee.required_procedures)==null?void 0:Vi.map((_,P)=>a.jsxs("li",{className:"flex items-start gap-2 text-body text-neutral-700",children:[a.jsx(Re,{className:"w-4 h-4 text-primary-500 mt-0.5 flex-shrink-0"}),_]},P))})]}),a.jsxs("div",{className:"p-3 bg-success-50 rounded-fluent border border-success-200",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(We,{className:"w-5 h-5 text-success-600"}),a.jsx("h3",{className:"text-body-strong text-success-900",children:"PCAOB AS 2401 Compliance"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-caption",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[(cu=ee.pcaob_as_2401_compliance)!=null&&cu.fraud_triangle_assessed?a.jsx(Re,{className:"w-4 h-4 text-success-500"}):a.jsx(tn,{className:"w-4 h-4 text-error-500"}),a.jsx("span",{children:"Fraud Triangle Assessed"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[(uu=ee.pcaob_as_2401_compliance)!=null&&uu.journal_entry_testing_planned?a.jsx(Re,{className:"w-4 h-4 text-success-500"}):a.jsx(tn,{className:"w-4 h-4 text-error-500"}),a.jsx("span",{children:"JE Testing Planned"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[(du=ee.pcaob_as_2401_compliance)!=null&&du.management_override_considered?a.jsx(Re,{className:"w-4 h-4 text-success-500"}):a.jsx(tn,{className:"w-4 h-4 text-error-500"}),a.jsx("span",{children:"Management Override Considered"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[(R=ee.pcaob_as_2401_compliance)!=null&&R.revenue_recognition_evaluated?a.jsx(Re,{className:"w-4 h-4 text-success-500"}):a.jsx(tn,{className:"w-4 h-4 text-error-500"}),a.jsx("span",{children:"Revenue Recognition Evaluated"})]})]})]})]})]}),d==="programs"&&a.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"fluent-card p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-title text-neutral-900",children:"AI-Generated Audit Programs"}),a.jsx("p",{className:"text-body text-neutral-600",children:"Risk-responsive procedures with optimized sample sizes"})]}),a.jsx("button",{onClick:vt,disabled:ve||!F||!Q,className:"fluent-btn-primary",children:ve?a.jsxs(a.Fragment,{children:[a.jsx(zr,{className:"w-4 h-4 animate-spin"}),"Generating..."]}):a.jsxs(a.Fragment,{children:[a.jsx($e,{className:"w-4 h-4"}),"Generate Programs"]})})]}),!F||!Q?a.jsxs("div",{className:"text-center py-8 text-neutral-500",children:[a.jsx(Qe,{className:"w-12 h-12 mx-auto mb-3 text-warning-400"}),a.jsx("p",{className:"text-body",children:"Complete Risk Analysis and Materiality calculation first"})]}):se.length>0?a.jsx("div",{className:"space-y-4",children:se.map((_,P)=>{var I,O,G,Z;return a.jsxs("details",{className:"group",children:[a.jsxs("summary",{className:"flex items-center justify-between p-4 bg-neutral-50 rounded-fluent cursor-pointer hover:bg-neutral-100",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-primary-100 flex items-center justify-center",children:a.jsx($e,{className:"w-5 h-5 text-primary-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-body-strong text-neutral-900",children:_.audit_area.charAt(0).toUpperCase()+_.audit_area.slice(1)}),a.jsxs("p",{className:"text-caption text-neutral-600",children:[((I=_.procedures)==null?void 0:I.length)||0," procedures | ",_.risk_level," risk"]})]})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-caption text-neutral-600",children:"Est. Hours"}),a.jsxs("p",{className:"text-body-strong text-neutral-900",children:[((O=_.estimated_hours)==null?void 0:O.total_estimated_hours)||0,"h"]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-caption text-success-600",children:"AI Savings"}),a.jsxs("p",{className:"text-body-strong text-success-700",children:[((G=_.estimated_hours)==null?void 0:G.efficiency_gain_percentage)||0,"%"]})]}),a.jsx(pN,{className:"w-5 h-5 text-neutral-400 group-open:rotate-180 transition-transform"})]})]}),a.jsxs("div",{className:"p-4 border border-neutral-200 border-t-0 rounded-b-fluent",children:[a.jsx("div",{className:"mb-4 p-3 bg-primary-50 rounded-fluent",children:a.jsx("p",{className:"text-caption text-primary-800 whitespace-pre-line",children:_.program_summary})}),a.jsx("div",{className:"space-y-2",children:(Z=_.procedures)==null?void 0:Z.map((q,K)=>a.jsx("div",{className:"p-3 bg-neutral-50 rounded-fluent",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-body-strong text-neutral-900",children:q.name}),a.jsx("p",{className:"text-caption text-neutral-600 mt-1",children:q.description}),q.ai_capability&&a.jsxs("div",{className:"mt-2 flex items-center gap-4 text-caption",children:[a.jsx("span",{className:"px-2 py-0.5 bg-primary-100 text-primary-700 rounded",children:"AI-Enhanced"}),a.jsxs("span",{className:"text-success-600",children:["Time saved: ",q.human_time_saved]}),a.jsxs("span",{className:"text-primary-600",children:["Accuracy: +",q.accuracy_improvement]})]})]}),a.jsx("span",{className:`text-caption px-2 py-1 rounded bg-${q.nature==="substantive"?"blue":"purple"}-100 text-${q.nature==="substantive"?"blue":"purple"}-700`,children:q.nature})]})},K))})]})]},P)})}):null]}),d==="memo"&&a.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"fluent-card p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-title text-neutral-900",children:"AI-Generated Planning Memo"}),a.jsx("p",{className:"text-body text-neutral-600",children:"PCAOB-compliant documentation ready for partner review"})]}),a.jsxs("div",{className:"flex gap-2",children:[ne&&a.jsxs("button",{className:"fluent-btn-secondary",children:[a.jsx(xs,{className:"w-4 h-4"}),"Export"]}),a.jsx("button",{onClick:xa,disabled:le||!F||!Q||!ee,className:"fluent-btn-primary",children:le?a.jsxs(a.Fragment,{children:[a.jsx(zr,{className:"w-4 h-4 animate-spin"}),"Generating..."]}):a.jsxs(a.Fragment,{children:[a.jsx($e,{className:"w-4 h-4"}),"Generate Memo"]})})]})]}),!F||!Q||!ee?a.jsxs("div",{className:"text-center py-8 text-neutral-500",children:[a.jsx(Qe,{className:"w-12 h-12 mx-auto mb-3 text-warning-400"}),a.jsx("p",{className:"text-body",children:"Complete all analyses first (Risk, Materiality, Fraud)"})]}):ne?a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"p-3 bg-warning-50 rounded-fluent border border-warning-200",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(cr,{className:"w-5 h-5 text-warning-600"}),a.jsx("span",{className:"text-body-strong text-warning-900",children:"Requires Partner Review"})]})}),a.jsx("div",{className:"prose prose-sm max-w-none",children:a.jsx("pre",{className:"bg-neutral-50 p-4 rounded-fluent overflow-x-auto whitespace-pre-wrap text-sm font-mono",children:ne.content})}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(M=ne.pcaob_references)==null?void 0:M.map((_,P)=>a.jsx("span",{className:"px-2 py-1 bg-neutral-100 text-neutral-700 text-caption rounded",children:_},P))})]}):null]})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"fluent-card p-5",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(vc,{className:"w-5 h-5 text-primary-500"}),a.jsx("h3",{className:"text-body-strong text-neutral-900",children:"AI Advantages"})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-success-100 flex items-center justify-center flex-shrink-0",children:a.jsx(nt,{className:"w-4 h-4 text-success-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-body-strong text-neutral-900",children:"70% Faster"}),a.jsx("p",{className:"text-caption text-neutral-600",children:"Than traditional risk assessment"})]})]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-primary-100 flex items-center justify-center flex-shrink-0",children:a.jsx(Ml,{className:"w-4 h-4 text-primary-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-body-strong text-neutral-900",children:"100% Coverage"}),a.jsx("p",{className:"text-caption text-neutral-600",children:"Benford's Law on all transactions"})]})]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-warning-100 flex items-center justify-center flex-shrink-0",children:a.jsx(_i,{className:"w-4 h-4 text-warning-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-body-strong text-neutral-900",children:"500+ Benchmarks"}),a.jsx("p",{className:"text-caption text-neutral-600",children:"Industry-specific comparisons"})]})]})]})]}),a.jsxs("div",{className:"fluent-card p-5",children:[a.jsx("h3",{className:"text-body-strong text-neutral-900 mb-4",children:"Planning Progress"}),a.jsx("div",{className:"space-y-3",children:[{label:"Risk Analysis",done:!!F},{label:"Materiality",done:!!Q},{label:"Fraud Detection",done:!!ee},{label:"Audit Programs",done:se.length>0},{label:"Planning Memo",done:!!ne}].map((_,P)=>a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-body text-neutral-700",children:_.label}),_.done?a.jsx(Re,{className:"w-5 h-5 text-success-500"}):a.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-neutral-300"})]},P))}),a.jsxs("div",{className:"mt-6 pt-4 border-t border-neutral-200",children:[a.jsx("button",{onClick:tf,disabled:U||!Un(),className:`w-full py-3 px-4 rounded-fluent font-medium transition-all flex items-center justify-center gap-2 ${Un()?"bg-success-500 hover:bg-success-600 text-white":"bg-neutral-200 text-neutral-500 cursor-not-allowed"}`,children:U?a.jsxs(a.Fragment,{children:[a.jsx(zr,{className:"w-4 h-4 animate-spin"}),"Advancing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Re,{className:"w-4 h-4"}),"Complete Planning & Advance to Fieldwork"]})}),!Un()&&a.jsx("p",{className:"text-caption text-neutral-500 mt-2 text-center",children:"Complete Risk Analysis and Materiality to advance"})]})]}),a.jsxs("div",{className:"fluent-card p-5 bg-success-50 border border-success-200",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(We,{className:"w-5 h-5 text-success-600"}),a.jsx("h3",{className:"text-body-strong text-success-900",children:"PCAOB Compliant"})]}),a.jsxs("ul",{className:"text-caption text-success-800 space-y-1",children:[a.jsx("li",{children:"AS 2101 - Audit Planning"}),a.jsx("li",{children:"AS 2105 - Materiality"}),a.jsx("li",{children:"AS 2110 - Risk Assessment"}),a.jsx("li",{children:"AS 2301 - Risk Response"}),a.jsx("li",{children:"AS 2401 - Fraud Consideration"})]})]})]})]})]})},KB="https://portal.auraai.toroniandcompany.com/api";class XB{constructor(){Wt(this,"api");this.api=ye.create({baseURL:`${KB}/rd-study`,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(t=>{const r=localStorage.getItem("access_token");return r&&(t.headers.Authorization=`Bearer ${r}`),t}),this.api.interceptors.response.use(t=>t,t=>{var r;return((r=t.response)==null?void 0:r.status)===401&&(localStorage.removeItem("access_token"),window.location.href="/login"),Promise.reject(t)})}async listStudies(t){return(await this.api.get("/studies",{params:t})).data}async getStudy(t){return(await this.api.get(`/studies/${t}`)).data}async createStudy(t){return(await this.api.post("/studies",t)).data}async updateStudy(t,r){return(await this.api.patch(`/studies/${t}`,r)).data}async transitionStudy(t,r,s){return(await this.api.post(`/studies/${t}/transition`,{new_status:r,notes:s})).data}async approveStudy(t,r,s){return(await this.api.post(`/studies/${t}/cpa-approval`,{approved:r,notes:s})).data}async listProjects(t){return(await this.api.get(`/studies/${t}/projects`)).data}async getProject(t,r){return(await this.api.get(`/studies/${t}/projects/${r}`)).data}async createProject(t,r){return(await this.api.post(`/studies/${t}/projects`,r)).data}async qualifyProject(t,r){return(await this.api.post(`/studies/${t}/projects/${r}/qualify`)).data}async overrideProjectQualification(t,r,s,n){return(await this.api.post(`/studies/${t}/projects/${r}/override`,{override_status:s,reason:n})).data}async listEmployees(t){return(await this.api.get(`/studies/${t}/employees`)).data}async createEmployee(t,r){return(await this.api.post(`/studies/${t}/employees`,r)).data}async adjustEmployeeTime(t,r,s,n){return(await this.api.post(`/studies/${t}/employees/${r}/adjust-time`,{adjusted_percentage:s,reason:n})).data}async listQREs(t){return(await this.api.get(`/studies/${t}/qres`)).data}async getQRESummary(t){return(await this.api.get(`/studies/${t}/qres/summary`)).data}async createQRE(t,r){return(await this.api.post(`/studies/${t}/qres`,r)).data}async calculateCredits(t,r){return(await this.api.post(`/studies/${t}/calculate`,{method:r,include_states:!0})).data}async getForm6765Data(t){return(await this.api.get(`/studies/${t}/form-6765-data`)).data}async uploadDocument(t,r,s){const n=new FormData;return n.append("file",r),s&&n.append("document_type",s),(await this.api.post(`/studies/${t}/documents`,n,{headers:{"Content-Type":"multipart/form-data"}})).data}async listDocuments(t){return(await this.api.get(`/studies/${t}/documents`)).data}async generateNarratives(t,r){return(await this.api.post(`/studies/${t}/narratives/generate`,{narrative_types:r})).data}async listNarratives(t){return(await this.api.get(`/studies/${t}/narratives`)).data}async updateNarrative(t,r,s,n){await this.api.patch(`/studies/${t}/narratives/${r}`,{content:s,edit_reason:n})}async getReviewQueue(t){return(await this.api.get(`/studies/${t}/review-queue`)).data}async generateOutputs(t,r){return(await this.api.post(`/studies/${t}/outputs/generate`,{output_types:r})).data}async listOutputs(t){return(await this.api.get(`/studies/${t}/outputs`)).data}async getAuditTrail(t,r){return(await this.api.get(`/studies/${t}/audit-trail`,{params:r})).data}async getFederalRules(){return(await this.api.get("/rules/federal")).data}async getStateRules(t){const r=t?`/rules/states/${t}`:"/rules/states";return(await this.api.get(r)).data}}const Ya=new XB,lh={draft:{label:"Draft",color:"text-gray-600",bgColor:"bg-gray-100"},intake:{label:"Intake",color:"text-blue-600",bgColor:"bg-blue-100"},data_collection:{label:"Data Collection",color:"text-indigo-600",bgColor:"bg-indigo-100"},ai_analysis:{label:"AI Analysis",color:"text-purple-600",bgColor:"bg-purple-100"},cpa_review:{label:"CPA Review",color:"text-orange-600",bgColor:"bg-orange-100"},calculation:{label:"Calculation",color:"text-cyan-600",bgColor:"bg-cyan-100"},narrative_generation:{label:"Narratives",color:"text-pink-600",bgColor:"bg-pink-100"},final_review:{label:"Final Review",color:"text-amber-600",bgColor:"bg-amber-100"},approved:{label:"Approved",color:"text-green-600",bgColor:"bg-green-100"},finalized:{label:"Finalized",color:"text-emerald-600",bgColor:"bg-emerald-100"},locked:{label:"Locked",color:"text-slate-600",bgColor:"bg-slate-100"}},QB=()=>{const e=ze(),[t,r]=C.useState([]),[s,n]=C.useState(!0),[i,l]=C.useState(""),[o,c]=C.useState("all"),[u,d]=C.useState("all"),[f,h]=C.useState({total:0,inProgress:0,completed:0,totalCredits:0});C.useEffect(()=>{x()},[o,u]);const x=async()=>{try{n(!0);const g={};o!=="all"&&(g.status=o),u!=="all"&&(g.tax_year=u);const y=await Ya.listStudies(g);r(y.items||[]);const j=y.items||[];h({total:j.length,inProgress:j.filter(A=>!["finalized","locked","approved"].includes(A.status)).length,completed:j.filter(A=>["finalized","locked","approved"].includes(A.status)).length,totalCredits:j.reduce((A,k)=>A+(k.total_credits||0),0)})}catch(g){console.error("Failed to load studies:",g),de.error("Failed to load R&D studies")}finally{n(!1)}},m=t.filter(g=>{if(!i)return!0;const y=i.toLowerCase();return g.name.toLowerCase().includes(y)||g.entity_name.toLowerCase().includes(y)||g.client_name&&g.client_name.toLowerCase().includes(y)}),p=g=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(g),w=new Date().getFullYear(),b=Array.from({length:5},(g,y)=>w-y);return s?a.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:a.jsxs("div",{className:"flex flex-col items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 border-4 border-purple-500 border-t-transparent rounded-full animate-spin"}),a.jsx("p",{className:"text-gray-600",children:"Loading R&D studies..."})]})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[a.jsx(pi,{className:"w-8 h-8 text-purple-600"}),"R&D Tax Credit Studies"]}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Manage R&D tax credit studies with AI-powered analysis"})]}),a.jsxs("button",{onClick:()=>e("/firm/rd-studies/new"),className:"btn-primary flex items-center gap-2",children:[a.jsx($t,{className:"w-5 h-5"}),"New R&D Study"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"card bg-gradient-to-br from-purple-500 to-purple-600 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-purple-100 text-sm",children:"Total Studies"}),a.jsx("p",{className:"text-3xl font-bold",children:f.total})]}),a.jsx($e,{className:"w-10 h-10 text-purple-200"})]})}),a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"card bg-gradient-to-br from-orange-500 to-orange-600 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-orange-100 text-sm",children:"In Progress"}),a.jsx("p",{className:"text-3xl font-bold",children:f.inProgress})]}),a.jsx(nt,{className:"w-10 h-10 text-orange-200"})]})}),a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"card bg-gradient-to-br from-green-500 to-green-600 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-green-100 text-sm",children:"Completed"}),a.jsx("p",{className:"text-3xl font-bold",children:f.completed})]}),a.jsx(Ut,{className:"w-10 h-10 text-green-200"})]})}),a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"card bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-blue-100 text-sm",children:"Total Credits"}),a.jsx("p",{className:"text-2xl font-bold",children:p(f.totalCredits)})]}),a.jsx(Or,{className:"w-10 h-10 text-blue-200"})]})})]}),a.jsx("div",{className:"card",children:a.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(Vs,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",value:i,onChange:g=>l(g.target.value),placeholder:"Search by name, entity, or client...",className:"input-field pl-10"})]}),a.jsxs("select",{value:o,onChange:g=>c(g.target.value),className:"input-field w-full md:w-48",children:[a.jsx("option",{value:"all",children:"All Statuses"}),Object.entries(lh).map(([g,y])=>a.jsx("option",{value:g,children:y.label},g))]}),a.jsxs("select",{value:u,onChange:g=>d(g.target.value==="all"?"all":parseInt(g.target.value)),className:"input-field w-full md:w-40",children:[a.jsx("option",{value:"all",children:"All Years"}),b.map(g=>a.jsx("option",{value:g,children:g},g))]})]})}),m.length===0?a.jsxs("div",{className:"card text-center py-16",children:[a.jsx(pi,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"No R&D Studies Found"}),a.jsx("p",{className:"text-gray-500 mb-6",children:i||o!=="all"||u!=="all"?"Try adjusting your filters":"Get started by creating your first R&D tax credit study"}),!i&&o==="all"&&u==="all"&&a.jsxs("button",{onClick:()=>e("/firm/rd-studies/new"),className:"btn-primary inline-flex items-center gap-2",children:[a.jsx($t,{className:"w-5 h-5"}),"Create R&D Study"]})]}):a.jsx("div",{className:"space-y-4",children:m.map((g,y)=>{const j=lh[g.status]||lh.draft;return a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:y*.05},className:"card hover:shadow-lg transition-all cursor-pointer group",onClick:()=>e(`/firm/rd-studies/${g.id}`),children:a.jsxs("div",{className:"flex items-center gap-6",children:[a.jsx("div",{className:"w-14 h-14 bg-purple-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(pi,{className:"w-7 h-7 text-purple-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 truncate group-hover:text-purple-600 transition-colors",children:g.name}),a.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-medium ${j.bgColor} ${j.color}`,children:j.label}),g.has_open_flags&&a.jsxs("span",{className:"px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-600 flex items-center gap-1",children:[a.jsx(Qe,{className:"w-3 h-3"}),"Flags"]})]}),a.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Nt,{className:"w-4 h-4"}),g.entity_name]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Jr,{className:"w-4 h-4"}),"Tax Year ",g.tax_year]}),g.client_name&&a.jsxs("span",{className:"text-gray-400",children:["Client: ",g.client_name]})]})]}),a.jsxs("div",{className:"text-right flex-shrink-0",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 mb-1",children:[a.jsx(ua,{className:"w-4 h-4 text-green-500"}),"Total Credits"]}),a.jsx("p",{className:"text-xl font-bold text-green-600",children:p(g.total_credits||0)}),a.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["Fed: ",p(g.federal_credit_final||0)," | State: ",p(g.total_state_credits||0)]})]}),a.jsx(fa,{className:"w-5 h-5 text-gray-400 group-hover:text-purple-600 transition-colors"})]})},g.id)})})]})},oh={draft:{label:"Draft",color:"text-gray-600",bgColor:"bg-gray-100"},intake:{label:"Intake",color:"text-blue-600",bgColor:"bg-blue-100"},data_collection:{label:"Data Collection",color:"text-indigo-600",bgColor:"bg-indigo-100"},ai_analysis:{label:"AI Analysis",color:"text-purple-600",bgColor:"bg-purple-100"},cpa_review:{label:"CPA Review",color:"text-orange-600",bgColor:"bg-orange-100"},calculation:{label:"Calculation",color:"text-cyan-600",bgColor:"bg-cyan-100"},narrative_generation:{label:"Narratives",color:"text-pink-600",bgColor:"bg-pink-100"},final_review:{label:"Final Review",color:"text-amber-600",bgColor:"bg-amber-100"},approved:{label:"Approved",color:"text-green-600",bgColor:"bg-green-100"},finalized:{label:"Finalized",color:"text-emerald-600",bgColor:"bg-emerald-100"},locked:{label:"Locked",color:"text-slate-600",bgColor:"bg-slate-100"}},JB=[{id:"overview",label:"Overview",icon:Ml},{id:"projects",label:"Projects",icon:pi},{id:"employees",label:"Employees",icon:zs},{id:"qres",label:"QREs",icon:Or},{id:"calculations",label:"Calculations",icon:Us},{id:"narratives",label:"Narratives",icon:ux},{id:"documents",label:"Documents",icon:$e},{id:"review",label:"Review Queue",icon:Ut}],ZB=()=>{const{id:e}=Hs(),t=ze(),[r,s]=C.useState(null),[n,i]=C.useState(!0),[l,o]=C.useState("overview"),[c,u]=C.useState([]),[d,f]=C.useState([]),[h,x]=C.useState(null),[m,p]=C.useState(null),[w,b]=C.useState(!1);C.useEffect(()=>{e&&g()},[e]),C.useEffect(()=>{r&&y()},[l,r]);const g=async()=>{try{i(!0);const E=await Ya.getStudy(e);s(E)}catch(E){console.error("Failed to load study:",E),de.error("Failed to load R&D study"),t("/firm/rd-studies")}finally{i(!1)}},y=async()=>{if(r)try{switch(l){case"projects":const E=await Ya.listProjects(r.id);u(E);break;case"employees":const S=await Ya.listEmployees(r.id);f(S);break;case"qres":const N=await Ya.getQRESummary(r.id);x(N);break;case"review":const D=await Ya.getReviewQueue(r.id);p(D);break}}catch(E){console.error(`Failed to load ${l} data:`,E)}},j=async()=>{var E,S;if(r)try{b(!0),await Ya.calculateCredits(r.id),de.success("Credits calculated successfully"),g()}catch(N){de.error(((S=(E=N.response)==null?void 0:E.data)==null?void 0:S.detail)||"Calculation failed")}finally{b(!1)}},A=async E=>{var S,N;if(r)try{await Ya.transitionStudy(r.id,E),de.success(`Study moved to ${oh[E].label}`),g()}catch(D){de.error(((N=(S=D.response)==null?void 0:S.data)==null?void 0:N.detail)||"Failed to update status")}},k=E=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(E);if(n)return a.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:a.jsxs("div",{className:"flex flex-col items-center gap-4",children:[a.jsx(Aa,{className:"w-12 h-12 text-purple-500 animate-spin"}),a.jsx("p",{className:"text-gray-600",children:"Loading study..."})]})});if(!r)return a.jsxs("div",{className:"text-center py-16",children:[a.jsx("h2",{className:"text-xl text-gray-600",children:"Study not found"}),a.jsx("button",{onClick:()=>t("/firm/rd-studies"),className:"btn-primary mt-4",children:"Back to Studies"})]});const v=oh[r.status]||oh.draft;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsxs("button",{onClick:()=>t("/firm/rd-studies"),className:"text-sm text-gray-600 hover:text-gray-900 mb-3 flex items-center gap-1",children:[a.jsx(Qr,{className:"w-4 h-4"}),"Back to R&D Studies"]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-purple-100 rounded-xl flex items-center justify-center",children:a.jsx(pi,{className:"w-7 h-7 text-purple-600"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:r.name}),a.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${v.bgColor} ${v.color}`,children:v.label}),r.has_open_flags&&a.jsxs("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-red-100 text-red-600 flex items-center gap-1",children:[a.jsx(Qe,{className:"w-4 h-4"}),r.risk_flags.length," Flags"]})]}),a.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-gray-500",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Nt,{className:"w-4 h-4"}),r.entity_name]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Jr,{className:"w-4 h-4"}),"Tax Year ",r.tax_year]}),r.ein&&a.jsxs("span",{children:["EIN: ",r.ein]})]})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:j,disabled:w,className:"btn-secondary flex items-center gap-2",children:[w?a.jsx(Aa,{className:"w-4 h-4 animate-spin"}):a.jsx(Us,{className:"w-4 h-4"}),"Calculate Credits"]}),r.status==="cpa_review"&&a.jsxs("button",{onClick:()=>A("approved"),className:"btn-primary flex items-center gap-2",children:[a.jsx(Xd,{className:"w-4 h-4"}),"Approve Study"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"card",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Total QRE"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:k(r.total_qre)})]}),a.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:a.jsx(Or,{className:"w-5 h-5 text-purple-600"})})]})}),a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"card",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"Federal Credit"}),a.jsx("p",{className:"text-2xl font-bold text-blue-600",children:k(r.federal_credit_final)}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:r.selected_method==="asc"?"ASC Method":"Regular Method"})]}),a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(ua,{className:"w-5 h-5 text-blue-600"})})]})}),a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"card",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-500",children:"State Credits"}),a.jsx("p",{className:"text-2xl font-bold text-indigo-600",children:k(r.total_state_credits)}),a.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[r.states.length," state(s)"]})]}),a.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center",children:a.jsx(Nt,{className:"w-5 h-5 text-indigo-600"})})]})}),a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"card bg-gradient-to-br from-green-500 to-green-600 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-green-100 text-sm",children:"Total Credits"}),a.jsx("p",{className:"text-2xl font-bold",children:k(r.total_credits)})]}),a.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center",children:a.jsx(Ut,{className:"w-5 h-5 text-white"})})]})})]}),a.jsx("div",{className:"border-b border-gray-200",children:a.jsx("nav",{className:"flex gap-1 overflow-x-auto",children:JB.map(E=>{const S=E.icon,N=l===E.id;return a.jsxs("button",{onClick:()=>o(E.id),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${N?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[a.jsx(S,{className:"w-4 h-4"}),E.label]},E.id)})})}),a.jsx(Xe,{mode:"wait",children:a.jsxs(z.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},children:[l==="overview"&&a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"card",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Study Details"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex justify-between py-2 border-b",children:[a.jsx("span",{className:"text-gray-500",children:"Entity Type"}),a.jsx("span",{className:"font-medium",children:r.entity_type.replace("_"," ").toUpperCase()})]}),a.jsxs("div",{className:"flex justify-between py-2 border-b",children:[a.jsx("span",{className:"text-gray-500",children:"Fiscal Year"}),a.jsxs("span",{className:"font-medium",children:[new Date(r.fiscal_year_start).toLocaleDateString()," -",new Date(r.fiscal_year_end).toLocaleDateString()]})]}),a.jsxs("div",{className:"flex justify-between py-2 border-b",children:[a.jsx("span",{className:"text-gray-500",children:"Short Year"}),a.jsx("span",{className:"font-medium",children:r.is_short_year?`Yes (${r.short_year_days} days)`:"No"})]}),a.jsxs("div",{className:"flex justify-between py-2 border-b",children:[a.jsx("span",{className:"text-gray-500",children:"Controlled Group"}),a.jsx("span",{className:"font-medium",children:r.is_controlled_group?r.controlled_group_name:"No"})]}),a.jsxs("div",{className:"flex justify-between py-2",children:[a.jsx("span",{className:"text-gray-500",children:"States"}),a.jsx("span",{className:"font-medium",children:r.states.join(", ")||"None"})]})]})]}),a.jsxs("div",{className:"card",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[a.jsx(Rt,{className:"w-5 h-5 text-purple-500"}),"AI Analysis"]}),r.ai_analysis_summary?a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-gray-600",children:r.ai_analysis_summary}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"p-3 bg-green-50 rounded-lg",children:[a.jsx("p",{className:"text-sm text-green-600",children:"Opportunity Score"}),a.jsxs("p",{className:"text-2xl font-bold text-green-700",children:[((r.ai_opportunity_score||0)*100).toFixed(0),"%"]})]}),a.jsxs("div",{className:"p-3 bg-orange-50 rounded-lg",children:[a.jsx("p",{className:"text-sm text-orange-600",children:"Risk Score"}),a.jsxs("p",{className:"text-2xl font-bold text-orange-700",children:[((r.ai_risk_score||0)*100).toFixed(0),"%"]})]})]})]}):a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx(Rt,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),a.jsx("p",{children:"AI analysis not yet available"}),a.jsx("p",{className:"text-sm",children:"Upload documents to trigger analysis"})]})]}),r.risk_flags.length>0&&a.jsxs("div",{className:"card lg:col-span-2",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[a.jsx(Qe,{className:"w-5 h-5 text-orange-500"}),"Risk Flags (",r.risk_flags.length,")"]}),a.jsx("div",{className:"space-y-3",children:r.risk_flags.map((E,S)=>a.jsx("div",{className:`p-4 rounded-lg border ${E.severity==="high"?"bg-red-50 border-red-200":E.severity==="medium"?"bg-orange-50 border-orange-200":"bg-yellow-50 border-yellow-200"}`,children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Qe,{className:`w-5 h-5 flex-shrink-0 ${E.severity==="high"?"text-red-500":E.severity==="medium"?"text-orange-500":"text-yellow-500"}`}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:E.type}),a.jsx("p",{className:"text-sm text-gray-600",children:E.message})]})]})},S))})]})]}),l==="projects"&&a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["R&D Projects (",c.length,")"]}),a.jsx("button",{className:"btn-secondary text-sm",children:"Add Project"})]}),c.length===0?a.jsxs("div",{className:"text-center py-12 text-gray-500",children:[a.jsx(pi,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),a.jsx("p",{children:"No projects added yet"})]}):a.jsx("div",{className:"space-y-3",children:c.map(E=>a.jsx("div",{className:"p-4 border rounded-lg hover:bg-gray-50",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900",children:E.name}),a.jsx("p",{className:"text-sm text-gray-500",children:E.department})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${E.qualification_status==="qualified"?"bg-green-100 text-green-700":E.qualification_status==="not_qualified"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:E.qualification_status}),E.overall_score&&a.jsxs("span",{className:"text-sm text-gray-500",children:["Score: ",(E.overall_score*100).toFixed(0),"%"]})]})]})},E.id))})]}),l==="employees"&&a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["R&D Employees (",d.length,")"]}),a.jsx("button",{className:"btn-secondary text-sm",children:"Add Employee"})]}),d.length===0?a.jsxs("div",{className:"text-center py-12 text-gray-500",children:[a.jsx(zs,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),a.jsx("p",{children:"No employees added yet"})]}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Name"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Title"}),a.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-600",children:"Total Wages"}),a.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-600",children:"Qualified %"}),a.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-gray-600",children:"Qualified Wages"}),a.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-600",children:"Reviewed"})]})}),a.jsx("tbody",{className:"divide-y",children:d.map(E=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 font-medium",children:E.name}),a.jsx("td",{className:"px-4 py-3 text-gray-500",children:E.title||"-"}),a.jsx("td",{className:"px-4 py-3 text-right",children:k(E.total_wages)}),a.jsxs("td",{className:"px-4 py-3 text-right",children:[E.qualified_time_percentage,"%"]}),a.jsx("td",{className:"px-4 py-3 text-right font-medium text-green-600",children:k(E.qualified_wages)}),a.jsx("td",{className:"px-4 py-3 text-center",children:E.cpa_reviewed?a.jsx(Ut,{className:"w-5 h-5 text-green-500 mx-auto"}):a.jsx(nt,{className:"w-5 h-5 text-gray-400 mx-auto"})})]},E.id))})]})})]}),l==="qres"&&a.jsxs("div",{className:"card",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"QRE Summary"}),h?a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:Object.entries(h.by_category||{}).map(([E,S])=>a.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[a.jsx("p",{className:"text-sm text-gray-500 capitalize",children:E.replace("_"," ")}),a.jsx("p",{className:"text-xl font-bold text-gray-900",children:k(S.qualified||0)}),a.jsxs("p",{className:"text-xs text-gray-400",children:[S.count," items"]})]},E))}):a.jsxs("div",{className:"text-center py-12 text-gray-500",children:[a.jsx(Or,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),a.jsx("p",{children:"No QRE data available"})]})]}),l==="calculations"&&a.jsxs("div",{className:"card",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Credit Calculations"}),a.jsxs("button",{onClick:j,disabled:w,className:"btn-primary text-sm flex items-center gap-2",children:[w?a.jsx(Aa,{className:"w-4 h-4 animate-spin"}):a.jsx(zr,{className:"w-4 h-4"}),"Recalculate"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"p-4 border rounded-lg",children:[a.jsx("h4",{className:"font-medium mb-3",children:"Federal - Regular Method (20%)"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-500",children:"Total QRE"}),a.jsx("span",{children:k(r.total_qre)})]}),a.jsxs("div",{className:"flex justify-between font-medium text-blue-600",children:[a.jsx("span",{children:"Credit"}),a.jsx("span",{children:k(r.federal_credit_regular)})]})]})]}),a.jsxs("div",{className:"p-4 border rounded-lg",children:[a.jsx("h4",{className:"font-medium mb-3",children:"Federal - ASC Method (14%)"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-500",children:"Total QRE"}),a.jsx("span",{children:k(r.total_qre)})]}),a.jsxs("div",{className:"flex justify-between font-medium text-blue-600",children:[a.jsx("span",{children:"Credit"}),a.jsx("span",{children:k(r.federal_credit_asc)})]})]})]})]}),r.recommended_method&&a.jsx("div",{className:"mt-4 p-4 bg-green-50 rounded-lg",children:a.jsxs("p",{className:"text-green-700",children:[a.jsx("strong",{children:"Recommended:"})," ",r.recommended_method==="asc"?"ASC":"Regular"," Method",r.method_selection_reason&&` - ${r.method_selection_reason}`]})})]}),l==="review"&&a.jsxs("div",{className:"card",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"CPA Review Queue"}),m?a.jsxs("div",{children:[a.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[a.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-center",children:[a.jsx("p",{className:"text-2xl font-bold",children:m.total_items}),a.jsx("p",{className:"text-sm text-gray-500",children:"Total Items"})]}),a.jsxs("div",{className:"p-3 bg-green-50 rounded-lg text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-green-600",children:m.reviewed_items}),a.jsx("p",{className:"text-sm text-gray-500",children:"Reviewed"})]}),a.jsxs("div",{className:"p-3 bg-orange-50 rounded-lg text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-orange-600",children:m.pending_items}),a.jsx("p",{className:"text-sm text-gray-500",children:"Pending"})]}),a.jsxs("div",{className:"p-3 bg-red-50 rounded-lg text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-red-600",children:m.high_priority_items}),a.jsx("p",{className:"text-sm text-gray-500",children:"High Priority"})]})]}),a.jsx("div",{className:"space-y-3",children:(m.items||[]).map(E=>a.jsx("div",{className:"p-4 border rounded-lg",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-xs text-gray-400 uppercase",children:E.entity_type}),a.jsx("h4",{className:"font-medium",children:E.title}),a.jsx("p",{className:"text-sm text-gray-500",children:E.description})]}),a.jsx("button",{className:"btn-secondary text-sm",children:"Review"})]})},E.id))})]}):a.jsxs("div",{className:"text-center py-12 text-gray-500",children:[a.jsx(Ut,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),a.jsx("p",{children:"Review queue loading..."})]})]}),(l==="narratives"||l==="documents")&&a.jsxs("div",{className:"card text-center py-12",children:[a.jsx($e,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),a.jsxs("p",{className:"text-gray-500",children:[l==="narratives"?"Narrative management":"Document management"," coming soon"]})]})]},l)})]})},eU="https://portal.auraai.toroniandcompany.com/api";class tU{constructor(){Wt(this,"api");this.api=ye.create({baseURL:`${eU}/tax`,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(t=>{const r=localStorage.getItem("access_token");return r&&(t.headers.Authorization=`Bearer ${r}`),t})}async healthCheck(){return(await this.api.get("/health")).data}async listReturns(t){return(await this.api.get("/v1/returns",{params:t})).data}async getReturn(t){return(await this.api.get(`/v1/returns/${t}`)).data}async createReturn(t){return(await this.api.post("/v1/returns",t)).data}async updateReturn(t,r){return(await this.api.patch(`/v1/returns/${t}`,r)).data}async deleteReturn(t){await this.api.delete(`/v1/returns/${t}`)}async calculateReturn(t,r=!1){return(await this.api.post(`/v1/returns/${t}/calculate`,null,{params:{force_recalculate:r}})).data}async getCalculationResult(t){return(await this.api.get(`/v1/returns/${t}/calculation`)).data}async explainLine(t,r){return(await this.api.post(`/v1/returns/${t}/explain/${r}`)).data}async getFormData(t,r){return(await this.api.get(`/v1/returns/${t}/forms/${r}`)).data}async updateFormData(t,r,s){return(await this.api.patch(`/v1/returns/${t}/forms/${r}`,s)).data}async getSchedules(t){return(await this.api.get(`/v1/returns/${t}/schedules`)).data}async getSchedule(t,r){return(await this.api.get(`/v1/returns/${t}/schedules/${r}`)).data}async updateSchedule(t,r,s){return(await this.api.patch(`/v1/returns/${t}/schedules/${r}`,s)).data}async getTaxRules(t,r="federal"){return(await this.api.get(`/v1/rules/${t}`,{params:{jurisdiction:r}})).data.rules}async getTaxBrackets(t,r){return(await this.api.get(`/v1/reference/brackets/${t}`,{params:{filing_status:r}})).data}async getStandardDeduction(t,r){return(await this.api.get(`/v1/reference/standard-deduction/${t}`,{params:{filing_status:r}})).data}async validateReturn(t){return(await this.api.post(`/v1/returns/${t}/validate`)).data}async prepareEfile(t){return(await this.api.post(`/v1/returns/${t}/efile/prepare`)).data}async submitEfile(t){return(await this.api.post(`/v1/returns/${t}/efile/submit`)).data}async getEfileStatus(t){return(await this.api.get(`/v1/returns/${t}/efile/status`)).data}async generatePDF(t,r){return(await this.api.post(`/v1/returns/${t}/pdf`,{form_types:r},{responseType:"blob"})).data}async downloadPDF(t,r){const s=await this.generatePDF(t,r),n=window.URL.createObjectURL(s),i=document.createElement("a");i.href=n,i.download=`tax-return-${t}.pdf`,document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(n),document.body.removeChild(i)}async importFromPriorYear(t,r,s){return(await this.api.post("/v1/returns/import/prior-year",{client_id:t,prior_year_return_id:r,tax_year:s})).data}async importFromIntegration(t,r,s){return(await this.api.post("/v1/returns/import/integration",{client_id:t,integration_id:r,tax_year:s})).data}}const Qn=new tU,rU=()=>{const e=ze(),[t,r]=C.useState([]),[s,n]=C.useState(!0),[i,l]=C.useState(""),[o,c]=C.useState("all"),[u,d]=C.useState("all"),[f,h]=C.useState("all"),[x,m]=C.useState(!1),[p,w]=C.useState({total:0,draft:0,inProgress:0,readyToFile:0,filed:0,totalRefunds:0,totalOwed:0});C.useEffect(()=>{b()},[]);const b=async()=>{n(!0);try{const v=await Qn.listReturns();r(v.items||[]),g(v.items||[])}catch(v){console.error("Failed to load tax returns:",v);const E=y();r(E),g(E)}finally{n(!1)}},g=v=>{const E={total:v.length,draft:v.filter(S=>S.status==="draft").length,inProgress:v.filter(S=>["data_entry","review","calculating"].includes(S.status)).length,readyToFile:v.filter(S=>S.status==="ready_to_file").length,filed:v.filter(S=>["filed","accepted"].includes(S.status)).length,totalRefunds:v.filter(S=>(S.refund_or_owed||0)>0).reduce((S,N)=>S+(N.refund_or_owed||0),0),totalOwed:v.filter(S=>(S.refund_or_owed||0)<0).reduce((S,N)=>S+Math.abs(N.refund_or_owed||0),0)};w(E)},y=()=>[{id:"1",client_id:"c1",client_name:"Johnson Family Trust",tax_year:2024,form_type:"1040",filing_status:"married_filing_jointly",status:"ready_to_file",taxpayer_name:"Robert & Sarah Johnson",taxpayer_ssn_last4:"4532",total_income:285e3,taxable_income:215e3,total_tax:42500,refund_or_owed:3200,due_date:"2025-04-15",created_at:"2025-01-15"},{id:"2",client_id:"c2",client_name:"Tech Innovations LLC",tax_year:2024,form_type:"1120S",status:"data_entry",taxpayer_name:"Tech Innovations LLC",total_income:125e4,taxable_income:89e4,due_date:"2025-03-15",created_at:"2025-01-10"},{id:"3",client_id:"c3",client_name:"Williams Partnership",tax_year:2024,form_type:"1065",status:"review",taxpayer_name:"Williams Investment Partners",total_income:45e5,due_date:"2025-03-15",created_at:"2025-01-08"},{id:"4",client_id:"c4",client_name:"Martinez Consulting Inc",tax_year:2024,form_type:"1120",status:"filed",taxpayer_name:"Martinez Consulting Inc",total_income:75e4,taxable_income:32e4,total_tax:67200,refund_or_owed:-12500,filed_date:"2025-02-28",created_at:"2025-01-05"},{id:"5",client_id:"c5",client_name:"Emily Chen",tax_year:2024,form_type:"1040",filing_status:"single",status:"accepted",taxpayer_name:"Emily Chen",taxpayer_ssn_last4:"7891",total_income:145e3,taxable_income:108e3,total_tax:21500,refund_or_owed:2800,filed_date:"2025-02-15",created_at:"2025-01-20"},{id:"6",client_id:"c6",client_name:"Community Foundation",tax_year:2024,form_type:"990",status:"draft",taxpayer_name:"Community Foundation of Metro",total_income:21e5,due_date:"2025-05-15",created_at:"2025-02-01"}],j=t.filter(v=>{var F;const E=v.taxpayer_name.toLowerCase().includes(i.toLowerCase())||((F=v.client_name)==null?void 0:F.toLowerCase().includes(i.toLowerCase())),S=o==="all"||v.tax_year===o,N=u==="all"||v.form_type===u,D=f==="all"||v.status===f;return E&&S&&N&&D}),A=v=>{const E={draft:{color:"text-gray-600",bgColor:"bg-gray-100",icon:$e,label:"Draft"},data_entry:{color:"text-blue-600",bgColor:"bg-blue-100",icon:nt,label:"Data Entry"},review:{color:"text-yellow-600",bgColor:"bg-yellow-100",icon:zr,label:"In Review"},calculating:{color:"text-purple-600",bgColor:"bg-purple-100",icon:Us,label:"Calculating"},ready_to_file:{color:"text-green-600",bgColor:"bg-green-100",icon:Ut,label:"Ready to File"},filed:{color:"text-indigo-600",bgColor:"bg-indigo-100",icon:Vc,label:"Filed"},accepted:{color:"text-emerald-600",bgColor:"bg-emerald-100",icon:Ut,label:"Accepted"},rejected:{color:"text-red-600",bgColor:"bg-red-100",icon:tn,label:"Rejected"},amended:{color:"text-orange-600",bgColor:"bg-orange-100",icon:Bs,label:"Amended"}};return E[v]||E.draft},k=v=>v===void 0?"-":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(v);return s?a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-12 h-12 border-4 border-primary-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading tax returns..."})]})}):a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Tax Returns"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Manage and file tax returns for your clients"})]}),a.jsxs("button",{onClick:()=>m(!0),className:"fluent-btn-primary",children:[a.jsx($t,{className:"w-5 h-5"}),"New Return"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl p-5 shadow-sm border border-gray-200",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:a.jsx($e,{className:"w-6 h-6 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Total Returns"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:p.total})]})]})}),a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-xl p-5 shadow-sm border border-gray-200",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:a.jsx(nt,{className:"w-6 h-6 text-yellow-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"In Progress"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:p.inProgress})]})]})}),a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-xl p-5 shadow-sm border border-gray-200",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:a.jsx(Ut,{className:"w-6 h-6 text-green-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Ready to File"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:p.readyToFile})]})]})}),a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-xl p-5 shadow-sm border border-gray-200",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-emerald-100 rounded-lg",children:a.jsx(Or,{className:"w-6 h-6 text-emerald-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Total Refunds"}),a.jsx("p",{className:"text-2xl font-bold text-emerald-600",children:k(p.totalRefunds)})]})]})})]}),a.jsx("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-200",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[a.jsx("div",{className:"flex-1 min-w-[200px]",children:a.jsxs("div",{className:"relative",children:[a.jsx(Vs,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",value:i,onChange:v=>l(v.target.value),placeholder:"Search by taxpayer or client name...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})}),a.jsxs("select",{value:o,onChange:v=>c(v.target.value==="all"?"all":Number(v.target.value)),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[a.jsx("option",{value:"all",children:"All Years"}),a.jsx("option",{value:"2024",children:"2024"}),a.jsx("option",{value:"2023",children:"2023"}),a.jsx("option",{value:"2022",children:"2022"})]}),a.jsxs("select",{value:u,onChange:v=>d(v.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[a.jsx("option",{value:"all",children:"All Forms"}),a.jsx("option",{value:"1040",children:"1040 - Individual"}),a.jsx("option",{value:"1120",children:"1120 - C-Corp"}),a.jsx("option",{value:"1120S",children:"1120-S - S-Corp"}),a.jsx("option",{value:"1065",children:"1065 - Partnership"}),a.jsx("option",{value:"990",children:"990 - Non-Profit"})]}),a.jsxs("select",{value:f,onChange:v=>h(v.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[a.jsx("option",{value:"all",children:"All Statuses"}),a.jsx("option",{value:"draft",children:"Draft"}),a.jsx("option",{value:"data_entry",children:"Data Entry"}),a.jsx("option",{value:"review",children:"In Review"}),a.jsx("option",{value:"ready_to_file",children:"Ready to File"}),a.jsx("option",{value:"filed",children:"Filed"}),a.jsx("option",{value:"accepted",children:"Accepted"})]})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Taxpayer / Client"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Form / Year"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Total Income"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Refund / Owed"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Due Date"}),a.jsx("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:j.map((v,E)=>{const S=A(v.status),N=S.icon,D=(v.refund_or_owed||0)>0;return a.jsxs(z.tr,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:E*.05},className:"hover:bg-gray-50 cursor-pointer",onClick:()=>e(`/firm/tax-returns/${v.id}`),children:[a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:v.form_type==="1040"?a.jsx(ha,{className:"w-5 h-5 text-gray-600"}):a.jsx(Nt,{className:"w-5 h-5 text-gray-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:v.taxpayer_name}),a.jsx("p",{className:"text-sm text-gray-500",children:v.client_name})]})]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{children:[a.jsxs("p",{className:"font-medium text-gray-900",children:["Form ",v.form_type]}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Tax Year ",v.tax_year]})]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ${S.bgColor} ${S.color}`,children:[a.jsx(N,{className:"w-3.5 h-3.5"}),S.label]})}),a.jsx("td",{className:"px-6 py-4 text-right",children:a.jsx("span",{className:"font-medium text-gray-900",children:k(v.total_income)})}),a.jsx("td",{className:"px-6 py-4 text-right",children:v.refund_or_owed!==void 0?a.jsxs("span",{className:`font-medium ${D?"text-green-600":"text-red-600"}`,children:[D?"+":"",k(v.refund_or_owed)]}):a.jsx("span",{className:"text-gray-400",children:"-"})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[a.jsx(Jr,{className:"w-4 h-4"}),v.due_date?new Date(v.due_date).toLocaleDateString():"-"]})}),a.jsx("td",{className:"px-6 py-4 text-center",children:a.jsx("button",{onClick:F=>{F.stopPropagation(),e(`/firm/tax-returns/${v.id}`)},className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(fa,{className:"w-5 h-5 text-gray-400"})})})]},v.id)})})]})}),j.length===0&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Us,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"No tax returns found"}),a.jsx("button",{onClick:()=>m(!0),className:"mt-4 text-primary-600 hover:text-primary-700 font-medium",children:"Create your first tax return"})]})]}),a.jsx(Xe,{children:x&&a.jsx(sU,{onClose:()=>m(!1),onCreated:v=>{r([v,...t]),g([v,...t]),m(!1),Ye.success("Tax return created successfully"),e(`/firm/tax-returns/${v.id}`)}})})]})},sU=({onClose:e,onCreated:t})=>{const[r,s]=C.useState({taxpayer_first_name:"",taxpayer_last_name:"",tax_year:2024,form_type:"1040",filing_status:"single",client_id:""}),[n,i]=C.useState(!1),l=async o=>{o.preventDefault(),i(!0);try{const c=await Qn.createReturn(r);t({id:c.id,client_id:c.client_id,tax_year:c.tax_year,form_type:c.form_type,filing_status:c.filing_status,status:c.status,taxpayer_name:`${c.taxpayer_first_name} ${c.taxpayer_last_name}`,created_at:c.created_at})}catch{const u={id:`new-${Date.now()}`,client_id:r.client_id||"mock-client",tax_year:r.tax_year,form_type:r.form_type,filing_status:r.filing_status,status:"draft",taxpayer_name:`${r.taxpayer_first_name} ${r.taxpayer_last_name}`,created_at:new Date().toISOString()};t(u)}finally{i(!1)}};return a.jsx(z.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:e,children:a.jsxs(z.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-xl shadow-xl max-w-lg w-full",onClick:o=>o.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Create New Tax Return"}),a.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-lg",children:a.jsx(ur,{className:"w-5 h-5 text-gray-500"})})]}),a.jsxs("form",{onSubmit:l,className:"p-6 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name *"}),a.jsx("input",{type:"text",value:r.taxpayer_first_name,onChange:o=>s({...r,taxpayer_first_name:o.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name *"}),a.jsx("input",{type:"text",value:r.taxpayer_last_name,onChange:o=>s({...r,taxpayer_last_name:o.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tax Year *"}),a.jsxs("select",{value:r.tax_year,onChange:o=>s({...r,tax_year:Number(o.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[a.jsx("option",{value:2024,children:"2024"}),a.jsx("option",{value:2023,children:"2023"}),a.jsx("option",{value:2022,children:"2022"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Form Type *"}),a.jsxs("select",{value:r.form_type,onChange:o=>s({...r,form_type:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[a.jsx("option",{value:"1040",children:"1040 - Individual"}),a.jsx("option",{value:"1120",children:"1120 - C-Corp"}),a.jsx("option",{value:"1120S",children:"1120-S - S-Corp"}),a.jsx("option",{value:"1065",children:"1065 - Partnership"}),a.jsx("option",{value:"990",children:"990 - Non-Profit"})]})]})]}),r.form_type==="1040"&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Filing Status *"}),a.jsxs("select",{value:r.filing_status,onChange:o=>s({...r,filing_status:o.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[a.jsx("option",{value:"single",children:"Single"}),a.jsx("option",{value:"married_filing_jointly",children:"Married Filing Jointly"}),a.jsx("option",{value:"married_filing_separately",children:"Married Filing Separately"}),a.jsx("option",{value:"head_of_household",children:"Head of Household"}),a.jsx("option",{value:"qualifying_widow",children:"Qualifying Surviving Spouse"})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:n||!r.taxpayer_first_name||!r.taxpayer_last_name,className:"fluent-btn-primary",children:n?a.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):"Create Return"})]})]})]})})},aU=()=>{var N,D;const{id:e}=Hs(),t=ze(),[r,s]=C.useState(null),[n,i]=C.useState(null),[l,o]=C.useState([]),[c,u]=C.useState(!0),[d,f]=C.useState(!1),[h,x]=C.useState("overview"),[m,p]=C.useState(null),[w,b]=C.useState(!1);C.useEffect(()=>{e&&g()},[e]);const g=async()=>{u(!0);try{const[F,Y]=await Promise.all([Qn.getReturn(e),Qn.getCalculationResult(e).catch(()=>null)]);s(F),i(Y)}catch(F){console.error("Failed to load tax return:",F),s(y()),i(j())}finally{u(!1)}},y=()=>({id:e||"1",firm_id:"firm-1",client_id:"client-1",tax_year:2024,form_type:"1040",status:"data_entry",taxpayer_first_name:"Robert",taxpayer_last_name:"Johnson",taxpayer_ssn:"***-**-4532",filing_status:"married_filing_jointly",spouse_first_name:"Sarah",spouse_last_name:"Johnson",spouse_ssn:"***-**-7891",address_street:"123 Main Street",address_city:"Austin",address_state:"TX",address_zip:"78701",occupation:"Software Engineer",spouse_occupation:"Marketing Director",total_income:285e3,adjusted_gross_income:265e3,taxable_income:215e3,total_tax:42500,total_payments:45700,refund_or_owed:3200,created_at:"2025-01-15",updated_at:"2025-02-20"}),j=()=>({tax_return_id:e||"1",calculated_at:new Date().toISOString(),calculation_status:"completed",wages:245e3,interest_income:12500,dividend_income:18500,business_income:0,capital_gains:9e3,other_income:0,total_income:285e3,adjustments_to_income:2e4,adjusted_gross_income:265e3,standard_deduction:29200,itemized_deductions:42e3,deduction_used:"itemized",qualified_business_income_deduction:0,taxable_income:215e3,regular_tax:42500,amt:0,niit:0,self_employment_tax:0,total_tax:42500,child_tax_credit:4e3,earned_income_credit:0,education_credits:0,other_credits:0,total_credits:4e3,withholding:42e3,estimated_payments:3700,other_payments:0,total_payments:45700,refund_or_owed:3200,warnings:[]}),A=async()=>{f(!0);try{const F=await Qn.calculateReturn(e,!0);i(F),Ye.success("Tax calculation completed")}catch{i(j()),Ye.success("Tax calculation completed")}finally{f(!1)}},k=async F=>{try{const Y=await Qn.explainLine(e,F);p(Y),b(!0)}catch{p({line:F,value:42500,explanation:`This line represents your total tax liability after applying the ${(r==null?void 0:r.filing_status)==="married_filing_jointly"?"Married Filing Jointly":"Single"} tax brackets for 2024. The calculation considers your taxable income of $215,000 and applies the marginal tax rates progressively.`,formula:"Tax = (Taxable Income  Marginal Rate) - Bracket Adjustment",inputs:{taxable_income:215e3,marginal_rate:.24},rules_applied:[{rule_id:"federal-brackets-2024",description:"2024 Federal Tax Brackets for Married Filing Jointly",irs_citation:"Rev. Proc. 2023-34"}]}),b(!0)}},v=async()=>{try{await Qn.downloadPDF(e),Ye.success("PDF downloaded")}catch{Ye.error("Failed to download PDF")}},E=F=>F===void 0?"-":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(F),S=[{id:"overview",label:"Overview",icon:tF},{id:"income",label:"Income",icon:Or},{id:"deductions",label:"Deductions",icon:wy},{id:"credits",label:"Credits",icon:Wl},{id:"schedules",label:"Schedules",icon:$e},{id:"review",label:"Review",icon:V0},{id:"efile",label:"E-File",icon:Vc}];return c?a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-12 h-12 border-4 border-primary-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading tax return..."})]})}):r?a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("button",{onClick:()=>t("/firm/tax-returns"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsx(Qr,{className:"w-5 h-5 text-gray-600"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[r.taxpayer_first_name," ",r.taxpayer_last_name]}),a.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-sm font-medium",children:["Form ",r.form_type]})]}),a.jsxs("p",{className:"text-gray-600 mt-1",children:["Tax Year ",r.tax_year,"  ",(N=r.filing_status)==null?void 0:N.replace(/_/g," ")]})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("button",{onClick:A,disabled:d,className:"fluent-btn-secondary",children:[d?a.jsx("div",{className:"w-5 h-5 border-2 border-primary-500 border-t-transparent rounded-full animate-spin"}):a.jsx(Us,{className:"w-5 h-5"}),"Calculate"]}),a.jsxs("button",{onClick:v,className:"fluent-btn-secondary",children:[a.jsx(xs,{className:"w-5 h-5"}),"Download PDF"]}),a.jsxs("button",{className:"fluent-btn-primary",children:[a.jsx(vN,{className:"w-5 h-5"}),"Save"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl p-5 shadow-sm border border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Total Income"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:E(n==null?void 0:n.total_income)})]}),a.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:a.jsx(ua,{className:"w-6 h-6 text-blue-600"})})]})}),a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-xl p-5 shadow-sm border border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Taxable Income"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:E(n==null?void 0:n.taxable_income)})]}),a.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:a.jsx(Or,{className:"w-6 h-6 text-purple-600"})})]})}),a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-xl p-5 shadow-sm border border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Total Tax"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:E(n==null?void 0:n.total_tax)})]}),a.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:a.jsx(wy,{className:"w-6 h-6 text-red-600"})})]})}),a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:`bg-white rounded-xl p-5 shadow-sm border ${((n==null?void 0:n.refund_or_owed)||0)>0?"border-green-200":"border-red-200"}`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:((n==null?void 0:n.refund_or_owed)||0)>0?"Refund":"Amount Owed"}),a.jsx("p",{className:`text-2xl font-bold ${((n==null?void 0:n.refund_or_owed)||0)>0?"text-green-600":"text-red-600"}`,children:E(Math.abs((n==null?void 0:n.refund_or_owed)||0))})]}),a.jsx("div",{className:`p-3 rounded-lg ${((n==null?void 0:n.refund_or_owed)||0)>0?"bg-green-100":"bg-red-100"}`,children:((n==null?void 0:n.refund_or_owed)||0)>0?a.jsx(ua,{className:"w-6 h-6 text-green-600"}):a.jsx(W0,{className:"w-6 h-6 text-red-600"})})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[a.jsx("div",{className:"border-b border-gray-200",children:a.jsx("nav",{className:"flex gap-1 p-2",children:S.map(F=>{const Y=F.icon;return a.jsxs("button",{onClick:()=>x(F.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ${h===F.id?"bg-primary-100 text-primary-700":"text-gray-600 hover:bg-gray-100"}`,children:[a.jsx(Y,{className:"w-4 h-4"}),F.label]},F.id)})})}),a.jsxs("div",{className:"p-6",children:[h==="overview"&&a.jsx(nU,{taxReturn:r,calculation:n,onExplain:k}),h==="income"&&a.jsx(iU,{calculation:n,onExplain:k}),h==="deductions"&&a.jsx(lU,{calculation:n,onExplain:k}),h==="credits"&&a.jsx(oU,{calculation:n,onExplain:k}),h==="schedules"&&a.jsx(cU,{taxReturn:r}),h==="review"&&a.jsx(uU,{taxReturn:r,calculation:n}),h==="efile"&&a.jsx(dU,{taxReturn:r})]})]}),a.jsx(Xe,{children:w&&m&&a.jsx(z.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>b(!1),children:a.jsxs(z.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-xl shadow-xl max-w-lg w-full max-h-[80vh] overflow-auto",onClick:F=>F.stopPropagation(),children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:a.jsx(H6,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Line Explanation"}),a.jsx("p",{className:"text-sm text-gray-500",children:m.line})]})]})}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Value"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:E(m.value)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Explanation"}),a.jsx("p",{className:"text-gray-600",children:m.explanation})]}),m.formula&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Formula"}),a.jsx("code",{className:"block p-3 bg-gray-100 rounded-lg text-sm font-mono",children:m.formula})]}),((D=m.rules_applied)==null?void 0:D.length)>0&&a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"IRS Citations"}),a.jsx("div",{className:"space-y-2",children:m.rules_applied.map((F,Y)=>a.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[a.jsx("p",{className:"text-sm font-medium text-blue-800",children:F.description}),F.irs_citation&&a.jsx("p",{className:"text-xs text-blue-600 mt-1",children:F.irs_citation})]},Y))})]})]}),a.jsx("div",{className:"p-4 border-t border-gray-200",children:a.jsx("button",{onClick:()=>b(!1),className:"w-full py-2 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium transition-colors",children:"Close"})})]})})})]}):a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Qe,{className:"w-12 h-12 text-yellow-500 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Tax return not found"}),a.jsx("button",{onClick:()=>t("/firm/tax-returns"),className:"mt-4 text-primary-600 hover:text-primary-700",children:"Back to Tax Returns"})]})})},nU=({taxReturn:e,calculation:t})=>{var s;const r=n=>n===void 0?"-":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0}).format(n);return a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[a.jsx(ha,{className:"w-5 h-5 text-gray-600"}),"Taxpayer Information"]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Name"}),a.jsxs("span",{className:"font-medium",children:[e.taxpayer_first_name," ",e.taxpayer_last_name]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"SSN"}),a.jsx("span",{className:"font-medium",children:e.taxpayer_ssn})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Filing Status"}),a.jsx("span",{className:"font-medium",children:(s=e.filing_status)==null?void 0:s.replace(/_/g," ")})]}),e.spouse_first_name&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Spouse"}),a.jsxs("span",{className:"font-medium",children:[e.spouse_first_name," ",e.spouse_last_name]})]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[a.jsx(V6,{className:"w-5 h-5 text-gray-600"}),"Address"]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Street"}),a.jsx("span",{className:"font-medium",children:e.address_street})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"City"}),a.jsx("span",{className:"font-medium",children:e.address_city})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"State"}),a.jsx("span",{className:"font-medium",children:e.address_state})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"ZIP"}),a.jsx("span",{className:"font-medium",children:e.address_zip})]})]})]}),a.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[a.jsx(Us,{className:"w-5 h-5 text-gray-600"}),"Tax Summary"]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Total Income"}),a.jsx("p",{className:"text-lg font-semibold",children:r(t==null?void 0:t.total_income)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"AGI"}),a.jsx("p",{className:"text-lg font-semibold",children:r(t==null?void 0:t.adjusted_gross_income)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Deductions"}),a.jsx("p",{className:"text-lg font-semibold",children:r((t==null?void 0:t.deduction_used)==="itemized"?t==null?void 0:t.itemized_deductions:t==null?void 0:t.standard_deduction)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Taxable Income"}),a.jsx("p",{className:"text-lg font-semibold",children:r(t==null?void 0:t.taxable_income)})]})]}),a.jsxs("div",{className:"border-t border-gray-200 mt-4 pt-4 grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Total Tax"}),a.jsx("p",{className:"text-lg font-semibold text-red-600",children:r(t==null?void 0:t.total_tax)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Credits"}),a.jsx("p",{className:"text-lg font-semibold text-green-600",children:r(t==null?void 0:t.total_credits)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Payments"}),a.jsx("p",{className:"text-lg font-semibold",children:r(t==null?void 0:t.total_payments)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:((t==null?void 0:t.refund_or_owed)||0)>0?"Refund":"Owed"}),a.jsx("p",{className:`text-lg font-semibold ${((t==null?void 0:t.refund_or_owed)||0)>0?"text-green-600":"text-red-600"}`,children:r(Math.abs((t==null?void 0:t.refund_or_owed)||0))})]})]})]})]})]})},iU=({calculation:e,onExplain:t})=>{const r=n=>n===void 0?"$0":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0}).format(n),s=[{label:"Wages, Salaries, Tips (W-2)",value:e==null?void 0:e.wages,line:"1040.line1"},{label:"Interest Income",value:e==null?void 0:e.interest_income,line:"1040.line2b"},{label:"Dividend Income",value:e==null?void 0:e.dividend_income,line:"1040.line3b"},{label:"Business Income (Schedule C)",value:e==null?void 0:e.business_income,line:"1040.line8"},{label:"Capital Gains (Schedule D)",value:e==null?void 0:e.capital_gains,line:"1040.line7"},{label:"Other Income",value:e==null?void 0:e.other_income,line:"1040.line8"}];return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Income Sources"}),a.jsx("span",{className:"text-sm text-gray-500",children:"Form 1040, Lines 1-8"})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg divide-y divide-gray-200",children:[s.map((n,i)=>a.jsxs("div",{className:"flex items-center justify-between p-4 hover:bg-gray-100",children:[a.jsx("span",{className:"text-gray-700",children:n.label}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"font-medium",children:r(n.value)}),a.jsx("button",{onClick:()=>t(n.line),className:"p-1 hover:bg-gray-200 rounded",title:"Explain this line",children:a.jsx(U6,{className:"w-4 h-4 text-gray-400"})})]})]},i)),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50",children:[a.jsx("span",{className:"font-semibold text-gray-900",children:"Total Income"}),a.jsx("span",{className:"font-bold text-lg",children:r(e==null?void 0:e.total_income)})]})]})]})},lU=({calculation:e,onExplain:t})=>{const r=s=>s===void 0?"$0":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0}).format(s);return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:`px-4 py-2 rounded-lg ${(e==null?void 0:e.deduction_used)==="standard"?"bg-primary-100 text-primary-700":"bg-gray-100 text-gray-600"}`,children:["Standard: ",r(e==null?void 0:e.standard_deduction)]}),a.jsxs("div",{className:`px-4 py-2 rounded-lg ${(e==null?void 0:e.deduction_used)==="itemized"?"bg-primary-100 text-primary-700":"bg-gray-100 text-gray-600"}`,children:["Itemized: ",r(e==null?void 0:e.itemized_deductions)]}),a.jsxs("span",{className:"text-sm text-gray-500",children:["Using ",e==null?void 0:e.deduction_used," deduction (higher amount)"]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("span",{className:"text-gray-700",children:"Adjusted Gross Income"}),a.jsx("span",{className:"font-medium",children:r(e==null?void 0:e.adjusted_gross_income)})]}),a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("span",{className:"text-gray-700",children:"Deduction Amount"}),a.jsxs("span",{className:"font-medium text-green-600",children:["-",r((e==null?void 0:e.deduction_used)==="itemized"?e==null?void 0:e.itemized_deductions:e==null?void 0:e.standard_deduction)]})]}),(e==null?void 0:e.qualified_business_income_deduction)&&e.qualified_business_income_deduction>0&&a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("span",{className:"text-gray-700",children:"QBI Deduction (199A)"}),a.jsxs("span",{className:"font-medium text-green-600",children:["-",r(e.qualified_business_income_deduction)]})]}),a.jsxs("div",{className:"border-t border-gray-200 pt-4 flex items-center justify-between",children:[a.jsx("span",{className:"font-semibold text-gray-900",children:"Taxable Income"}),a.jsx("span",{className:"font-bold text-lg",children:r(e==null?void 0:e.taxable_income)})]})]})]})},oU=({calculation:e,onExplain:t})=>{const r=n=>n===void 0?"$0":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0}).format(n),s=[{label:"Child Tax Credit",value:e==null?void 0:e.child_tax_credit},{label:"Earned Income Credit",value:e==null?void 0:e.earned_income_credit},{label:"Education Credits",value:e==null?void 0:e.education_credits},{label:"Other Credits",value:e==null?void 0:e.other_credits}];return a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Tax Credits"}),a.jsxs("div",{className:"bg-gray-50 rounded-lg divide-y divide-gray-200",children:[s.map((n,i)=>a.jsxs("div",{className:"flex items-center justify-between p-4",children:[a.jsx("span",{className:"text-gray-700",children:n.label}),a.jsx("span",{className:"font-medium text-green-600",children:r(n.value)})]},i)),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-50",children:[a.jsx("span",{className:"font-semibold text-gray-900",children:"Total Credits"}),a.jsx("span",{className:"font-bold text-lg text-green-600",children:r(e==null?void 0:e.total_credits)})]})]})]})},cU=({taxReturn:e})=>{const t=[{id:"A",name:"Itemized Deductions",required:!0,complete:!0},{id:"B",name:"Interest and Dividends",required:!0,complete:!0},{id:"C",name:"Business Income",required:!1,complete:!1},{id:"D",name:"Capital Gains and Losses",required:!0,complete:!0},{id:"E",name:"Supplemental Income",required:!1,complete:!1},{id:"SE",name:"Self-Employment Tax",required:!1,complete:!1}];return a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Schedules & Forms"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map(r=>a.jsx("div",{className:`p-4 rounded-lg border ${r.complete?"border-green-200 bg-green-50":r.required?"border-yellow-200 bg-yellow-50":"border-gray-200 bg-gray-50"}`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("p",{className:"font-medium text-gray-900",children:["Schedule ",r.id]}),a.jsx("p",{className:"text-sm text-gray-600",children:r.name})]}),r.complete?a.jsx(Ut,{className:"w-5 h-5 text-green-600"}):r.required?a.jsx(nt,{className:"w-5 h-5 text-yellow-600"}):a.jsx("span",{className:"text-xs text-gray-500",children:"Optional"})]})},r.id))})]})},uU=({taxReturn:e,calculation:t})=>{const r=[{label:"Taxpayer information complete",status:"pass"},{label:"All income sources reported",status:"pass"},{label:"Deductions properly documented",status:"pass"},{label:"Credits eligibility verified",status:"pass"},{label:"Prior year comparison reviewed",status:"warning"},{label:"E-file validation passed",status:"pending"}];return a.jsxs("div",{className:"space-y-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Pre-Filing Review"}),a.jsx("div",{className:"space-y-3",children:r.map((s,n)=>a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[s.status==="pass"&&a.jsx(Ut,{className:"w-5 h-5 text-green-600"}),s.status==="warning"&&a.jsx(Qe,{className:"w-5 h-5 text-yellow-600"}),s.status==="pending"&&a.jsx(nt,{className:"w-5 h-5 text-gray-400"}),a.jsx("span",{className:"text-gray-700",children:s.label})]},n))}),(t==null?void 0:t.warnings)&&t.warnings.length>0&&a.jsxs("div",{className:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:"Warnings"}),a.jsx("ul",{className:"list-disc list-inside text-sm text-yellow-700 space-y-1",children:t.warnings.map((s,n)=>a.jsx("li",{children:s},n))})]})]})},dU=({taxReturn:e})=>{const[t,r]=C.useState(!1);return a.jsxs("div",{className:"space-y-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Electronic Filing"}),a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(z0,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-blue-800",children:"Ready to E-File"}),a.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"This return has passed all validation checks and is ready for electronic filing."})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("button",{onClick:()=>r(!0),disabled:t,className:"p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-primary-500 hover:bg-primary-50 transition-colors text-center",children:[a.jsx(V0,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"font-medium text-gray-700",children:"Prepare for E-File"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Generate XML and validate"})]}),a.jsxs("button",{className:"p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-primary-500 hover:bg-primary-50 transition-colors text-center",children:[a.jsx(Vc,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"font-medium text-gray-700",children:"Submit to IRS"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Transmit return electronically"})]})]})]})},fU="https://portal.auraai.toroniandcompany.com/api";class hU{constructor(){Wt(this,"api");this.api=ye.create({baseURL:`${fU}/fraud-detection`,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(t=>{const r=localStorage.getItem("access_token");return r&&(t.headers.Authorization=`Bearer ${r}`),t})}async healthCheck(){return(await this.api.get("/health")).data}async createPlaidLinkToken(t){return(await this.api.post("/plaid/link-token",null,{params:{user_id:t}})).data}async exchangePlaidToken(t,r,s,n,i){return(await this.api.post("/plaid/exchange-token",{public_token:r,account_id:s,institution_id:n,institution_name:i},{params:{customer_id:t}})).data}async listBankAccounts(t,r){return(await this.api.get("/bank-accounts",{params:{customer_id:t,...r}})).data}async getBankAccount(t){return(await this.api.get(`/bank-accounts/${t}`)).data}async updateBankAccount(t,r){return(await this.api.patch(`/bank-accounts/${t}`,r)).data}async syncBankAccount(t){return(await this.api.post(`/bank-accounts/${t}/sync`)).data}async listTransactions(t){return(await this.api.get("/transactions",{params:t})).data}async getTransactionAnalysis(t){return(await this.api.get(`/transactions/${t}`)).data}async analyzeBatchTransactions(t,r=!1){return(await this.api.post("/transactions/analyze-batch",{transaction_ids:t,force_reanalysis:r})).data}async createFraudCase(t,r){return(await this.api.post("/fraud-cases",t,{params:{user_id:r}})).data}async listFraudCases(t){return(await this.api.get("/fraud-cases",{params:t})).data}async getFraudCase(t){return(await this.api.get(`/fraud-cases/${t}`)).data}async updateFraudCase(t,r,s){return(await this.api.patch(`/fraud-cases/${t}`,r,{params:{user_id:s}})).data}async getCaseActivities(t){return(await this.api.get(`/fraud-cases/${t}/activities`)).data}async addCaseActivity(t,r,s){return(await this.api.post(`/fraud-cases/${t}/activities`,r,{params:{user_id:s}})).data}async listAlerts(t){return(await this.api.get("/alerts",{params:t})).data}async updateAlert(t,r,s){return(await this.api.patch(`/alerts/${t}`,r,{params:{user_id:s}})).data}async getFeatureFlag(t){return(await this.api.get(`/feature-flags/${t}`)).data}async updateFeatureFlag(t,r,s){return(await this.api.patch(`/feature-flags/${t}`,r,{params:{user_id:s}})).data}async getStatistics(t){return(await this.api.get("/statistics",{params:t})).data}async getDashboardMetrics(){return(await this.api.get("/dashboard")).data}}const sn=new hU,mU=()=>{const e=ze(),[t,r]=C.useState(!0),[s,n]=C.useState("overview"),[i,l]=C.useState(null),[o,c]=C.useState([]),[u,d]=C.useState([]),[f,h]=C.useState([]),[x,m]=C.useState([]),[p,w]=C.useState("");C.useEffect(()=>{b()},[]);const b=async()=>{r(!0);try{const[N,D,F]=await Promise.all([sn.getDashboardMetrics(),sn.listAlerts({limit:20}),sn.listFraudCases({limit:20})]);l(N),c(D),d(F)}catch(N){console.error("Failed to load dashboard data:",N),l(g()),c(y()),d(j())}finally{r(!1)}},g=()=>({today_transactions:1247,today_flagged:23,new_alerts:8,open_cases:12,total_monitored_accounts:156,active_customers:45,average_risk_score:.15,top_fraud_types:[{type:"Account Takeover",count:15},{type:"Payment Fraud",count:12},{type:"Identity Theft",count:8},{type:"Wire Fraud",count:5}],recent_alerts:[]}),y=()=>[{id:"1",transaction_id:"t1",alert_type:"high_risk_transaction",severity:"critical",status:"new",message:"Unusual wire transfer of $45,000 to foreign account",triggered_rules:["LARGE_AMOUNT","FOREIGN_TRANSACTION"],created_at:new Date(Date.now()-1e3*60*5).toISOString()},{id:"2",transaction_id:"t2",alert_type:"velocity_spike",severity:"high",status:"acknowledged",message:"15 transactions in 1 hour from same merchant",triggered_rules:["HIGH_VELOCITY"],acknowledged_at:new Date(Date.now()-1e3*60*30).toISOString(),created_at:new Date(Date.now()-1e3*60*45).toISOString()},{id:"3",transaction_id:"t3",alert_type:"anomaly_detected",severity:"medium",status:"new",message:"Transaction pattern deviation detected",triggered_rules:["UNUSUAL_AMOUNT"],created_at:new Date(Date.now()-1e3*60*60).toISOString()},{id:"4",transaction_id:"t4",alert_type:"suspicious_time",severity:"medium",status:"resolved",message:"Large transaction at 3:00 AM",triggered_rules:["SUSPICIOUS_TIME","LARGE_AMOUNT"],resolved_at:new Date(Date.now()-1e3*60*120).toISOString(),created_at:new Date(Date.now()-1e3*60*180).toISOString()}],j=()=>[{id:"1",case_number:"FRAUD-20250228-A1B2C3D4",customer_id:"c1",title:"Suspected Account Takeover - Johnson Corp",description:"Multiple unauthorized transfers detected",severity:"critical",status:"investigating",fraud_type:"account_takeover",estimated_loss_amount:125e3,detected_patterns:["FOREIGN_TRANSACTION","HIGH_VELOCITY","LARGE_AMOUNT"],assigned_to:"John Smith",created_at:new Date(Date.now()-1e3*60*60*2).toISOString()},{id:"2",case_number:"FRAUD-20250227-E5F6G7H8",customer_id:"c2",title:"Wire Fraud Attempt - Tech Solutions LLC",description:"Suspicious wire request intercepted",severity:"high",status:"open",fraud_type:"wire_fraud",estimated_loss_amount:5e4,detected_patterns:["UNUSUAL_AMOUNT","FOREIGN_TRANSACTION"],created_at:new Date(Date.now()-1e3*60*60*24).toISOString()},{id:"3",case_number:"FRAUD-20250226-I9J0K1L2",customer_id:"c3",title:"Payment Card Fraud - Martinez Consulting",description:"Multiple fraudulent charges detected",severity:"medium",status:"resolved",fraud_type:"payment_fraud",estimated_loss_amount:8500,actual_loss_amount:0,resolution_notes:"All charges reversed successfully",resolved_at:new Date(Date.now()-1e3*60*60*48).toISOString(),created_at:new Date(Date.now()-1e3*60*60*72).toISOString()}],A=N=>{const D={critical:{color:"text-red-700",bgColor:"bg-red-100",icon:tn},high:{color:"text-orange-700",bgColor:"bg-orange-100",icon:Qe},medium:{color:"text-yellow-700",bgColor:"bg-yellow-100",icon:cr},low:{color:"text-green-700",bgColor:"bg-green-100",icon:Ut}};return D[N]||D.medium},k=N=>{const D={new:{color:"text-blue-700",bgColor:"bg-blue-100",label:"New"},open:{color:"text-blue-700",bgColor:"bg-blue-100",label:"Open"},acknowledged:{color:"text-yellow-700",bgColor:"bg-yellow-100",label:"Acknowledged"},investigating:{color:"text-purple-700",bgColor:"bg-purple-100",label:"Investigating"},pending_review:{color:"text-orange-700",bgColor:"bg-orange-100",label:"Pending Review"},resolved:{color:"text-green-700",bgColor:"bg-green-100",label:"Resolved"},closed:{color:"text-gray-700",bgColor:"bg-gray-100",label:"Closed"},dismissed:{color:"text-gray-700",bgColor:"bg-gray-100",label:"Dismissed"},false_positive:{color:"text-gray-700",bgColor:"bg-gray-100",label:"False Positive"}};return D[N]||D.open},v=N=>N===void 0?"-":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0}).format(N),E=N=>{const D=new Date(N),Y=new Date().getTime()-D.getTime(),Q=Math.floor(Y/(1e3*60)),ae=Math.floor(Y/(1e3*60*60)),ee=Math.floor(Y/(1e3*60*60*24));return Q<60?`${Q}m ago`:ae<24?`${ae}h ago`:`${ee}d ago`},S=[{id:"overview",label:"Overview",icon:Yd},{id:"alerts",label:"Alerts",icon:Kd},{id:"cases",label:"Cases",icon:yc},{id:"transactions",label:"Transactions",icon:Wl},{id:"accounts",label:"Accounts",icon:lx},{id:"settings",label:"Settings",icon:gc}];return t?a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-12 h-12 border-4 border-red-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading fraud detection..."})]})}):a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(yc,{className:"w-7 h-7 text-red-600"}),"Fraud Detection"]}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Real-time monitoring and fraud prevention for your clients"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("button",{onClick:b,className:"fluent-btn-secondary",children:[a.jsx(zr,{className:"w-5 h-5"}),"Refresh"]}),a.jsxs("button",{className:"fluent-btn-primary",children:[a.jsx($t,{className:"w-5 h-5"}),"Connect Account"]})]})]}),a.jsx(z.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-green-500 to-emerald-600 rounded-xl p-4 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:a.jsx(_i,{className:"w-6 h-6"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:"Real-Time Monitoring Active"}),a.jsxs("p",{className:"text-sm text-green-100",children:[(i==null?void 0:i.total_monitored_accounts)||0," accounts monitored across ",(i==null?void 0:i.active_customers)||0," clients"]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),a.jsx("span",{className:"text-sm",children:"Live"})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl p-5 shadow-sm border border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Today's Transactions"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i==null?void 0:i.today_transactions.toLocaleString()}),a.jsxs("p",{className:"text-xs text-red-600 mt-1",children:[i==null?void 0:i.today_flagged," flagged (",(((i==null?void 0:i.today_flagged)||0)/((i==null?void 0:i.today_transactions)||1)*100).toFixed(1),"%)"]})]}),a.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:a.jsx(Yd,{className:"w-6 h-6 text-blue-600"})})]})}),a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-xl p-5 shadow-sm border border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"New Alerts"}),a.jsx("p",{className:"text-2xl font-bold text-red-600",children:i==null?void 0:i.new_alerts}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Requires attention"})]}),a.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:a.jsx(Kd,{className:"w-6 h-6 text-red-600"})})]})}),a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-xl p-5 shadow-sm border border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Open Cases"}),a.jsx("p",{className:"text-2xl font-bold text-orange-600",children:i==null?void 0:i.open_cases}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Under investigation"})]}),a.jsx("div",{className:"p-3 bg-orange-100 rounded-lg",children:a.jsx(Ml,{className:"w-6 h-6 text-orange-600"})})]})}),a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-xl p-5 shadow-sm border border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Avg Risk Score"}),a.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[(((i==null?void 0:i.average_risk_score)||0)*100).toFixed(1),"%"]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Low risk baseline"})]}),a.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:a.jsx(ua,{className:"w-6 h-6 text-green-600"})})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[a.jsx("div",{className:"border-b border-gray-200",children:a.jsx("nav",{className:"flex gap-1 p-2",children:S.map(N=>{const D=N.icon;return a.jsxs("button",{onClick:()=>n(N.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ${s===N.id?"bg-red-100 text-red-700":"text-gray-600 hover:bg-gray-100"}`,children:[a.jsx(D,{className:"w-4 h-4"}),N.label,N.id==="alerts"&&((i==null?void 0:i.new_alerts)||0)>0&&a.jsx("span",{className:"px-1.5 py-0.5 bg-red-500 text-white text-xs rounded-full",children:i==null?void 0:i.new_alerts})]},N.id)})})}),a.jsxs("div",{className:"p-6",children:[s==="overview"&&a.jsx(pU,{metrics:i,alerts:o,cases:u,onViewCase:N=>e(`/firm/fraud-detection/cases/${N}`)}),s==="alerts"&&a.jsx(xU,{alerts:o,getSeverityConfig:A,getStatusConfig:k,formatTimeAgo:E}),s==="cases"&&a.jsx(gU,{cases:u,getSeverityConfig:A,getStatusConfig:k,formatCurrency:v,formatTimeAgo:E,onViewCase:N=>e(`/firm/fraud-detection/cases/${N}`)}),s==="transactions"&&a.jsx(yU,{}),s==="accounts"&&a.jsx(vU,{}),s==="settings"&&a.jsx(wU,{})]})]})]})},pU=({metrics:e,alerts:t,cases:r,onViewCase:s})=>a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[a.jsx(Ba,{className:"w-5 h-5 text-gray-600"}),"Top Fraud Types"]}),a.jsx("div",{className:"space-y-3",children:e==null?void 0:e.top_fraud_types.map((n,i)=>{var l;return a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-700",children:n.type}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-32 h-2 bg-gray-200 rounded-full overflow-hidden",children:a.jsx("div",{className:"h-full bg-red-500 rounded-full",style:{width:`${n.count/(((l=e.top_fraud_types[0])==null?void 0:l.count)||1)*100}%`}})}),a.jsx("span",{className:"text-sm font-medium text-gray-600 w-8",children:n.count})]})]},i)})})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[a.jsx(Kd,{className:"w-5 h-5 text-gray-600"}),"Recent Alerts"]}),a.jsx("div",{className:"space-y-3",children:t.slice(0,4).map(n=>a.jsxs("div",{className:"flex items-start gap-3 p-2 bg-white rounded-lg",children:[a.jsx("div",{className:`p-1 rounded ${n.severity==="critical"?"bg-red-100":n.severity==="high"?"bg-orange-100":"bg-yellow-100"}`,children:a.jsx(Qe,{className:`w-4 h-4 ${n.severity==="critical"?"text-red-600":n.severity==="high"?"text-orange-600":"text-yellow-600"}`})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:n.message}),a.jsx("p",{className:"text-xs text-gray-500",children:new Date(n.created_at).toLocaleString()})]})]},n.id))})]}),a.jsxs("div",{className:"lg:col-span-2 bg-gray-50 rounded-lg p-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[a.jsx(yc,{className:"w-5 h-5 text-gray-600"}),"Active Cases"]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"text-left text-xs font-semibold text-gray-500 uppercase",children:[a.jsx("th",{className:"pb-3",children:"Case"}),a.jsx("th",{className:"pb-3",children:"Severity"}),a.jsx("th",{className:"pb-3",children:"Status"}),a.jsx("th",{className:"pb-3",children:"Est. Loss"}),a.jsx("th",{className:"pb-3",children:"Assigned"}),a.jsx("th",{className:"pb-3"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:r.filter(n=>n.status!=="resolved"&&n.status!=="closed").slice(0,5).map(n=>a.jsxs("tr",{className:"hover:bg-white",children:[a.jsxs("td",{className:"py-3",children:[a.jsx("p",{className:"font-medium text-gray-900",children:n.title}),a.jsx("p",{className:"text-xs text-gray-500",children:n.case_number})]}),a.jsx("td",{className:"py-3",children:a.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${n.severity==="critical"?"bg-red-100 text-red-700":n.severity==="high"?"bg-orange-100 text-orange-700":"bg-yellow-100 text-yellow-700"}`,children:n.severity.toUpperCase()})}),a.jsx("td",{className:"py-3",children:a.jsx("span",{className:"text-sm text-gray-600",children:n.status.replace("_"," ")})}),a.jsx("td",{className:"py-3",children:a.jsxs("span",{className:"text-sm font-medium text-red-600",children:["$",(n.estimated_loss_amount||0).toLocaleString()]})}),a.jsx("td",{className:"py-3",children:a.jsx("span",{className:"text-sm text-gray-600",children:n.assigned_to||"Unassigned"})}),a.jsx("td",{className:"py-3",children:a.jsx("button",{onClick:()=>s(n.id),className:"p-1 hover:bg-gray-200 rounded",children:a.jsx(fa,{className:"w-4 h-4 text-gray-400"})})})]},n.id))})]})})]})]}),xU=({alerts:e,getSeverityConfig:t,getStatusConfig:r,formatTimeAgo:s})=>{const[n,i]=C.useState("all"),l=e.filter(o=>n==="all"||o.status===n);return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Fraud Alerts"}),a.jsxs("select",{value:n,onChange:o=>i(o.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"all",children:"All Statuses"}),a.jsx("option",{value:"new",children:"New"}),a.jsx("option",{value:"acknowledged",children:"Acknowledged"}),a.jsx("option",{value:"resolved",children:"Resolved"})]})]}),a.jsx("div",{className:"space-y-3",children:l.map(o=>{const c=t(o.severity),u=c.icon,d=r(o.status);return a.jsx(z.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:`p-2 rounded-lg ${c.bgColor}`,children:a.jsx(u,{className:`w-5 h-5 ${c.color}`})}),a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:o.message}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${c.bgColor} ${c.color}`,children:o.severity.toUpperCase()}),a.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${d.bgColor} ${d.color}`,children:d.label}),o.triggered_rules&&a.jsxs("span",{className:"text-xs text-gray-500",children:["Rules: ",o.triggered_rules.join(", ")]})]})]}),a.jsx("span",{className:"text-sm text-gray-500",children:s(o.created_at)})]})})]})},o.id)})})]})},gU=({cases:e,getSeverityConfig:t,getStatusConfig:r,formatCurrency:s,formatTimeAgo:n,onViewCase:i})=>a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Fraud Cases"}),a.jsxs("button",{className:"fluent-btn-primary text-sm",children:[a.jsx($t,{className:"w-4 h-4"}),"Create Case"]})]}),a.jsx("div",{className:"space-y-3",children:e.map(l=>{const o=t(l.severity),c=r(l.status);return a.jsx(z.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},onClick:()=>i(l.id),className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:l.title}),a.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${o.bgColor} ${o.color}`,children:l.severity.toUpperCase()})]}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:l.case_number}),l.description&&a.jsx("p",{className:"text-sm text-gray-600 mt-2",children:l.description}),a.jsxs("div",{className:"flex items-center gap-4 mt-3",children:[a.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${c.bgColor} ${c.color}`,children:c.label}),l.estimated_loss_amount&&a.jsxs("span",{className:"text-sm text-red-600 font-medium",children:["Est. Loss: ",s(l.estimated_loss_amount)]}),l.assigned_to&&a.jsxs("span",{className:"text-sm text-gray-500",children:["Assigned: ",l.assigned_to]}),a.jsx("span",{className:"text-sm text-gray-400",children:n(l.created_at)})]})]}),a.jsx(fa,{className:"w-5 h-5 text-gray-400"})]})},l.id)})})]}),yU=()=>a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Wl,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Transaction Monitor"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Connect bank accounts to monitor transactions in real-time"}),a.jsxs("button",{className:"fluent-btn-primary",children:[a.jsx(ud,{className:"w-5 h-5"}),"Connect Bank Account"]})]}),vU=()=>a.jsxs("div",{className:"text-center py-12",children:[a.jsx(lx,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Connected Accounts"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"No bank accounts connected yet. Connect via Plaid to enable fraud monitoring."}),a.jsxs("button",{className:"fluent-btn-primary",children:[a.jsx($t,{className:"w-5 h-5"}),"Connect Account"]})]}),wU=()=>{const[e,t]=C.useState({ml_detection:!0,rule_based_detection:!0,anomaly_detection:!0,real_time_monitoring:!0,alert_email:!0,alert_sms:!1,auto_case_threshold:.75,high_risk_threshold:1e4});return a.jsxs("div",{className:"max-w-2xl space-y-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Detection Settings"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:"ML Detection"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Use machine learning models for fraud detection"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:e.ml_detection,onChange:r=>t({...e,ml_detection:r.target.checked}),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:ring-4 peer-focus:ring-red-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-red-600"})]})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:"Rule-Based Detection"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Apply pre-defined fraud detection rules"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:e.rule_based_detection,onChange:r=>t({...e,rule_based_detection:r.target.checked}),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:ring-4 peer-focus:ring-red-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-red-600"})]})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:"Anomaly Detection"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Detect unusual transaction patterns"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:e.anomaly_detection,onChange:r=>t({...e,anomaly_detection:r.target.checked}),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:ring-4 peer-focus:ring-red-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-red-600"})]})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:"Real-Time Monitoring"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Process transactions in real-time via webhooks"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:e.real_time_monitoring,onChange:r=>t({...e,real_time_monitoring:r.target.checked}),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:ring-4 peer-focus:ring-red-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-red-600"})]})]})]}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mt-8",children:"Alert Settings"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:"Email Alerts"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Send alerts via email"})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:e.alert_email,onChange:r=>t({...e,alert_email:r.target.checked}),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:ring-4 peer-focus:ring-red-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-red-600"})]})]}),a.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("p",{className:"font-medium text-gray-900",children:"Auto Case Creation Threshold"}),a.jsxs("span",{className:"text-sm font-medium text-gray-600",children:[(e.auto_case_threshold*100).toFixed(0),"%"]})]}),a.jsx("input",{type:"range",min:"0.5",max:"1",step:"0.05",value:e.auto_case_threshold,onChange:r=>t({...e,auto_case_threshold:parseFloat(r.target.value)}),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Automatically create cases for transactions with fraud score above this threshold"})]}),a.jsx("div",{className:"p-4 bg-gray-50 rounded-lg",children:a.jsxs("label",{className:"block",children:[a.jsx("p",{className:"font-medium text-gray-900 mb-2",children:"High Risk Amount Threshold"}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:"$"}),a.jsx("input",{type:"number",value:e.high_risk_threshold,onChange:r=>t({...e,high_risk_threshold:parseInt(r.target.value)}),className:"w-full pl-8 pr-4 py-2 border border-gray-300 rounded-lg"})]}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Transactions above this amount trigger high-risk alerts"})]})})]}),a.jsx("div",{className:"pt-4",children:a.jsx("button",{className:"fluent-btn-primary",children:"Save Settings"})})]})},bU=()=>{var N;const{id:e}=Hs(),t=ze(),[r,s]=C.useState(null),[n,i]=C.useState([]),[l,o]=C.useState(null),[c,u]=C.useState(!0),[d,f]=C.useState("overview"),[h,x]=C.useState(""),[m,p]=C.useState(!1);C.useEffect(()=>{e&&w()},[e]);const w=async()=>{u(!0);try{const[D,F]=await Promise.all([sn.getFraudCase(e),sn.getCaseActivities(e)]);if(s(D),i(F),D.transaction_id){const Y=await sn.getTransactionAnalysis(D.transaction_id);o(Y)}}catch(D){console.error("Failed to load case:",D),s(b()),i(g()),o(y())}finally{u(!1)}},b=()=>({id:e||"1",case_number:"FRAUD-20250228-A1B2C3D4",customer_id:"c1",bank_account_id:"ba1",transaction_id:"t1",title:"Suspected Account Takeover - Johnson Corp",description:"Multiple unauthorized wire transfers detected from the Johnson Corp business account. Total of 3 transactions to foreign accounts within a 2-hour window.",severity:"critical",status:"investigating",fraud_type:"account_takeover",estimated_loss_amount:125e3,detected_patterns:["FOREIGN_TRANSACTION","HIGH_VELOCITY","LARGE_AMOUNT","UNUSUAL_TIME"],investigation_notes:"Initial review shows transactions originated from a new IP address. Customer confirmed they did not authorize these transfers.",assigned_to:"John Smith",acknowledged_at:new Date(Date.now()-1e3*60*60).toISOString(),created_at:new Date(Date.now()-1e3*60*60*2).toISOString(),updated_at:new Date(Date.now()-1e3*60*30).toISOString()}),g=()=>[{id:"1",fraud_case_id:e||"1",activity_type:"status_change",description:"Case status changed from Open to Investigating",user_id:"user1",created_at:new Date(Date.now()-1e3*60*60).toISOString()},{id:"2",fraud_case_id:e||"1",activity_type:"note_added",description:"Contacted customer to verify transaction authenticity",user_id:"user1",created_at:new Date(Date.now()-1e3*60*45).toISOString()},{id:"3",fraud_case_id:e||"1",activity_type:"case_assigned",description:"Case assigned to John Smith",user_id:"admin",created_at:new Date(Date.now()-1e3*60*30).toISOString()},{id:"4",fraud_case_id:e||"1",activity_type:"case_created",description:"Fraud case created automatically from high-risk transaction",user_id:"system",created_at:new Date(Date.now()-1e3*60*60*2).toISOString()}],y=()=>({transaction:{id:"t1",bank_account_id:"ba1",plaid_transaction_id:"plaid_123",transaction_date:new Date(Date.now()-1e3*60*60*2).toISOString(),amount:-45e3,description:"Wire Transfer - International",merchant_name:"WIRE TRANSFER",category:["Transfer","Wire"],location:{city:"Lagos",country:"NG"},payment_channel:"online",is_flagged:!0,fraud_score:.92,risk_level:"critical",flagged_reasons:{rules:["FOREIGN_TRANSACTION","LARGE_AMOUNT","UNUSUAL_TIME"],explanation:"High-risk wire transfer to foreign account during unusual hours"},analyzed_at:new Date(Date.now()-1e3*60*60*2).toISOString(),created_at:new Date(Date.now()-1e3*60*60*2).toISOString()},model_predictions:{random_forest:.89,xgboost:.94,isolation_forest:.88},feature_importance:{has_foreign_location:.35,is_large_amount:.28,is_night_time:.15,txn_count_1h:.12,deviation_from_avg:.1},anomaly_score:.91,triggered_rules:["FOREIGN_TRANSACTION","LARGE_AMOUNT","UNUSUAL_TIME","HIGH_VELOCITY"],recommendation:"BLOCK - High fraud risk. Recommend immediate investigation."}),j=async D=>{if(r){p(!0);try{const F=await sn.updateFraudCase(r.id,{status:D},"current-user-id");s(F),Ye.success(`Case status updated to ${D}`),w()}catch{s({...r,status:D}),Ye.success(`Case status updated to ${D}`)}finally{p(!1)}}},A=async()=>{if(!(!h.trim()||!r)){p(!0);try{await sn.addCaseActivity(r.id,{activity_type:"note_added",description:h},"current-user-id"),x(""),w(),Ye.success("Note added")}catch{const F={id:`new-${Date.now()}`,fraud_case_id:r.id,activity_type:"note_added",description:h,user_id:"current-user",created_at:new Date().toISOString()};i([F,...n]),x(""),Ye.success("Note added")}finally{p(!1)}}},k=D=>{const F={critical:{color:"text-red-700",bgColor:"bg-red-100",borderColor:"border-red-500"},high:{color:"text-orange-700",bgColor:"bg-orange-100",borderColor:"border-orange-500"},medium:{color:"text-yellow-700",bgColor:"bg-yellow-100",borderColor:"border-yellow-500"},low:{color:"text-green-700",bgColor:"bg-green-100",borderColor:"border-green-500"}};return F[D]||F.medium},v=D=>D===void 0?"-":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0}).format(Math.abs(D)),E=[{id:"overview",label:"Overview",icon:yc},{id:"transaction",label:"Transaction",icon:Wl},{id:"timeline",label:"Timeline",icon:$6},{id:"notes",label:"Notes",icon:ux}];if(c)return a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-12 h-12 border-4 border-red-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading case..."})]})});if(!r)return a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Qe,{className:"w-12 h-12 text-yellow-500 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Case not found"}),a.jsx("button",{onClick:()=>t("/firm/fraud-detection"),className:"mt-4 text-red-600 hover:text-red-700",children:"Back to Dashboard"})]})});const S=k(r.severity);return a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("button",{onClick:()=>t("/firm/fraud-detection"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors mt-1",children:a.jsx(Qr,{className:"w-5 h-5 text-gray-600"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:r.title}),a.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${S.bgColor} ${S.color}`,children:r.severity.toUpperCase()})]}),a.jsx("p",{className:"text-gray-500 mt-1",children:r.case_number})]})]}),a.jsx("div",{className:"flex items-center gap-3",children:a.jsxs("select",{value:r.status,onChange:D=>j(D.target.value),disabled:m,className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500",children:[a.jsx("option",{value:"open",children:"Open"}),a.jsx("option",{value:"investigating",children:"Investigating"}),a.jsx("option",{value:"pending_review",children:"Pending Review"}),a.jsx("option",{value:"resolved",children:"Resolved"}),a.jsx("option",{value:"closed",children:"Closed"}),a.jsx("option",{value:"false_positive",children:"False Positive"})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:`bg-white rounded-xl p-4 shadow-sm border-l-4 ${S.borderColor}`,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`p-2 ${S.bgColor} rounded-lg`,children:a.jsx(Or,{className:`w-5 h-5 ${S.color}`})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Estimated Loss"}),a.jsx("p",{className:"text-xl font-bold text-red-600",children:v(r.estimated_loss_amount)})]})]})}),a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-xl p-4 shadow-sm border border-gray-200",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:a.jsx(oF,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Fraud Type"}),a.jsx("p",{className:"text-lg font-semibold text-gray-900",children:((N=r.fraud_type)==null?void 0:N.replace("_"," ").replace(/\b\w/g,D=>D.toUpperCase()))||"Unknown"})]})]})}),a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-xl p-4 shadow-sm border border-gray-200",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:a.jsx(ha,{className:"w-5 h-5 text-purple-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Assigned To"}),a.jsx("p",{className:"text-lg font-semibold text-gray-900",children:r.assigned_to||"Unassigned"})]})]})}),a.jsx(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-xl p-4 shadow-sm border border-gray-200",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:a.jsx(Jr,{className:"w-5 h-5 text-gray-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Created"}),a.jsx("p",{className:"text-lg font-semibold text-gray-900",children:new Date(r.created_at).toLocaleDateString()})]})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[a.jsx("div",{className:"border-b border-gray-200",children:a.jsx("nav",{className:"flex gap-1 p-2",children:E.map(D=>{const F=D.icon;return a.jsxs("button",{onClick:()=>f(D.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ${d===D.id?"bg-red-100 text-red-700":"text-gray-600 hover:bg-gray-100"}`,children:[a.jsx(F,{className:"w-4 h-4"}),D.label]},D.id)})})}),a.jsxs("div",{className:"p-6",children:[d==="overview"&&a.jsx(jU,{fraudCase:r}),d==="transaction"&&a.jsx(NU,{transaction:l}),d==="timeline"&&a.jsx(_U,{activities:n}),d==="notes"&&a.jsx(kU,{fraudCase:r,activities:n.filter(D=>D.activity_type==="note_added"),newNote:h,setNewNote:x,onAddNote:A,saving:m})]})]})]})},jU=({fraudCase:e})=>a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Description"}),a.jsx("p",{className:"text-gray-700",children:e.description||"No description provided."})]}),e.detected_patterns&&e.detected_patterns.length>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Detected Patterns"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:e.detected_patterns.map((t,r)=>a.jsx("span",{className:"px-3 py-1 bg-red-100 text-red-700 rounded-full text-sm font-medium",children:t.replace("_"," ")},r))})]}),e.investigation_notes&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Investigation Notes"}),a.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:a.jsx("p",{className:"text-gray-700",children:e.investigation_notes})})]}),e.resolution_notes&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Resolution Notes"}),a.jsx("div",{className:"bg-green-50 rounded-lg p-4",children:a.jsx("p",{className:"text-gray-700",children:e.resolution_notes})})]})]}),NU=({transaction:e})=>{if(!e)return a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Wl,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"No transaction data available"})]});const t=e.transaction;return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Transaction Details"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Amount"}),a.jsxs("span",{className:"font-semibold text-red-600",children:["$",Math.abs(t.amount).toLocaleString()]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Date"}),a.jsx("span",{className:"font-medium",children:new Date(t.transaction_date).toLocaleString()})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Merchant"}),a.jsx("span",{className:"font-medium",children:t.merchant_name||"N/A"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Payment Channel"}),a.jsx("span",{className:"font-medium",children:t.payment_channel||"N/A"})]}),t.location&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Location"}),a.jsxs("span",{className:"font-medium",children:[t.location.city,", ",t.location.country]})]})]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Risk Analysis"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-gray-600",children:"Fraud Score"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-24 h-2 bg-gray-200 rounded-full overflow-hidden",children:a.jsx("div",{className:`h-full rounded-full ${t.fraud_score>=.8?"bg-red-500":t.fraud_score>=.5?"bg-orange-500":"bg-green-500"}`,style:{width:`${t.fraud_score*100}%`}})}),a.jsxs("span",{className:"font-bold text-red-600",children:[(t.fraud_score*100).toFixed(0),"%"]})]})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-gray-600",children:"Anomaly Score"}),a.jsxs("span",{className:"font-medium",children:[(e.anomaly_score*100).toFixed(0),"%"]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Risk Level"}),a.jsx("span",{className:`px-2 py-0.5 rounded text-sm font-medium ${t.risk_level==="critical"?"bg-red-100 text-red-700":t.risk_level==="high"?"bg-orange-100 text-orange-700":"bg-yellow-100 text-yellow-700"}`,children:t.risk_level.toUpperCase()})]})]})]})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"ML Model Predictions"}),a.jsx("div",{className:"grid grid-cols-3 gap-4",children:Object.entries(e.model_predictions).map(([r,s])=>a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-sm text-gray-600 mb-1",children:r.replace("_"," ")}),a.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[(s*100).toFixed(0),"%"]})]},r))})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Key Risk Factors"}),a.jsx("div",{className:"space-y-3",children:Object.entries(e.feature_importance).sort((r,s)=>s[1]-r[1]).map(([r,s])=>a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("span",{className:"text-gray-600 w-40",children:r.replace(/_/g," ")}),a.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:a.jsx("div",{className:"h-full bg-red-500 rounded-full",style:{width:`${s*100}%`}})}),a.jsxs("span",{className:"text-sm font-medium text-gray-700 w-12",children:[(s*100).toFixed(0),"%"]})]},r))})]}),a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-red-800 mb-2",children:"Recommendation"}),a.jsx("p",{className:"text-red-700",children:e.recommendation})]})]})},_U=({activities:e})=>{const t=r=>{switch(r){case"case_created":return a.jsx(L6,{className:"w-4 h-4"});case"status_change":return a.jsx(nt,{className:"w-4 h-4"});case"case_assigned":return a.jsx(ha,{className:"w-4 h-4"});case"note_added":return a.jsx(ux,{className:"w-4 h-4"});default:return a.jsx($e,{className:"w-4 h-4"})}};return a.jsx("div",{className:"space-y-4",children:e.map((r,s)=>a.jsxs(z.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:s*.1},className:"flex gap-4",children:[a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:"p-2 bg-gray-100 rounded-full",children:t(r.activity_type)}),s<e.length-1&&a.jsx("div",{className:"w-px h-full bg-gray-200 my-2"})]}),a.jsxs("div",{className:"flex-1 pb-4",children:[a.jsx("p",{className:"font-medium text-gray-900",children:r.description}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:new Date(r.created_at).toLocaleString()})]})]},r.id))})},kU=({fraudCase:e,activities:t,newNote:r,setNewNote:s,onAddNote:n,saving:i})=>a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Add Note"}),a.jsx("textarea",{value:r,onChange:l=>s(l.target.value),placeholder:"Enter investigation notes...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 resize-none"}),a.jsx("div",{className:"flex justify-end mt-3",children:a.jsx("button",{onClick:n,disabled:i||!r.trim(),className:"fluent-btn-primary",children:i?a.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsx(Vc,{className:"w-4 h-4"}),"Add Note"]})})})]}),a.jsx("div",{className:"space-y-4",children:t.length===0?a.jsx("p",{className:"text-center text-gray-500 py-8",children:"No notes yet"}):t.map(l=>a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[a.jsx("p",{className:"text-gray-700",children:l.description}),a.jsx("p",{className:"text-sm text-gray-500 mt-2",children:new Date(l.created_at).toLocaleString()})]},l.id))})]}),SU=[{id:"dashboard",label:"Dashboard",icon:z6,path:"/firm/dashboard"},{id:"clients",label:"Clients",icon:Nt,path:"/firm/clients"},{id:"audits",label:"Audits",icon:$e,path:"/firm/audits"},{id:"soc",label:"SOC Audits",icon:We,path:"/firm/soc-engagements"},{id:"rd-studies",label:"R&D Credits",icon:pi,path:"/firm/rd-studies"},{id:"tax-returns",label:"Tax Returns",icon:Us,path:"/firm/tax-returns"},{id:"fraud-detection",label:"Fraud Detection",icon:yc,path:"/firm/fraud-detection"},{id:"employees",label:"Team",icon:zs,path:"/firm/employees"},{id:"reports",label:"Reports",icon:Ba,path:"/firm/reports"},{id:"settings",label:"Settings",icon:gc,path:"/firm/settings"}],qe=({children:e,portalType:t})=>{const r=ze(),s=window.location.hostname.startsWith("cpa.");return Ei.useEffect(()=>{if(s&&t==="client"){r("/firm/dashboard",{replace:!0});return}if(!s&&t==="firm"){r("/client/dashboard",{replace:!0});return}},[s,t,r]),s&&t==="client"||!s&&t==="firm"?null:a.jsx(a.Fragment,{children:e})},mt=({children:e})=>{const[t,r]=C.useState(!0),[s,n]=C.useState(!1),i=ze(),l=F0(),c=(()=>{try{const u=localStorage.getItem("user");return u?JSON.parse(u):null}catch{return null}})();return a.jsxs("div",{className:"min-h-screen bg-[#faf9f8]",children:[a.jsx(z.aside,{initial:!1,animate:{width:t?280:72},transition:{duration:.2,ease:[.1,.9,.2,1]},className:"fixed top-0 left-0 h-screen bg-white border-r border-neutral-200 z-50",children:a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"h-16 flex items-center justify-between px-4 border-b border-neutral-200",children:[a.jsx(Xe,{mode:"wait",children:t&&a.jsxs(z.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-8 h-8 bg-primary-500 rounded-fluent flex items-center justify-center",children:a.jsx(Nt,{className:"w-5 h-5 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-body-strong text-neutral-900",children:"Aura CPA"}),a.jsx("p",{className:"text-caption text-neutral-600",children:"Portal"})]})]})}),a.jsx("button",{onClick:()=>r(!t),className:"p-2 hover:bg-neutral-100 rounded-fluent-sm transition-colors","aria-label":"Toggle sidebar",children:a.jsx(Y6,{className:"w-5 h-5 text-neutral-700"})})]}),a.jsx("nav",{className:"flex-1 p-3 space-y-1 overflow-y-auto",children:SU.map(u=>{const d=u.icon,f=l.pathname===u.path;return a.jsxs("button",{onClick:()=>i(u.path),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-fluent transition-all duration-100 ${f?"bg-primary-50 text-primary-600 font-semibold":"text-neutral-700 hover:bg-neutral-50 font-medium"}`,title:t?void 0:u.label,children:[a.jsx(d,{className:`w-5 h-5 flex-shrink-0 ${f?"text-primary-600":"text-neutral-600"}`}),a.jsx(Xe,{mode:"wait",children:t&&a.jsx(z.span,{initial:{opacity:0,width:0},animate:{opacity:1,width:"auto"},exit:{opacity:0,width:0},transition:{duration:.15},className:"text-body-strong whitespace-nowrap overflow-hidden",children:u.label})}),f&&t&&a.jsx(z.div,{layoutId:"activeIndicator",className:"ml-auto w-1 h-4 bg-primary-500 rounded-full",transition:{duration:.2,ease:[.1,.9,.2,1]}})]},u.id)})}),a.jsxs("div",{className:"p-3 border-t border-neutral-200",children:[a.jsxs("div",{className:"flex items-center gap-3 px-3 py-2.5",children:[a.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-primary-500 to-primary-600 rounded-full flex items-center justify-center text-white text-body-strong flex-shrink-0",children:c!=null&&c.full_name?c.full_name.charAt(0).toUpperCase():"U"}),a.jsx(Xe,{mode:"wait",children:t&&a.jsxs(z.div,{initial:{opacity:0,width:0},animate:{opacity:1,width:"auto"},exit:{opacity:0,width:0},transition:{duration:.15},className:"flex-1 min-w-0 overflow-hidden",children:[a.jsx("p",{className:"text-body-strong text-neutral-900 truncate",children:(c==null?void 0:c.full_name)||"User"}),a.jsx("p",{className:"text-caption text-neutral-600 truncate",children:(c==null?void 0:c.email)||""})]})})]}),a.jsxs("button",{onClick:()=>{localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),i("/login")},className:"w-full flex items-center gap-3 px-3 py-2.5 text-error-500 hover:bg-error-50 rounded-fluent transition-colors mt-2",title:t?void 0:"Logout",children:[a.jsx(G6,{className:"w-5 h-5 flex-shrink-0"}),a.jsx(Xe,{mode:"wait",children:t&&a.jsx(z.span,{initial:{opacity:0,width:0},animate:{opacity:1,width:"auto"},exit:{opacity:0,width:0},transition:{duration:.15},className:"text-body-strong whitespace-nowrap overflow-hidden",children:"Logout"})})]})]})]})}),a.jsxs(z.main,{animate:{marginLeft:t?280:72},transition:{duration:.2,ease:[.1,.9,.2,1]},className:"min-h-screen",children:[a.jsx("div",{className:"h-16 bg-white border-b border-neutral-200 sticky top-0 z-40 fluent-acrylic",children:a.jsxs("div",{className:"h-full flex items-center justify-between px-6",children:[a.jsx("div",{className:"flex-1 max-w-xl",children:s?a.jsxs(z.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"relative",children:[a.jsx(Vs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-neutral-500 w-4 h-4"}),a.jsx("input",{type:"text",placeholder:"Search for anything...",autoFocus:!0,onBlur:()=>n(!1),className:"w-full pl-10 pr-4 py-2 bg-neutral-50 border border-neutral-200 rounded-fluent text-body focus:outline-none focus:border-primary-500 focus:shadow-[0_0_0_1px_#0078d4]"})]}):a.jsxs("button",{onClick:()=>n(!0),className:"flex items-center gap-2 px-4 py-2 bg-neutral-50 hover:bg-neutral-100 rounded-fluent transition-colors w-full max-w-md",children:[a.jsx(Vs,{className:"w-4 h-4 text-neutral-500"}),a.jsx("span",{className:"text-body text-neutral-600",children:"Search"}),a.jsx("span",{className:"ml-auto text-caption text-neutral-500 font-mono",children:"Ctrl+K"})]})}),a.jsxs("div",{className:"flex items-center gap-2 ml-6",children:[a.jsxs("button",{className:"relative p-2.5 hover:bg-neutral-100 rounded-fluent transition-colors",children:[a.jsx(Kd,{className:"w-5 h-5 text-neutral-700"}),a.jsx("span",{className:"absolute top-1.5 right-1.5 w-2 h-2 bg-error-500 rounded-full ring-2 ring-white"})]}),a.jsx("button",{className:"p-2.5 hover:bg-neutral-100 rounded-fluent transition-colors",children:a.jsx(ha,{className:"w-5 h-5 text-neutral-700"})})]})]})}),a.jsx("div",{className:"p-8",children:a.jsx(Xe,{mode:"wait",children:a.jsx(z.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.2,ease:[.1,.9,.2,1]},children:e},l.pathname)})})]})]})},CU=()=>a.jsxs(_C,{children:[a.jsx(f3,{position:"top-right",toastOptions:{duration:4e3,className:"fluent-card",style:{background:"#fff",color:"#171717",borderRadius:"8px",padding:"12px 16px",boxShadow:"0 2.4px 7.2px rgba(0, 0, 0, 0.1), 0 12.8px 28.8px rgba(0, 0, 0, 0.13)",fontSize:"0.875rem",fontWeight:600},success:{iconTheme:{primary:"#10893e",secondary:"#fff"}},error:{iconTheme:{primary:"#e81123",secondary:"#fff"}}}}),a.jsxs(wC,{children:[a.jsx(De,{path:"/login",element:a.jsx(UR,{})}),a.jsx(De,{path:"/register",element:a.jsx($R,{})}),a.jsx(De,{path:"/accept-invitation",element:a.jsx(VR,{})}),a.jsx(De,{path:"/forgot-password",element:a.jsx(HR,{})}),a.jsx(De,{path:"/reset-password",element:a.jsx(GR,{})}),a.jsx(De,{path:"/firm/dashboard",element:a.jsx(qe,{portalType:"firm",children:a.jsx(mt,{children:a.jsx(tP,{})})})}),a.jsx(De,{path:"/firm/clients",element:a.jsx(qe,{portalType:"firm",children:a.jsx(mt,{children:a.jsx(iP,{})})})}),a.jsx(De,{path:"/firm/settings",element:a.jsx(qe,{portalType:"firm",children:a.jsx(mt,{children:a.jsx(rP,{})})})}),a.jsx(De,{path:"/firm/employees",element:a.jsx(qe,{portalType:"firm",children:a.jsx(mt,{children:a.jsx(sP,{})})})}),a.jsx(De,{path:"/firm/audits",element:a.jsx(qe,{portalType:"firm",children:a.jsx(mt,{children:a.jsx(cP,{})})})}),a.jsx(De,{path:"/firm/soc-engagements",element:a.jsx(qe,{portalType:"firm",children:a.jsx(mt,{children:a.jsx($P,{})})})}),a.jsx(De,{path:"/firm/rd-studies",element:a.jsx(qe,{portalType:"firm",children:a.jsx(mt,{children:a.jsx(QB,{})})})}),a.jsx(De,{path:"/firm/rd-studies/:id",element:a.jsx(qe,{portalType:"firm",children:a.jsx(mt,{children:a.jsx(ZB,{})})})}),a.jsx(De,{path:"/firm/tax-returns",element:a.jsx(qe,{portalType:"firm",children:a.jsx(mt,{children:a.jsx(rU,{})})})}),a.jsx(De,{path:"/firm/tax-returns/:id",element:a.jsx(qe,{portalType:"firm",children:a.jsx(mt,{children:a.jsx(aU,{})})})}),a.jsx(De,{path:"/firm/fraud-detection",element:a.jsx(qe,{portalType:"firm",children:a.jsx(mt,{children:a.jsx(mU,{})})})}),a.jsx(De,{path:"/firm/fraud-detection/cases/:id",element:a.jsx(qe,{portalType:"firm",children:a.jsx(mt,{children:a.jsx(bU,{})})})}),a.jsx(De,{path:"/firm/reports",element:a.jsx(qe,{portalType:"firm",children:a.jsx(mt,{children:a.jsx(fP,{})})})}),a.jsx(De,{path:"/firm/engagements/:id",element:a.jsx(qe,{portalType:"firm",children:a.jsx(mt,{children:a.jsx(Yy,{})})})}),a.jsx(De,{path:"/firm/engagements/:id/workspace",element:a.jsx(qe,{portalType:"firm",children:a.jsx(mt,{children:a.jsx(Yy,{})})})}),a.jsx(De,{path:"/firm/engagements/:id/workpapers",element:a.jsx(qe,{portalType:"firm",children:a.jsx(mt,{children:a.jsx(CP,{})})})}),a.jsx(De,{path:"/firm/engagements/:id/analytics",element:a.jsx(qe,{portalType:"firm",children:a.jsx(mt,{children:a.jsx(AP,{})})})}),a.jsx(De,{path:"/firm/engagements/:id/testing",element:a.jsx(qe,{portalType:"firm",children:a.jsx(mt,{children:a.jsx(PP,{})})})}),a.jsx(De,{path:"/firm/engagements/:id/risk",element:a.jsx(qe,{portalType:"firm",children:a.jsx(mt,{children:a.jsx(OP,{})})})}),a.jsx(De,{path:"/firm/engagements/:id/documents",element:a.jsx(qe,{portalType:"firm",children:a.jsx(mt,{children:a.jsx(MP,{})})})}),a.jsx(De,{path:"/firm/engagements/:id/reports",element:a.jsx(qe,{portalType:"firm",children:a.jsx(mt,{children:a.jsx(LP,{})})})}),a.jsx(De,{path:"/firm/engagements/:id/ai-planning",element:a.jsx(qe,{portalType:"firm",children:a.jsx(mt,{children:a.jsx(YB,{})})})}),a.jsx(De,{path:"/customer/dashboard",element:a.jsx(qe,{portalType:"client",children:a.jsx(zy,{})})}),a.jsx(De,{path:"/customer/documents",element:a.jsx(qe,{portalType:"client",children:a.jsx(Wy,{})})}),a.jsx(De,{path:"/customer/integrations",element:a.jsx(qe,{portalType:"client",children:a.jsx(Gy,{})})}),a.jsx(De,{path:"/client/dashboard",element:a.jsx(qe,{portalType:"client",children:a.jsx(zy,{})})}),a.jsx(De,{path:"/client/documents",element:a.jsx(qe,{portalType:"client",children:a.jsx(Wy,{})})}),a.jsx(De,{path:"/client/integrations",element:a.jsx(qe,{portalType:"client",children:a.jsx(Gy,{})})}),a.jsx(De,{path:"/",element:a.jsx($y,{})}),a.jsx(De,{path:"*",element:a.jsx($y,{})})]})]}),TU=new S5({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1,staleTime:5*60*1e3}}});ch.createRoot(document.getElementById("root")).render(a.jsx(Ei.StrictMode,{children:a.jsx(T5,{client:TU,children:a.jsx(CU,{})})}));
