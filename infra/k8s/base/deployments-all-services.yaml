# All Aura Audit AI Service Deployments
# This file contains deployments for all 10 microservices

---
# LLM Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: llm
  namespace: aura-audit-ai
  labels:
    app: llm
    component: api
spec:
  replicas: 3
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 0
  selector:
    matchLabels:
      app: llm
  template:
    metadata:
      labels:
        app: llm
        component: api
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: llm
        image: ${ACR_NAME}.azurecr.io/aura/llm:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: aura-redis-connection
              key: connection-string
        - name: OPENAI_API_KEY
          valueFrom:
            secretKeyRef:
              name: aura-secrets
              key: openai-api-key
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 500m
            memory: 2Gi
          limits:
            cpu: 2000m
            memory: 4Gi
        livenessProbe:
          httpGet:
            path: /health
            port: 8000
          initialDelaySeconds: 60
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /health
            port: 8000
          initialDelaySeconds: 30
          periodSeconds: 5
      nodeSelector:
        workload: application
---
apiVersion: v1
kind: Service
metadata:
  name: llm
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: llm
---
# Analytics Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: analytics
  namespace: aura-audit-ai
  labels:
    app: analytics
    component: api
spec:
  replicas: 3
  selector:
    matchLabels:
      app: analytics
  template:
    metadata:
      labels:
        app: analytics
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: analytics
        image: ${ACR_NAME}.azurecr.io/aura/analytics:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: aura-redis-connection
              key: connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 500m
            memory: 1Gi
          limits:
            cpu: 2000m
            memory: 3Gi
        livenessProbe:
          httpGet:
            path: /health
            port: 8000
        readinessProbe:
          httpGet:
            path: /health
            port: 8000
---
apiVersion: v1
kind: Service
metadata:
  name: analytics
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: analytics
---
# Normalize Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: normalize
  namespace: aura-audit-ai
  labels:
    app: normalize
    component: api
spec:
  replicas: 3
  selector:
    matchLabels:
      app: normalize
  template:
    metadata:
      labels:
        app: normalize
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: normalize
        image: ${ACR_NAME}.azurecr.io/aura/normalize:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: aura-redis-connection
              key: connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 250m
            memory: 512Mi
          limits:
            cpu: 1000m
            memory: 1Gi
        livenessProbe:
          httpGet:
            path: /health
            port: 8000
        readinessProbe:
          httpGet:
            path: /health
            port: 8000
---
apiVersion: v1
kind: Service
metadata:
  name: normalize
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: normalize
---
# Ingestion Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: ingestion
  namespace: aura-audit-ai
  labels:
    app: ingestion
    component: api
spec:
  replicas: 3
  selector:
    matchLabels:
      app: ingestion
  template:
    metadata:
      labels:
        app: ingestion
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: ingestion
        image: ${ACR_NAME}.azurecr.io/aura/ingestion:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: aura-redis-connection
              key: connection-string
        - name: STORAGE_CONNECTION_STRING
          valueFrom:
            secretKeyRef:
              name: aura-secrets
              key: storage-connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 250m
            memory: 512Mi
          limits:
            cpu: 1000m
            memory: 2Gi
        livenessProbe:
          httpGet:
            path: /health
            port: 8000
        readinessProbe:
          httpGet:
            path: /health
            port: 8000
---
apiVersion: v1
kind: Service
metadata:
  name: ingestion
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: ingestion
---
# Engagement Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: engagement
  namespace: aura-audit-ai
  labels:
    app: engagement
    component: api
spec:
  replicas: 3
  selector:
    matchLabels:
      app: engagement
  template:
    metadata:
      labels:
        app: engagement
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: engagement
        image: ${ACR_NAME}.azurecr.io/aura/engagement:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: aura-redis-connection
              key: connection-string
        - name: STORAGE_CONNECTION_STRING
          valueFrom:
            secretKeyRef:
              name: aura-secrets
              key: storage-connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 250m
            memory: 512Mi
          limits:
            cpu: 1000m
            memory: 1Gi
---
apiVersion: v1
kind: Service
metadata:
  name: engagement
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: engagement
---
# Disclosures Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: disclosures
  namespace: aura-audit-ai
  labels:
    app: disclosures
    component: api
spec:
  replicas: 3
  selector:
    matchLabels:
      app: disclosures
  template:
    metadata:
      labels:
        app: disclosures
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: disclosures
        image: ${ACR_NAME}.azurecr.io/aura/disclosures:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: aura-redis-connection
              key: connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 250m
            memory: 512Mi
          limits:
            cpu: 1000m
            memory: 1Gi
---
apiVersion: v1
kind: Service
metadata:
  name: disclosures
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: disclosures
---
# Reporting Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: reporting
  namespace: aura-audit-ai
  labels:
    app: reporting
    component: api
spec:
  replicas: 3
  selector:
    matchLabels:
      app: reporting
  template:
    metadata:
      labels:
        app: reporting
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: reporting
        image: ${ACR_NAME}.azurecr.io/aura/reporting:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: aura-redis-connection
              key: connection-string
        - name: STORAGE_CONNECTION_STRING
          valueFrom:
            secretKeyRef:
              name: aura-secrets
              key: storage-connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 250m
            memory: 512Mi
          limits:
            cpu: 1000m
            memory: 1Gi
---
apiVersion: v1
kind: Service
metadata:
  name: reporting
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: reporting
---
# QC Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: qc
  namespace: aura-audit-ai
  labels:
    app: qc
    component: api
spec:
  replicas: 3
  selector:
    matchLabels:
      app: qc
  template:
    metadata:
      labels:
        app: qc
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: qc
        image: ${ACR_NAME}.azurecr.io/aura/qc:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: aura-redis-connection
              key: connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 250m
            memory: 512Mi
          limits:
            cpu: 1000m
            memory: 1Gi
---
apiVersion: v1
kind: Service
metadata:
  name: qc
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: qc
---
# Connectors Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: connectors
  namespace: aura-audit-ai
  labels:
    app: connectors
    component: api
spec:
  replicas: 3
  selector:
    matchLabels:
      app: connectors
  template:
    metadata:
      labels:
        app: connectors
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: connectors
        image: ${ACR_NAME}.azurecr.io/aura/connectors:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: aura-redis-connection
              key: connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 250m
            memory: 512Mi
          limits:
            cpu: 1000m
            memory: 1Gi
---
apiVersion: v1
kind: Service
metadata:
  name: connectors
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: connectors
---
# Reg AB Audit Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: reg-ab-audit
  namespace: aura-audit-ai
  labels:
    app: reg-ab-audit
    component: api
spec:
  replicas: 2
  selector:
    matchLabels:
      app: reg-ab-audit
  template:
    metadata:
      labels:
        app: reg-ab-audit
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: reg-ab-audit
        image: ${ACR_NAME}.azurecr.io/aura/reg-ab-audit:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: aura-redis-connection
              key: connection-string
        - name: STORAGE_CONNECTION_STRING
          valueFrom:
            secretKeyRef:
              name: aura-secrets
              key: storage-connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 250m
            memory: 512Mi
          limits:
            cpu: 1000m
            memory: 1Gi
---
apiVersion: v1
kind: Service
metadata:
  name: reg-ab-audit
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: reg-ab-audit
---
# Audit Planning Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: audit-planning
  namespace: aura-audit-ai
  labels:
    app: audit-planning
    component: api
spec:
  replicas: 2
  selector:
    matchLabels:
      app: audit-planning
  template:
    metadata:
      labels:
        app: audit-planning
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: audit-planning
        image: ${ACR_NAME}.azurecr.io/aura/audit-planning:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: aura-redis-connection
              key: connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 250m
            memory: 512Mi
          limits:
            cpu: 1000m
            memory: 1Gi
---
apiVersion: v1
kind: Service
metadata:
  name: audit-planning
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: audit-planning
---
# Accounting Integrations Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: accounting-integrations
  namespace: aura-audit-ai
  labels:
    app: accounting-integrations
    component: api
spec:
  replicas: 2
  selector:
    matchLabels:
      app: accounting-integrations
  template:
    metadata:
      labels:
        app: accounting-integrations
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: accounting-integrations
        image: ${ACR_NAME}.azurecr.io/aura/accounting-integrations:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: aura-redis-connection
              key: connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 250m
            memory: 512Mi
          limits:
            cpu: 1000m
            memory: 1Gi
---
apiVersion: v1
kind: Service
metadata:
  name: accounting-integrations
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: accounting-integrations
---
# Data Anonymization Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: data-anonymization
  namespace: aura-audit-ai
  labels:
    app: data-anonymization
    component: api
spec:
  replicas: 2
  selector:
    matchLabels:
      app: data-anonymization
  template:
    metadata:
      labels:
        app: data-anonymization
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: data-anonymization
        image: ${ACR_NAME}.azurecr.io/aura/data-anonymization:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: aura-redis-connection
              key: connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 250m
            memory: 512Mi
          limits:
            cpu: 1000m
            memory: 1Gi
---
apiVersion: v1
kind: Service
metadata:
  name: data-anonymization
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: data-anonymization
---
# Financial Analysis Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: financial-analysis
  namespace: aura-audit-ai
  labels:
    app: financial-analysis
    component: api
spec:
  replicas: 2
  selector:
    matchLabels:
      app: financial-analysis
  template:
    metadata:
      labels:
        app: financial-analysis
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: financial-analysis
        image: ${ACR_NAME}.azurecr.io/aura/financial-analysis:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: aura-redis-connection
              key: connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 250m
            memory: 512Mi
          limits:
            cpu: 1000m
            memory: 1Gi
---
apiVersion: v1
kind: Service
metadata:
  name: financial-analysis
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: financial-analysis
---
# Fraud Detection Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: fraud-detection
  namespace: aura-audit-ai
  labels:
    app: fraud-detection
    component: api
spec:
  replicas: 2
  selector:
    matchLabels:
      app: fraud-detection
  template:
    metadata:
      labels:
        app: fraud-detection
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: fraud-detection
        image: ${ACR_NAME}.azurecr.io/aura/fraud-detection:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: aura-redis-connection
              key: connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 500m
            memory: 1Gi
          limits:
            cpu: 2000m
            memory: 2Gi
---
apiVersion: v1
kind: Service
metadata:
  name: fraud-detection
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: fraud-detection
---
# Related Party Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: related-party
  namespace: aura-audit-ai
  labels:
    app: related-party
    component: api
spec:
  replicas: 2
  selector:
    matchLabels:
      app: related-party
  template:
    metadata:
      labels:
        app: related-party
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: related-party
        image: ${ACR_NAME}.azurecr.io/aura/related-party:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: aura-redis-connection
              key: connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 250m
            memory: 512Mi
          limits:
            cpu: 1000m
            memory: 1Gi
---
apiVersion: v1
kind: Service
metadata:
  name: related-party
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: related-party
---
# Sampling Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: sampling
  namespace: aura-audit-ai
  labels:
    app: sampling
    component: api
spec:
  replicas: 2
  selector:
    matchLabels:
      app: sampling
  template:
    metadata:
      labels:
        app: sampling
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: sampling
        image: ${ACR_NAME}.azurecr.io/aura/sampling:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: aura-redis-connection
              key: connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 250m
            memory: 512Mi
          limits:
            cpu: 1000m
            memory: 1Gi
---
apiVersion: v1
kind: Service
metadata:
  name: sampling
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: sampling
---
# Security Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: security
  namespace: aura-audit-ai
  labels:
    app: security
    component: api
spec:
  replicas: 3
  selector:
    matchLabels:
      app: security
  template:
    metadata:
      labels:
        app: security
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: security
        image: ${ACR_NAME}.azurecr.io/aura/security:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: aura-redis-connection
              key: connection-string
        - name: STORAGE_CONNECTION_STRING
          valueFrom:
            secretKeyRef:
              name: aura-secrets
              key: storage-connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 250m
            memory: 512Mi
          limits:
            cpu: 1000m
            memory: 1Gi
---
apiVersion: v1
kind: Service
metadata:
  name: security
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: security
---
# Subsequent Events Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: subsequent-events
  namespace: aura-audit-ai
  labels:
    app: subsequent-events
    component: api
spec:
  replicas: 2
  selector:
    matchLabels:
      app: subsequent-events
  template:
    metadata:
      labels:
        app: subsequent-events
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: subsequent-events
        image: ${ACR_NAME}.azurecr.io/aura/subsequent-events:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: aura-redis-connection
              key: connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 250m
            memory: 512Mi
          limits:
            cpu: 1000m
            memory: 1Gi
---
apiVersion: v1
kind: Service
metadata:
  name: subsequent-events
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: subsequent-events
---
# Substantive Testing Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: substantive-testing
  namespace: aura-audit-ai
  labels:
    app: substantive-testing
    component: api
spec:
  replicas: 2
  selector:
    matchLabels:
      app: substantive-testing
  template:
    metadata:
      labels:
        app: substantive-testing
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: substantive-testing
        image: ${ACR_NAME}.azurecr.io/aura/substantive-testing:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: aura-redis-connection
              key: connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 250m
            memory: 512Mi
          limits:
            cpu: 1000m
            memory: 1Gi
---
apiVersion: v1
kind: Service
metadata:
  name: substantive-testing
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: substantive-testing
---
# Training Data Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: training-data
  namespace: aura-audit-ai
  labels:
    app: training-data
    component: api
spec:
  replicas: 2
  selector:
    matchLabels:
      app: training-data
  template:
    metadata:
      labels:
        app: training-data
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: training-data
        image: ${ACR_NAME}.azurecr.io/aura/training-data:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: aura-redis-connection
              key: connection-string
        - name: STORAGE_CONNECTION_STRING
          valueFrom:
            secretKeyRef:
              name: aura-secrets
              key: storage-connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 250m
            memory: 512Mi
          limits:
            cpu: 1000m
            memory: 1Gi
---
apiVersion: v1
kind: Service
metadata:
  name: training-data
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: training-data
---
# EO Insurance Portal Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: eo-insurance-portal
  namespace: aura-audit-ai
  labels:
    app: eo-insurance-portal
    component: api
spec:
  replicas: 2
  selector:
    matchLabels:
      app: eo-insurance-portal
  template:
    metadata:
      labels:
        app: eo-insurance-portal
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: eo-insurance-portal
        image: ${ACR_NAME}.azurecr.io/aura/eo-insurance-portal:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: aura-redis-connection
              key: connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 250m
            memory: 512Mi
          limits:
            cpu: 500m
            memory: 1Gi
---
apiVersion: v1
kind: Service
metadata:
  name: eo-insurance-portal
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: eo-insurance-portal
---
# Estimates Evaluation Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: estimates-evaluation
  namespace: aura-audit-ai
  labels:
    app: estimates-evaluation
    component: api
spec:
  replicas: 2
  selector:
    matchLabels:
      app: estimates-evaluation
  template:
    metadata:
      labels:
        app: estimates-evaluation
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: estimates-evaluation
        image: ${ACR_NAME}.azurecr.io/aura/estimates-evaluation:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: aura-redis-connection
              key: connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 250m
            memory: 512Mi
          limits:
            cpu: 1000m
            memory: 1Gi
---
apiVersion: v1
kind: Service
metadata:
  name: estimates-evaluation
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: estimates-evaluation
---
# AI Feedback Service (Top Priority AI Enhancement #2)
apiVersion: apps/v1
kind: Deployment
metadata:
  name: ai-feedback
  namespace: aura-audit-ai
  labels:
    app: ai-feedback
    component: api
spec:
  replicas: 2
  selector:
    matchLabels:
      app: ai-feedback
  template:
    metadata:
      labels:
        app: ai-feedback
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: ai-feedback
        image: ${ACR_NAME}.azurecr.io/aura/ai-feedback:${IMAGE_TAG}
        ports:
        - containerPort: 8015
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: aura-redis-connection
              key: connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 250m
            memory: 512Mi
          limits:
            cpu: 1000m
            memory: 1Gi
        livenessProbe:
          httpGet:
            path: /health
            port: 8015
        readinessProbe:
          httpGet:
            path: /health
            port: 8015
---
apiVersion: v1
kind: Service
metadata:
  name: ai-feedback
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8015
  selector:
    app: ai-feedback
---
# AI Explainability Service (Top Priority AI Enhancement #3)
apiVersion: apps/v1
kind: Deployment
metadata:
  name: ai-explainability
  namespace: aura-audit-ai
  labels:
    app: ai-explainability
    component: api
spec:
  replicas: 2
  selector:
    matchLabels:
      app: ai-explainability
  template:
    metadata:
      labels:
        app: ai-explainability
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: ai-explainability
        image: ${ACR_NAME}.azurecr.io/aura/ai-explainability:${IMAGE_TAG}
        ports:
        - containerPort: 8016
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: OPENAI_API_KEY
          valueFrom:
            secretKeyRef:
              name: aura-secrets
              key: openai-api-key
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 500m
            memory: 1Gi
          limits:
            cpu: 2000m
            memory: 2Gi
        livenessProbe:
          httpGet:
            path: /health
            port: 8016
        readinessProbe:
          httpGet:
            path: /health
            port: 8016
---
apiVersion: v1
kind: Service
metadata:
  name: ai-explainability
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8016
  selector:
    app: ai-explainability
---
# Intelligent Sampling Service (Top Priority AI Enhancement #4)
apiVersion: apps/v1
kind: Deployment
metadata:
  name: intelligent-sampling
  namespace: aura-audit-ai
  labels:
    app: intelligent-sampling
    component: api
spec:
  replicas: 2
  selector:
    matchLabels:
      app: intelligent-sampling
  template:
    metadata:
      labels:
        app: intelligent-sampling
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: intelligent-sampling
        image: ${ACR_NAME}.azurecr.io/aura/intelligent-sampling:${IMAGE_TAG}
        ports:
        - containerPort: 8017
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 250m
            memory: 512Mi
          limits:
            cpu: 1000m
            memory: 1Gi
        livenessProbe:
          httpGet:
            path: /health
            port: 8017
        readinessProbe:
          httpGet:
            path: /health
            port: 8017
---
apiVersion: v1
kind: Service
metadata:
  name: intelligent-sampling
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8017
  selector:
    app: intelligent-sampling
---
# AI Chat Service (Top Priority AI Enhancement #5)
apiVersion: apps/v1
kind: Deployment
metadata:
  name: ai-chat
  namespace: aura-audit-ai
  labels:
    app: ai-chat
    component: api
spec:
  replicas: 2
  selector:
    matchLabels:
      app: ai-chat
  template:
    metadata:
      labels:
        app: ai-chat
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: ai-chat
        image: ${ACR_NAME}.azurecr.io/aura/ai-chat:${IMAGE_TAG}
        ports:
        - containerPort: 8018
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: OPENAI_API_KEY
          valueFrom:
            secretKeyRef:
              name: aura-secrets
              key: openai-api-key
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 250m
            memory: 512Mi
          limits:
            cpu: 1000m
            memory: 1Gi
        livenessProbe:
          httpGet:
            path: /health
            port: 8018
        readinessProbe:
          httpGet:
            path: /health
            port: 8018
---
apiVersion: v1
kind: Service
metadata:
  name: ai-chat
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8018
  selector:
    app: ai-chat
---
# Advanced Report Generation Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: advanced-report-generation
  namespace: aura-audit-ai
  labels:
    app: advanced-report-generation
    component: api
spec:
  replicas: 2
  selector:
    matchLabels:
      app: advanced-report-generation
  template:
    metadata:
      labels:
        app: advanced-report-generation
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: advanced-report-generation
        image: ${ACR_NAME}.azurecr.io/aura/advanced-report-generation:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: OPENAI_API_KEY
          valueFrom:
            secretKeyRef:
              name: aura-secrets
              key: openai-api-key
        - name: STORAGE_CONNECTION_STRING
          valueFrom:
            secretKeyRef:
              name: aura-secrets
              key: storage-connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 500m
            memory: 1Gi
          limits:
            cpu: 2000m
            memory: 3Gi
        livenessProbe:
          httpGet:
            path: /health
            port: 8000
        readinessProbe:
          httpGet:
            path: /health
            port: 8000
---
apiVersion: v1
kind: Service
metadata:
  name: advanced-report-generation
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: advanced-report-generation
---
# Tax Engine Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: tax-engine
  namespace: aura-audit-ai
  labels:
    app: tax-engine
    component: api
spec:
  replicas: 2
  selector:
    matchLabels:
      app: tax-engine
  template:
    metadata:
      labels:
        app: tax-engine
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: tax-engine
        image: ${ACR_NAME}.azurecr.io/aura/tax-engine:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: aura-redis-connection
              key: connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 250m
            memory: 512Mi
          limits:
            cpu: 1000m
            memory: 2Gi
---
apiVersion: v1
kind: Service
metadata:
  name: tax-engine
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: tax-engine
---
# Tax Forms Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: tax-forms
  namespace: aura-audit-ai
  labels:
    app: tax-forms
    component: api
spec:
  replicas: 2
  selector:
    matchLabels:
      app: tax-forms
  template:
    metadata:
      labels:
        app: tax-forms
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: tax-forms
        image: ${ACR_NAME}.azurecr.io/aura/tax-forms:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: STORAGE_CONNECTION_STRING
          valueFrom:
            secretKeyRef:
              name: aura-secrets
              key: storage-connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 250m
            memory: 512Mi
          limits:
            cpu: 1000m
            memory: 1Gi
---
apiVersion: v1
kind: Service
metadata:
  name: tax-forms
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: tax-forms
---
# Tax OCR Intake Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: tax-ocr-intake
  namespace: aura-audit-ai
  labels:
    app: tax-ocr-intake
    component: api
spec:
  replicas: 2
  selector:
    matchLabels:
      app: tax-ocr-intake
  template:
    metadata:
      labels:
        app: tax-ocr-intake
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: tax-ocr-intake
        image: ${ACR_NAME}.azurecr.io/aura/tax-ocr-intake:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: STORAGE_CONNECTION_STRING
          valueFrom:
            secretKeyRef:
              name: aura-secrets
              key: storage-connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 500m
            memory: 1Gi
          limits:
            cpu: 2000m
            memory: 2Gi
---
apiVersion: v1
kind: Service
metadata:
  name: tax-ocr-intake
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: tax-ocr-intake
---
# Tax Review Service
apiVersion: apps/v1
kind: Deployment
metadata:
  name: tax-review
  namespace: aura-audit-ai
  labels:
    app: tax-review
    component: api
spec:
  replicas: 2
  selector:
    matchLabels:
      app: tax-review
  template:
    metadata:
      labels:
        app: tax-review
    spec:
      serviceAccountName: aura-workload-identity
      containers:
      - name: tax-review
        image: ${ACR_NAME}.azurecr.io/aura/tax-review:${IMAGE_TAG}
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: aura-db-connection
              key: connection-string
        - name: REDIS_URL
          valueFrom:
            secretKeyRef:
              name: aura-redis-connection
              key: connection-string
        envFrom:
        - configMapRef:
            name: aura-config
        resources:
          requests:
            cpu: 250m
            memory: 512Mi
          limits:
            cpu: 1000m
            memory: 1Gi
---
apiVersion: v1
kind: Service
metadata:
  name: tax-review
  namespace: aura-audit-ai
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8000
  selector:
    app: tax-review
